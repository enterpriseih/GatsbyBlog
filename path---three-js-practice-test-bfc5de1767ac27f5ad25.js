webpackJsonp([0xb943fd16fa68],{1656:function(n,s){n.exports={data:{file:{childImageSharp:{sizes:{base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsSAAALEgHS3X78AAAHlUlEQVRIx11WaWxU1xWewbQlrdofkSIhGiBpMPZ4Vs/2lpm3zupZPOOZ8Sz2YGzANkaAKaYQUrMkLYgiIlxCQjCYQAwYEoMQNJAIFBxaQgUhoCopYceBJo1pKFVDCbOc0/fesOZKV+fM1Tvf/c56R0VYOZW8lvAxtSybvbExAu1+mndGuaDQ2F4rNHVFhCZJZlMeZ1Qrf9Mt+H+qur/ihFORAFA64J0pVTcXVcDmcKFfruIzZ7rY1H89fAZivjbM1MzFxkAnZqWd9M7KJcTmv7zCN44sY+tflm12C79WLxLCqidWN9cwWpYvsfXL13vasZudgm4mgX4hW6h1teRjnrZCwjOzWO/twIR/FjZ7WnEZ35JvcUSeU4gwSXV7W1sJzEH6R8nSRArlXjr6r7S1DqNUvMAzCXCzSfDxDRAUmyDkaoawtEPi1LxHyGLMkby5gEqUy7atjnq1roosAXqE6Yq7DBXa7RLS6HRG8y4hhbwzDiJbj4IkXUwS5e1h07IOorMePUL6ruiKGmRblg2PesJlq9nxrJMMfydIbhIWP9jMPrBLkrIHgXfG0CdmgKMjwFARFKVvHEQo5xUyKDDRN2T7aE17mV5rfZQYm1lM0EQYWUe0aNTxoKl0Qnk5jVqNA/VaFu3SBS7SB7Ju0ougr2KKWg2DBi17mbCaxyghMzgeMTTp2W7CGkTKHshZqn0Q5Osg6opBhAmAzcADY/NheyQJBi2D8mXVehYMOgEsJg9aTIxSN2YTO+ohQ62G6rGZa5AmAjmj0YvzG5vhVP8f4fTO12FtVxfMjTfC6zPbwOsIQNybhK6GlmLCm5DA6cu2aoeSaaOeVheLxRKgpoJcZ5UAly94MeeiQ+jnQtBCcTBTZ8Ght9fDfy58DDdOHIRj2zdA/4uzYWBpZ6Fr6jR8/lfWP8n2usqA2mQgH7msr3Ks0WgEfGvN6lz/q6tgXqgZjgpZOGSLwsldA4CFG4j3rmP/osU47xkdrm5pLfjdETm+p64cf0fJME34HiVFV+VYajF50UGGc/Nnz4XDfW/ArQ09+M++XsCblwD+fQEL356HswuWwdedS+Dg2p5ilZQwa7VrpCHZ9nOl7Ojg44B0hxxg0hbMjx2rh2iwDk4feReKI58hfn8V8c5lwNyXiF+dRbz4Z1jY1g4TJ1rQbnHfc/ORihJDr5q0kw8AyVqDjpeSEpJLAyaMN6HRwMDuTa/B1fcPwcfbBuHc8SPw+cnDsGvzeim7HOg0DpAYoouPBWUMJxUo65y18X4MtbYJOo3zjgQoxwWen1iNDdPmwPu9+2BvfCXsXbQRehf9Hly0B8aN04OuioGqCipvt/hQ5GLzS4Dh0Tdv3+/nvm0qVVUlfUouboOWK8jxmaznMBXIwpbfroWN63th384tcHTfDpj0gg21lQxoK+m8TQGMb5UxAt6OUYSVkUuGK5MPKiuIHicZwWqDmNNqpE6pIFBjpGDxsqXwuxUroWtBN5w4NgSbNvcDIRW61CUFu9UrtV/si7Fjf/ajUmICSvxKgJMtdQxVK2XOU9RpGNBL3VBeQWIqPR3SjR3QOW8xrFmxCnrWbYJMaobEkr1HE/4zIpv4nrK7NIrbpF+tspoYZdpMLte+wNPRu6S1Bs1GqV/1DOqMPFjIMFbq3dg6cyFkGmagqZqHaoOAHF2XZ6ngWg+XBM4RVoLHOWrLVG4uWpo4FvsvfHz6NktFkbT6QafnQGsUoFLHYm1dFj44cgwYPgQVkymkbP6RWl+LNIRjL/uFhltuNjEoYySCXaNUojOsMPSw4aqwa+o9ga5DggiC1RFDmyMG1bYQVlTSIIhRMJq9RaPZJ4VF+DQZ6MCAmOkLurJ/DYiNt/R67VMKs4hrqjL+o+6mjrj0hjBEOG+1h8FOxcFO1oHVFgazPYQGqdfNthBYpUqwEME78nsT4tP7o96WwWSwA1nKb35iyCZ8M85EXE3oYBO3ab4RKWcSKCaFJJMCQprSpPQcUFwKzWQUKo1+lC9x0r7Fcc+0OVOj8zEkNrY8BAuLDV11ruZvDXrhuJ3NIu+bAYK/FXjfdOA8zegUp6DdmQKNMQD+8HTseW1LYeijE/jB4Q+/Wry8a5L01B6MeaetUcDSjfVjjOVM7da+bTMPvHfkbmrKb5DksjkLncmZqXTe6siAnWmAmkhbYUPvQP7cufO5L69fxyvD/8Ctb+/aI2PU8AmvRGqZAoiIityzb8/T165d3X3t2vD/Pjr+KW7b+R6u2/AOrli9CQfePYQXLg3jpSvDeOLkWTxw6Oh3uwYPrJTMlNHlFcLPeNk6/UOXZ7cuGP1A397fP/7v584vvzJ8o+dvn33+Zm/v9q9X/2EDbN+19+ybm3ds33/ww5f63uovf/D9woVL1A90P5dQqYaGhpQfg4N71BJbteoHqyk7Z+e8zlfuSupPHj+/eO2bso5ZcxQ9Fsiqgny6ZOv3+VTfjIwo+iefnFYN7BxQf3FxuEwGH1c+fgxBuIZnTFuIIh9U2qt3844fb9y0Vf0gXPKm7bzKzYZ+wGTKFFWNz1/6v8OLUiuaFKMJz00yEvaa/RQZnK086s6MutpEqRLx+kcT+rH1f+YikeeNfqnwAAAAAElFTkSuQmCC",aspectRatio:.6666666666666666,src:"/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-25c91.png",srcSet:"/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-8a97b.png 200w,\n/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-0fdf3.png 400w,\n/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-25c91.png 600w",srcWebp:"/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-216f6.webp",srcSetWebp:"/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-5d70e.webp 200w,\n/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-d1677.webp 400w,\n/static/avatar-a4ccbab8e7381acb89452773ce94d5a0-216f6.webp 600w",sizes:"(max-width: 600px) 100vw, 600px"}}},site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}},mainPost:{html:'<h1 id="测试一"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试一</h1>\n<p>画 3 个带有反光的立方体</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/3btjsn?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二</h1>\n<p>对 3 个带有反光的立方体做响应式处理，要求满足下面条件</p>\n<ol>\n<li>窗口任意大小立方体不会被拉伸</li>\n<li>不能出现明显的锯齿（块状化）</li>\n<li>支持高分屏</li>\n</ol>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/nebf1k?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三</h1>\n<p>绘制常见的图元</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/gcewxz?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四</h1>\n<p>太阳，地球，月球模拟</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/w4pi5h?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试五"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试五</h1>\n<p>实现坦克多视角切换</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/msmdwo?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试六"><a href="#%E6%B5%8B%E8%AF%95%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试六</h1>\n<p>实现常见的不同材质</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/cuu62y?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试七"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试七</h1>\n<p>多个纹理加载</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/v163we?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试八"><a href="#%E6%B5%8B%E8%AF%95%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试八</h1>\n<p>实现过滤和 mipmaps</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/fqi2f6?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试九"><a href="#%E6%B5%8B%E8%AF%95%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试九</h1>\n<p>重复，偏移，旋转，包裹一个纹理</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/xtlriw?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十</h1>\n<p>创建环境光</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/17q625?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十一"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十一</h1>\n<p>创建半球光</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/x1b9cp?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十二"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十二</h1>\n<p>创建方向光</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/v7e67l?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十三"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十三</h1>\n<p>创建点光源</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/1j3e52?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十四"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十四</h1>\n<p>创建聚光灯</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/pc9zx5?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十五"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十五</h1>\n<p>创建矩形区域光</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/m38c3f?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十六"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十六</h1>\n<p>模拟实际的光照衰减</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/x2elr4?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十七"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十七</h1>\n<p>实现透视摄像</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/edblhq?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十八"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十八</h1>\n<p>z 冲突实例</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/0xmclm?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试十九"><a href="#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试十九</h1>\n<p>实现正交摄像</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/h7ggwm?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十</h1>\n<p>正交摄像模拟实现 2d canvas</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/6ssft6?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十一"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十一</h1>\n<p>假阴影贴图实现</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/o11cmu?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十二"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十二</h1>\n<p>定向光阴影</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/zonbfj?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十三"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十三</h1>\n<p>聚光灯阴影</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/qjtuhk?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十四"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十四</h1>\n<p>点光源阴影</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ozl5m4?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十五"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十五</h1>\n<ol>\n<li>实现 2 种雾</li>\n<li>是否受雾的影响参数</li>\n</ol>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/uj4rui?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十六"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十六</h1>\n<p>雾的各项参数</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/0mztb3?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十七"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十七</h1>\n<p>实现简单的渲染目标</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/vre5qz?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十八"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十八</h1>\n<p>创建一个使用 BufferGeometry 的方块</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/rs3i1j?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试二十九"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试二十九</h1>\n<p>使用 BufferGeometry 方块的重复顶点数据索引化</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/woj5g0?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十</h1>\n<p>使用类型数组 TypedArrays 动态更新顶点数据的任何一部分</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/0mo4ci?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十一"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十一</h1>\n<p>按需渲染（不使用 requestAnimationFrame）</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/b6ekgv?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十二"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十二</h1>\n<p>canvas 截图：</p>\n<ol>\n<li>截图前调用一次渲染代码</li>\n<li>防止 canvas 被清空（即使使用 <code class="language-text">preserveDrawingBuffer: true</code> 切换横竖屏、切换分辨率还是会清空）</li>\n</ol>\n<p>这里使用方案一，方案二不推荐</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/zen3n2?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十三"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十三</h1>\n<p>canvas 获取键盘输入</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ft38nj?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十四"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十四</h1>\n<p>透明化 canvas</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/7qylxp?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十五"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十五</h1>\n<p>大量对象的优化方案：合并几何体</p>\n<p>优化前：</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/kz8rg3?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>优化后：</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/8gd7k1?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十六"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十六</h1>\n<p>优化对象的同时保持动画效果</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ur1myu?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十七"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十七</h1>\n<p>离屏渲染画布</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/wdp7bt?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十八"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十八</h1>\n<p>加载 .OBJ 文件</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/blxxwe?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试三十九"><a href="#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试三十九</h1>\n<p>加载 .gltf 文件</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/qob9yy?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十</h1>\n<p>透明图片背景，使用 css</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/4ci0m3?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>透明图片背景，使用 threejs 渲染，可被后期效果影响</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/nnnrpf?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十一"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十一</h1>\n<p>立方体贴图实现天空盒</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/jyhq0y?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>等距矩形贴图实现天空盒</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/e9dxl1?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十二"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十二</h1>\n<p>绘制透明立方体</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/mp0mr1?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>绘制透明相交平面</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/k10jil?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>绘制草地</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/pnnejl?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十三"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十三</h1>\n<p>单画布多场景渲染</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/v29sb6?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>单画布多场景屏幕外渲染</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/qg3k9t?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十四"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十四</h1>\n<p>射线追踪法拾取</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/8mq96z?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>基于 GPU 的拾取</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ocw2c6?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十五"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十五</h1>\n<p>后期处理</p>\n<h1 id="测试四十六"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十六</h1>\n<p>写一个基础的 shadertoy 容器</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/zgvn3o?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>在上面的基础上支持从图片中读取纹理</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ct29m8?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>使用上面的 shadertoy 纹理画立方体</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/mnek69?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十七"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十七</h1>\n<p>对齐 HTML 元素到 3D 对象</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/9pld70?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>在上面的基础上实现给谷歌地图添加标签</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/sebyby?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十八"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十八</h1>\n<p>使用纹理索引来拾取和着色</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ecuhy2?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试四十九"><a href="#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试四十九</h1>\n<p>用 canvas 动态纹理绘制立方体</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/ey4m6l?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>利用以上方式绘制文本标签</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/sxhfm5?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试五十"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试五十</h1>\n<p>实现一个广告牌形式的文本标签（即这个文本标签始终面向用户）</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/8d6ojv?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>绘制树木网络</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/g1s32s?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>绘制树木网络的立面</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/jr82bj?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试五十一"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试五十一</h1>\n<p>手动释放资源（需要明确指定）</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/f5od2u?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>自动释放资源</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/9ff10e?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<h1 id="测试五十二"><a href="#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试五十二</h1>\n<p>写一个简易版我的世界</p>\n<p><html><head></head><body><iframe data-src="https://codesandbox.io/embed/99dnps?codemirror=1&amp;hidenavigation=1&amp;module=index.js&amp;theme=light&amp;view=split" class="embedded-codesandbox lazy" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin allow-downloads"></iframe></body></html></p>\n<p>// TODO threejs 练手测试</p>',
excerpt:"测试一 画 3 个带有反光的立方体 测试二 对…",timeToRead:7,tableOfContents:'<ul>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%80">测试一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C">测试二</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89">测试三</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B">测试四</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%94">测试五</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%85%AD">测试六</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%83">测试七</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%85%AB">测试八</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B9%9D">测试九</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81">测试十</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%80">测试十一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%BA%8C">测试十二</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%89">测试十三</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%9B%9B">测试十四</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%BA%94">测试十五</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%85%AD">测试十六</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B8%83">测试十七</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E5%85%AB">测试十八</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%8D%81%E4%B9%9D">测试十九</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81">测试二十</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%80">测试二十一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%BA%8C">测试二十二</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%89">测试二十三</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%9B%9B">测试二十四</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%BA%94">测试二十五</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%85%AD">测试二十六</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B8%83">测试二十七</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E5%85%AB">测试二十八</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%8C%E5%8D%81%E4%B9%9D">测试二十九</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81">测试三十</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%80">测试三十一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%BA%8C">测试三十二</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%89">测试三十三</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%9B%9B">测试三十四</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%BA%94">测试三十五</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%85%AD">测试三十六</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B8%83">测试三十七</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E5%85%AB">测试三十八</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%B8%89%E5%8D%81%E4%B9%9D">测试三十九</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81">测试四十</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%80">测试四十一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%BA%8C">测试四十二</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%89">测试四十三</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%9B%9B">测试四十四</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%BA%94">测试四十五</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%85%AD">测试四十六</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B8%83">测试四十七</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E5%85%AB">测试四十八</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E5%9B%9B%E5%8D%81%E4%B9%9D">测试四十九</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81">测试五十</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81%E4%B8%80">测试五十一</a></li>\n<li><a href="/three-js-practice-test/#%E6%B5%8B%E8%AF%95%E4%BA%94%E5%8D%81%E4%BA%8C">测试五十二</a></li>\n</ul>',wordCount:{words:267},frontmatter:{date:"2023-05-15 18:53:49",path:"/three-js-practice-test/",tags:"前端, three.js, WebGL, 练手测试",title:"Three.js练手测试",draft:null,catalog_number:null}},nextPost:{html:'<h1 id="背景知识"><a href="#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>背景知识</h1>\n<p><a href="https://course.rs/about-book.html" target="_blank" rel="nofollow noreferrer noopener">Rust 语言圣经</a></p>\n<h1 id="变量绑定与解构"><a href="#%E5%8F%98%E9%87%8F%E7%BB%91%E5%AE%9A%E4%B8%8E%E8%A7%A3%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>变量绑定与解构</h1>\n<h2 id="问题一"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h2>\n<p>变量只有在初始化后才能被使用</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5642600519977248000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并尽可能少的修改\nfn main() {\n    let x: i32; // 未初始化，但被使用\n    let y: i32; // 未初始化，也未被使用\n    println!(&quot;x is equal to {}&quot;, x);\n}`, `5642600519977248000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并尽可能少的修改</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">;</span> <span class="token comment">// 未初始化，但被使用</span>\n    <span class="token keyword">let</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">;</span> <span class="token comment">// 未初始化，也未被使用</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is equal to {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23673494914637017000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并尽可能少的修改\nfn main() {\n    let x: i32 = 0; // 未初始化，但被使用\n    let _y: i32; // 未初始化，也未被使用\n    println!(&quot;x is equal to {}&quot;, x);\n}`, `23673494914637017000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并尽可能少的修改</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 未初始化，但被使用</span>\n    <span class="token keyword">let</span> _y<span class="token punctuation">:</span> i32<span class="token punctuation">;</span> <span class="token comment">// 未初始化，也未被使用</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is equal to {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题二"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h2>\n<p>可以使用 mut 将变量标记为可变</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49702950419764404000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 完形填空，让代码编译\nfn main() {\n    let __ =  1;\n    __ += 2;\n\n    println!(&quot;x = {}&quot;, x);\n}`, `49702950419764404000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 完形填空，让代码编译</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> __ <span class="token operator">=</span>  <span class="token number">1</span><span class="token punctuation">;</span>\n    __ <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x = {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-1"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84185664683527820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 完形填空，让代码编译\nfn main() {\n    let mut x = 1;\n    x += 2;\n\n    println!(&quot;x = {}&quot;, x);\n}`, `84185664683527820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 完形填空，让代码编译</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x = {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题三"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h2>\n<p>作用域是一个变量在程序中能够保持合法的范围</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39597534446557810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并使用尽可能少的改变\nfn main() {\n    let x: i32 = 10;\n    {\n        let y: i32 = 5;\n        println!(&quot;x 的值是 {}, y 的值是 {}&quot;, x, y);\n    }\n    println!(&quot;x 的值是 {}, y 的值是 {}&quot;, x, y);\n}`, `39597534446557810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并使用尽可能少的改变</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> y<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的值是 {}, y 的值是 {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的值是 {}, y 的值是 {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-2"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71512826213123870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并使用尽可能少的改变\nfn main() {\n    let x: i32 = 10;\n    let y: i32 = 5;\n    {\n        println!(&quot;x 的值是 {}, y 的值是 {}&quot;, x, y);\n    }\n    println!(&quot;x 的值是 {}, y 的值是 {}&quot;, x, y);\n}`, `71512826213123870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并使用尽可能少的改变</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的值是 {}, y 的值是 {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的值是 {}, y 的值是 {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="最佳解答"><a href="#%E6%9C%80%E4%BD%B3%E8%A7%A3%E7%AD%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36961971963262830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x: i32 = 10;\n    {\n        let y: i32 = 5;\n        println!(&quot;The value of x is {} and value of y is {}&quot;, x, y);\n    }\n    println!(&quot;The value of x is {}&quot;, x);\n}`, `36961971963262830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> y<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The value of x is {} and value of y is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The value of x is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题四"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69214641746279710000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    println!(&quot;{}, world&quot;, x);\n}\n\nfn define_x() {\n    let x = &quot;hello&quot;;\n}`, `69214641746279710000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, world"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">define_x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-3"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="37856794281684935000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let x = define_x();\n    println!(&quot;{}, world&quot;, x);\n}\n\nfn define_x() -> &\'static str {\n    let x = &quot;hello&quot;;\n    x\n}`, `37856794281684935000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">define_x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, world"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">define_x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n    x\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="最佳解答-1"><a href="#%E6%9C%80%E4%BD%B3%E8%A7%A3%E7%AD%94-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16269198337281376000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = define_x();\n    println!(&quot;{}, world&quot;, x);\n}\n\nfn define_x() -> String {\n    let x = &quot;hello&quot;.to_string();\n    x\n}`, `16269198337281376000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">define_x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, world"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">define_x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    x\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题五"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h2>\n<p>若后面的变量声明的名称和之前的变量相同，则我们说：第一个变量被第二个同名变量遮蔽了（shadowing）</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10878833191641713000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 只允许修改 \\`assert_eq!\\` 来让 \\`println!\\` 工作(在终端输出 \\`42\\`)\nfn main() {\n    let x: i32 = 5;\n    {\n        let x = 12;\n        assert_eq!(x, 5);\n    }\n\n    assert_eq!(x, 12);\n\n    let x = 42;\n    println!(&quot;{}&quot;, x); // 输出 &quot;42&quot;.\n}`, `10878833191641713000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 只允许修改 `assert_eq!` 来让 `println!` 工作(在终端输出 `42`)</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 "42".</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-4"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16743620890345000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 只允许修改 \\`assert_eq!\\` 来让 \\`println!\\` 工作(在终端输出 \\`42\\`)\nfn main() {\n    let x: i32 = 5;\n    {\n        let x = 12;\n        assert_eq!(x, 12);\n    }\n\n    assert_eq!(x, 5);\n\n    let x = 42;\n    println!(&quot;{}&quot;, x); // 输出 &quot;42&quot;.\n}`, `16743620890345000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 只允许修改 `assert_eq!` 来让 `println!` 工作(在终端输出 `42`)</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 "42".</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题六"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h2>\n<p>删除一行代码以通过编译</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78604359632446200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut x: i32 = 1;\n    x = 7;\n    // 遮蔽且再次绑定\n    let x = x;\n    x += 3;\n\n\n    let y = 4;\n    // 遮蔽\n    let y = &quot;I can also be bound to text!&quot;;\n}`, `78604359632446200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>\n    <span class="token comment">// 遮蔽且再次绑定</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    x <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n\n\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>\n    <span class="token comment">// 遮蔽</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token string">"I can also be bound to text!"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-5"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43583055499985870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut x: i32 = 1;\n    x = 7;\n    // 遮蔽且再次绑定\n    let x = x;\n\n    let y = 4;\n    // 遮蔽\n    let y = &quot;I can also be bound to text!&quot;;\n}`, `43583055499985870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>\n    <span class="token comment">// 遮蔽且再次绑定</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> x<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>\n    <span class="token comment">// 遮蔽</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token string">"I can also be bound to text!"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题七"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h2>\n<p>使用以下方法来修复编译器输出的 warning:</p>\n<ul>\n<li>一种方法</li>\n<li>两种方法</li>\n</ul>\n<blockquote>\n<p>注意: 你可以使用两种方法解决，但是它们没有一种是移除 <code class="language-text">let x = 1</code> 所在的代码行</p>\n</blockquote>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7759373415180692000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = 1;\n}\n\n// compiler warning: unused variable: \\`x\\``, `7759373415180692000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// compiler warning: unused variable: `x`</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-6"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73200678181666460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let _x = 1;\n}\n\n// compiler warning: unused variable: \\`x\\``, `73200678181666460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// compiler warning: unused variable: `x`</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88668337412629940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[allow(unused_variables)]\nfn main() {\n    let x = 1;\n}\n\n// compiler warning: unused variable: \\`x\\``, `88668337412629940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[allow(unused_variables)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// compiler warning: unused variable: `x`</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题八"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h2>\n<p>我们可以将 let 跟一个模式一起使用来解构一个元组，最终将它解构为多个独立的变量</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52743159359602655000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并尽可能少的修改\nfn main() {\n    let (x, y) = (1, 2);\n    x += 2;\n\n    assert_eq!(x, 3);\n    assert_eq!(y, 2);\n}`, `52743159359602655000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并尽可能少的修改</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-7"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86042843356885990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并尽可能少的修改\nfn main() {\n    let (mut x, y) = (1, 2);\n    x += 2;\n\n    assert_eq!(x, 3);\n    assert_eq!(y, 2);\n}`, `86042843356885990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并尽可能少的修改</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">mut</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95696972174476480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复下面代码的错误并尽可能少的修改\nfn main() {\n    let (x, y) = (1, 2);\n    let x = 3;\n\n    assert_eq!(x, 3);\n    assert_eq!(y, 2);\n}`, `95696972174476480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复下面代码的错误并尽可能少的修改</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题九"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h2>\n<p>在赋值语句的左式中使用元组、切片或结构体进行匹配赋值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3974824339301896700"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y);\n    (x, ..) = (3, 4);\n    [.., y] = [1, 2];\n    // 填空，让代码工作\n    assert_eq!([x, y], __);\n}`, `3974824339301896700`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">..</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 填空，让代码工作</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-8"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69418401683634270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y);\n    (x, ..) = (3, 4);\n    [.., y] = [1, 2];\n    // 填空，让代码工作\n    assert_eq!([x, y], [3, 2]);\n}`, `69418401683634270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">..</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 填空，让代码工作</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="基本类型"><a href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基本类型</h1>\n<h2 id="数值类型"><a href="#%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数值类型</h2>\n<h3 id="问题一-1"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>如果我们没有显式的给予变量一个类型，那编译器会自动帮我们推导一个类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80763013841382600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 移除某个部分让代码工作\nfn main() {\n    let x: i32 = 5;\n    let mut y: u32 = 5;\n\n    y = x;\n\n    let z = 10; // 这里 z 的类型是?\n}`, `80763013841382600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 移除某个部分让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> y<span class="token punctuation">:</span> u32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n    y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 这里 z 的类型是?</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-9"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53983903927150380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 移除某个部分让代码工作\nfn main() {\n    let x: i32 = 5;\n    let mut y: u32 = 5;\n\n    // y = x;\n\n    let z = 10; // 这里 z 的类型是?\n}`, `53983903927150380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 移除某个部分让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> y<span class="token punctuation">:</span> u32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// y = x;</span>\n\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 这里 z 的类型是?</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="最佳解答-2"><a href="#%E6%9C%80%E4%BD%B3%E8%A7%A3%E7%AD%94-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61225916623403260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x: i32 = 5;\n    let mut y = 5;\n\n    y = x;\n\n    let z = 10; // type of z : i32\n}`, `61225916623403260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n    y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// type of z : i32</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-1"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7569014945880070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let v: u16 = 38_u8 as __;\n}`, `7569014945880070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> u16 <span class="token operator">=</span> <span class="token number">38_u8</span> <span class="token keyword">as</span> __<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-10"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92612669882478720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let v: u16 = 38_u8 as u16;\n}`, `92612669882478720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> u16 <span class="token operator">=</span> <span class="token number">38_u8</span> <span class="token keyword">as</span> u16<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-1"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83029353585194240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//  修改 \\`assert_eq!\\` 让代码工作\nfn main() {\n    let x = 5;\n    assert_eq!(&quot;u32&quot;.to_string(), type_of(&x));\n}\n\n// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;\nfn type_of<T>(_: &T) -> String {\n    format!(&quot;{}&quot;, std::any::type_name::<T>())\n}`, `83029353585194240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">//  修改 `assert_eq!` 让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token string">"u32"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">type_of</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  "i8", "u8", "i32", "u32"</span>\n<span class="token keyword">fn</span> type_of<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>_<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> std<span class="token punctuation">::</span>any<span class="token punctuation">::</span>type_name<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-11"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76538999259479430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//  修改 \\`assert_eq!\\` 让代码工作\nfn main() {\n    let x = 5;\n    assert_eq!(&quot;i32&quot;.to_string(), type_of(&x));\n}\n\n// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;\nfn type_of<T>(_: &T) -> String {\n    format!(&quot;{}&quot;, std::any::type_name::<T>())\n}`, `76538999259479430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">//  修改 `assert_eq!` 让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token string">"i32"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">type_of</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  "i8", "u8", "i32", "u32"</span>\n<span class="token keyword">fn</span> type_of<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>_<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> std<span class="token punctuation">::</span>any<span class="token punctuation">::</span>type_name<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-1"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25118567886788813000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\nfn main() {\n    assert_eq!(i8::MAX, __);\n    assert_eq!(u8::MAX, __);\n}`, `25118567886788813000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>i8<span class="token punctuation">::</span>MAX<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>u8<span class="token punctuation">::</span>MAX<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-12"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92271263443360940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\nfn main() {\n    assert_eq!(i8::MAX, 127);\n    assert_eq!(u8::MAX, 255);\n}`, `92271263443360940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>i8<span class="token punctuation">::</span>MAX<span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>u8<span class="token punctuation">::</span>MAX<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-1"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8933507792420170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 解决代码中的错误和 \\`panic\\`\nfn main() {\n   let v1 = 251_u8 + 8;\n   let v2 = i8::checked_add(251, 8).unwrap();\n   println!(&quot;{},{}&quot;,v1,v2);\n}`, `8933507792420170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 解决代码中的错误和 `panic`</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token number">251_u8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v2 <span class="token operator">=</span> i8<span class="token punctuation">::</span><span class="token function">checked_add</span><span class="token punctuation">(</span><span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-13"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88757797488187690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 解决代码中的错误和 \\`panic\\`\nfn main() {\n    let v1 = 251_u16 + 8;\n    let v2 = i16::checked_add(251, 8).unwrap();\n    println!(&quot;{},{}&quot;, v1, v2);\n}`, `88757797488187690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 解决代码中的错误和 `panic`</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token number">251_u16</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v2 <span class="token operator">=</span> i16<span class="token punctuation">::</span><span class="token function">checked_add</span><span class="token punctuation">(</span><span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="最佳解答-3"><a href="#%E6%9C%80%E4%BD%B3%E8%A7%A3%E7%AD%94-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30817216709063434000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let v1 = 247_u8 + 8;\n    let v2 = i8::checked_add(119, 8).unwrap();\n    println!(&quot;{},{}&quot;, v1, v2);\n}`, `30817216709063434000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token number">247_u8</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v2 <span class="token operator">=</span> i8<span class="token punctuation">::</span><span class="token function">checked_add</span><span class="token punctuation">(</span><span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-1"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67407658669269900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改 \\`assert!\\` 让代码工作\nfn main() {\n    let v = 1_024 + 0xff + 0o77 + 0b1111_1111;\n    assert!(v == 1579);\n}`, `67407658669269900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改 `assert!` 让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token number">1_024</span> <span class="token operator">+</span> <span class="token number">0xff</span> <span class="token operator">+</span> <span class="token number">0o77</span> <span class="token operator">+</span> <span class="token number">0b1111_1111</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>v <span class="token operator">==</span> <span class="token number">1579</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-14"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96151186361267030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改 \\`assert!\\` 让代码工作\nfn main() {\n    let v = 1_024 + 0xff + 0o77 + 0b1111_1111;\n    assert!(v == 1597);\n}`, `96151186361267030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改 `assert!` 让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token number">1_024</span> <span class="token operator">+</span> <span class="token number">0xff</span> <span class="token operator">+</span> <span class="token number">0o77</span> <span class="token operator">+</span> <span class="token number">0b1111_1111</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>v <span class="token operator">==</span> <span class="token number">1597</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-1"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65476639229886710000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 将 ? 替换成你的答案\nfn main() {\n    let x = 1_000.000_1; // ?\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}`, `65476639229886710000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 将 ? 替换成你的答案</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1_000.000_1</span><span class="token punctuation">;</span> <span class="token comment">// ?</span>\n    <span class="token keyword">let</span> y<span class="token punctuation">:</span> f32 <span class="token operator">=</span> <span class="token number">0.12</span><span class="token punctuation">;</span> <span class="token comment">// f32</span>\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">0.01_f64</span><span class="token punctuation">;</span> <span class="token comment">// f64</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-15"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90469422767399400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 将 ? 替换成你的答案\nfn main() {\n    let x = 1_000.000_1; // f64\n    let y: f32 = 0.12; // f32\n    let z = 0.01_f64; // f64\n}`, `90469422767399400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 将 ? 替换成你的答案</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1_000.000_1</span><span class="token punctuation">;</span> <span class="token comment">// f64</span>\n    <span class="token keyword">let</span> y<span class="token punctuation">:</span> f32 <span class="token operator">=</span> <span class="token number">0.12</span><span class="token punctuation">;</span> <span class="token comment">// f32</span>\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">0.01_f64</span><span class="token punctuation">;</span> <span class="token comment">// f64</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-1"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>使用两种方法来让下面代码工作</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3840995722288487400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    assert!(0.1 + 0.2 == 0.3);\n}`, `3840995722288487400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">==</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-16"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93605552158168220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    assert!((0.1_f64 + 0.2 - 0.3).abs() < 0.00001);\n}`, `93605552158168220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1_f64</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">-</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.00001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14387139644908188000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    assert!(0.1_f32 + 0.2_f32 == 0.3_f32);\n}`, `14387139644908188000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">0.1_f32</span> <span class="token operator">+</span> <span class="token number">0.2_f32</span> <span class="token operator">==</span> <span class="token number">0.3_f32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-1"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<p>两个目标:</p>\n<ol>\n<li>修改 assert! 让它工作</li>\n<li>让 println! 输出: 97 - 122</li>\n</ol>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71938460943863410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -3);\n\n    for c in \'a\'..=\'z\' {\n        println!(&quot;{}&quot;, c);\n    }\n}`, `71938460943863410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>\n        sum <span class="token operator">+=</span> i\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token char string">\'a\'</span><span class="token punctuation">..=</span><span class="token char string">\'z\'</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-17"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11059135849218294000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in \'a\'..=\'z\' {\n        println!(&quot;{}&quot;, c);\n    }\n}`, `11059135849218294000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>\n        sum <span class="token operator">+=</span> i\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token char string">\'a\'</span><span class="token punctuation">..=</span><span class="token char string">\'z\'</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="最佳解答-4"><a href="#%E6%9C%80%E4%BD%B3%E8%A7%A3%E7%AD%94-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最佳解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8085245759200666000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut sum = 0;\n    for i in -3..2 {\n        sum += i\n    }\n\n    assert!(sum == -5);\n\n    for c in \'a\'..=\'z\' {\n        println!(&quot;{}&quot;, c as u8);\n    }\n}`, `8085245759200666000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>\n        sum <span class="token operator">+=</span> i\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token char string">\'a\'</span><span class="token punctuation">..=</span><span class="token char string">\'z\'</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c <span class="token keyword">as</span> u8<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43321893725529460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..__), Range{ start: 1, end: 5 });\n    assert_eq!((1..__), RangeInclusive::new(1, 5));\n}`, `43321893725529460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span><span class="token punctuation">{</span>Range<span class="token punctuation">,</span> RangeInclusive<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span>__<span class="token punctuation">)</span><span class="token punctuation">,</span> Range<span class="token punctuation">{</span> start<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> end<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span>__<span class="token punctuation">)</span><span class="token punctuation">,</span> RangeInclusive<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-18"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45727933817886620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::ops::{Range, RangeInclusive};\nfn main() {\n    assert_eq!((1..5), Range { start: 1, end: 5 });\n    assert_eq!((1..=5), RangeInclusive::new(1, 5));\n}`, `45727933817886620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span><span class="token punctuation">{</span>Range<span class="token punctuation">,</span> RangeInclusive<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Range <span class="token punctuation">{</span> start<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> end<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> RangeInclusive<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十一"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81%E4%B8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9014034844131658000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，并解决错误\nfn main() {\n    // 整数加法\n    assert!(1u32 + 2 == __);\n\n    // 整数减法\n    assert!(1i32 - 2 == __);\n    assert!(1u8 - 2 == -1);\n\n    assert!(3 * 50 == __);\n\n    assert!(9.6 / 3.2 == 3.0); // error ! 修改它让代码工作\n\n    assert!(24 % 5 == __);\n\n    // 逻辑与或非操作\n    assert!(true && false == __);\n    assert!(true || false == __);\n    assert!(!true == __);\n\n    // 位操作\n    println!(&quot;0011 AND 0101 is {:04b}&quot;, 0b0011u32 & 0b0101);\n    println!(&quot;0011 OR 0101 is {:04b}&quot;, 0b0011u32 | 0b0101);\n    println!(&quot;0011 XOR 0101 is {:04b}&quot;, 0b0011u32 ^ 0b0101);\n    println!(&quot;1 << 5 is {}&quot;, 1u32 << 5);\n    println!(&quot;0x80 >> 2 is 0x{:x}&quot;, 0x80u32 >> 2);\n}`, `9014034844131658000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，并解决错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 整数加法</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1u32</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 整数减法</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1i32</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1u8</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">9.6</span> <span class="token operator">/</span> <span class="token number">3.2</span> <span class="token operator">==</span> <span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error ! 修改它让代码工作</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 逻辑与或非操作</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token keyword">true</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">false</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token keyword">true</span> <span class="token operator">||</span> <span class="token keyword">false</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">true</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 位操作</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 AND 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">&amp;</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 OR 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">|</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 XOR 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">^</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"1 &lt;&lt; 5 is {}"</span><span class="token punctuation">,</span> <span class="token number">1u32</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0x80 >> 2 is 0x{:x}"</span><span class="token punctuation">,</span> <span class="token number">0x80u32</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-19"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42806187519988970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，并解决错误\nfn main() {\n    // 整数加法\n    assert!(1u32 + 2 == 3);\n\n    // 整数减法\n    assert!(1i32 - 2 == -1);\n    assert!(1i8 - 2 == -1);\n\n    assert!(3 * 50 == 150);\n\n    assert!(9.6_f32 / 3.2_f32 == 3.0_f32); // error ! 修改它让代码工作\n\n    assert!(24 % 5 == 4);\n\n    // 逻辑与或非操作\n    assert!(true && false == false);\n    assert!(true || false == true);\n    assert!(!true == false);\n\n    // 位操作\n    println!(&quot;0011 AND 0101 is {:04b}&quot;, 0b0011u32 & 0b0101);\n    println!(&quot;0011 OR 0101 is {:04b}&quot;, 0b0011u32 | 0b0101);\n    println!(&quot;0011 XOR 0101 is {:04b}&quot;, 0b0011u32 ^ 0b0101);\n    println!(&quot;1 << 5 is {}&quot;, 1u32 << 5);\n    println!(&quot;0x80 >> 2 is 0x{:x}&quot;, 0x80u32 >> 2);\n}`, `42806187519988970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，并解决错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 整数加法</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1u32</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 整数减法</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1i32</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">1i8</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">==</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">9.6_f32</span> <span class="token operator">/</span> <span class="token number">3.2_f32</span> <span class="token operator">==</span> <span class="token number">3.0_f32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error ! 修改它让代码工作</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 逻辑与或非操作</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token keyword">true</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">false</span> <span class="token operator">==</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token keyword">true</span> <span class="token operator">||</span> <span class="token keyword">false</span> <span class="token operator">==</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">true</span> <span class="token operator">==</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 位操作</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 AND 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">&amp;</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 OR 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">|</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0011 XOR 0101 is {:04b}"</span><span class="token punctuation">,</span> <span class="token number">0b0011u32</span> <span class="token operator">^</span> <span class="token number">0b0101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"1 &lt;&lt; 5 is {}"</span><span class="token punctuation">,</span> <span class="token number">1u32</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"0x80 >> 2 is 0x{:x}"</span><span class="token punctuation">,</span> <span class="token number">0x80u32</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="字符、布尔、单元类型"><a href="#%E5%AD%97%E7%AC%A6%E3%80%81%E5%B8%83%E5%B0%94%E3%80%81%E5%8D%95%E5%85%83%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字符、布尔、单元类型</h2>\n<h3 id="问题一-2"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20037726969077750000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//  修改 2 处 \\`assert_eq!\\` 让代码工作\n\nuse std::mem::size_of_val;\nfn main() {\n    let c1 = \'a\';\n    assert_eq!(size_of_val(&c1), 1);\n\n    let c2 = \'中\';\n    assert_eq!(size_of_val(&c2), 3);\n\n    println!(&quot;Success!&quot;)\n}`, `20037726969077750000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">//  修改 2 处 `assert_eq!` 让代码工作</span>\n\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of_val<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c1 <span class="token operator">=</span> <span class="token char string">\'a\'</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> c2 <span class="token operator">=</span> <span class="token char string">\'中\'</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-20"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5441012622209951000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改 2 处 \\`assert_eq!\\` 让代码工作\n\nuse std::mem::size_of_val;\nfn main() {\n    let c1 = \'a\';\n    assert_eq!(size_of_val(&c1), 4);\n\n    let c2 = \'中\';\n    assert_eq!(size_of_val(&c2), 4);\n\n    println!(&quot;Success!&quot;)\n}`, `5441012622209951000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改 2 处 `assert_eq!` 让代码工作</span>\n\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of_val<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c1 <span class="token operator">=</span> <span class="token char string">\'a\'</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> c2 <span class="token operator">=</span> <span class="token char string">\'中\'</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-2"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64435186725054150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改一行让代码正常打印\nfn main() {\n    let c1 = &quot;中&quot;;\n    print_char(c1);\n}\n\nfn print_char(c : char) {\n    println!(&quot;{}&quot;, c);\n}`, `64435186725054150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改一行让代码正常打印</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c1 <span class="token operator">=</span> <span class="token string">"中"</span><span class="token punctuation">;</span>\n    <span class="token function">print_char</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_char</span><span class="token punctuation">(</span>c <span class="token punctuation">:</span> char<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-21"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53538978729505770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改一行让代码正常打印\nfn main() {\n    let c1 = \'中\';\n    print_char(c1);\n}\n\nfn print_char(c: char) {\n    println!(&quot;{}&quot;, c);\n}`, `53538978729505770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改一行让代码正常打印</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c1 <span class="token operator">=</span> <span class="token char string">\'中\'</span><span class="token punctuation">;</span>\n    <span class="token function">print_char</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_char</span><span class="token punctuation">(</span>c<span class="token punctuation">:</span> char<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-2"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28949804862002516000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使成功打印\nfn main() {\n    let _f: bool = false;\n\n    let t = true;\n    if !t {\n        println!(&quot;Success!&quot;)\n    }\n}`, `28949804862002516000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使成功打印</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _f<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token operator">!</span>t <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-22"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99667719132407220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使成功打印\nfn main() {\n    let _f: bool = false;\n\n    let t = true;\n    if t {\n        println!(&quot;Success!&quot;)\n    }\n}`, `99667719132407220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使成功打印</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _f<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> t <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-2"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58505703424930020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let f = true;\n    let t = true && false;\n    assert_eq!(t, f);\n\n    println!(&quot;Success!&quot;)\n}`, `58505703424930020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">false</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-23"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92210331163387890000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let f = true;\n    let t = true && false;\n    assert_eq!(t, !f);\n\n    println!(&quot;Success!&quot;)\n}`, `92210331163387890000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">false</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token operator">!</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-2"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75126570239183770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 让代码工作，但不要修改 \\`implicitly_ret_unit\\` !\nfn main() {\n    let _v: () = ();\n\n    let v = (2, 3);\n    assert_eq!(v, implicitly_ret_unit());\n\n    println!(&quot;Success!&quot;)\n}\n\nfn implicitly_ret_unit() {\n    println!(&quot;I will return a ()&quot;)\n}\n\n// 不要使用下面的函数，它只用于演示！\nfn explicitly_ret_unit() -> () {\n    println!(&quot;I will return a ()&quot;)\n}`, `75126570239183770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 让代码工作，但不要修改 `implicitly_ret_unit` !</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _v<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token function">implicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">implicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"I will return a ()"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 不要使用下面的函数，它只用于演示！</span>\n<span class="token keyword">fn</span> <span class="token function">explicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"I will return a ()"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-24"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66559554922716320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 让代码工作，但不要修改 \\`implicitly_ret_unit\\` !\nfn main() {\n    let _v: () = ();\n\n    let v = ();\n    assert_eq!(v, implicitly_ret_unit());\n\n    println!(&quot;Success!&quot;)\n}\n\nfn implicitly_ret_unit() {\n    println!(&quot;I will return a ()&quot;)\n}\n\n// 不要使用下面的函数，它只用于演示！\nfn explicitly_ret_unit() -> () {\n    println!(&quot;I will return a ()&quot;)\n}`, `66559554922716320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 让代码工作，但不要修改 `implicitly_ret_unit` !</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _v<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token function">implicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">implicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"I will return a ()"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 不要使用下面的函数，它只用于演示！</span>\n<span class="token keyword">fn</span> <span class="token function">explicitly_ret_unit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"I will return a ()"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-2"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>单元类型占用的内存大小是多少？</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32392736596124940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 让代码工作：修改 \\`assert!\\` 中的 \\`4\\`\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 4);\n\n    println!(&quot;Success!&quot;)\n}`, `32392736596124940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 让代码工作：修改 `assert!` 中的 `4`</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of_val<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> unit<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unit<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-25"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59591997742439014000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 让代码工作：修改 \\`assert!\\` 中的 \\`4\\`\nuse std::mem::size_of_val;\nfn main() {\n    let unit: () = ();\n    assert!(size_of_val(&unit) == 0);\n\n    println!(&quot;Success!&quot;)\n}`, `59591997742439014000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 让代码工作：修改 `assert!` 中的 `4`</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of_val<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> unit<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unit<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="语句与表达式"><a href="#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>语句与表达式</h2>\n<h3 id="问题一-3"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70881552273710540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用两种方法让代码工作起来\nfn main() {\n    let v = {\n        let mut x = 1;\n        x += 2\n    };\n\n    assert_eq!(v, 3);\n}`, `70881552273710540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用两种方法让代码工作起来</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        x <span class="token operator">+=</span> <span class="token number">2</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-26"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74819229808579640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let v = {\n        let mut x = 1;\n        x += 2\n    };\n\n    assert_eq!(v, ());\n}`, `74819229808579640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        x <span class="token operator">+=</span> <span class="token number">2</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48752242860921410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let v = {\n        let mut x = 1;\n        x += 2;\n        x\n    };\n\n    assert_eq!(v, 3);\n}`, `48752242860921410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        x <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n        x\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-3"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59018125322464354000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let v = (let x = 3);\n\n    assert!(v == 3);\n}`, `59018125322464354000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>v <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-27"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69766308276851220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let v = {\n        let x = 3;\n        x\n    };\n\n    assert!(v == 3);\n}`, `69766308276851220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n        x\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>v <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-3"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5683564081571579000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = sum(1, 2);\n    assert_eq!(s, 3);\n}\n\nfn sum(x: i32, y: i32) -> i32 {\n    x + y;\n}`, `5683564081571579000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-28"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5180581755105052000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = sum(1, 2);\n    assert_eq!(s, 3);\n}\n\nfn sum(x: i32, y: i32) -> i32 {\n    x + y\n}`, `5180581755105052000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="函数"><a href="#%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数</h2>\n<h3 id="问题一-4"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15007844466592246000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 不要修改下面两行代码!\n    let (x, y) = (1, 2);\n    let s = sum(x, y);\n\n    assert_eq!(s, 3);\n}\n\nfn sum(x, y: i32) {\n    x + y;\n}`, `15007844466592246000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 不要修改下面两行代码!</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-29"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82305714652003700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y) = (1, 2);\n    let s = sum(x, y);\n\n    assert_eq!(s, 3);\n}\n\nfn sum(x: i32, y: i32) -> i32 {\n    x + y\n}`, `82305714652003700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-4"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43548652718097070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    print();\n}\n\n// 使用另一个类型来替代 i32\nfn print() -> i32 {\n    println!(&quot;hello,world&quot;);\n}`, `43548652718097070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 使用另一个类型来替代 i32</span>\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"hello,world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-30"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29417594839434047000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    print();\n}\n\nfn print() -> () {\n    println!(&quot;hello,world&quot;);\n}`, `29417594839434047000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"hello,world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-4"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83996057805826150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 用两种方法求解\nfn main() {\n    never_return();\n}\n\nfn never_return() -> ! {\n    // 实现这个函数，不要修改函数签名!\n}`, `83996057805826150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 用两种方法求解</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现这个函数，不要修改函数签名!</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-31"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42737655458975340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    never_return();\n}\n\nfn never_return() -> ! {\n    loop {}\n}`, `42737655458975340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token keyword">loop</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96060772327591690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    never_return();\n}\n\nfn never_return() -> ! {\n    panic!(&quot;error&quot;)\n}`, `96060772327591690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">never_return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-3"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>发散函数(Diverging function)不会返回任何值，因此它们可以用于替代需要返回任何值的地方</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1022787277534509300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    println!(&quot;Success!&quot;);\n}\n\nfn get_option(tp: u8) -> Option<i32> {\n    match tp {\n        1 => {\n        }\n        _ => {\n        }\n    };\n\n    // 这里与其返回一个 None，不如使用发散函数替代\n    never_return_fn()\n}\n\n// 使用三种方法实现以下发散函数\nfn never_return_fn() -> ! {}`, `1022787277534509300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">get_option</span><span class="token punctuation">(</span>tp<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> tp <span class="token punctuation">{</span>\n        <span class="token number">1</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token punctuation">}</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 这里与其返回一个 None，不如使用发散函数替代</span>\n    <span class="token function">never_return_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 使用三种方法实现以下发散函数</span>\n<span class="token keyword">fn</span> <span class="token function">never_return_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-32"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86329843975872840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn never_return_fn() -> ! {\n    panic!()\n}`, `86329843975872840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">never_return_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7777288023659223000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn never_return_fn() -> ! {\n    todo!();\n}`, `7777288023659223000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">never_return_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token function">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7623425188948896000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn never_return_fn() -> ! {\n    loop {\n        std::thread::sleep(std::time::Duration::from_secs(1))\n    }\n}`, `7623425188948896000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">never_return_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">!</span> <span class="token punctuation">{</span>\n    <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span><span class="token function">sleep</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>time<span class="token punctuation">::</span>Duration<span class="token punctuation">::</span><span class="token function">from_secs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-3"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39764557372264080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 填空\n    let b = __;\n\n    let _v = match b {\n        true => 1,\n        // 发散函数也可以用于 \\`match\\` 表达式，用于替代任何类型的值\n        false => {\n            println!(&quot;Success!&quot;);\n            panic!(&quot;we have no value for \\`false\\`, but we can panic&quot;)\n        }\n    };\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}`, `39764557372264080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> b <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _v <span class="token operator">=</span> <span class="token keyword">match</span> b <span class="token punctuation">{</span>\n        <span class="token keyword">true</span> <span class="token operator">=></span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token comment">// 发散函数也可以用于 `match` 表达式，用于替代任何类型的值</span>\n        <span class="token keyword">false</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"we have no value for `false`, but we can panic"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-33"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-33" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75937862078541480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let b = false;\n\n    let _v = match b {\n        true => 1,\n        // 发散函数也可以用于 \\`match\\` 表达式，用于替代任何类型的值\n        false => {\n            println!(&quot;Success!&quot;);\n            panic!(&quot;we have no value for \\`false\\`, but we can panic&quot;)\n        }\n    };\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}`, `75937862078541480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _v <span class="token operator">=</span> <span class="token keyword">match</span> b <span class="token punctuation">{</span>\n        <span class="token keyword">true</span> <span class="token operator">=></span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token comment">// 发散函数也可以用于 `match` 表达式，用于替代任何类型的值</span>\n        <span class="token keyword">false</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"we have no value for `false`, but we can panic"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="所有权与借用"><a href="#%E6%89%80%E6%9C%89%E6%9D%83%E4%B8%8E%E5%80%9F%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>所有权与借用</h1>\n<h2 id="所有权"><a href="#%E6%89%80%E6%9C%89%E6%9D%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>所有权</h2>\n<h3 id="问题一-5"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11974570128622907000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 使用尽可能多的方法来通过编译\n    let x = String::from(&quot;hello, world&quot;);\n    let y = x;\n    println!(&quot;{},{}&quot;, x, y);\n}`, `11974570128622907000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用尽可能多的方法来通过编译</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-34"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-34" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77944616146873700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = String::from(&quot;hello, world&quot;);\n    let y = x.clone();\n    println!(&quot;{},{}&quot;, x, y);\n}`, `77944616146873700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5354817503361132000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = String::from(&quot;hello, world&quot;);\n    let y = &x;\n    println!(&quot;{},{}&quot;, x, y);\n}`, `5354817503361132000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42317795285782390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = &quot;hello, world&quot;;\n    let y = x;\n    println!(&quot;{},{}&quot;, x, y);\n}`, `42317795285782390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42673803015483930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = String::from(&quot;hello, world&quot;);\n    let y = x.as_str();\n    println!(&quot;{},{}&quot;, x, y);\n}`, `42673803015483930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{},{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-5"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77429285299604570000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 不要修改 main 中的代码\nfn main() {\n    let s1 = String::from(&quot;hello, world&quot;);\n    let s2 = take_ownership(s1);\n\n    println!(&quot;{}&quot;, s2);\n}\n\n// 只能修改下面的代码!\nfn take_ownership(s: String) {\n    println!(&quot;{}&quot;, s);\n}`, `77429285299604570000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 不要修改 main 中的代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">take_ownership</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 只能修改下面的代码!</span>\n<span class="token keyword">fn</span> <span class="token function">take_ownership</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-35"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-35" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97933194520955440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s1 = String::from(&quot;hello, world&quot;);\n    let s2 = take_ownership(s1);\n\n    println!(&quot;{}&quot;, s2);\n}\n\nfn take_ownership(s: String) -> String {\n    println!(&quot;{}&quot;, s);\n    s\n}`, `97933194520955440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token function">take_ownership</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">take_ownership</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-5"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54594119472557834000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = give_ownership();\n    println!(&quot;{}&quot;, s);\n}\n\n// 只能修改下面的代码!\nfn give_ownership() -> String {\n    let s = String::from(&quot;hello, world&quot;);\n    // convert String to Vec\n    // 将 String 转换成 Vec 类型\n    let _s = s.into_bytes();\n    s\n}`, `54594119472557834000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 只能修改下面的代码!</span>\n<span class="token keyword">fn</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// convert String to Vec</span>\n    <span class="token comment">// 将 String 转换成 Vec 类型</span>\n    <span class="token keyword">let</span> _s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">into_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-36"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-36" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4351991679981037600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = give_ownership();\n    println!(&quot;{}&quot;, s);\n}\n\nfn give_ownership() -> String {\n    let s = String::from(&quot;hello, world&quot;);\n    // convert String to Vec\n    // 将 String 转换成 Vec 类型\n    let _s = s.as_bytes();\n    s\n}`, `4351991679981037600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// convert String to Vec</span>\n    <span class="token comment">// 将 String 转换成 Vec 类型</span>\n    <span class="token keyword">let</span> _s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47966098765415970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = give_ownership();\n    println!(&quot;{}&quot;, s);\n}\n\n// Only modify the code below!\nfn give_ownership() -> String {\n    let s = String::from(&quot;hello, world&quot;);\n    s\n}`, `47966098765415970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Only modify the code below!</span>\n<span class="token keyword">fn</span> <span class="token function">give_ownership</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-4"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53881310118097510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要删除任何代码行\nfn main() {\n    let s = String::from(&quot;hello, world&quot;);\n\n    print_str(s);\n\n    println!(&quot;{}&quot;, s);\n}\n\nfn print_str(s: String)  {\n    println!(&quot;{}&quot;,s)\n}`, `53881310118097510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要删除任何代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_str</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_str</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span>  <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-37"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-37" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63394598188520760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello, world&quot;);\n\n    print_str(&s);\n\n    println!(&quot;{}&quot;, s);\n}\n\nfn print_str(s: &String) {\n    println!(&quot;{}&quot;, s)\n}`, `63394598188520760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_str</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47610835531191920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello, world&quot;);\n\n    print_str(s.clone());\n\n    println!(&quot;{}&quot;, s);\n}\n\nfn print_str(s: String)  {\n    println!(&quot;{}&quot;,s)\n}`, `47610835531191920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_str</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span>  <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-4"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1686790515482439200"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 不要使用 clone，使用 copy 的方式替代\nfn main() {\n    let x = (1, 2, (), &quot;hello&quot;.to_string());\n    let y = x.clone();\n    println!(&quot;{:?}, {:?}&quot;, x, y);\n}`, `1686790515482439200`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 不要使用 clone，使用 copy 的方式替代</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-38"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-38" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78500315261281980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = (1, 2, (), &quot;hello&quot;);\n    let y = x;\n    println!(&quot;{:?}, {:?}&quot;, x, y);\n}`, `78500315261281980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-3"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>当所有权转移时，可变性也可以随之改变</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18254175064384205000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello, &quot;);\n\n    // 只修改下面这行代码 !\n    let s1 = s;\n\n    s1.push_str(&quot;world&quot;)\n}`, `18254175064384205000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 只修改下面这行代码 !</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> s<span class="token punctuation">;</span>\n\n    s1<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-39"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-39" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67532418287565110000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello, &quot;);\n\n    let mut s1 = s;\n\n    s1.push_str(&quot;world&quot;)\n}`, `67532418287565110000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s1 <span class="token operator">=</span> s<span class="token punctuation">;</span>\n\n    s1<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-2"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29850605813674426000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = Box::new(5);\n\n    let ...      // 完成该行代码，不要修改其它行！\n\n    *y = 4;\n\n    assert_eq!(*x, 5);\n}`, `29850605813674426000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token punctuation">...</span>      <span class="token comment">// 完成该行代码，不要修改其它行！</span>\n\n    <span class="token operator">*</span>y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-40"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-40" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70967710521060020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = Box::new(5);\n\n    let mut y = Box::new(1);\n\n    *y = 4;\n\n    assert_eq!(*x, 5);\n}`, `70967710521060020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> y <span class="token operator">=</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token operator">*</span>y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-2"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>当解构一个变量时，可以同时使用 move 和引用模式绑定的方式。当这么做时，部分 move 就会发生：变量中一部分的所有权被转移给其它变量，而另一部分我们获取了它的引用。</p>\n<p>在这种情况下，原变量将无法再被使用，但是它没有转移所有权的那一部分依然可以使用，也就是之前被引用的那部分。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48916364674961300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let t = (String::from(&quot;hello&quot;), String::from(&quot;world&quot;));\n\n   let _s = t.0;\n\n   // 仅修改下面这行代码，且不要使用 \\`_s\\`\n   println!(&quot;{:?}&quot;, t);\n}`, `48916364674961300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> _s <span class="token operator">=</span> t<span class="token number">.0</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 仅修改下面这行代码，且不要使用 `_s`</span>\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-41"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-41" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88204143920424170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let t = (String::from(&quot;hello&quot;), String::from(&quot;world&quot;));\n\n    let _s = t.0;\n\n    println!(&quot;{:?}&quot;, t.1);\n}`, `88204143920424170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _s <span class="token operator">=</span> t<span class="token number">.0</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> t<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-2"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34631195003837534000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let t = (String::from(&quot;hello&quot;), String::from(&quot;world&quot;));\n\n   // 填空，不要修改其它代码\n   let (__, __) = __;\n\n   println!(&quot;{:?}, {:?}, {:?}&quot;, s1, s2, t); // -> &quot;hello&quot;, &quot;world&quot;, (&quot;hello&quot;, &quot;world&quot;)\n}`, `34631195003837534000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 填空，不要修改其它代码</span>\n   <span class="token keyword">let</span> <span class="token punctuation">(</span>__<span class="token punctuation">,</span> __<span class="token punctuation">)</span> <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}, {:?}"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -> "hello", "world", ("hello", "world")</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-42"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-42" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82391415583626300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let t = (String::from(&quot;hello&quot;), String::from(&quot;world&quot;));\n\n    let (ref s1, ref s2) = t;\n\n    println!(&quot;{:?}, {:?}, {:?}&quot;, s1, s2, t); // -> &quot;hello&quot;, &quot;world&quot;, (&quot;hello&quot;, &quot;world&quot;)\n}`, `82391415583626300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">ref</span> s1<span class="token punctuation">,</span> <span class="token keyword">ref</span> s2<span class="token punctuation">)</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}, {:?}"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -> "hello", "world", ("hello", "world")</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38080870682646140000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let t = (String::from(&quot;hello&quot;), String::from(&quot;world&quot;));\n\n    let (ref s1, ref s2) = t.clone();\n\n    println!(&quot;{:?}, {:?}, {:?}&quot;, s1, s2, t); // -> &quot;hello&quot;, &quot;world&quot;, (&quot;hello&quot;, &quot;world&quot;)\n}`, `38080870682646140000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">ref</span> s1<span class="token punctuation">,</span> <span class="token keyword">ref</span> s2<span class="token punctuation">)</span> <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}, {:?}"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// -> "hello", "world", ("hello", "world")</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="引用与借用"><a href="#%E5%BC%95%E7%94%A8%E4%B8%8E%E5%80%9F%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引用与借用</h2>\n<h3 id="问题一-6"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>引用</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71116520274042600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let x = 5;\n   // 填写空白处\n   let p = __;\n\n   println!(&quot;x 的内存地址是 {:p}&quot;, p); // output: 0x16fa3ac84\n}`, `71116520274042600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n   <span class="token comment">// 填写空白处</span>\n   <span class="token keyword">let</span> p <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的内存地址是 {:p}"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: 0x16fa3ac84</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-43"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-43" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59069314671239460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = 5;\n    // 填写空白处\n    let p = &x;\n\n    println!(&quot;x 的内存地址是 {:p}&quot;, p); // output: 0x16fa3ac84\n}`, `59069314671239460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token comment">// 填写空白处</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x 的内存地址是 {:p}"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: 0x16fa3ac84</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-6"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57045253630687290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = 5;\n    let y = &x;\n\n    // 只能修改以下行\n    assert_eq!(5, y);\n}`, `57045253630687290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>\n\n    <span class="token comment">// 只能修改以下行</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-44"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-44" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65950854094873380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let x = 5;\n    let y = &x;\n\n    // 只能修改以下行\n    assert_eq!(5, *y);\n}`, `65950854094873380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>\n\n    <span class="token comment">// 只能修改以下行</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-6"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97748242411265050000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    borrow_object(s)\n}\n\nfn borrow_object(s: &String) {}`, `97748242411265050000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-45"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-45" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30603813893026157000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    borrow_object(&s)\n}\n\nfn borrow_object(s: &String) {}`, `30603813893026157000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">borrow_object</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-5"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90707547223179000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    push_str(s)\n}\n\nfn push_str(s: &mut String) {\n    s.push_str(&quot;world&quot;)\n}`, `90707547223179000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">push_str</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">push_str</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-46"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-46" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84040871245315300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    push_str(&mut s)\n}\n\nfn push_str(s: &mut String) {\n    s.push_str(&quot;world&quot;)\n}`, `84040871245315300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">push_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">push_str</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-5"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48041420392607460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    // 填写空白处，让代码工作\n    let p = __;\n\n    p.push_str(&quot;world&quot;);\n}`, `48041420392607460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填写空白处，让代码工作</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n    p<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-47"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-47" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19536452958551597000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    // 填写空白处，让代码工作\n    let p = &mut s;\n\n    p.push_str(&quot;world&quot;);\n}`, `19536452958551597000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填写空白处，让代码工作</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n\n    p<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-4"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>ref 与 &#x26; 类似，可以用来获取一个值的引用，但是它们的用法有所不同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16578417571769854000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let c = \'中\';\n\n    let r1 = &c;\n    // 填写空白处，但是不要修改其它行的代码\n    let __ r2 = c;\n\n    assert_eq!(*r1, *r2);\n\n    // 判断两个内存地址的字符串是否相等\n    assert_eq!(get_addr(r1),get_addr(r2));\n}\n\n// 获取传入引用的内存地址的字符串形式\nfn get_addr(r: &char) -> String {\n    format!(&quot;{:p}&quot;, r)\n}`, `16578417571769854000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token char string">\'中\'</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span>c<span class="token punctuation">;</span>\n    <span class="token comment">// 填写空白处，但是不要修改其它行的代码</span>\n    <span class="token keyword">let</span> __ r2 <span class="token operator">=</span> c<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>r1<span class="token punctuation">,</span> <span class="token operator">*</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 判断两个内存地址的字符串是否相等</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">get_addr</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get_addr</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 获取传入引用的内存地址的字符串形式</span>\n<span class="token keyword">fn</span> <span class="token function">get_addr</span><span class="token punctuation">(</span>r<span class="token punctuation">:</span> <span class="token operator">&amp;</span>char<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{:p}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-48"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-48" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53001922942233936000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let c = \'中\';\n\n    let r1 = &c;\n    let ref r2 = c;\n\n    assert_eq!(*r1, *r2);\n\n    assert_eq!(get_addr(r1), get_addr(r2));\n}\n\nfn get_addr(r: &char) -> String {\n    format!(&quot;{:p}&quot;, r)\n}`, `53001922942233936000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token char string">\'中\'</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span>c<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">ref</span> r2 <span class="token operator">=</span> c<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>r1<span class="token punctuation">,</span> <span class="token operator">*</span>r2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">get_addr</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">get_addr</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">get_addr</span><span class="token punctuation">(</span>r<span class="token punctuation">:</span> <span class="token operator">&amp;</span>char<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{:p}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-3"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<p>借用规则</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91029424164610260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 移除代码某个部分，让它工作\n// 你不能移除整行的代码！\nfn main() {\n    let mut s = String::from(&quot;hello&quot;);\n\n    let r1 = &mut s;\n    let r2 = &mut s;\n\n    println!(&quot;{}, {}&quot;, r1, r2);\n}`, `91029424164610260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 移除代码某个部分，让它工作</span>\n<span class="token comment">// 你不能移除整行的代码！</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-49"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-49" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69590095299706350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 移除代码某个部分，让它工作\n// 你不能移除整行的代码！\nfn main() {\n    let mut s = String::from(&quot;hello&quot;);\n\n    let r1 = &s;\n    let r2 = &s;\n\n    println!(&quot;{}, {}&quot;, r1, r2);\n}`, `69590095299706350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 移除代码某个部分，让它工作</span>\n<span class="token comment">// 你不能移除整行的代码！</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-3"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>错误: 从不可变对象借用可变</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83811844502374400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 通过修改下面一行代码来修复错误\n    let s = String::from(&quot;hello, &quot;);\n\n    borrow_object(&mut s)\n}\n\nfn borrow_object(s: &mut String) {}`, `83811844502374400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 通过修改下面一行代码来修复错误</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">borrow_object</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-50"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-50" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42929605716642840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    borrow_object(&mut s)\n}\n\nfn borrow_object(s: &mut String) {}`, `42929605716642840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">borrow_object</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9518855688996575000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    borrow_object(&s);\n\n    s.push_str(&quot;world&quot;);\n}\n\nfn borrow_object(s: &String) {}`, `9518855688996575000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">borrow_object</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">borrow_object</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>String<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-3"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<p>NLL</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71043776267432720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 注释掉一行代码让它工作\nfn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    let r1 = &mut s;\n    r1.push_str(&quot;world&quot;);\n    let r2 = &mut s;\n    r2.push_str(&quot;!&quot;);\n\n    println!(&quot;{}&quot;,r1);\n}`, `71043776267432720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 注释掉一行代码让它工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    r1<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    r2<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-51"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-51" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29218682886171533000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    let r1 = &mut s;\n    r1.push_str(&quot;world&quot;);\n    let r2 = &mut s;\n    r2.push_str(&quot;!&quot;);\n\n    // println!(&quot;{}&quot;,r1);\n}`, `29218682886171533000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    r1<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    r2<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// println!("{}",r1);</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十-1"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46241320490269900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    let r1 = &mut s;\n    let r2 = &mut s;\n\n    // 在下面增加一行代码人为制造编译错误：cannot borrow \\`s\\` as mutable more than once at a time\n    // 你不能同时使用 r1 和 r2\n}`, `46241320490269900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n\n    <span class="token comment">// 在下面增加一行代码人为制造编译错误：cannot borrow `s` as mutable more than once at a time</span>\n    <span class="token comment">// 你不能同时使用 r1 和 r2</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-52"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-52" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79537100975856580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello, &quot;);\n\n    let r1 = &mut s;\n    let r2 = &mut s;\n\n    println!(&quot;{}&quot;, r1)\n}`, `79537100975856580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> r1<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="复合类型"><a href="#%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>复合类型</h1>\n<h2 id="字符串"><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字符串</h2>\n<h3 id="问题一-7"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>正常情况下我们无法使用 str 类型，但是可以使用 &#x26;str 来替代</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75679725779396210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要新增代码行\nfn main() {\n    let s: str = &quot;hello, world&quot;;\n}`, `75679725779396210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要新增代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-53"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-53" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21181586316151325000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s: &str = &quot;hello, world&quot;;\n}`, `21181586316151325000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-7"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>如果要使用 str 类型，只能配合 Box。 &#x26; 可以用来将 <code class="language-text">Box&lt;str&gt;</code> 转换为 &#x26;str 类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66360120035578180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用至少两种方法来修复错误\nfn main() {\n    let s: Box<str> = &quot;hello, world&quot;.into();\n    greetings(s)\n}\n\nfn greetings(s: &str) {\n    println!(&quot;{}&quot;,s)\n}`, `66360120035578180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用至少两种方法来修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span>str<span class="token operator">></span> <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-54"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-54" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55413525261236620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s: Box<str> = &quot;hello, world&quot;.into();\n    greetings(&s)\n}\n\nfn greetings(s: &str) {\n    println!(&quot;{}&quot;, s)\n}`, `55413525261236620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span>str<span class="token operator">></span> <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54536983081336700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s: Box<&str> = &quot;hello, world&quot;.into();\n    greetings(*s)\n}\n\nfn greetings(s: &str) {\n    println!(&quot;{}&quot;, s);\n}`, `54536983081336700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span><span class="token operator">&amp;</span>str<span class="token operator">></span> <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span><span class="token operator">*</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-7"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>String 是定义在标准库中的类型，分配在堆上，可以动态的增长。它的底层存储是动态字节数组的方式(<code class="language-text">Vec&lt;u8&gt;</code>)，但是与字节数组不同，String 是 UTF-8 编码。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83388803490437870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut s = __;\n    s.push_str(&quot;hello, world&quot;);\n    s.push(\'!\');\n\n    assert_eq!(s, &quot;hello, world!&quot;);\n}`, `83388803490437870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> __<span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-55"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-55" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62768964664968310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;&quot;);\n    s.push_str(&quot;hello, world&quot;);\n    s.push(\'!\');\n\n    assert_eq!(s, &quot;hello, world!&quot;);\n}`, `62768964664968310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62370275722961360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::new();\n    s.push_str(&quot;hello, world&quot;);\n    s.push(\'!\');\n\n    assert_eq!(s, &quot;hello, world!&quot;);\n}`, `62370275722961360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-6"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="208068151737261800"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复所有错误，并且不要新增代码行\nfn main() {\n    let  s = String::from(&quot;hello&quot;);\n    s.push(\',\');\n    s.push(&quot; world&quot;);\n    s += &quot;!&quot;.to_string();\n\n    println!(&quot;{}&quot;, s)\n}`, `208068151737261800`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复所有错误，并且不要新增代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span>  s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\',\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">" world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s <span class="token operator">+=</span> <span class="token string">"!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-56"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-56" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2702621982070829600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello&quot;);\n    s.push(\',\');\n    s.push_str(&quot; world&quot;);\n    s += &quot;!&quot;;\n\n    println!(&quot;{}&quot;, s)\n}`, `2702621982070829600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\',\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">" world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s <span class="token operator">+=</span> <span class="token string">"!"</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-6"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>我们可以用 replace 方法来替换指定的子字符串</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9982774623638413000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let s = String::from(&quot;I like dogs&quot;);\n    // 以下方法会重新分配一块内存空间，然后将修改后的字符串存在这里\n    let s1 = s.__(&quot;dogs&quot;, &quot;cats&quot;);\n\n    assert_eq!(s1, &quot;I like cats&quot;)\n}`, `9982774623638413000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I like dogs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 以下方法会重新分配一块内存空间，然后将修改后的字符串存在这里</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token string">"dogs"</span><span class="token punctuation">,</span> <span class="token string">"cats"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token string">"I like cats"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-57"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-57" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="394902435465227500"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;I like dogs&quot;);\n    let s1 = s.replace(&quot;dogs&quot;, &quot;cats&quot;);\n\n    assert_eq!(s1, &quot;I like cats&quot;)\n}`, `394902435465227500`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I like dogs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"dogs"</span><span class="token punctuation">,</span> <span class="token string">"cats"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token string">"I like cats"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-5"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>你只能将 String 跟 &#x26;str 类型进行拼接，并且 String 的所有权在此过程中会被 move</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74027480489869560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复所有错误，不要删除任何一行代码\nfn main() {\n    let s1 = String::from(&quot;hello,&quot;);\n    let s2 = String::from(&quot;world!&quot;);\n    let s3 = s1 + s2;\n    assert_eq!(s3,&quot;hello,world!&quot;);\n    println!(&quot;{}&quot;,s1);\n}`, `74027480489869560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复所有错误，不要删除任何一行代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s3 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s3<span class="token punctuation">,</span><span class="token string">"hello,world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-58"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-58" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12394829085200753000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s1 = String::from(&quot;hello,&quot;);\n    let s2 = String::from(&quot;world!&quot;);\n    let s3 = s1.clone() + &s2;\n    assert_eq!(s3, &quot;hello,world!&quot;);\n    println!(&quot;{}&quot;, s1);\n}`, `12394829085200753000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s2 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s3 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">&amp;</span>s2<span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s3<span class="token punctuation">,</span> <span class="token string">"hello,world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-4"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<p>我们可以使用两种方法将 &#x26;str 转换成 String 类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86290828008375350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用至少两种方法来修复错误\nfn main() {\n    let s = &quot;hello, world&quot;;\n    greetings(s)\n}\n\nfn greetings(s: String) {\n    println!(&quot;{}&quot;,s)\n}`, `86290828008375350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用至少两种方法来修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-59"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-59" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90516164206787900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;;\n    greetings(s)\n}\n\nfn greetings(s: &str) {\n    println!(&quot;{}&quot;, s)\n}`, `90516164206787900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60739736751724945000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;.to_string();\n    greetings(s)\n}\n\nfn greetings(s: String) {\n    println!(&quot;{}&quot;, s)\n}`, `60739736751724945000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10733447551715080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello, world&quot;);\n    greetings(s)\n}\n\nfn greetings(s: String) {\n    println!(&quot;{}&quot;, s)\n}`, `10733447551715080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">greetings</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-4"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>我们可以使用 String::from 或 <code class="language-text">to_string</code> 将 &#x26;str 转换成 String 类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63472152952324000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用两种方法来解决错误，不要新增代码行\nfn main() {\n    let s = &quot;hello, world&quot;.to_string();\n    let s1: &str = s;\n}`, `63472152952324000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用两种方法来解决错误，不要新增代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-60"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-60" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92721972195137520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;.to_string();\n    let s1: &str = &s;\n}`, `92721972195137520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32511567477157910000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;;\n    let s1: &str = &s;\n}`, `32511567477157910000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96188194270596610000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;.to_string();\n    let s1: &str = &s[..];\n}`, `96188194270596610000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84116098787976360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;hello, world&quot;.to_string();\n    let s1: &str = s.as_str();\n}`, `84116098787976360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-4"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68776038683240940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 你可以使用转义的方式来输出想要的字符，这里我们使用十六进制的值，例如 \\x73 会被转义成小写字母 \'s\'\n    // 填空以输出 &quot;I\'m writing Rust&quot;\n    let byte_escape = &quot;I\'m writing Ru\\x73__!&quot;;\n    println!(&quot;What are you doing\\x3F (\\\\x3F means ?) {}&quot;, byte_escape);\n\n    // 也可以使用 Unicode 形式的转义字符\n    let unicode_codepoint = &quot;\\u{211D}&quot;;\n    let character_name = &quot;\\&quot;DOUBLE-STRUCK CAPITAL R\\&quot;&quot;;\n\n    println!(&quot;Unicode character {} (U+211D) is called {}&quot;,\n                unicode_codepoint, character_name );\n\n    // 还能使用 \\ 来连接多行字符串\n    let long_string = &quot;String literals\n                        can span multiple lines.\n                        The linebreak and indentation here \\\n                         can be escaped too!&quot;;\n    println!(&quot;{}&quot;, long_string);\n}`, `68776038683240940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 你可以使用转义的方式来输出想要的字符，这里我们使用十六进制的值，例如 \\x73 会被转义成小写字母 \'s\'</span>\n    <span class="token comment">// 填空以输出 "I\'m writing Rust"</span>\n    <span class="token keyword">let</span> byte_escape <span class="token operator">=</span> <span class="token string">"I\'m writing Ru\\x73__!"</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"What are you doing\\x3F (\\\\x3F means ?) {}"</span><span class="token punctuation">,</span> byte_escape<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 也可以使用 Unicode 形式的转义字符</span>\n    <span class="token keyword">let</span> unicode_codepoint <span class="token operator">=</span> <span class="token string">"\\u{211D}"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> character_name <span class="token operator">=</span> <span class="token string">"\\"DOUBLE-STRUCK CAPITAL R\\""</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Unicode character {} (U+211D) is called {}"</span><span class="token punctuation">,</span>\n                unicode_codepoint<span class="token punctuation">,</span> character_name <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 还能使用 \\ 来连接多行字符串</span>\n    <span class="token keyword">let</span> long_string <span class="token operator">=</span> "String literals\n                        can span multiple lines<span class="token punctuation">.</span>\n                        The linebreak and indentation here \\\n                         can <span class="token keyword">be</span> escaped <span class="token macro-rules function">too!</span>"<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> long_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-61"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-61" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20614906223120680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let byte_escape = &quot;I\'m writing Ru\\x73\\x74!&quot;;\n    println!(&quot;What are you doing\\x3F (\\\\x3F means ?) {}&quot;, byte_escape);\n\n    let unicode_codepoint = &quot;\\u{211D}&quot;;\n    let character_name = &quot;\\&quot;DOUBLE-STRUCK CAPITAL R\\&quot;&quot;;\n\n    println!(&quot;Unicode character {} (U+211D) is called {}&quot;,\n                unicode_codepoint, character_name );\n\n   let long_string = &quot;String literals\n                        can span multiple lines.\n                        The linebreak and indentation here \\\n                         can be escaped too!&quot;;\n    println!(&quot;{}&quot;, long_string);\n}`, `20614906223120680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> byte_escape <span class="token operator">=</span> <span class="token string">"I\'m writing Ru\\x73\\x74!"</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"What are you doing\\x3F (\\\\x3F means ?) {}"</span><span class="token punctuation">,</span> byte_escape<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> unicode_codepoint <span class="token operator">=</span> <span class="token string">"\\u{211D}"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> character_name <span class="token operator">=</span> <span class="token string">"\\"DOUBLE-STRUCK CAPITAL R\\""</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Unicode character {} (U+211D) is called {}"</span><span class="token punctuation">,</span>\n                unicode_codepoint<span class="token punctuation">,</span> character_name <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> long_string <span class="token operator">=</span> "String literals\n                        can span multiple lines<span class="token punctuation">.</span>\n                        The linebreak and indentation here \\\n                         can <span class="token keyword">be</span> escaped <span class="token macro-rules function">too!</span>"<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> long_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十-2"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h3>\n<p>有时候需要转义的字符很多，我们会希望使用更方便的方式来书写字符串: raw string.</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87112601377029080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 填空并修复所有错误 */\nfn main() {\n    let raw_str = r&quot;Escapes don\'t work here: \\x3F \\u{211D}&quot;;\n    // 修改上面的行让代码工作\n    assert_eq!(raw_str, &quot;Escapes don\'t work here: ? ℝ&quot;);\n\n    // 如果你希望在字符串中使用双引号，可以使用以下形式\n    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;\n    println!(&quot;{}&quot;, quotes);\n\n    // 如果希望在字符串中使用 # 号，可以如下使用：\n    let  delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;\n    println!(&quot;{}&quot;, delimiter);\n\n    // 填空\n    let long_delimiter = __;\n    assert_eq!(long_delimiter, &quot;Hello, \\&quot;##\\&quot;&quot;)\n}`, `87112601377029080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 填空并修复所有错误 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> raw_str <span class="token operator">=</span> <span class="token string">r"Escapes don\'t work here: \\x3F \\u{211D}"</span><span class="token punctuation">;</span>\n    <span class="token comment">// 修改上面的行让代码工作</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>raw_str<span class="token punctuation">,</span> <span class="token string">"Escapes don\'t work here: ? ℝ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 如果你希望在字符串中使用双引号，可以使用以下形式</span>\n    <span class="token keyword">let</span> quotes <span class="token operator">=</span> <span class="token string">r#"And then I said: "There is no escape!""#</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> quotes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 如果希望在字符串中使用 # 号，可以如下使用：</span>\n    <span class="token keyword">let</span>  delimiter <span class="token operator">=</span> <span class="token string">r###"A string with "# in it. And even "##!"###</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> long_delimiter <span class="token operator">=</span> __<span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>long_delimiter<span class="token punctuation">,</span> <span class="token string">"Hello, \\"##\\""</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-62"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-62" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22202425967344697000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let raw_str = &quot;Escapes don\'t work here: \\x3F \\u{211D}&quot;;\n    assert_eq!(raw_str, &quot;Escapes don\'t work here: ? ℝ&quot;);\n\n    let quotes = r#&quot;And then I said: &quot;There is no escape!&quot;&quot;#;\n    println!(&quot;{}&quot;, quotes);\n\n    let delimiter = r###&quot;A string with &quot;# in it. And even &quot;##!&quot;###;\n    println!(&quot;{}&quot;, delimiter);\n\n    let long_delimiter = r###&quot;Hello, &quot;##&quot;&quot;###;\n    assert_eq!(long_delimiter, &quot;Hello, \\&quot;##\\&quot;&quot;)\n}`, `22202425967344697000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> raw_str <span class="token operator">=</span> <span class="token string">"Escapes don\'t work here: \\x3F \\u{211D}"</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>raw_str<span class="token punctuation">,</span> <span class="token string">"Escapes don\'t work here: ? ℝ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> quotes <span class="token operator">=</span> <span class="token string">r#"And then I said: "There is no escape!""#</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> quotes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> delimiter <span class="token operator">=</span> <span class="token string">r###"A string with "# in it. And even "##!"###</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> long_delimiter <span class="token operator">=</span> <span class="token string">r###"Hello, "##""###</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>long_delimiter<span class="token punctuation">,</span> <span class="token string">"Hello, \\"##\\""</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十一-1"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81%E4%B8%80-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十一</h3>\n<p>你无法通过索引的方式去访问字符串中的某个字符，但是可以使用切片的方式 <code class="language-text">&amp;s1[start..end]</code>，但是 start 和 end 必须准确落在字符的边界处</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88573187931815080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s1 = String::from(&quot;hi,中国&quot;);\n    let h = s1[0]; // 修改当前行来修复错误，提示: \\`h\\` 字符在 UTF-8 格式中只需要 1 个字节来表示\n    assert_eq!(h, &quot;h&quot;);\n\n    let h1 = &s1[3..5];// 修改当前行来修复错误，提示: \\`中\\` 字符在 UTF-8 格式中需要 3 个字节来表示\n    assert_eq!(h1, &quot;中&quot;);\n}`, `88573187931815080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hi,中国"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> h <span class="token operator">=</span> s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 修改当前行来修复错误，提示: `h` 字符在 UTF-8 格式中只需要 1 个字节来表示</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> h1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 修改当前行来修复错误，提示: `中` 字符在 UTF-8 格式中需要 3 个字节来表示</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>h1<span class="token punctuation">,</span> <span class="token string">"中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-63"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-63" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58335337623227930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s1 = String::from(&quot;hi,中国&quot;);\n    let h = &s1[0..1];\n    assert_eq!(h, &quot;h&quot;);\n\n    let h1 = &s1[3..6];\n    assert_eq!(h1, &quot;中&quot;);\n}`, `58335337623227930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hi,中国"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> h <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> h1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>h1<span class="token punctuation">,</span> <span class="token string">"中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十二"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81%E4%BA%8C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86692561449017540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 填空，打印出 &quot;你好，世界&quot; 中的每一个字符\n    for c in &quot;你好，世界&quot;.__ {\n        println!(&quot;{}&quot;, c)\n    }\n}`, `86692561449017540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空，打印出 "你好，世界" 中的每一个字符</span>\n    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"你好，世界"</span><span class="token punctuation">.</span>__ <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-64"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-64" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57357198541582790000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    for c in &quot;你好，世界&quot;.chars() {\n        println!(&quot;{}&quot;, c)\n    }\n}`, `57357198541582790000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"你好，世界"</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十三"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81%E4%B8%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十三</h3>\n<p>我们可以使用三方库 <code class="language-text">utf8_slice</code> 来访问 UTF-8 字符串的某个子串，但是与之前不同的是，该库索引的是字符，而不是字节</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26468336286118290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use utf8_slice;\nfn main() {\n    let s = &quot;The 🚀 goes to the 🌑!&quot;;\n\n    let rocket = utf8_slice::slice(s, 4, 5);\n    // 结果是 &quot;🚀&quot;，索引的是字符\n}`, `26468336286118290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> utf8_slice<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"The 🚀 goes to the 🌑!"</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> rocket <span class="token operator">=</span> utf8_slice<span class="token punctuation">::</span><span class="token function">slice</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 结果是 "🚀"，索引的是字符</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="数组"><a href="#%E6%95%B0%E7%BB%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数组</h2>\n<h3 id="问题一-8"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>数组的类型是 [T; Length]，就如你所看到的，数组的长度是类型签名的一部分，因此数组的长度必须在编译期就已知</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86251751622594970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 使用合适的类型填空\n    let arr: __ = [1, 2, 3, 4, 5];\n\n    // 修改以下代码，让它顺利运行\n    assert!(arr.len() == 4);\n}`, `86251751622594970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用合适的类型填空</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> __ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 修改以下代码，让它顺利运行</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-65"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-65" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74504305197662360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [i32; 5] = [1, 2, 3, 4, 5];\n\n    assert!(arr.len() == 5);\n}`, `74504305197662360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-8"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72807652925166625000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 很多时候，我们可以忽略数组的部分类型，也可以忽略全部类型，让编译器帮助我们推导\n    let arr0 = [1, 2, 3];\n    let arr: [_; 3] = [\'a\', \'b\', \'c\'];\n\n    // 填空\n    // 数组分配在栈上， \\`std::mem::size_of_val\\` 函数会返回整个数组占用的内存空间\n    // 数组中的每个 char 元素占用 4 字节的内存空间，因为在 Rust 中， char 是 Unicode 字符\n    assert!(std::mem::size_of_val(&arr) == __);\n}`, `72807652925166625000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 很多时候，我们可以忽略数组的部分类型，也可以忽略全部类型，让编译器帮助我们推导</span>\n    <span class="token keyword">let</span> arr0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>_<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'b\'</span><span class="token punctuation">,</span> <span class="token char string">\'c\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    <span class="token comment">// 数组分配在栈上， `std::mem::size_of_val` 函数会返回整个数组占用的内存空间</span>\n    <span class="token comment">// 数组中的每个 char 元素占用 4 字节的内存空间，因为在 Rust 中， char 是 Unicode 字符</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-66"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-66" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99645197386538390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr0 = [1, 2, 3];\n    let arr: [_; 3] = [\'a\', \'b\', \'c\'];\n\n    assert!(std::mem::size_of_val(&arr) == 12);\n}`, `99645197386538390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>_<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'b\'</span><span class="token punctuation">,</span> <span class="token char string">\'c\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-8"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>数组中的所有元素可以一起初始化为同一个值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87932579519942800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 填空\n    let list: [i32; 100] = __ ;\n\n    assert!(list[0] == 1);\n    assert!(list.len() == 100);\n}`, `87932579519942800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> list<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">;</span> <span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> __ <span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-67"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-67" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44438596836475175000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let list: [i32; 100] = [1; 100];\n\n    assert!(list[0] == 1);\n    assert!(list.len() == 100);\n}`, `44438596836475175000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> list<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">;</span> <span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-7"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>数组中的所有元素必须是同一类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71876774301742820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 修复错误\n    let _arr = [1, 2, \'3\'];\n}`, `71876774301742820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 修复错误</span>\n    <span class="token keyword">let</span> _arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char string">\'3\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-68"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-68" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5378651920258570000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let _arr = [1, 2, 3];\n}`, `5378651920258570000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-7"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>数组的下标索引从 0 开始</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58260098067751390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr = [\'a\', \'b\', \'c\'];\n\n    let ele = arr[1]; // 只修改此行来让代码工作\n\n    assert!(ele == \'a\');\n}`, `58260098067751390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'b\'</span><span class="token punctuation">,</span> <span class="token char string">\'c\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 只修改此行来让代码工作</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>ele <span class="token operator">==</span> <span class="token char string">\'a\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-69"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-69" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58566918128742640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr = [\'a\', \'b\', \'c\'];\n\n    let ele = arr[0];\n\n    assert!(ele == \'a\');\n}`, `58566918128742640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'b\'</span><span class="token punctuation">,</span> <span class="token char string">\'c\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>ele <span class="token operator">==</span> <span class="token char string">\'a\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-6"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>越界索引会导致代码的 panic</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30082815197043810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复代码中的错误\nfn main() {\n    let names = [String::from(&quot;Sunfei&quot;), &quot;Sunface&quot;.to_string()];\n\n    // \\`get\\` 返回 \\`Option<T>\\` 类型，因此它的使用非常安全\n    let name0 = names.get(0).unwrap();\n\n    // 但是下标索引就存在越界的风险了\n    let _name1 = &names[2];\n}`, `30082815197043810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复代码中的错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> names <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Sunfei"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// `get` 返回 `Option&lt;T>` 类型，因此它的使用非常安全</span>\n    <span class="token keyword">let</span> name0 <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 但是下标索引就存在越界的风险了</span>\n    <span class="token keyword">let</span> _name1 <span class="token operator">=</span> <span class="token operator">&amp;</span>names<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-70"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-70" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88577791369285450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let names = [String::from(&quot;Sunfei&quot;), &quot;Sunface&quot;.to_string()];\n\n    let name0 = names.get(0).unwrap();\n\n    let _name1 = &names[1];\n}`, `88577791369285450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> names <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Sunfei"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> name0 <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _name1 <span class="token operator">=</span> <span class="token operator">&amp;</span>names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="切片"><a href="#%E5%88%87%E7%89%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>切片</h2>\n<h3 id="问题一-9"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>这里 <code class="language-text">[i32]</code> 和 str 都是切片类型，但是直接使用它们会造成编译错误，如下代码所示。为了解决，你需要使用切片的引用： <code class="language-text">&amp;[i32]</code>，&#x26;str</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86400931000860880000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复代码中的错误，不要新增代码行!\nfn main() {\n    let arr = [1, 2, 3];\n    let s1: [i32] = arr[0..2];\n\n    let s2: str = &quot;hello, world&quot; as str;\n}`, `86400931000860880000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复代码中的错误，不要新增代码行!</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> s2<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"hello, world"</span> <span class="token keyword">as</span> str<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-71"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-71" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48446458645636596000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr = [1, 2, 3];\n    let s1: &[i32] = &arr[0..2];\n\n    let s2: &str = &quot;hello, world&quot;;\n}`, `48446458645636596000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>i32<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> s2<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token string">"hello, world"</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-9"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>一个切片引用占用了 2 个字大小的内存空间(从现在开始，为了简洁性考虑，如无特殊原因，我们统一使用切片来特指切片引用)。该切片的第一个字是指向数据的指针，第二个字是切片的长度。字的大小取决于处理器架构，例如在 x86-64 上，字的大小是 64 位也就是 8 个字节，那么一个切片引用就是 16 个字节大小。</p>\n<p>切片(引用)可以用来借用数组的某个连续的部分，对应的签名是 <code class="language-text">&amp;[T]</code>，大家可以与数组的签名对比下 <code class="language-text">[T; Length]</code>。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58866132386109580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [char; 3] = [\'中\', \'国\', \'人\'];\n\n    let slice = &arr[..2];\n\n    // 修改数字 \\`8\\` 让代码工作\n    // 小提示: 切片和数组不一样，它是引用。如果是数组的话，那下面的 \\`assert!\\` 将会通过： \'中\'和\'国\'是 char 类型，char 类型是 Unicode 编码，大小固定为 4 字节，两个字符为 8 字节。\n    assert!(std::mem::size_of_val(&slice) == 8);\n}`, `58866132386109580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>char<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'中\'</span><span class="token punctuation">,</span> <span class="token char string">\'国\'</span><span class="token punctuation">,</span> <span class="token char string">\'人\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 修改数字 `8` 让代码工作</span>\n    <span class="token comment">// 小提示: 切片和数组不一样，它是引用。如果是数组的话，那下面的 `assert!` 将会通过： \'中\'和\'国\'是 char 类型，char 类型是 Unicode 编码，大小固定为 4 字节，两个字符为 8 字节。</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>slice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-72"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-72" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12693653570323794000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [char; 3] = [\'中\', \'国\', \'人\'];\n\n    let slice = &arr[..2];\n\n    // 16 是切片大小\n    assert!(std::mem::size_of_val(&slice) == 16);\n    // 8 是数组大小\n    assert!(std::mem::size_of_val(slice) == 8);\n}`, `12693653570323794000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>char<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'中\'</span><span class="token punctuation">,</span> <span class="token char string">\'国\'</span><span class="token punctuation">,</span> <span class="token char string">\'人\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 16 是切片大小</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>slice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 8 是数组大小</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span><span class="token function">size_of_val</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-9"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97055653876747300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let arr: [i32; 5] = [1, 2, 3, 4, 5];\n  // 填空让代码工作起来\n  let slice: __ = __;\n  assert_eq!(slice, &[2, 3, 4]);\n}`, `97055653876747300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token comment">// 填空让代码工作起来</span>\n  <span class="token keyword">let</span> slice<span class="token punctuation">:</span> __ <span class="token operator">=</span> __<span class="token punctuation">;</span>\n  <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-73"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-73" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5678639623359593000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [i32; 5] = [1, 2, 3, 4, 5];\n    // let slice: &[i32] = &arr[1..=3];\n    let slice: &[i32] = &arr[1..4];\n    assert_eq!(slice, &[2, 3, 4]);\n}`, `5678639623359593000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>i32<span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// let slice: &amp;[i32] = &amp;arr[1..=3];</span>\n    <span class="token keyword">let</span> slice<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>i32<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-8"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31696531309208620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello&quot;);\n\n    let slice1 = &s[0..2];\n    // 填空，不要再使用 0..2\n    let slice2 = &s[__];\n\n    assert_eq!(slice1, slice2);\n}`, `31696531309208620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 填空，不要再使用 0..2</span>\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span>__<span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> slice2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-74"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-74" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80428285832832810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = String::from(&quot;hello&quot;);\n\n    let slice1 = &s[0..2];\n    // let slice2 = &s[..=1];\n    let slice2 = &s[..2];\n\n    assert_eq!(slice1, slice2);\n}`, `80428285832832810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// let slice2 = &amp;s[..=1];</span>\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> slice2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-8"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64889997112623670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;你好，世界&quot;;\n    // 修改以下代码行，让代码工作起来\n    let slice = &s[0..2];\n\n    assert!(slice == &quot;你&quot;);\n}`, `64889997112623670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"你好，世界"</span><span class="token punctuation">;</span>\n    <span class="token comment">// 修改以下代码行，让代码工作起来</span>\n    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>slice <span class="token operator">==</span> <span class="token string">"你"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-75"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-75" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21468131154298507000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;你好，世界&quot;;\n    let slice = &s[0..3];\n\n    assert!(slice == &quot;你&quot;);\n}`, `21468131154298507000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"你好，世界"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>slice <span class="token operator">==</span> <span class="token string">"你"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-7"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>&#x26;String 可以被隐式地转换成 &#x26;str 类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39756072606667470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复所有错误\nfn main() {\n    let mut s = String::from(&quot;hello world&quot;);\n\n    // 这里, &s 是 \\`&String\\` 类型，但是 \\`first_character\\` 函数需要的是 \\`&str\\` 类型。\n    // 尽管两个类型不一样，但是代码仍然可以工作，原因是 \\`&String\\` 会被隐式地转换成 \\`&str\\` 类型，如果大家想要知道更多，可以看看 Deref 章节: https://course.rs/advance/smart-pointer/deref.html\n    let ch = first_character(&s);\n\n    s.clear(); // error!\n\n    println!(&quot;the first character is: {}&quot;, ch);\n}\nfn first_character(s: &str) -> &str {\n    &s[..1]\n}`, `39756072606667470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复所有错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 这里, &amp;s 是 `&amp;String` 类型，但是 `first_character` 函数需要的是 `&amp;str` 类型。</span>\n    <span class="token comment">// 尽管两个类型不一样，但是代码仍然可以工作，原因是 `&amp;String` 会被隐式地转换成 `&amp;str` 类型，如果大家想要知道更多，可以看看 Deref 章节: https://course.rs/advance/smart-pointer/deref.html</span>\n    <span class="token keyword">let</span> ch <span class="token operator">=</span> <span class="token function">first_character</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the first character is: {}"</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">first_character</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n    <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-76"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-76" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9393837058868560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let mut s = String::from(&quot;hello world&quot;);\n\n    let ch = first_character(&s);\n\n    println!(&quot;the first character is: {}&quot;, ch);\n\n    s.clear(); // error!\n}\n\nfn first_character(s: &str) -> &str {\n    &s[..1]\n}`, `9393837058868560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> ch <span class="token operator">=</span> <span class="token function">first_character</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the first character is: {}"</span><span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">first_character</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n    <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="元组"><a href="#%E5%85%83%E7%BB%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>元组</h2>\n<h3 id="问题一-10"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>元组中的元素可以是不同的类型。元组的类型签名是(T1, T2, …), 这里 T1, T2 是相对应的元组成员的类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29212946786824200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let _t0: (u8,i16) = (0, -1);\n    // 元组的成员还可以是一个元组\n    let _t1: (u8, (i16, u32)) = (0, (-1, 1));\n    // 填空让代码工作\n    let t: (u8, __, i64, __, __) = (1u8, 2u16, 3i64, &quot;hello&quot;, String::from(&quot;, world&quot;));\n}`, `29212946786824200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _t0<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span>i16<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 元组的成员还可以是一个元组</span>\n    <span class="token keyword">let</span> _t1<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span> <span class="token punctuation">(</span>i16<span class="token punctuation">,</span> u32<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 填空让代码工作</span>\n    <span class="token keyword">let</span> t<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span> __<span class="token punctuation">,</span> i64<span class="token punctuation">,</span> __<span class="token punctuation">,</span> __<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1u8</span><span class="token punctuation">,</span> <span class="token number">2u16</span><span class="token punctuation">,</span> <span class="token number">3i64</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">", world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-77"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-77" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34875358801424870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let _t0: (u8,i16) = (0, -1);\n    let _t1: (u8, (i16, u32)) = (0, (-1, 1));\n    let t: (u8, u16, i64, &str, String) = (1u8, 2u16, 3i64, &quot;hello&quot;, String::from(&quot;, world&quot;));\n}`, `34875358801424870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _t0<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span>i16<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _t1<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span> <span class="token punctuation">(</span>i16<span class="token punctuation">,</span> u32<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> t<span class="token punctuation">:</span> <span class="token punctuation">(</span>u8<span class="token punctuation">,</span> u16<span class="token punctuation">,</span> i64<span class="token punctuation">,</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> String<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1u8</span><span class="token punctuation">,</span> <span class="token number">2u16</span><span class="token punctuation">,</span> <span class="token number">3i64</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">", world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-10"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>可以使用索引来获取元组的成员</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57078534214656980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改合适的地方，让代码工作\nfn main() {\n    let t = (&quot;i&quot;, &quot;am&quot;, &quot;sunface&quot;);\n    assert_eq!(t.1, &quot;sunface&quot;);\n}`, `57078534214656980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改合适的地方，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"am"</span><span class="token punctuation">,</span> <span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token number">.1</span><span class="token punctuation">,</span> <span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-78"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-78" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61852705096112800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let t = (&quot;i&quot;, &quot;am&quot;, &quot;sunface&quot;);\n    assert_eq!(t.2, &quot;sunface&quot;);\n}`, `61852705096112800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"am"</span><span class="token punctuation">,</span> <span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token number">.2</span><span class="token punctuation">,</span> <span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-10"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>过长的元组无法被打印输出</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10697676783188736000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复代码错误\nfn main() {\n    let too_long_tuple = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13);\n    println!(&quot;too long tuple: {:?}&quot;, too_long_tuple);\n}`, `10697676783188736000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复代码错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> too_long_tuple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"too long tuple: {:?}"</span><span class="token punctuation">,</span> too_long_tuple<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-79"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-79" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13664884213065021000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let too_long_tuple = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12);\n    println!(&quot;too long tuple: {:?}&quot;, too_long_tuple);\n}`, `13664884213065021000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> too_long_tuple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"too long tuple: {:?}"</span><span class="token punctuation">,</span> too_long_tuple<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-9"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>使用模式匹配来解构元组</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25751742550315580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let tup = (1, 6.4, &quot;hello&quot;);\n\n    // 填空\n    let __ = tup;\n\n    assert_eq!(x, 1);\n    assert_eq!(y, &quot;hello&quot;);\n    assert_eq!(z, 6.4);\n}`, `25751742550315580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> __ <span class="token operator">=</span> tup<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-80"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80916521662592450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let tup = (1, 6.4, &quot;hello&quot;);\n\n    let (x, z, y) = tup;\n\n    assert_eq!(x, 1);\n    assert_eq!(y, &quot;hello&quot;);\n    assert_eq!(z, 6.4);\n}`, `80916521662592450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> z<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> tup<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-9"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>解构式赋值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80693122783362450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y, z);\n\n    // 填空\n    __ = (1, 2, 3);\n\n    assert_eq!(x, 3);\n    assert_eq!(y, 1);\n    assert_eq!(z, 2);\n}`, `80693122783362450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    __ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-81"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16859694588416895000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y, z);\n\n    (y, z, x) = (1, 2, 3);\n\n    assert_eq!(x, 3);\n    assert_eq!(y, 1);\n    assert_eq!(z, 2);\n}`, `16859694588416895000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token punctuation">(</span>y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-8"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>元组可以用于函数的参数和返回值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33234989289077133000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 填空，需要稍微计算下\n    let (x, y) = sum_multiply(__);\n\n    assert_eq!(x, 5);\n    assert_eq!(y, 6);\n}\n\nfn sum_multiply(nums: (i32, i32)) -> (i32, i32) {\n    (nums.0 + nums.1, nums.0 * nums.1)\n}`, `33234989289077133000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空，需要稍微计算下</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum_multiply</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum_multiply</span><span class="token punctuation">(</span>nums<span class="token punctuation">:</span> <span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">(</span>nums<span class="token number">.0</span> <span class="token operator">+</span> nums<span class="token number">.1</span><span class="token punctuation">,</span> nums<span class="token number">.0</span> <span class="token operator">*</span> nums<span class="token number">.1</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-82"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-82" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97757493592019420000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let (x, y) = sum_multiply((2, 3));\n\n    assert_eq!(x, 5);\n    assert_eq!(y, 6);\n}\n\nfn sum_multiply(nums: (i32, i32)) -> (i32, i32) {\n    (nums.0 + nums.1, nums.0 * nums.1)\n}`, `97757493592019420000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum_multiply</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">sum_multiply</span><span class="token punctuation">(</span>nums<span class="token punctuation">:</span> <span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">(</span>nums<span class="token number">.0</span> <span class="token operator">+</span> nums<span class="token number">.1</span><span class="token punctuation">,</span> nums<span class="token number">.0</span> <span class="token operator">*</span> nums<span class="token number">.1</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="结构体"><a href="#%E7%BB%93%E6%9E%84%E4%BD%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结构体</h2>\n<h3 id="问题一-11"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>对于结构体，我们必须为其中的每一个字段都指定具体的值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20012002439930864000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// fix the error\nstruct Person {\n    name: String,\n    age: u8,\n    hobby: String\n}\nfn main() {\n    let age = 30;\n    let p = Person {\n        name: String::from(&quot;sunface&quot;),\n        age,\n    };\n}`, `20012002439930864000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// fix the error</span>\n<span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n    hobby<span class="token punctuation">:</span> String\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-83"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57327558243677900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Person {\n    name: String,\n    age: u8,\n    hobby: String,\n}\nfn main() {\n    let age = 30;\n    let p = Person {\n        name: String::from(&quot;sunface&quot;),\n        age,\n        hobby: String::from(&quot;dsa&quot;),\n    };\n}`, `57327558243677900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n    hobby<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">,</span>\n        hobby<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"dsa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-11"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>单元结构体没有任何字段</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57834216629993865000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Unit;\ntrait SomeTrait {\n    // ...定义一些行为\n}\n\n// 我们并不关心结构体中有什么数据( 字段 )，但我们关心它的行为。\n// 因此这里我们使用没有任何字段的单元结构体，然后为它实现一些行为\nimpl SomeTrait for Unit {  }\nfn main() {\n    let u = Unit;\n    do_something_with_unit(u);\n}\n\n// 填空，让代码工作\nfn do_something_with_unit(u: __) {   }`, `57834216629993865000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Unit<span class="token punctuation">;</span>\n<span class="token keyword">trait</span> SomeTrait <span class="token punctuation">{</span>\n    <span class="token comment">// ...定义一些行为</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 我们并不关心结构体中有什么数据( 字段 )，但我们关心它的行为。</span>\n<span class="token comment">// 因此这里我们使用没有任何字段的单元结构体，然后为它实现一些行为</span>\n<span class="token keyword">impl</span> SomeTrait <span class="token keyword">for</span> Unit <span class="token punctuation">{</span>  <span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> u <span class="token operator">=</span> Unit<span class="token punctuation">;</span>\n    <span class="token function">do_something_with_unit</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">do_something_with_unit</span><span class="token punctuation">(</span>u<span class="token punctuation">:</span> __<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-84"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56578237769782010000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Unit;\ntrait SomeTrait {\n}\n\nimpl SomeTrait for Unit {}\nfn main() {\n    let u = Unit;\n    do_something_with_unit(u);\n}\n\nfn do_something_with_unit(u: Unit) {}`, `56578237769782010000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Unit<span class="token punctuation">;</span>\n<span class="token keyword">trait</span> SomeTrait <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> SomeTrait <span class="token keyword">for</span> Unit <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> u <span class="token operator">=</span> Unit<span class="token punctuation">;</span>\n    <span class="token function">do_something_with_unit</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">do_something_with_unit</span><span class="token punctuation">(</span>u<span class="token punctuation">:</span> Unit<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-11"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>元组结构体看起来跟元组很像，但是它拥有一个结构体的名称，该名称可以赋予它一定的意义。由于它并不关心内部数据到底是什么名称，因此此时元组结构体就非常适合</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36557684647381496000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nstruct Color(i32, i32, i32);\nstruct Point(i32, i32, i32);\nfn main() {\n    let v = Point(__, __, __);\n    check_color(v);\n}\n\nfn check_color(p: Color) {\n   let (x, _, _) = p;\n   assert_eq!(x, 0);\n   assert_eq!(p.1, 127);\n   assert_eq!(__, 255);\n}`, `36557684647381496000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">struct</span> <span class="token function">Color</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">struct</span> <span class="token function">Point</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">Point</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> __<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">check_color</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">check_color</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Color<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p<span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-85"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-85" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83417200744352190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Color(i32, i32, i32);\nstruct Point(i32, i32, i32);\nfn main() {\n    let v = Point(0, 127, 255);\n    check_color(v);\n}\n\nfn check_color(p: Point) {\n    let Point(x, y, z) = p;\n    assert_eq!(x, 0);\n    assert_eq!(p.1, 127);\n    assert_eq!(z, 255);\n}`, `83417200744352190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> <span class="token function">Color</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">struct</span> <span class="token function">Point</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">check_color</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">check_color</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> Point<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token function">Point</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> p<span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p<span class="token number">.1</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-10"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>你可以在实例化一个结构体时将它整体标记为可变的，但是 Rust 不允许我们将结构体的某个字段专门指定为可变的</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82470787589212620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误，不要增加或移除代码行\nstruct Person {\n    name: String,\n    age: u8,\n}\nfn main() {\n    let age = 18;\n    let p = Person {\n        name: String::from(&quot;sunface&quot;),\n        age,\n    };\n\n    // how can you believe sunface is only 18?\n    p.age = 30;\n\n    // 填空\n    __ = String::from(&quot;sunfei&quot;);\n}`, `82470787589212620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误，不要增加或移除代码行</span>\n<span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// how can you believe sunface is only 18?</span>\n    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    __ <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunfei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-86"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25625779544434350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Person {\n    name: String,\n    age: u8,\n}\nfn main() {\n    let age = 18;\n    let mut p = Person {\n        name: String::from(&quot;sunface&quot;),\n        age,\n    };\n\n    p.age = 30;\n\n    p.name = String::from(&quot;sunfei&quot;);\n}`, `25625779544434350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> p <span class="token operator">=</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>\n\n    p<span class="token punctuation">.</span>name <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunfei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-10"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>使用结构体字段初始化缩略语法可以减少一些重复代码</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98887174593368930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nstruct Person {\n    name: String,\n    age: u8,\n}\nfn main() {}\n\nfn build_person(name: String, age: u8) -> Person {\n    Person {\n        age,\n        __\n    }\n}`, `98887174593368930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">build_person</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> String<span class="token punctuation">,</span> age<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> Person <span class="token punctuation">{</span>\n    Person <span class="token punctuation">{</span>\n        age<span class="token punctuation">,</span>\n        __\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-87"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10971887668014890000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Person {\n    name: String,\n    age: u8,\n}\nfn main() {}\n\nfn build_person(name: String, age: u8) -> Person {\n    Person {\n        age,\n        name\n    }\n}`, `10971887668014890000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">build_person</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> String<span class="token punctuation">,</span> age<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> Person <span class="token punctuation">{</span>\n    Person <span class="token punctuation">{</span>\n        age<span class="token punctuation">,</span>\n        name\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-9"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>你可以使用结构体更新语法基于一个结构体实例来构造另一个</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7307673138545101000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\nstruct User {\n    active: bool,\n    username: String,\n    email: String,\n    sign_in_count: u64,\n}\nfn main() {\n    let u1 = User {\n        email: String::from(&quot;someone@example.com&quot;),\n        username: String::from(&quot;sunface&quot;),\n        active: true,\n        sign_in_count: 1,\n    };\n\n    let u2 = set_email(u1);\n}\n\nfn set_email(u: User) -> User {\n    User {\n        email: String::from(&quot;contact@im.dev&quot;),\n        __\n    }\n}`, `7307673138545101000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">struct</span> User <span class="token punctuation">{</span>\n    active<span class="token punctuation">:</span> bool<span class="token punctuation">,</span>\n    username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    email<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    sign_in_count<span class="token punctuation">:</span> u64<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> u1 <span class="token operator">=</span> User <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someone@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        active<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>\n        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> u2 <span class="token operator">=</span> <span class="token function">set_email</span><span class="token punctuation">(</span>u1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">set_email</span><span class="token punctuation">(</span>u<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">-></span> User <span class="token punctuation">{</span>\n    User <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"contact@im.dev"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        __\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-88"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-88" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54952652640970490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct User {\n    active: bool,\n    username: String,\n    email: String,\n    sign_in_count: u64,\n}\nfn main() {\n    let u1 = User {\n        email: String::from(&quot;someone@example.com&quot;),\n        username: String::from(&quot;sunface&quot;),\n        active: true,\n        sign_in_count: 1,\n    };\n\n    let u2 = set_email(u1);\n}\n\nfn set_email(u: User) -> User {\n    User {\n        email: String::from(&quot;contact@im.dev&quot;),\n        ..u\n    }\n}`, `54952652640970490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> User <span class="token punctuation">{</span>\n    active<span class="token punctuation">:</span> bool<span class="token punctuation">,</span>\n    username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    email<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    sign_in_count<span class="token punctuation">:</span> u64<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> u1 <span class="token operator">=</span> User <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someone@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        username<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        active<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>\n        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> u2 <span class="token operator">=</span> <span class="token function">set_email</span><span class="token punctuation">(</span>u1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">set_email</span><span class="token punctuation">(</span>u<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">-></span> User <span class="token punctuation">{</span>\n    User <span class="token punctuation">{</span>\n        email<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"contact@im.dev"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">..</span>u\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-5"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<p>我们可以使用 <code class="language-text">#[derive(Debug)]</code> 让结构体变成可打印的.</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19196261967934358000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\n#[__]\nstruct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let scale = 2;\n    let rect1 = Rectangle {\n        width: dbg!(30 * scale), // 打印 debug 信息到标准错误输出 stderr,并将 \\`30 * scale\\` 的值赋给 \\`width\\`\n        height: 50,\n    };\n\n    dbg!(&rect1); // 打印 debug 信息到标准错误输出 stderr\n\n    println!(__, rect1); // 打印 debug 信息到标准输出 stdout\n}`, `19196261967934358000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token attribute attr-name">#[__]</span>\n<span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> scale <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> Rectangle <span class="token punctuation">{</span>\n        width<span class="token punctuation">:</span> <span class="token function">dbg!</span><span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 打印 debug 信息到标准错误输出 stderr,并将 `30 * scale` 的值赋给 `width`</span>\n        height<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">dbg!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rect1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印 debug 信息到标准错误输出 stderr</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> rect1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印 debug 信息到标准输出 stdout</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-89"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91244056581173560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let scale = 2;\n    let rect1 = Rectangle {\n        width: dbg!(30 * scale),\n        height: 50,\n    };\n\n    dbg!(&rect1);\n\n    println!(&quot;{:#?}&quot;, rect1);\n}`, `91244056581173560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> scale <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> Rectangle <span class="token punctuation">{</span>\n        width<span class="token punctuation">:</span> <span class="token function">dbg!</span><span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">*</span> scale<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        height<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">dbg!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rect1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:#?}"</span><span class="token punctuation">,</span> rect1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-5"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>当解构一个变量时，可以同时使用 move 和引用模式绑定的方式。当这么做时，部分 move 就会发生：变量中一部分的所有权被转移给其它变量，而另一部分我们获取了它的引用。</p>\n<p>在这种情况下，原变量将无法再被使用，但是它没有转移所有权的那一部分依然可以使用，也就是之前被引用的那部分。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59354214518579090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    #[derive(Debug)]\n    struct Person {\n        name: String,\n        age: Box<u8>,\n    }\n\n    let person = Person {\n        name: String::from(&quot;Alice&quot;),\n        age: Box::new(20),\n    };\n\n    // 通过这种解构式模式匹配，person.name 的所有权被转移给新的变量 \\`name\\`\n    // 但是，这里 \\`age\\` 变量确是对 person.age 的引用, 这里 ref 的使用相当于: let age = &person.age\n    let Person { name, ref age } = person;\n\n    println!(&quot;The person\'s age is {}&quot;, age);\n\n    println!(&quot;The person\'s name is {}&quot;, name);\n\n    // Error! 原因是 person 的一部分已经被转移了所有权，因此我们无法再使用它\n    //println!(&quot;The person struct is {:?}&quot;, person);\n\n    // 虽然 \\`person\\` 作为一个整体无法再被使用，但是 \\`person.age\\` 依然可以使用\n    println!(&quot;The person\'s age from person struct is {}&quot;, person.age);\n}`, `59354214518579090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token attribute attr-name">#[derive(Debug)]</span>\n    <span class="token keyword">struct</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n        age<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">let</span> person <span class="token operator">=</span> Person <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">:</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 通过这种解构式模式匹配，person.name 的所有权被转移给新的变量 `name`</span>\n    <span class="token comment">// 但是，这里 `age` 变量确是对 person.age 的引用, 这里 ref 的使用相当于: let age = &amp;person.age</span>\n    <span class="token keyword">let</span> Person <span class="token punctuation">{</span> name<span class="token punctuation">,</span> <span class="token keyword">ref</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> person<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The person\'s age is {}"</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The person\'s name is {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// Error! 原因是 person 的一部分已经被转移了所有权，因此我们无法再使用它</span>\n    <span class="token comment">//println!("The person struct is {:?}", person);</span>\n\n    <span class="token comment">// 虽然 `person` 作为一个整体无法再被使用，但是 `person.age` 依然可以使用</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The person\'s age from person struct is {}"</span><span class="token punctuation">,</span> person<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-5"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33179824431895265000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\n#[derive(Debug)]\nstruct File {\n    name: String,\n    data: String,\n}\nfn main() {\n    let f = File {\n        name: String::from(&quot;readme.md&quot;),\n        data: &quot;Rust By Practice&quot;.to_string()\n    };\n\n    let _name = f.name;\n\n    // 只能修改这一行\n    println!(&quot;{}, {}, {:?}&quot;,f.name, f.data, f);\n}`, `33179824431895265000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> File <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    data<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> File <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"readme.md"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        data<span class="token punctuation">:</span> <span class="token string">"Rust By Practice"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _name <span class="token operator">=</span> f<span class="token punctuation">.</span>name<span class="token punctuation">;</span>\n\n    <span class="token comment">// 只能修改这一行</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}, {:?}"</span><span class="token punctuation">,</span>f<span class="token punctuation">.</span>name<span class="token punctuation">,</span> f<span class="token punctuation">.</span>data<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-90"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93435817275475670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct File {\n    name: String,\n    data: String,\n}\nfn main() {\n    let f = File {\n        name: String::from(&quot;readme.md&quot;),\n        data: &quot;Rust By Practice&quot;.to_string(),\n    };\n\n    let _name = f.name;\n\n    println!(&quot;{}, {}&quot;, _name, f.data);\n}`, `93435817275475670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> File <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    data<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> File <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"readme.md"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        data<span class="token punctuation">:</span> <span class="token string">"Rust By Practice"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> _name <span class="token operator">=</span> f<span class="token punctuation">.</span>name<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> _name<span class="token punctuation">,</span> f<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="枚举"><a href="#%E6%9E%9A%E4%B8%BE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>枚举</h2>\n<h3 id="问题一-12"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>在创建枚举时，你可以使用显式的整数设定枚举成员的值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45102146870322905000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nenum Number {\n    Zero,\n    One,\n    Two,\n}\n\nenum Number1 {\n    Zero = 0,\n    One,\n    Two,\n}\n\n// C语言风格的枚举定义\nenum Number2 {\n    Zero = 0.0,\n    One = 1.0,\n    Two = 2.0,\n}\n\n\nfn main() {\n    // 通过 \\`as\\` 可以将枚举值强转为整数类型\n    assert_eq!(Number::One, Number1::One);\n    assert_eq!(Number1::One, Number2::One);\n}`, `45102146870322905000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">enum</span> Number <span class="token punctuation">{</span>\n    Zero<span class="token punctuation">,</span>\n    One<span class="token punctuation">,</span>\n    Two<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> Number1 <span class="token punctuation">{</span>\n    Zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>\n    One<span class="token punctuation">,</span>\n    Two<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// C语言风格的枚举定义</span>\n<span class="token keyword">enum</span> Number2 <span class="token punctuation">{</span>\n    Zero <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">,</span>\n    One <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">,</span>\n    Two <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 通过 `as` 可以将枚举值强转为整数类型</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Number<span class="token punctuation">::</span>One<span class="token punctuation">,</span> Number1<span class="token punctuation">::</span>One<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Number1<span class="token punctuation">::</span>One<span class="token punctuation">,</span> Number2<span class="token punctuation">::</span>One<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-91"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75227853808152150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum Number {\n    Zero,\n    One,\n    Two,\n}\n\nenum Number1 {\n    Zero = 0,\n    One,\n    Two,\n}\n\nenum Number2 {\n    Zero = 0,\n    One = 1,\n    Two = 2,\n}\n\n\nfn main() {\n    assert_eq!(Number::One as u8, Number1::One as u8);\n    assert_eq!(Number1::One as u8, Number2::One as u8);\n}`, `75227853808152150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> Number <span class="token punctuation">{</span>\n    Zero<span class="token punctuation">,</span>\n    One<span class="token punctuation">,</span>\n    Two<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> Number1 <span class="token punctuation">{</span>\n    Zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>\n    One<span class="token punctuation">,</span>\n    Two<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> Number2 <span class="token punctuation">{</span>\n    Zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>\n    One <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    Two <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Number<span class="token punctuation">::</span>One <span class="token keyword">as</span> u8<span class="token punctuation">,</span> Number1<span class="token punctuation">::</span>One <span class="token keyword">as</span> u8<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Number1<span class="token punctuation">::</span>One <span class="token keyword">as</span> u8<span class="token punctuation">,</span> Number2<span class="token punctuation">::</span>One <span class="token keyword">as</span> u8<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-12"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>枚举成员可以持有各种类型的值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21628309342367834000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msg1 = Message::Move{__}; // 使用x = 1, y = 2 来初始化\n    let msg2 = Message::Write(__); // 使用 &quot;hello, world!&quot; 来初始化\n}`, `21628309342367834000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg1 <span class="token operator">=</span> Message<span class="token punctuation">::</span>Move<span class="token punctuation">{</span>__<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 使用x = 1, y = 2 来初始化</span>\n    <span class="token keyword">let</span> msg2 <span class="token operator">=</span> Message<span class="token punctuation">::</span><span class="token function">Write</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 "hello, world!" 来初始化</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-92"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-92" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20565400371982447000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msg1 = Message::Move { x: 1, y: 2 };\n    let msg2 = Message::Write(String::from(&quot;hello, world!&quot;));\n}`, `20565400371982447000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg1 <span class="token operator">=</span> Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> msg2 <span class="token operator">=</span> Message<span class="token punctuation">::</span><span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-12"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>枚举成员中的值可以使用模式匹配来获取</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29378703618915635000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 仅填空并修复错误\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msg = Message::Move{x: 1, y: 2};\n\n    if let Message::Move{__} = msg {\n        assert_eq!(a, b);\n    } else {\n        panic!(&quot;不要让这行代码运行！&quot;);\n    }\n}`, `29378703618915635000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 仅填空并修复错误</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg <span class="token operator">=</span> Message<span class="token punctuation">::</span>Move<span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> Message<span class="token punctuation">::</span>Move<span class="token punctuation">{</span>__<span class="token punctuation">}</span> <span class="token operator">=</span> msg <span class="token punctuation">{</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"不要让这行代码运行！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-93"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21011535620075250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msg = Message::Move { x: 1, y: 1 };\n\n    if let Message::Move { x: a, y: b } = msg {\n        assert_eq!(a, b);\n    } else {\n        panic!(&quot;不要让这行代码运行！&quot;);\n    }\n}`, `21011535620075250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg <span class="token operator">=</span> Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> a<span class="token punctuation">,</span> y<span class="token punctuation">:</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> msg <span class="token punctuation">{</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"不要让这行代码运行！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-11"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>使用枚举对类型进行同一化</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47852344119340230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，并修复错误\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msgs: __ = [\n        Message::Quit,\n        Message::Move{x:1, y:3},\n        Message::ChangeColor(255,255,0)\n    ];\n\n    for msg in msgs {\n        show_message(msg)\n    }\n}\n\nfn show_message(msg: Message) {\n    println!(&quot;{}&quot;, msg);\n}`, `47852344119340230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，并修复错误</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msgs<span class="token punctuation">:</span> __ <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Message<span class="token punctuation">::</span>Quit<span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Move<span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs <span class="token punctuation">{</span>\n        <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">:</span> Message<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-94"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13569400795578780000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msgs = [\n        Message::Quit,\n        Message::Move { x: 1, y: 3 },\n        Message::ChangeColor(255, 255, 0),\n    ];\n\n    for msg in msgs {\n        show_message(msg)\n    }\n}\n\nfn show_message(msg: Message) {\n    println!(&quot;{:#?}&quot;, msg);\n}`, `13569400795578780000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msgs <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Message<span class="token punctuation">::</span>Quit<span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs <span class="token punctuation">{</span>\n        <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">:</span> Message<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:#?}"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-11"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>Rust 中没有 null，我们通过 <code class="language-text">Option&lt;T&gt;</code> 枚举来处理值为空的情况</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35766937076886405000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空让 \\`println\\` 输出，同时添加一些代码不要让最后一行的 \\`panic\\` 执行到\nfn main() {\n    let five = Some(5);\n    let six = plus_one(five);\n    let none = plus_one(None);\n\n    if let __ = six {\n        println!(&quot;{}&quot;, n)\n    }\n\n    panic!(&quot;不要让这行代码运行！&quot;);\n}\n\nfn plus_one(x: Option<i32>) -> Option<i32> {\n    match x {\n        __ => None,\n        __ => Some(i + 1),\n    }\n}`, `35766937076886405000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空让 `println` 输出，同时添加一些代码不要让最后一行的 `panic` 执行到</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> five <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> six <span class="token operator">=</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>five<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> none <span class="token operator">=</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>None<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> __ <span class="token operator">=</span> six <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"不要让这行代码运行！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> x <span class="token punctuation">{</span>\n        __ <span class="token operator">=></span> None<span class="token punctuation">,</span>\n        __ <span class="token operator">=></span> <span class="token function">Some</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-95"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66470557828956880000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let five = Some(5);\n    let six = plus_one(five);\n    let none = plus_one(None);\n\n    if let Some(n) = six {\n        println!(&quot;{}&quot;, n);\n        return\n    }\n\n    panic!(&quot;不要让这行代码运行！&quot;);\n}\n\nfn plus_one(x: Option<i32>) -> Option<i32> {\n    match x {\n        None => None,\n        Some(i) => Some(i + 1),\n    }\n}`, `66470557828956880000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> five <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> six <span class="token operator">=</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>five<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> none <span class="token operator">=</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>None<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Some</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> six <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"不要让这行代码运行！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">plus_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> x <span class="token punctuation">{</span>\n        None <span class="token operator">=></span> None<span class="token punctuation">,</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Some</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-10"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>使用枚举来实现链表</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="525018975981961200"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码运行\nuse crate::List::*;\n\nenum List {\n    // Cons: 链表中包含有值的节点，节点是元组类型，第一个元素是节点的值，第二个元素是指向下一个节点的指针\n    Cons(u32, Box<List>),\n    // Nil: 链表中的最后一个节点，用于说明链表的结束\n    Nil,\n}\n\n// 为枚举实现一些方法\nimpl List {\n    // 创建空的链表\n    fn new() -> List {\n        // 因为没有节点，所以直接返回 Nil 节点\n        // 枚举成员 Nil 的类型是 List\n        Nil\n    }\n\n    // 在老的链表前面新增一个节点，并返回新的链表\n    fn prepend(self, elem: u32) -> __ {\n        Cons(elem, Box::new(self))\n    }\n\n    // 返回链表的长度\n    fn len(&self) -> u32 {\n        match *self {\n            // 这里我们不能拿走 tail 的所有权，因此需要获取它的引用\n            Cons(_, __ tail) => 1 + tail.len(),\n            // 空链表的长度为 0\n            Nil => 0\n        }\n    }\n\n    // 返回链表的字符串表现形式，用于打印输出\n    fn stringify(&self) -> String {\n        match *self {\n            Cons(head, ref tail) => {\n                // 递归生成字符串\n                format!(&quot;{}, {}&quot;, head, tail.__())\n            },\n            Nil => {\n                format!(&quot;Nil&quot;)\n            },\n        }\n    }\n}\n\nfn main() {\n    // 创建一个新的链表(也是空的)\n    let mut list = List::new();\n\n    // 添加一些元素\n    list = list.prepend(1);\n    list = list.prepend(2);\n    list = list.prepend(3);\n\n    // 打印列表的当前状态\n    println!(&quot;链表的长度是: {}&quot;, list.len());\n    println!(&quot;{}&quot;, list.stringify());\n}`, `525018975981961200`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码运行</span>\n<span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>List<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>\n\n<span class="token keyword">enum</span> List <span class="token punctuation">{</span>\n    <span class="token comment">// Cons: 链表中包含有值的节点，节点是元组类型，第一个元素是节点的值，第二个元素是指向下一个节点的指针</span>\n    <span class="token function">Cons</span><span class="token punctuation">(</span>u32<span class="token punctuation">,</span> Box<span class="token operator">&lt;</span>List<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment">// Nil: 链表中的最后一个节点，用于说明链表的结束</span>\n    Nil<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 为枚举实现一些方法</span>\n<span class="token keyword">impl</span> List <span class="token punctuation">{</span>\n    <span class="token comment">// 创建空的链表</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> List <span class="token punctuation">{</span>\n        <span class="token comment">// 因为没有节点，所以直接返回 Nil 节点</span>\n        <span class="token comment">// 枚举成员 Nil 的类型是 List</span>\n        Nil\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 在老的链表前面新增一个节点，并返回新的链表</span>\n    <span class="token keyword">fn</span> <span class="token function">prepend</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> elem<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> __ <span class="token punctuation">{</span>\n        <span class="token function">Cons</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 返回链表的长度</span>\n    <span class="token keyword">fn</span> <span class="token function">len</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>\n            <span class="token comment">// 这里我们不能拿走 tail 的所有权，因此需要获取它的引用</span>\n            <span class="token function">Cons</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> __ tail<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">1</span> <span class="token operator">+</span> tail<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token comment">// 空链表的长度为 0</span>\n            Nil <span class="token operator">=></span> <span class="token number">0</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 返回链表的字符串表现形式，用于打印输出</span>\n    <span class="token keyword">fn</span> <span class="token function">stringify</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>\n            <span class="token function">Cons</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span> <span class="token keyword">ref</span> tail<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token comment">// 递归生成字符串</span>\n                <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> head<span class="token punctuation">,</span> tail<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            Nil <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Nil"</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 创建一个新的链表(也是空的)</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> list <span class="token operator">=</span> List<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 添加一些元素</span>\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 打印列表的当前状态</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"链表的长度是: {}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-96"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10156110286644204000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use crate::List::*;\n\nenum List {\n    Cons(u32, Box<List>),\n    Nil,\n}\n\nimpl List {\n    fn new() -> List {\n        Nil\n    }\n\n    fn prepend(self, elem: u32) -> List {\n        Cons(elem, Box::new(self))\n    }\n\n    fn len(&self) -> u32 {\n        match *self {\n            Cons(_, ref tail) => 1 + tail.len(),\n            Nil => 0\n        }\n    }\n\n    fn stringify(&self) -> String {\n        match *self {\n            Cons(head, ref tail) => {\n                format!(&quot;{}, {}&quot;, head, tail.stringify())\n            },\n            Nil => {\n                format!(&quot;Nil&quot;)\n            },\n        }\n    }\n}\n\nfn main() {\n    let mut list = List::new();\n\n    list = list.prepend(1);\n    list = list.prepend(2);\n    list = list.prepend(3);\n\n    println!(&quot;链表的长度是: {}&quot;, list.len());\n    println!(&quot;{}&quot;, list.stringify());\n}`, `10156110286644204000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>List<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>\n\n<span class="token keyword">enum</span> List <span class="token punctuation">{</span>\n    <span class="token function">Cons</span><span class="token punctuation">(</span>u32<span class="token punctuation">,</span> Box<span class="token operator">&lt;</span>List<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Nil<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> List <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> List <span class="token punctuation">{</span>\n        Nil\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">prepend</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> elem<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> List <span class="token punctuation">{</span>\n        <span class="token function">Cons</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">len</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>\n            <span class="token function">Cons</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token keyword">ref</span> tail<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">1</span> <span class="token operator">+</span> tail<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            Nil <span class="token operator">=></span> <span class="token number">0</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">stringify</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>\n            <span class="token function">Cons</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span> <span class="token keyword">ref</span> tail<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> head<span class="token punctuation">,</span> tail<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            Nil <span class="token operator">=></span> <span class="token punctuation">{</span>\n                <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Nil"</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> list <span class="token operator">=</span> List<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"链表的长度是: {}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>// TODO 练习到这里</p>\n<h1 id="流程控制"><a href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>流程控制</h1>\n<h2 id="问题一-13"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1978144592246744300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let n = 5;\n\n    if n < 0 {\n        println!(&quot;{} is negative&quot;, n);\n    } __ n > 0 {\n        println!(&quot;{} is positive&quot;, n);\n    } __ {\n        println!(&quot;{} is zero&quot;, n);\n    }\n}`, `1978144592246744300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is negative"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> __ n <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is positive"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> __ <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is zero"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-97"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33478779161941905000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let n = 0;\n\n    if n < 0 {\n        println!(&quot;{} is negative&quot;, n);\n    } else if n > 0 {\n        println!(&quot;{} is positive&quot;, n);\n    } else {\n        println!(&quot;{} is zero&quot;, n);\n    }\n}`, `33478779161941905000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is negative"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> n <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is positive"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is zero"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题二-13"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h2>\n<p>if / else 可以用作表达式来进行赋值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65547586490043286000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let n = 5;\n\n    let big_n =\n        if n < 10 && n > -10 {\n            println!(&quot; 数字太小，先增加 10 倍再说&quot;);\n\n            10 * n\n        } else {\n            println!(&quot;数字太大，我们得让它减半&quot;);\n\n            n / 2.0 ;\n        }\n\n    println!(&quot;{} -> {}&quot;, n, big_n);\n}`, `65547586490043286000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> big_n <span class="token operator">=</span>\n        <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">></span> <span class="token operator">-</span><span class="token number">10</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">" 数字太小，先增加 10 倍再说"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            <span class="token number">10</span> <span class="token operator">*</span> n\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"数字太大，我们得让它减半"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            n <span class="token operator">/</span> <span class="token number">2.0</span> <span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} -> {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> big_n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-98"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-98" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87980478183347980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let n = 11;\n\n    let big_n = if n < 10 && n > -10 {\n        println!(&quot; 数字太小，先增加 10 倍再说&quot;);\n\n        10 * n\n    } else {\n        println!(&quot;数字太大，我们得让它减半&quot;);\n\n        n / 2\n    };\n\n    println!(&quot;{} -> {}&quot;, n, big_n);\n}`, `87980478183347980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> big_n <span class="token operator">=</span> <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">></span> <span class="token operator">-</span><span class="token number">10</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">" 数字太小，先增加 10 倍再说"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token number">10</span> <span class="token operator">*</span> n\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"数字太大，我们得让它减半"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        n <span class="token operator">/</span> <span class="token number">2</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} -> {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> big_n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题三-13"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h2>\n<p>for in 可以用于迭代一个迭代器，例如序列 a..b</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27196561591540180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    for n in 1..=100 { // 修改此行，让代码工作\n        if n == 100 {\n            panic!(&quot;NEVER LET THIS RUN&quot;)\n        }\n    }\n}`, `27196561591540180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">100</span> <span class="token punctuation">{</span> <span class="token comment">// 修改此行，让代码工作</span>\n        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">100</span> <span class="token punctuation">{</span>\n            <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"NEVER LET THIS RUN"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-99"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43109846513425555000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    for n in 1..100 { // 修改此行，让代码工作\n        if n == 100 {\n            panic!(&quot;NEVER LET THIS RUN&quot;)\n        }\n    }\n}`, `43109846513425555000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">..</span><span class="token number">100</span> <span class="token punctuation">{</span> <span class="token comment">// 修改此行，让代码工作</span>\n        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">100</span> <span class="token punctuation">{</span>\n            <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"NEVER LET THIS RUN"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题四-12"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97824803476502040000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要新增或删除代码行\nfn main() {\n    let names = [String::from(&quot;liming&quot;),String::from(&quot;hanmeimei&quot;)];\n    for name in names {\n        // do something with name...\n    }\n\n    println!(&quot;{:?}&quot;, names);\n\n    let numbers = [1, 2, 3];\n    // numbers中的元素实现了 Copy，因此无需转移所有权\n    for n in numbers {\n        // do something with name...\n    }\n\n    println!(&quot;{:?}&quot;, numbers);\n}`, `97824803476502040000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要新增或删除代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> names <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"liming"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hanmeimei"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> name <span class="token keyword">in</span> names <span class="token punctuation">{</span>\n        <span class="token comment">// do something with name...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> names<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// numbers中的元素实现了 Copy，因此无需转移所有权</span>\n    <span class="token keyword">for</span> n <span class="token keyword">in</span> numbers <span class="token punctuation">{</span>\n        <span class="token comment">// do something with name...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-100"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-100" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83331689529376060000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要新增或删除代码行\nfn main() {\n    let names = [String::from(&quot;liming&quot;), String::from(&quot;hanmeimei&quot;)];\n    for name in &names {\n        // do something with name...\n    }\n\n    println!(&quot;{:?}&quot;, names);\n\n    let numbers = [1, 2, 3];\n    // numbers 中的元素实现了 Copy，因此无需转移所有权\n    for n in numbers {\n        // do something with name...\n    }\n\n    println!(&quot;{:?}&quot;, numbers);\n}`, `83331689529376060000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要新增或删除代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> names <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"liming"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hanmeimei"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token operator">&amp;</span>names <span class="token punctuation">{</span>\n        <span class="token comment">// do something with name...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> names<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// numbers 中的元素实现了 Copy，因此无需转移所有权</span>\n    <span class="token keyword">for</span> n <span class="token keyword">in</span> numbers <span class="token punctuation">{</span>\n        <span class="token comment">// do something with name...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题五-12"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85938310675507500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let a = [4,3,2,1];\n\n    // 通过索引和值的方式迭代数组 \\`a\\`\n    for (i,v) in a.__ {\n        println!(&quot;第{}个元素是{}&quot;,i+1,v);\n    }\n}`, `85938310675507500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 通过索引和值的方式迭代数组 `a`</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span>v<span class="token punctuation">)</span> <span class="token keyword">in</span> a<span class="token punctuation">.</span>__ <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"第{}个元素是{}"</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-101"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-101" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84981604605423620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let a = [4, 3, 2, 1];\n\n    // 通过索引和值的方式迭代数组 \\`a\\`\n    for (i, v) in a.iter().enumerate() {\n        println!(&quot;第{}个元素是{}&quot;, i + 1, v);\n    }\n}`, `84981604605423620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 通过索引和值的方式迭代数组 `a`</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">in</span> a<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"第{}个元素是{}"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题六-11"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h2>\n<p>当条件为 true 时，while 将一直循环</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53160791464195056000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让最后一行的 println! 工作 !\nfn main() {\n    // 一个计数值\n    let mut n = 1;\n\n    // 当条件为真时，不停的循环\n    while n __ 10 {\n        if n % 15 == 0 {\n            println!(&quot;fizzbuzz&quot;);\n        } else if n % 3 == 0 {\n            println!(&quot;fizz&quot;);\n        } else if n % 5 == 0 {\n            println!(&quot;buzz&quot;);\n        } else {\n            println!(&quot;{}&quot;, n);\n        }\n\n\n        __;\n    }\n\n    println!(&quot;n 的值是 {}, 循环结束&quot;,n);\n}`, `53160791464195056000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让最后一行的 println! 工作 !</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 一个计数值</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 当条件为真时，不停的循环</span>\n    <span class="token keyword">while</span> n __ <span class="token number">10</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">15</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"fizzbuzz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"fizz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"buzz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n\n        __<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n 的值是 {}, 循环结束"</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-102"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-102" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3173656229417454000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让最后一行的  println! 工作 !\nfn main() {\n    // 一个计数值\n    let mut n = 1;\n\n    // 当条件为真时，不停的循环\n    while n < 10 {\n        if n % 15 == 0 {\n            println!(&quot;fizzbuzz&quot;);\n        } else if n % 3 == 0 {\n            println!(&quot;fizz&quot;);\n        } else if n % 5 == 0 {\n            println!(&quot;buzz&quot;);\n        } else {\n            println!(&quot;{}&quot;, n);\n        }\n\n        n = n + 1;\n    }\n\n    println!(&quot;n 的值是 {}, 循环结束&quot;, n);\n}`, `3173656229417454000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让最后一行的  println! 工作 !</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 一个计数值</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 当条件为真时，不停的循环</span>\n    <span class="token keyword">while</span> n <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">15</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"fizzbuzz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"fizz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"buzz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        n <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n 的值是 {}, 循环结束"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题七-6"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h2>\n<p>使用 break 可以跳出循环</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49387645704009286000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut n = 0;\n    for i in 0..=100 {\n       if n == 66 {\n           __\n       }\n       n += 1;\n    }\n\n    assert_eq!(n, 66);\n}`, `49387645704009286000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">100</span> <span class="token punctuation">{</span>\n       <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">66</span> <span class="token punctuation">{</span>\n           __\n       <span class="token punctuation">}</span>\n       n <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-103"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-103" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86456842670493380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut n = 0;\n    for i in 0..=100 {\n        if n == 66 {\n            break;\n        }\n        n += 1;\n    }\n\n    assert_eq!(n, 66);\n}`, `86456842670493380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">100</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">66</span> <span class="token punctuation">{</span>\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        n <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题八-6"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h2>\n<p>continue 会结束当次循环并立即开始下一次循环</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81726417868869940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut n = 0;\n    for i in 0..=100 {\n       if n != 66 {\n           n+=1;\n           __;\n       }\n\n       __\n    }\n\n    assert_eq!(n, 66);\n}`, `81726417868869940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">100</span> <span class="token punctuation">{</span>\n       <span class="token keyword">if</span> n <span class="token operator">!=</span> <span class="token number">66</span> <span class="token punctuation">{</span>\n           n<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>\n           __<span class="token punctuation">;</span>\n       <span class="token punctuation">}</span>\n\n       __\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-104"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-104" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72853382952313940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut n = 0;\n    for i in 0..=100 {\n        if n != 66 {\n            n += 1;\n            continue;\n        }\n    }\n\n    assert_eq!(n, 66);\n}`, `72853382952313940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">100</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> n <span class="token operator">!=</span> <span class="token number">66</span> <span class="token punctuation">{</span>\n            n <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n            <span class="token keyword">continue</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题九-6"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h2>\n<p>loop 一般都需要配合 break 或 continue 一起使用</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15079054234851697000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut count = 0u32;\n\n    println!(&quot;Let\'s count until infinity!&quot;);\n\n    // 无限循环\n    loop {\n        count += 1;\n\n        if count == 3 {\n            println!(&quot;three&quot;);\n\n            // 跳过当此循环的剩余代码\n            __;\n        }\n\n        println!(&quot;{}&quot;, count);\n\n        if count == 5 {\n            println!(&quot;OK, that\'s enough&quot;);\n\n            __;\n        }\n    }\n\n    assert_eq!(count, 5);\n}`, `15079054234851697000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0u32</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Let\'s count until infinity!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 无限循环</span>\n    <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"three"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            <span class="token comment">// 跳过当此循环的剩余代码</span>\n            __<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"OK, that\'s enough"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            __<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-105"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-105" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96063405919785240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，不要修改其它代码\nfn main() {\n    let mut count = 0u32;\n\n    println!(&quot;Let\'s count until infinity!&quot;);\n\n    // 无限循环\n    loop {\n        count += 1;\n\n        if count == 3 {\n            println!(&quot;three&quot;);\n\n            // 跳过当此循环的剩余代码\n            continue;\n        }\n\n        println!(&quot;{}&quot;, count);\n\n        if count == 5 {\n            println!(&quot;OK, that\'s enough&quot;);\n\n            break;\n        }\n    }\n\n    assert_eq!(count, 5);\n}`, `96063405919785240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0u32</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Let\'s count until infinity!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 无限循环</span>\n    <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"three"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            <span class="token comment">// 跳过当此循环的剩余代码</span>\n            <span class="token keyword">continue</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"OK, that\'s enough"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题十-3"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h2>\n<p>loop 是一个表达式，因此我们可以配合 break 来返回一个值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23407575033865480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut counter = 0;\n\n    let result = loop {\n        counter += 1;\n\n        if counter == 10 {\n            __;\n        }\n    };\n\n    assert_eq!(result, 20);\n}`, `23407575033865480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> counter <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span>\n            __<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-106"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-106" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59198465185653236000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut counter = 0;\n\n    let result = loop {\n        counter += 1;\n\n        if counter == 10 {\n            break counter * 2;\n        }\n    };\n\n    assert_eq!(result, 20);\n}`, `59198465185653236000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> counter <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span>\n            <span class="token keyword">break</span> counter <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题十一-2"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81%E4%B8%80-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十一</h2>\n<p>当有多层循环时，你可以使用 continue 或 break 来控制外层的循环。要实现这一点，外部的循环必须拥有一个标签 <code class="language-text">&#39;label</code>, 然后在 break 或 continue 时指定该标签</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89761442141218130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut count = 0;\n    \'outer: loop {\n        \'inner1: loop {\n            if count >= 20 {\n                // 这只会跳出 inner1 循环\n                break \'inner1; // 这里使用 \\`break\\` 也是一样的\n            }\n            count += 2;\n        }\n\n        count += 5;\n\n        \'inner2: loop {\n            if count >= 30 {\n                break \'outer;\n            }\n\n            continue \'outer;\n        }\n    }\n\n    assert!(count == __)\n}`, `89761442141218130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token lifetime-annotation symbol">\'outer:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        <span class="token lifetime-annotation symbol">\'inner1:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">20</span> <span class="token punctuation">{</span>\n                <span class="token comment">// 这只会跳出 inner1 循环</span>\n                <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">\'inner1;</span> <span class="token comment">// 这里使用 `break` 也是一样的</span>\n            <span class="token punctuation">}</span>\n            count <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        count <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n        <span class="token lifetime-annotation symbol">\'inner2:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">30</span> <span class="token punctuation">{</span>\n                <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">\'outer;</span>\n            <span class="token punctuation">}</span>\n\n            <span class="token keyword">continue</span> <span class="token lifetime-annotation symbol">\'outer;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>count <span class="token operator">==</span> __<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-107"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-107" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91941769288624950000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut count = 0;\n    \'outer: loop {\n        \'inner1: loop {\n            if count >= 20 {\n                // 这只会跳出 inner1 循环\n                break \'inner1; // 这里使用 \\`break\\` 也是一样的\n            }\n            count += 2;\n        }\n\n        count += 5;\n\n        \'inner2: loop {\n            if count >= 30 {\n                break \'outer;\n            }\n\n            continue \'outer;\n        }\n    }\n\n    assert!(count == 30)\n}`, `91941769288624950000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token lifetime-annotation symbol">\'outer:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n        <span class="token lifetime-annotation symbol">\'inner1:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">20</span> <span class="token punctuation">{</span>\n                <span class="token comment">// 这只会跳出 inner1 循环</span>\n                <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">\'inner1;</span> <span class="token comment">// 这里使用 `break` 也是一样的</span>\n            <span class="token punctuation">}</span>\n            count <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        count <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n\n        <span class="token lifetime-annotation symbol">\'inner2:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">30</span> <span class="token punctuation">{</span>\n                <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">\'outer;</span>\n            <span class="token punctuation">}</span>\n\n            <span class="token keyword">continue</span> <span class="token lifetime-annotation symbol">\'outer;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert!</span><span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="模式匹配"><a href="#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式匹配</h1>\n<h2 id="match-和-if-let"><a href="#match-%E5%92%8C-if-let" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>match 和 if let</h2>\n<h3 id="问题一-14"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33027081569744830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Direction {\n    East,\n    West,\n    North,\n    South,\n}\n\nfn main() {\n    let dire = Direction::South;\n    match dire {\n        Direction::East => println!(&quot;East&quot;),\n        __  => { // 在这里匹配 South 或 North\n            println!(&quot;South or North&quot;);\n        },\n        _ => println!(__),\n    };\n}`, `33027081569744830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>\n    East<span class="token punctuation">,</span>\n    West<span class="token punctuation">,</span>\n    North<span class="token punctuation">,</span>\n    South<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> dire <span class="token operator">=</span> Direction<span class="token punctuation">::</span>South<span class="token punctuation">;</span>\n    <span class="token keyword">match</span> dire <span class="token punctuation">{</span>\n        Direction<span class="token punctuation">::</span>East <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"East"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        __  <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// 在这里匹配 South 或 North</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"South or North"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-108"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-108" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58111561418468450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Direction {\n    East,\n    West,\n    North,\n    South,\n}\n\nfn main() {\n    let dire = Direction::South;\n    match dire {\n        Direction::East => println!(&quot;East&quot;),\n        Direction::South | Direction::North => {\n            // 在这里匹配 South 或 North\n            println!(&quot;South or North&quot;);\n        }\n        _ => println!(&quot;West&quot;),\n    };\n}`, `58111561418468450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>\n    East<span class="token punctuation">,</span>\n    West<span class="token punctuation">,</span>\n    North<span class="token punctuation">,</span>\n    South<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> dire <span class="token operator">=</span> Direction<span class="token punctuation">::</span>South<span class="token punctuation">;</span>\n    <span class="token keyword">match</span> dire <span class="token punctuation">{</span>\n        Direction<span class="token punctuation">::</span>East <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"East"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Direction<span class="token punctuation">::</span>South <span class="token operator">|</span> Direction<span class="token punctuation">::</span>North <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token comment">// 在这里匹配 South 或 North</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"South or North"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        _ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"West"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-14"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>match 是一个表达式，因此可以用在赋值语句中</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17872440055876692000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let boolean = true;\n\n    // 使用 match 表达式填空，并满足以下条件\n    //\n    // boolean = true => binary = 1\n    // boolean = false => binary = 0\n    let binary = __;\n\n    assert_eq!(binary, 1);\n}`, `17872440055876692000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> boolean <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 match 表达式填空，并满足以下条件</span>\n    <span class="token comment">//</span>\n    <span class="token comment">// boolean = true => binary = 1</span>\n    <span class="token comment">// boolean = false => binary = 0</span>\n    <span class="token keyword">let</span> binary <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>binary<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-109"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-109" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65358076868405400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let boolean = true;\n\n    // 使用 match 表达式填空，并满足以下条件\n    //\n    // boolean = true => binary = 1\n    // boolean = false => binary = 0\n    let binary = match boolean {\n        true => 1,\n        false => 0,\n    };\n\n    assert_eq!(binary, 1);\n}`, `65358076868405400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> boolean <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 match 表达式填空，并满足以下条件</span>\n    <span class="token comment">//</span>\n    <span class="token comment">// boolean = true => binary = 1</span>\n    <span class="token comment">// boolean = false => binary = 0</span>\n    <span class="token keyword">let</span> binary <span class="token operator">=</span> <span class="token keyword">match</span> boolean <span class="token punctuation">{</span>\n        <span class="token keyword">true</span> <span class="token operator">=></span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token keyword">false</span> <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>binary<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-14"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>使用 match 匹配出枚举成员持有的值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77521649464042420000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msgs = [\n        Message::Quit,\n        Message::Move{x:1, y:3},\n        Message::ChangeColor(255,255,0)\n    ];\n\n    for msg in msgs {\n        show_message(msg)\n    }\n}\n\nfn show_message(msg: Message) {\n    match msg {\n        __ => { // 这里匹配 Message::Move\n            assert_eq!(a, 1);\n            assert_eq!(b, 3);\n        },\n        Message::ChangeColor(_, g, b) => {\n            assert_eq!(g, __);\n            assert_eq!(b, __);\n        }\n        __ => println!(&quot;no data in these variants&quot;)\n    }\n}`, `77521649464042420000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msgs <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Message<span class="token punctuation">::</span>Quit<span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Move<span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs <span class="token punctuation">{</span>\n        <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">:</span> Message<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>\n        __ <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// 这里匹配 Message::Move</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        __ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"no data in these variants"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-110"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-110" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57808393707129225000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Message {\n    Quit,\n    Move { x: i32, y: i32 },\n    Write(String),\n    ChangeColor(i32, i32, i32),\n}\n\nfn main() {\n    let msgs = [\n        Message::Quit,\n        Message::Move { x: 1, y: 3 },\n        Message::ChangeColor(255, 255, 0),\n    ];\n\n    for msg in msgs {\n        show_message(msg)\n    }\n}\n\nfn show_message(msg: Message) {\n    match msg {\n        Message::Move { x: a, y: b } => {\n            // 这里匹配 Message::Move\n            assert_eq!(a, 1);\n            assert_eq!(b, 3);\n        }\n        Message::ChangeColor(_, g, b) => {\n            assert_eq!(g, 255);\n            assert_eq!(b, 0);\n        }\n        __ => println!(&quot;no data in these variants&quot;),\n    }\n}`, `57808393707129225000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Quit<span class="token punctuation">,</span>\n    Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">Write</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">ChangeColor</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msgs <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Message<span class="token punctuation">::</span>Quit<span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> msg <span class="token keyword">in</span> msgs <span class="token punctuation">{</span>\n        <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">show_message</span><span class="token punctuation">(</span>msg<span class="token punctuation">:</span> Message<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>\n        Message<span class="token punctuation">::</span>Move <span class="token punctuation">{</span> x<span class="token punctuation">:</span> a<span class="token punctuation">,</span> y<span class="token punctuation">:</span> b <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token comment">// 这里匹配 Message::Move</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        Message<span class="token punctuation">::</span><span class="token function">ChangeColor</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        __ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"no data in these variants"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-13"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>matches! 看起来像 match, 但是它可以做一些特别的事情</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67246832417128720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let alphabets = [\'a\', \'E\', \'Z\', \'0\', \'x\', \'9\' , \'Y\'];\n\n    // 使用 \\`matches\\` 填空\n    for ab in alphabets {\n        assert!(__)\n    }\n}`, `67246832417128720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> alphabets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'E\'</span><span class="token punctuation">,</span> <span class="token char string">\'Z\'</span><span class="token punctuation">,</span> <span class="token char string">\'0\'</span><span class="token punctuation">,</span> <span class="token char string">\'x\'</span><span class="token punctuation">,</span> <span class="token char string">\'9\'</span> <span class="token punctuation">,</span> <span class="token char string">\'Y\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 `matches` 填空</span>\n    <span class="token keyword">for</span> ab <span class="token keyword">in</span> alphabets <span class="token punctuation">{</span>\n        <span class="token function">assert!</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-111"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-111" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8647620328068783000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let alphabets = [\'a\', \'E\', \'Z\', \'0\', \'x\', \'9\', \'Y\'];\n\n    // 使用 \\`matches\\` 填空\n    for ab in alphabets {\n        assert!(matches!(ab, \'a\'..=\'z\' | \'A\'..=\'Z\' | \'0\'..=\'9\'))\n    }\n}`, `8647620328068783000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> alphabets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token char string">\'a\'</span><span class="token punctuation">,</span> <span class="token char string">\'E\'</span><span class="token punctuation">,</span> <span class="token char string">\'Z\'</span><span class="token punctuation">,</span> <span class="token char string">\'0\'</span><span class="token punctuation">,</span> <span class="token char string">\'x\'</span><span class="token punctuation">,</span> <span class="token char string">\'9\'</span><span class="token punctuation">,</span> <span class="token char string">\'Y\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 `matches` 填空</span>\n    <span class="token keyword">for</span> ab <span class="token keyword">in</span> alphabets <span class="token punctuation">{</span>\n        <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token function">matches!</span><span class="token punctuation">(</span>ab<span class="token punctuation">,</span> <span class="token char string">\'a\'</span><span class="token punctuation">..=</span><span class="token char string">\'z\'</span> <span class="token operator">|</span> <span class="token char string">\'A\'</span><span class="token punctuation">..=</span><span class="token char string">\'Z\'</span> <span class="token operator">|</span> <span class="token char string">\'0\'</span><span class="token punctuation">..=</span><span class="token char string">\'9\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-13"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65642413530760700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum MyEnum {\n    Foo,\n    Bar\n}\n\nfn main() {\n    let mut count = 0;\n\n    let v = vec![MyEnum::Foo,MyEnum::Bar,MyEnum::Foo];\n    for e in v {\n        if e == MyEnum::Foo { // 修复错误，只能修改本行代码\n            count += 1;\n        }\n    }\n\n    assert_eq!(count, 2);\n}`, `65642413530760700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> MyEnum <span class="token punctuation">{</span>\n    Foo<span class="token punctuation">,</span>\n    Bar\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Bar<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> e <span class="token keyword">in</span> v <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> e <span class="token operator">==</span> MyEnum<span class="token punctuation">::</span>Foo <span class="token punctuation">{</span> <span class="token comment">// 修复错误，只能修改本行代码</span>\n            count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-112"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-112" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78019989110270350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum MyEnum {\n    Foo,\n    Bar\n}\n\nfn main() {\n    let mut count = 0;\n\n    let v = vec![MyEnum::Foo,MyEnum::Bar,MyEnum::Foo];\n    for e in v {\n        if matches!(e, MyEnum::Foo) { // 修复错误，只能修改本行代码\n            count += 1;\n        }\n    }\n\n    assert_eq!(count, 2);\n}`, `78019989110270350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> MyEnum <span class="token punctuation">{</span>\n    Foo<span class="token punctuation">,</span>\n    Bar\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Bar<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> e <span class="token keyword">in</span> v <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token function">matches!</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 修复错误，只能修改本行代码</span>\n            count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19925402875666530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum MyEnum {\n    Foo,\n    Bar\n}\n\nfn main() {\n    let mut count = 0;\n\n    let v = vec![MyEnum::Foo,MyEnum::Bar,MyEnum::Foo];\n    for e in v {\n        if let MyEnum::Foo = e { // 修复错误，只能修改本行代码\n            count += 1;\n        }\n    }\n\n    assert_eq!(count, 2);\n}`, `19925402875666530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> MyEnum <span class="token punctuation">{</span>\n    Foo<span class="token punctuation">,</span>\n    Bar\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Bar<span class="token punctuation">,</span>MyEnum<span class="token punctuation">::</span>Foo<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> e <span class="token keyword">in</span> v <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token keyword">let</span> MyEnum<span class="token punctuation">::</span>Foo <span class="token operator">=</span> e <span class="token punctuation">{</span> <span class="token comment">// 修复错误，只能修改本行代码</span>\n            count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-12"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>在有些时候, 使用 match 匹配枚举有些太重了，此时 if let 就非常适合</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26279780891867177000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let o = Some(7);\n\n    // 移除整个 \\`match\\` 语句块，使用 \\`if let\\` 替代\n    match o {\n        Some(i) => {\n            println!(&quot;This is a really long string and \\`{:?}\\`&quot;, i);\n        }\n        _ => {}\n    };\n}`, `26279780891867177000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 移除整个 `match` 语句块，使用 `if let` 替代</span>\n    <span class="token keyword">match</span> o <span class="token punctuation">{</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"This is a really long string and `{:?}`"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-113"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-113" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7023096035309062000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let o = Some(7);\n\n    if let Some(i) = o {\n        println!(&quot;This is a really long string and \\`{:?}\\`&quot;, i);\n    }\n}`, `7023096035309062000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Some</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> o <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"This is a really long string and `{:?}`"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-7"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69412682729852370000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Foo {\n    Bar(u8)\n}\n\nfn main() {\n    let a = Foo::Bar(1);\n\n    __ {\n        println!(&quot;foobar 持有的值是: {}&quot;, i);\n    }\n}`, `69412682729852370000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Foo <span class="token punctuation">{</span>\n    <span class="token function">Bar</span><span class="token punctuation">(</span>u8<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> Foo<span class="token punctuation">::</span><span class="token function">Bar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    __ <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"foobar 持有的值是: {}"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-114"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-114" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13376027207391860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nenum Foo {\n    Bar(u8),\n}\n\nfn main() {\n    let a = Foo::Bar(1);\n\n    if let Foo::Bar(i) = a {\n        println!(&quot;foobar 持有的值是: {}&quot;, i);\n    }\n}`, `13376027207391860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">enum</span> Foo <span class="token punctuation">{</span>\n    <span class="token function">Bar</span><span class="token punctuation">(</span>u8<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> Foo<span class="token punctuation">::</span><span class="token function">Bar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token keyword">let</span> Foo<span class="token punctuation">::</span><span class="token function">Bar</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> a <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"foobar 持有的值是: {}"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-7"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75871413051433350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum Foo {\n    Bar,\n    Baz,\n    Qux(u32)\n}\n\nfn main() {\n    let a = Foo::Qux(10);\n\n    // 移除以下代码，使用 \\`match\\` 代替\n    if let Foo::Bar = a {\n        println!(&quot;match foo::bar&quot;)\n    } else if let Foo::Baz = a {\n        println!(&quot;match foo::baz&quot;)\n    } else {\n        println!(&quot;match others&quot;)\n    }\n}`, `75871413051433350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> Foo <span class="token punctuation">{</span>\n    Bar<span class="token punctuation">,</span>\n    Baz<span class="token punctuation">,</span>\n    <span class="token function">Qux</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> Foo<span class="token punctuation">::</span><span class="token function">Qux</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 移除以下代码，使用 `match` 代替</span>\n    <span class="token keyword">if</span> <span class="token keyword">let</span> Foo<span class="token punctuation">::</span>Bar <span class="token operator">=</span> a <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match foo::bar"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token keyword">let</span> Foo<span class="token punctuation">::</span>Baz <span class="token operator">=</span> a <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match foo::baz"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match others"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-115"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-115" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63392710704238130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`enum Foo {\n    Bar,\n    Baz,\n    Qux(u32),\n}\n\nfn main() {\n    let a = Foo::Qux(10);\n\n    match a {\n        Foo::Bar => println!(&quot;match foo::bar&quot;),\n        Foo::Baz => println!(&quot;match foo::baz&quot;),\n        _ => println!(&quot;match others&quot;),\n    }\n}`, `63392710704238130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">enum</span> Foo <span class="token punctuation">{</span>\n    Bar<span class="token punctuation">,</span>\n    Baz<span class="token punctuation">,</span>\n    <span class="token function">Qux</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> Foo<span class="token punctuation">::</span><span class="token function">Qux</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> a <span class="token punctuation">{</span>\n        Foo<span class="token punctuation">::</span>Bar <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match foo::bar"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Foo<span class="token punctuation">::</span>Baz <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match foo::baz"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match others"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-7"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40949541003036700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 就地修复错误\nfn main() {\n    let age = Some(30);\n    if let Some(age) = age { // 创建一个新的变量，该变量与之前的 \\`age\\` 变量同名\n       assert_eq!(age, Some(30));\n    } // 新的 \\`age\\` 变量在这里超出作用域\n\n    match age {\n        // \\`match\\` 也能实现变量遮蔽\n        Some(age) =>  println!(&quot;age 是一个新的变量，它的值是 {}&quot;,age),\n        _ => ()\n    }\n }`, `40949541003036700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 就地修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Some</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token operator">=</span> age <span class="token punctuation">{</span> <span class="token comment">// 创建一个新的变量，该变量与之前的 `age` 变量同名</span>\n       <span class="token function">assert_eq!</span><span class="token punctuation">(</span>age<span class="token punctuation">,</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token comment">// 新的 `age` 变量在这里超出作用域</span>\n\n    <span class="token keyword">match</span> age <span class="token punctuation">{</span>\n        <span class="token comment">// `match` 也能实现变量遮蔽</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token operator">=></span>  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"age 是一个新的变量，它的值是 {}"</span><span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n <span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-116"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-116" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61460481260381995000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 就地修复错误\nfn main() {\n    let age = Some(30);\n    if let Some(age) = age { // 创建一个新的变量，该变量与之前的 \\`age\\` 变量同名\n        assert_eq!(age, 30);\n    } // 新的 \\`age\\` 变量在这里超出作用域\n\n    match age {\n        // \\`match\\` 也能实现变量遮蔽\n        Some(age) => println!(&quot;age 是一个新的变量，它的值是 {}&quot;, age),\n        _ => (),\n    }\n}`, `61460481260381995000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 就地修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Some</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token operator">=</span> age <span class="token punctuation">{</span> <span class="token comment">// 创建一个新的变量，该变量与之前的 `age` 变量同名</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>age<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token comment">// 新的 `age` 变量在这里超出作用域</span>\n\n    <span class="token keyword">match</span> age <span class="token punctuation">{</span>\n        <span class="token comment">// `match` 也能实现变量遮蔽</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"age 是一个新的变量，它的值是 {}"</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="模式"><a href="#%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式</h2>\n<h3 id="问题一-15"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>使用 | 可以匹配多个值, 而使用 ..= 可以匹配一个闭区间的数值序列</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39597440611295445000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {}\nfn match_number(n: i32) {\n    match n {\n        // 匹配一个单独的值\n        1 => println!(&quot;One!&quot;),\n        // 使用 \\`|\\` 填空，不要使用 \\`..\\` 或 \\`..=\\`\n        __ => println!(&quot;match 2 -> 5&quot;),\n        // 匹配一个闭区间的数值序列\n        6..=10 => {\n            println!(&quot;match 6 -> 10&quot;)\n        },\n        _ => {\n            println!(&quot;match 11 -> +infinite&quot;)\n        }\n    }\n}`, `39597440611295445000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">match_number</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> n <span class="token punctuation">{</span>\n        <span class="token comment">// 匹配一个单独的值</span>\n        <span class="token number">1</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 使用 `|` 填空，不要使用 `..` 或 `..=`</span>\n        __ <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 2 -> 5"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 匹配一个闭区间的数值序列</span>\n        <span class="token number">6</span><span class="token punctuation">..=</span><span class="token number">10</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 6 -> 10"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 11 -> +infinite"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-117"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-117" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6141515513919216000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {}\nfn match_number(n: i32) {\n    match n {\n        // 匹配一个单独的值\n        1 => println!(&quot;One!&quot;),\n        // 使用 \\`|\\` 填空，不要使用 \\`..\\` 或 \\`..=\\`\n        2 | 3 | 4 | 5 => println!(&quot;match 2 -> 5&quot;),\n        // 匹配一个闭区间的数值序列\n        6..=10 => {\n            println!(&quot;match 6 -> 10&quot;)\n        }\n        _ => {\n            println!(&quot;match 11 -> +infinite&quot;)\n        }\n    }\n}`, `6141515513919216000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">match_number</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> n <span class="token punctuation">{</span>\n        <span class="token comment">// 匹配一个单独的值</span>\n        <span class="token number">1</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 使用 `|` 填空，不要使用 `..` 或 `..=`</span>\n        <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">4</span> <span class="token operator">|</span> <span class="token number">5</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 2 -> 5"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 匹配一个闭区间的数值序列</span>\n        <span class="token number">6</span><span class="token punctuation">..=</span><span class="token number">10</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 6 -> 10"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        _ <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"match 11 -> +infinite"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-15"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>@ 操作符可以让我们将一个与模式相匹配的值绑定到新的变量上</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16725760873579400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Point {\n    x: i32,\n    y: i32,\n}\n\nfn main() {\n    // 填空，让 p 匹配第二个分支\n    let p = Point { x: __, y: __ };\n\n    match p {\n        Point { x, y: 0 } => println!(&quot;On the x axis at {}&quot;, x),\n        // 第二个分支\n        Point { x: 0..=5, y: y@ (10 | 20 | 30) } => println!(&quot;On the y axis at {}&quot;, y),\n        Point { x, y } => println!(&quot;On neither axis: ({}, {})&quot;, x, y),\n    }\n}`, `16725760873579400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Point <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空，让 p 匹配第二个分支</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> __<span class="token punctuation">,</span> y<span class="token punctuation">:</span> __ <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> p <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On the x axis at {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 第二个分支</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> y<span class="token operator">@</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">|</span> <span class="token number">20</span> <span class="token operator">|</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On the y axis at {}"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On neither axis: ({}, {})"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-118"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-118" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50709753191524180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Point {\n    x: i32,\n    y: i32,\n}\n\nfn main() {\n    // 填空，让 p 匹配第二个分支\n    let p = Point { x: 0, y: 10 };\n\n    match p {\n        Point { x, y: 0 } => println!(&quot;On the x axis at {}&quot;, x),\n        // 第二个分支\n        Point { x: 0..=5, y: y@ (10 | 20 | 30) } => println!(&quot;On the y axis at {}&quot;, y),\n        Point { x, y } => println!(&quot;On neither axis: ({}, {})&quot;, x, y),\n    }\n}`, `50709753191524180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Point <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空，让 p 匹配第二个分支</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> p <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On the x axis at {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// 第二个分支</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> y<span class="token operator">@</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">|</span> <span class="token number">20</span> <span class="token operator">|</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On the y axis at {}"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"On neither axis: ({}, {})"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-15"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54760405852770310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nenum Message {\n    Hello { id: i32 },\n}\n\nfn main() {\n    let msg = Message::Hello { id: 5 };\n\n    match msg {\n        Message::Hello {\n            id:  3..=7,\n        } => println!(&quot;id 值的范围在 [3, 7] 之间: {}&quot;, id),\n        Message::Hello { id: newid@10 | 11 | 12 } => {\n            println!(&quot;id 值的范围在 [10, 12] 之间: {}&quot;, newid)\n        }\n        Message::Hello { id } => println!(&quot;Found some other id: {}&quot;, id),\n    }\n}`, `54760405852770310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg <span class="token operator">=</span> Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span>\n            id<span class="token punctuation">:</span>  <span class="token number">3</span><span class="token punctuation">..=</span><span class="token number">7</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"id 值的范围在 [3, 7] 之间: {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> newid<span class="token operator">@</span><span class="token number">10</span> <span class="token operator">|</span> <span class="token number">11</span> <span class="token operator">|</span> <span class="token number">12</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"id 值的范围在 [10, 12] 之间: {}"</span><span class="token punctuation">,</span> newid<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Found some other id: {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-119"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-119" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95708799183669120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nenum Message {\n    Hello { id: i32 },\n}\n\nfn main() {\n    let msg = Message::Hello { id: 5 };\n\n    match msg {\n        Message::Hello { id: id @ 3..=7 } => println!(&quot;id 值的范围在 [3, 7] 之间: {}&quot;, id),\n        Message::Hello {\n            id: newid @ (10 | 11 | 12),\n        } => {\n            println!(&quot;id 值的范围在 [10, 12] 之间: {}&quot;, newid)\n        }\n        Message::Hello { id } => println!(&quot;Found some other id: {}&quot;, id),\n    }\n}`, `95708799183669120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">enum</span> Message <span class="token punctuation">{</span>\n    Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> i32 <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> msg <span class="token operator">=</span> Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> msg <span class="token punctuation">{</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id<span class="token punctuation">:</span> id <span class="token operator">@</span> <span class="token number">3</span><span class="token punctuation">..=</span><span class="token number">7</span> <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"id 值的范围在 [3, 7] 之间: {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span>\n            id<span class="token punctuation">:</span> newid <span class="token operator">@</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">|</span> <span class="token number">11</span> <span class="token operator">|</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"id 值的范围在 [10, 12] 之间: {}"</span><span class="token punctuation">,</span> newid<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        Message<span class="token punctuation">::</span>Hello <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Found some other id: {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-14"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>匹配守卫（match guard）是一个位于 match 分支模式之后的额外 if 条件，它能为分支模式提供更进一步的匹配条件。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24305644303433605000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空让代码工作，必须使用 \\`split\\`\nfn main() {\n    let num = Some(4);\n    let split = 5;\n    match num {\n        Some(x) __ => assert!(x < split),\n        Some(x) => assert!(x >= split),\n        None => (),\n    }\n}`, `24305644303433605000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空让代码工作，必须使用 `split`</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> split <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> num <span class="token punctuation">{</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> __ <span class="token operator">=></span> <span class="token function">assert!</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> split<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">assert!</span><span class="token punctuation">(</span>x <span class="token operator">>=</span> split<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        None <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-120"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-120" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92910991117383830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空让代码工作，必须使用 \\`split\\`\nfn main() {\n    let num = Some(4);\n    let split = 5;\n    match num {\n        Some(x) if (x < split) => assert!(x < split),\n        Some(x) => assert!(x >= split),\n        None => (),\n    }\n}`, `92910991117383830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空让代码工作，必须使用 `split`</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> split <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> num <span class="token punctuation">{</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> split<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">assert!</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> split<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">assert!</span><span class="token punctuation">(</span>x <span class="token operator">>=</span> split<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        None <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-14"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>使用 .. 忽略一部分值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19469052399109190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\nfn main() {\n    let numbers = (2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048);\n\n    match numbers {\n        __ => {\n           assert_eq!(first, 2);\n           assert_eq!(last, 2048);\n        }\n    }\n}`, `19469052399109190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> numbers <span class="token punctuation">{</span>\n        __ <span class="token operator">=></span> <span class="token punctuation">{</span>\n           <span class="token function">assert_eq!</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n           <span class="token function">assert_eq!</span><span class="token punctuation">(</span>last<span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-121"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-121" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60516542286487110000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空，让代码工作\nfn main() {\n    let numbers = (2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048);\n\n    match numbers {\n        (first, .., last) => {\n            assert_eq!(first, 2);\n            assert_eq!(last, 2048);\n        }\n    }\n}`, `60516542286487110000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> numbers <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> numbers <span class="token punctuation">{</span>\n        <span class="token punctuation">(</span>first<span class="token punctuation">,</span> <span class="token punctuation">..</span><span class="token punctuation">,</span> last<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>last<span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-13"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>使用模式 &#x26;mut V 去匹配一个可变引用时，你需要格外小心，因为匹配出来的 V 是一个值，而不是可变引用</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45205438579316556000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，尽量少地修改代码\n// 不要移除任何代码行\nfn main() {\n    let mut v = String::from(&quot;hello,&quot;);\n    let r = &mut v;\n\n    match r {\n       &mut value => value.push_str(&quot; world!&quot;)\n    }\n}`, `45205438579316556000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，尽量少地修改代码</span>\n<span class="token comment">// 不要移除任何代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> r <span class="token punctuation">{</span>\n       <span class="token operator">&amp;</span><span class="token keyword">mut</span> value <span class="token operator">=></span> value<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">" world!"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-122"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-122" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26601572519147364000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，尽量少地修改代码\n// 不要移除任何代码行\nfn main() {\n    let mut v = String::from(&quot;hello,&quot;);\n    let r = &mut v;\n\n    match r {\n        value => value.push_str(&quot; world!&quot;),\n    }\n}`, `26601572519147364000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，尽量少地修改代码</span>\n<span class="token comment">// 不要移除任何代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">;</span>\n\n    <span class="token keyword">match</span> r <span class="token punctuation">{</span>\n        value <span class="token operator">=></span> value<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">" world!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="方法"><a href="#%E6%96%B9%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>方法</h1>\n<h2 id="问题一-16"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h2>\n<p>方法跟函数类似：都是使用 fn 声明，有参数和返回值。但是与函数不同的是，方法定义在结构体的上下文中(枚举、特征对象也可以定义方法)，而且方法的第一个参数一定是 self 或其变体 &#x26;self、&#x26;mut self，self 代表了当前调用的结构体实例。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24390573157373075000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nimpl Rectangle {\n    // 完成 area 方法，返回矩形 Rectangle 的面积\n    fn area\n}\n\nfn main() {\n    let rect1 = Rectangle { width: 30, height: 50 };\n\n    assert_eq!(rect1.area(), 1500);\n}`, `24390573157373075000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Rectangle <span class="token punctuation">{</span>\n    <span class="token comment">// 完成 area 方法，返回矩形 Rectangle 的面积</span>\n    <span class="token keyword">fn</span> area\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> Rectangle <span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>rect1<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-123"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-123" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2966141071352224300"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nimpl Rectangle {\n    // 完成 area 方法，返回矩形 Rectangle 的面积\n    fn area(&self) -> u32 {\n        self.width * self.height\n    }\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    assert_eq!(rect1.area(), 1500);\n}`, `2966141071352224300`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Rectangle <span class="token punctuation">{</span>\n    <span class="token comment">// 完成 area 方法，返回矩形 Rectangle 的面积</span>\n    <span class="token keyword">fn</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> Rectangle <span class="token punctuation">{</span>\n        width<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span>\n        height<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>rect1<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题二-16"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h2>\n<p>self 会拿走当前结构体实例(调用对象)的所有权，而 &#x26;self 却只会借用一个不可变引用，&#x26;mut self 会借用一个可变引用</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8280155766982556000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 只填空，不要删除任何代码行!\n#[derive(Debug)]\nstruct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    pub fn show_state(__)  {\n        println!(&quot;the current state is {}&quot;, __.color);\n    }\n}\nfn main() {\n    let light = TrafficLight{\n        color: &quot;red&quot;.to_owned(),\n    };\n    // 不要拿走 \\`light\\` 的所有权\n    light.show_state();\n    // 否则下面代码会报错\n    println!(&quot;{:?}&quot;, light);\n}`, `8280155766982556000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 只填空，不要删除任何代码行!</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">show_state</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span>  <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the current state is {}"</span><span class="token punctuation">,</span> __<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> light <span class="token operator">=</span> TrafficLight<span class="token punctuation">{</span>\n        color<span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token comment">// 不要拿走 `light` 的所有权</span>\n    light<span class="token punctuation">.</span><span class="token function">show_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 否则下面代码会报错</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> light<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-124"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-124" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20424923491630166000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 只填空，不要删除任何代码行!\n#[derive(Debug)]\nstruct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    pub fn show_state(&self) {\n        println!(&quot;the current state is {}&quot;, self.color);\n    }\n}\nfn main() {\n    let light = TrafficLight {\n        color: &quot;red&quot;.to_owned(),\n    };\n    // 不要拿走 \\`light\\` 的所有权\n    light.show_state();\n    // 否则下面代码会报错\n    println!(&quot;{:?}&quot;, light);\n}`, `20424923491630166000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 只填空，不要删除任何代码行!</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">show_state</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the current state is {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> light <span class="token operator">=</span> TrafficLight <span class="token punctuation">{</span>\n        color<span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token comment">// 不要拿走 `light` 的所有权</span>\n    light<span class="token punctuation">.</span><span class="token function">show_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 否则下面代码会报错</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> light<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题三-16"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h2>\n<p>&#x26;self 实际上是 self: &#x26;Self 的缩写或者说语法糖</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68662107271720770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    // 使用 \\`Self\\` 填空\n    pub fn show_state(__)  {\n        println!(&quot;the current state is {}&quot;, self.color);\n    }\n\n    // 填空，不要使用 \\`Self\\` 或其变体\n    pub fn change_state(__) {\n        self.color = &quot;green&quot;.to_string()\n    }\n}\nfn main() {}`, `68662107271720770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token comment">// 使用 `Self` 填空</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">show_state</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span>  <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the current state is {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 填空，不要使用 `Self` 或其变体</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">change_state</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"green"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-125"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-125" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13374100856103023000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    // 使用 \\`Self\\` 填空\n    pub fn show_state(self: &Self) {\n        println!(&quot;the current state is {}&quot;, self.color);\n    }\n\n    // 填空，不要使用 \\`Self\\` 或其变体\n    pub fn change_state(&mut self) {\n        self.color = &quot;green&quot;.to_string()\n    }\n}\nfn main() {}`, `13374100856103023000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token comment">// 使用 `Self` 填空</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">show_state</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"the current state is {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 填空，不要使用 `Self` 或其变体</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">change_state</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"green"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题四-15"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h2>\n<p>定义在 impl 语句块中的函数被称为关联函数，因为它们跟当前类型关联在一起。关联函数与方法最大的区别就是它第一个参数不是 self，原因是它们不需要使用当前的实例，因此关联函数往往可以用于构造函数：初始化一个实例对象</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41722834318475720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    // 1. 实现下面的关联函数 \\`new\\`,\n    // 2. 该函数返回一个 TrafficLight 实例，包含 \\`color\\` &quot;red&quot;\n    // 3. 该函数必须使用 \\`Self\\` 作为类型，不能在签名或者函数体中使用 \\`TrafficLight\\`\n    pub fn new()\n\n    pub fn get_state(&self) -> &str {\n        &self.color\n    }\n}\n\nfn main() {\n    let light = TrafficLight::new();\n    assert_eq!(light.get_state(), &quot;red&quot;);\n}`, `41722834318475720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token comment">// 1. 实现下面的关联函数 `new`,</span>\n    <span class="token comment">// 2. 该函数返回一个 TrafficLight 实例，包含 `color` "red"</span>\n    <span class="token comment">// 3. 该函数必须使用 `Self` 作为类型，不能在签名或者函数体中使用 `TrafficLight`</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">get_state</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>color\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> light <span class="token operator">=</span> TrafficLight<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span><span class="token function">get_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-126"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-126" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79016798632467270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct TrafficLight {\n    color: String,\n}\n\nimpl TrafficLight {\n    // 1. 实现下面的关联函数 \\`new\\`,\n    // 2. 该函数返回一个 TrafficLight 实例，包含 \\`color\\` &quot;red&quot;\n    // 3. 该函数必须使用 \\`Self\\` 作为类型，不能在签名或者函数体中使用 \\`TrafficLight\\`\n    pub fn new() -> Self {\n        TrafficLight {\n            color: &quot;red&quot;.to_string(),\n        }\n    }\n\n    pub fn get_state(&self) -> &str {\n        &self.color\n    }\n}\n\nfn main() {\n    let light = TrafficLight::new();\n    assert_eq!(light.get_state(), &quot;red&quot;);\n}`, `79016798632467270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> TrafficLight <span class="token punctuation">{</span>\n    color<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> TrafficLight <span class="token punctuation">{</span>\n    <span class="token comment">// 1. 实现下面的关联函数 `new`,</span>\n    <span class="token comment">// 2. 该函数返回一个 TrafficLight 实例，包含 `color` "red"</span>\n    <span class="token comment">// 3. 该函数必须使用 `Self` 作为类型，不能在签名或者函数体中使用 `TrafficLight`</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>\n        TrafficLight <span class="token punctuation">{</span>\n            color<span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">get_state</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>color\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> light <span class="token operator">=</span> TrafficLight<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span><span class="token function">get_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题五-15"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h2>\n<p>每一个结构体允许拥有多个 impl 语句块</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85912948877730350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\n// 使用多个 \\`impl\\` 语句块重写下面的代码\nimpl Rectangle {\n    fn area(&self) -> u32 {\n        self.width * self.height\n    }\n\n    fn can_hold(&self, other: &Rectangle) -> bool {\n        self.width > other.width && self.height > other.height\n    }\n}\n\nfn main() {}`, `85912948877730350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 使用多个 `impl` 语句块重写下面的代码</span>\n<span class="token keyword">impl</span> Rectangle <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Rectangle<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">></span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">></span> other<span class="token punctuation">.</span>height\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-127"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-127" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="730607786017789600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\n// 使用多个 \\`impl\\` 语句块重写下面的代码\nimpl Rectangle {\n    fn area(&self) -> u32 {\n        self.width * self.height\n    }\n}\n\n// 使用多个 \\`impl\\` 语句块重写下面的代码\nimpl Rectangle {\n    fn can_hold(&self, other: &Rectangle) -> bool {\n        self.width > other.width && self.height > other.height\n    }\n}\n\nfn main() {}`, `730607786017789600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Rectangle <span class="token punctuation">{</span>\n    width<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n    height<span class="token punctuation">:</span> u32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 使用多个 `impl` 语句块重写下面的代码</span>\n<span class="token keyword">impl</span> Rectangle <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 使用多个 `impl` 语句块重写下面的代码</span>\n<span class="token keyword">impl</span> Rectangle <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Rectangle<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">></span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">></span> other<span class="token punctuation">.</span>height\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题六-14"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h2>\n<p>我们还可以为枚举类型定义方法</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32042632181544350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nenum TrafficLightColor {\n    Red,\n    Yellow,\n    Green,\n}\n\n// 为 TrafficLightColor 实现所需的方法\nimpl TrafficLightColor {\n\n}\n\nfn main() {\n    let c = TrafficLightColor::Yellow;\n\n    assert_eq!(c.color(), &quot;yellow&quot;);\n\n    println!(&quot;{:?}&quot;,c);\n}`, `32042632181544350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> TrafficLightColor <span class="token punctuation">{</span>\n    Red<span class="token punctuation">,</span>\n    Yellow<span class="token punctuation">,</span>\n    Green<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 为 TrafficLightColor 实现所需的方法</span>\n<span class="token keyword">impl</span> TrafficLightColor <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c <span class="token operator">=</span> TrafficLightColor<span class="token punctuation">::</span>Yellow<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-128"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-128" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39403067017908140000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nenum TrafficLightColor {\n    Red,\n    Yellow,\n    Green,\n}\n\n// 为 TrafficLightColor 实现所需的方法\nimpl TrafficLightColor {\n    fn color(&self) -> &str {\n        match self {\n            TrafficLightColor::Yellow => &quot;yellow&quot;,\n            _ => &quot;None&quot;,\n        }\n    }\n}\n\nfn main() {\n    let c = TrafficLightColor::Yellow;\n\n    assert_eq!(c.color(), &quot;yellow&quot;);\n\n    println!(&quot;{:?}&quot;, c);\n}`, `39403067017908140000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> TrafficLightColor <span class="token punctuation">{</span>\n    Red<span class="token punctuation">,</span>\n    Yellow<span class="token punctuation">,</span>\n    Green<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 为 TrafficLightColor 实现所需的方法</span>\n<span class="token keyword">impl</span> TrafficLightColor <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n        <span class="token keyword">match</span> <span class="token keyword">self</span> <span class="token punctuation">{</span>\n            TrafficLightColor<span class="token punctuation">::</span>Yellow <span class="token operator">=></span> <span class="token string">"yellow"</span><span class="token punctuation">,</span>\n            _ <span class="token operator">=></span> <span class="token string">"None"</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> c <span class="token operator">=</span> TrafficLightColor<span class="token punctuation">::</span>Yellow<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="泛型和特征"><a href="#%E6%B3%9B%E5%9E%8B%E5%92%8C%E7%89%B9%E5%BE%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>泛型和特征</h1>\n<h2 id="泛型"><a href="#%E6%B3%9B%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>泛型</h2>\n<h3 id="问题一-17"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16380500242873274000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nstruct A;          // 具体的类型 \\`A\\`.\nstruct S(A);       // 具体的类型 \\`S\\`.\nstruct SGen<T>(T); // 泛型 \\`SGen\\`.\n\nfn reg_fn(_s: S) {}\n\nfn gen_spec_t(_s: SGen<A>) {}\n\nfn gen_spec_i32(_s: SGen<i32>) {}\n\nfn generic<T>(_s: SGen<T>) {}\n\nfn main() {\n    // 使用非泛型函数\n    reg_fn(__);          // 具体的类型\n    gen_spec_t(__);   // 隐式地指定类型参数  \\`A\\`.\n    gen_spec_i32(__); // 隐式地指定类型参数\\`i32\\`.\n\n    // 显式地指定类型参数 \\`char\\`\n    generic::<char>(__);\n\n    // 隐式地指定类型参数 \\`char\\`.\n    generic(__);\n}`, `16380500242873274000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">struct</span> A<span class="token punctuation">;</span>          <span class="token comment">// 具体的类型 `A`.</span>\n<span class="token keyword">struct</span> <span class="token function">S</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 具体的类型 `S`.</span>\n<span class="token keyword">struct</span> SGen<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 泛型 `SGen`.</span>\n\n<span class="token keyword">fn</span> <span class="token function">reg_fn</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> S<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">gen_spec_t</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>A<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">gen_spec_i32</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> generic<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用非泛型函数</span>\n    <span class="token function">reg_fn</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 具体的类型</span>\n    <span class="token function">gen_spec_t</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 隐式地指定类型参数  `A`.</span>\n    <span class="token function">gen_spec_i32</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 隐式地指定类型参数`i32`.</span>\n\n    <span class="token comment">// 显式地指定类型参数 `char`</span>\n    generic<span class="token punctuation">::</span><span class="token operator">&lt;</span>char<span class="token operator">></span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 隐式地指定类型参数 `char`.</span>\n    <span class="token function">generic</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-129"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-129" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57959951948824396000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nstruct A;          // 具体的类型 \\`A\\`.\nstruct S(A);       // 具体的类型 \\`S\\`.\nstruct SGen<T>(T); // 泛型 \\`SGen\\`.\n\nfn reg_fn(_s: S) {}\n\nfn gen_spec_t(_s: SGen<A>) {}\n\nfn gen_spec_i32(_s: SGen<i32>) {}\n\nfn generic<T>(_s: SGen<T>) {}\n\nfn main() {\n    // 使用非泛型函数\n    reg_fn(S(A));          // 具体的类型\n    gen_spec_t(SGen(A));   // 隐式地指定类型参数  \\`A\\`.\n    gen_spec_i32(SGen(1)); // 隐式地指定类型参数\\`i32\\`.\n\n    // 显式地指定类型参数 \\`char\\`\n    generic::<char>(SGen(\'1\'));\n\n    // 隐式地指定类型参数 \\`char\\`.\n    generic(SGen(\'1\'));\n}`, `57959951948824396000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">struct</span> A<span class="token punctuation">;</span>          <span class="token comment">// 具体的类型 `A`.</span>\n<span class="token keyword">struct</span> <span class="token function">S</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 具体的类型 `S`.</span>\n<span class="token keyword">struct</span> SGen<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 泛型 `SGen`.</span>\n\n<span class="token keyword">fn</span> <span class="token function">reg_fn</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> S<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">gen_spec_t</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>A<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">gen_spec_i32</span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> generic<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>_s<span class="token punctuation">:</span> SGen<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用非泛型函数</span>\n    <span class="token function">reg_fn</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 具体的类型</span>\n    <span class="token function">gen_spec_t</span><span class="token punctuation">(</span><span class="token function">SGen</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 隐式地指定类型参数  `A`.</span>\n    <span class="token function">gen_spec_i32</span><span class="token punctuation">(</span><span class="token function">SGen</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 隐式地指定类型参数`i32`.</span>\n\n    <span class="token comment">// 显式地指定类型参数 `char`</span>\n    generic<span class="token punctuation">::</span><span class="token operator">&lt;</span>char<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">SGen</span><span class="token punctuation">(</span><span class="token char string">\'1\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 隐式地指定类型参数 `char`.</span>\n    <span class="token function">generic</span><span class="token punctuation">(</span><span class="token function">SGen</span><span class="token punctuation">(</span><span class="token char string">\'1\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-17"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78740270166296670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现下面的泛型函数 sum\nfn sum\n\nfn main() {\n    assert_eq!(5, sum(2i8, 3i8));\n    assert_eq!(50, sum(20, 30));\n    assert_eq!(2.46, sum(1.23, 1.23));\n}`, `78740270166296670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现下面的泛型函数 sum</span>\n<span class="token keyword">fn</span> sum\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">2i8</span><span class="token punctuation">,</span> <span class="token number">3i8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">2.46</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1.23</span><span class="token punctuation">,</span> <span class="token number">1.23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-130"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-130" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64228632115814130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现下面的泛型函数 sum\nfn sum<T: std::ops::Add<Output = T>>(a: T, b: T) -> T {\n    a + b\n}\n\nfn main() {\n    assert_eq!(5, sum(2i8, 3i8));\n    assert_eq!(50, sum(20, 30));\n    assert_eq!(2.46, sum(1.23, 1.23));\n}`, `64228632115814130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现下面的泛型函数 sum</span>\n<span class="token keyword">fn</span> sum<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Add<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> T<span class="token punctuation">,</span> b<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> T <span class="token punctuation">{</span>\n    a <span class="token operator">+</span> b\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">2i8</span><span class="token punctuation">,</span> <span class="token number">3i8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">2.46</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1.23</span><span class="token punctuation">,</span> <span class="token number">1.23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-17"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86962711663959750000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现一个结构体 Point 让代码工作\n\nfn main() {\n    let integer = Point { x: 5, y: 10 };\n    let float = Point { x: 1.0, y: 4.0 };\n}`, `86962711663959750000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现一个结构体 Point 让代码工作</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> integer <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> float <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">4.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-131"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-131" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7897364072249635000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现一个结构体 Point 让代码工作\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\nfn main() {\n    let integer = Point { x: 5, y: 10 };\n    let float = Point { x: 1.0, y: 4.0 };\n}`, `7897364072249635000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现一个结构体 Point 让代码工作</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> integer <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> float <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">4.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-16"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13704257525111175000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改以下结构体让代码工作\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\nfn main() {\n    // 不要修改这行代码！\n    let p = Point{x: 5, y : &quot;hello&quot;.to_string()};\n}`, `13704257525111175000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改以下结构体让代码工作</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 不要修改这行代码！</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point<span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-132"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-132" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71320898304477920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改以下结构体让代码工作\nstruct Point<T, U> {\n    x: T,\n    y: U,\n}\n\nfn main() {\n    // 不要修改这行代码！\n    let p = Point{x: 5, y : &quot;hello&quot;.to_string()};\n}`, `71320898304477920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改以下结构体让代码工作</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> U<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 不要修改这行代码！</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point<span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-16"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44769827562707240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 为 Val 增加泛型参数，不要修改 \\`main\\` 中的代码\nstruct Val {\n    val: f64,\n}\n\nimpl Val {\n    fn value(&self) -> &f64 {\n        &self.val\n    }\n}\n\nfn main() {\n    let x = Val{ val: 3.0 };\n    let y = Val{ val: &quot;hello&quot;.to_string()};\n    println!(&quot;{}, {}&quot;, x.value(), y.value());\n}`, `44769827562707240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 为 Val 增加泛型参数，不要修改 `main` 中的代码</span>\n<span class="token keyword">struct</span> Val <span class="token punctuation">{</span>\n    val<span class="token punctuation">:</span> f64<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Val <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>f64 <span class="token punctuation">{</span>\n        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>val\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> Val<span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">3.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> Val<span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-133"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-133" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57375917016559330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 为 Val 增加泛型参数，不要修改 \\`main\\` 中的代码\nstruct Val<T> {\n    val: T,\n}\n\nimpl<T> Val<T> {\n    fn value(&self) -> &T {\n        &self.val\n    }\n}\n\nfn main() {\n    let x = Val { val: 3.0 };\n    let y = Val {\n        val: &quot;hello&quot;.to_string(),\n    };\n    println!(&quot;{}, {}&quot;, x.value(), y.value());\n}`, `57375917016559330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 为 Val 增加泛型参数，不要修改 `main` 中的代码</span>\n<span class="token keyword">struct</span> Val<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    val<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">></span> Val<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>T <span class="token punctuation">{</span>\n        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>val\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> Val <span class="token punctuation">{</span> val<span class="token punctuation">:</span> <span class="token number">3.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> Val <span class="token punctuation">{</span>\n        val<span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-15"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9137369900281068000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Point<T, U> {\n    x: T,\n    y: U,\n}\n\nimpl<T, U> Point<T, U> {\n    // 实现 mixup，不要修改其它代码！\n    fn mixup\n}\n\nfn main() {\n    let p1 = Point { x: 5, y: 10 };\n    let p2 = Point { x: &quot;Hello&quot;, y: \'中\'};\n\n    let p3 = p1.mixup(p2);\n\n    assert_eq!(p3.x, 5);\n    assert_eq!(p3.y, \'中\');\n}`, `9137369900281068000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> U<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现 mixup，不要修改其它代码！</span>\n    <span class="token keyword">fn</span> mixup\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> p1 <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> p2 <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token char string">\'中\'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> p3 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">mixup</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token char string">\'中\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-134"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-134" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60634375366665675000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Point<T, U> {\n    x: T,\n    y: U,\n}\n\nimpl<T, U> Point<T, U> {\n    // 实现 mixup，不要修改其它代码！\n    fn mixup<V, W>(self, other: Point<V, W>) -> Point<T, W> {\n        Point {\n            x: self.x,\n            y: other.y,\n        }\n    }\n}\n\nfn main() {\n    let p1 = Point { x: 5, y: 10 };\n    let p2 = Point {\n        x: &quot;Hello&quot;,\n        y: \'中\',\n    };\n\n    let p3 = p1.mixup(p2);\n\n    assert_eq!(p3.x, 5);\n    assert_eq!(p3.y, \'中\');\n}`, `60634375366665675000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> U<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> U<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现 mixup，不要修改其它代码！</span>\n    <span class="token keyword">fn</span> mixup<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> Point<span class="token operator">&lt;</span>V<span class="token punctuation">,</span> W<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Point<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> W<span class="token operator">></span> <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span>\n            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>\n            y<span class="token punctuation">:</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> p1 <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> p2 <span class="token operator">=</span> Point <span class="token punctuation">{</span>\n        x<span class="token punctuation">:</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span>\n        y<span class="token punctuation">:</span> <span class="token char string">\'中\'</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> p3 <span class="token operator">=</span> p1<span class="token punctuation">.</span><span class="token function">mixup</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token char string">\'中\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-8"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90028817839691920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，让代码工作\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\nimpl Point<f32> {\n    fn distance_from_origin(&self) -> f32 {\n        (self.x.powi(2) + self.y.powi(2)).sqrt()\n    }\n}\n\nfn main() {\n    let p = Point{x: 5, y: 10};\n    println!(&quot;{}&quot;,p.distance_from_origin())\n}`, `90028817839691920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，让代码工作</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Point<span class="token operator">&lt;</span>f32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">distance_from_origin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> f32 <span class="token punctuation">{</span>\n        <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point<span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>p<span class="token punctuation">.</span><span class="token function">distance_from_origin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-135"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-135" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60204788297875260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，让代码工作\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\nimpl Point<f32> {\n    fn distance_from_origin(&self) -> f32 {\n        (self.x.powi(2) + self.y.powi(2)).sqrt()\n    }\n}\n\nfn main() {\n    let p = Point{x: 5.0, y: 10.0};\n    println!(&quot;{}&quot;,p.distance_from_origin())\n}`, `60204788297875260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，让代码工作</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Point<span class="token operator">&lt;</span>f32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">distance_from_origin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> f32 <span class="token punctuation">{</span>\n        <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> p <span class="token operator">=</span> Point<span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10.0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>p<span class="token punctuation">.</span><span class="token function">distance_from_origin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="const-泛型"><a href="#const-%E6%B3%9B%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Const 泛型</h2>\n<h3 id="问题一-18"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>下面的例子同时使用泛型和 const 泛型来实现一个结构体，该结构体的字段中的数组长度是可变的</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74409127908041560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct ArrayPair<T, const N: usize> {\n    left: [T; N],\n    right: [T; N],\n}\n\nimpl<T: Debug, const N: usize> Debug for ArrayPair<T, N> {\n    // ...\n}`, `74409127908041560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> ArrayPair<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span> <span class="token punctuation">{</span>\n    left<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span><span class="token punctuation">,</span>\n    right<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Debug<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span> Debug <span class="token keyword">for</span> ArrayPair<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> N<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-18"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>目前，const 泛型参数只能使用以下形式的实参:</p>\n<ul>\n<li>一个单独的 const 泛型参数</li>\n<li>一个字面量（i.e. 整数, 布尔值或字符）</li>\n<li>一个具体的 const 表达式（表达式中不能包含任何泛型参数）</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3777076606305418000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn foo<const N: usize>() {}\n\nfn bar<T, const M: usize>() {\n    foo::<M>(); // ok: 符合第一种\n    foo::<2021>(); // ok: 符合第二种\n    foo::<{20 * 100 + 20 * 10 + 1}>(); // ok: 符合第三种\n\n    foo::<{ M + 1 }>(); // error: 违背第三种，const 表达式中不能有泛型参数 M\n    foo::<{ std::mem::size_of::<T>() }>(); // error: 泛型表达式包含了泛型参数 T\n\n    let _: [u8; M]; // ok: 符合第一种\n    let _: [u8; std::mem::size_of::<T>()]; // error: 泛型表达式包含了泛型参数 T\n}\n\nfn main() {}`, `3777076606305418000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> foo<span class="token operator">&lt;</span><span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> bar<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> M<span class="token punctuation">:</span> usize<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    foo<span class="token punctuation">::</span><span class="token operator">&lt;</span>M<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok: 符合第一种</span>\n    foo<span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token number">2021</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok: 符合第二种</span>\n    foo<span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token number">20</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok: 符合第三种</span>\n\n    foo<span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> M <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error: 违背第三种，const 表达式中不能有泛型参数 M</span>\n    foo<span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error: 泛型表达式包含了泛型参数 T</span>\n\n    <span class="token keyword">let</span> _<span class="token punctuation">:</span> <span class="token punctuation">[</span>u8<span class="token punctuation">;</span> M<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ok: 符合第一种</span>\n    <span class="token keyword">let</span> _<span class="token punctuation">:</span> <span class="token punctuation">[</span>u8<span class="token punctuation">;</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// error: 泛型表达式包含了泛型参数 T</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-18"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>const 泛型还能帮我们避免一些运行时检查，提升性能</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19057822686123350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pub struct MinSlice<T, const N: usize> {\n    pub head: [T; N],\n    pub tail: [T],\n}\n\nfn main() {\n    let slice: &[u8] = b&quot;Hello, world&quot;;\n    let reference: Option<&u8> = slice.get(6);\n    // 我们知道 \\`.get\\` 返回的是 \\`Some(b\' \')\\`\n    // 但编译器不知道\n    assert!(reference.is_some());\n\n    let slice: &[u8] = b&quot;Hello, world&quot;;\n\n    // 当编译构建 MinSlice 时会进行长度检查，也就是在编译期我们就知道它的长度是 12\n    // 在运行期，一旦 \\`unwrap\\` 成功，在 \\`MinSlice\\` 的作用域内，就再无需任何检查\n    let minslice = MinSlice::<u8, 12>::from_slice(slice).unwrap();\n    let value: u8 = minslice.head[6];\n    assert_eq!(value, b\' \')\n}`, `19057822686123350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">struct</span> MinSlice<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> head<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token keyword">pub</span> tail<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> slice<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>u8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">b"Hello, world"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> reference<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span>u8<span class="token operator">></span> <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 我们知道 `.get` 返回的是 `Some(b\' \')`</span>\n    <span class="token comment">// 但编译器不知道</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>reference<span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>u8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">b"Hello, world"</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 当编译构建 MinSlice 时会进行长度检查，也就是在编译期我们就知道它的长度是 12</span>\n    <span class="token comment">// 在运行期，一旦 `unwrap` 成功，在 `MinSlice` 的作用域内，就再无需任何检查</span>\n    <span class="token keyword">let</span> minslice <span class="token operator">=</span> MinSlice<span class="token punctuation">::</span><span class="token operator">&lt;</span>u8<span class="token punctuation">,</span> <span class="token number">12</span><span class="token operator">></span><span class="token punctuation">::</span><span class="token function">from_slice</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> value<span class="token punctuation">:</span> u8 <span class="token operator">=</span> minslice<span class="token punctuation">.</span>head<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token char string">b\' \'</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-17"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p><code class="language-text">&lt;T, const N: usize&gt;</code> 是结构体类型的一部分，和数组类型一样，这意味着长度不同会导致类型不同： <code class="language-text">Array&lt;i32, 3&gt;</code> 和 <code class="language-text">Array&lt;i32, 4&gt;</code> 是不同的类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92521973933824020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nstruct Array<T, const N: usize> {\n    data : [T; N]\n}\n\nfn main() {\n    let arrays = [\n        Array{\n            data: [1, 2, 3],\n        },\n        Array {\n            data: [1.0, 2.0, 3.0],\n        },\n        Array {\n            data: [1, 2]\n        }\n    ];\n}`, `92521973933824020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">struct</span> Array<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span> <span class="token punctuation">{</span>\n    data <span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arrays <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Array<span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Array <span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Array <span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-136"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-136" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7237074027969315000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nstruct Array<T, const N: usize> {\n    data : [T; N]\n}\n\nfn main() {\n    let arrays = [\n        Array{\n            data: [1, 2, 3],\n        },\n        Array {\n            data: [1, 2, 3],\n        },\n        Array {\n            data: [1, 2, 3]\n        }\n    ];\n}`, `7237074027969315000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">struct</span> Array<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span> <span class="token punctuation">{</span>\n    data <span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arrays <span class="token operator">=</span> <span class="token punctuation">[</span>\n        Array<span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Array <span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Array <span class="token punctuation">{</span>\n            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-17"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65758556113857700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn print_array<__>(__) {\n    println!(&quot;{:?}&quot;, arr);\n}\nfn main() {\n    let arr = [1, 2, 3];\n    print_array(arr);\n\n    let arr = [&quot;hello&quot;, &quot;world&quot;];\n    print_array(arr);\n}`, `65758556113857700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> print_array<span class="token operator">&lt;</span>__<span class="token operator">></span><span class="token punctuation">(</span>__<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">print_array</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">print_array</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-137"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-137" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6243795249090178000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn print_array<T: std::fmt::Debug, const N: usize>(arr: [T; N]) {\n    println!(&quot;{:?}&quot;, arr);\n}\n\nfn main() {\n    let arr = [1, 2, 3];\n    print_array(arr);\n\n    let arr = [&quot;hello&quot;, &quot;world&quot;];\n    print_array(arr);\n}`, `6243795249090178000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> print_array<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug<span class="token punctuation">,</span> <span class="token keyword">const</span> N<span class="token punctuation">:</span> usize<span class="token operator">></span><span class="token punctuation">(</span>arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>T<span class="token punctuation">;</span> N<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">print_array</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">print_array</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-16"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>有时我们希望能限制一个变量占用内存的大小，例如在嵌入式环境中，此时 const 泛型参数的第三种形式 const 表达式 就非常适合</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11393054366357447000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(incomplete_features)]\n#![feature(generic_const_exprs)]\n\nfn check_size<T>(val: T)\nwhere\n    Assert<{ core::mem::size_of::<T>() < 768 }>: IsTrue,\n{\n    //...\n}\n\n// 修复 main 函数中的错误\nfn main() {\n    check_size([0u8; 767]);\n    check_size([0i32; 191]);\n    check_size([&quot;hello你好&quot;; __]); // size of &str ?\n    check_size([(); __].map(|_| &quot;hello你好&quot;.to_string()));  // size of String?\n    check_size([\'中\'; __]); // size of char ?\n}\n\n\n\npub enum Assert<const CHECK: bool> {}\n\npub trait IsTrue {}\n\nimpl IsTrue for Assert<true> {}`, `11393054366357447000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(incomplete_features)]</span>\n<span class="token attribute attr-name">#![feature(generic_const_exprs)]</span>\n\n<span class="token keyword">fn</span> check_size<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>val<span class="token punctuation">:</span> T<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n    Assert<span class="token operator">&lt;</span><span class="token punctuation">{</span> core<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">768</span> <span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">:</span> IsTrue<span class="token punctuation">,</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//...</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 修复 main 函数中的错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">767</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0i32</span><span class="token punctuation">;</span> <span class="token number">191</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"hello你好"</span><span class="token punctuation">;</span> __<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// size of &amp;str ?</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> __<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>_<span class="token operator">|</span> <span class="token string">"hello你好"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// size of String?</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token char string">\'中\'</span><span class="token punctuation">;</span> __<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// size of char ?</span>\n<span class="token punctuation">}</span>\n\n\n\n<span class="token keyword">pub</span> <span class="token keyword">enum</span> Assert<span class="token operator">&lt;</span><span class="token keyword">const</span> CHECK<span class="token punctuation">:</span> bool<span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">trait</span> IsTrue <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> IsTrue <span class="token keyword">for</span> Assert<span class="token operator">&lt;</span><span class="token keyword">true</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-138"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-138" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24412772848167653000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(incomplete_features)]\n#![feature(generic_const_exprs)]\n\nfn check_size<T>(val: T)\nwhere\n    Assert<{ core::mem::size_of::<T>() < 768 }>: IsTrue,\n{\n    //...\n}\n\n// 修复 main 函数中的错误\nfn main() {\n    check_size([0u8; 767]); // 1 * 768 = 768\n    check_size([0i32; 191]); // 4 * 192 = 768\n    check_size([&quot;hello你好&quot;; 47]); // 16 * 48 = 768，&str is a string reference, containing a pointer and string length in it, so it takes two word long, in x86-64, 1 word = 8 bytes\n    check_size([(); 31].map(|_| &quot;hello你好&quot;.to_string())); // 24 * 32 = 768，String is a smart pointer struct, it has three fields: pointer, length and capacity, each takes 8 bytes\n    check_size([\'中\'; 191]); // 192 * 4 = 768\n}\n\npub enum Assert<const CHECK: bool> {}\n\npub trait IsTrue {}\n\nimpl IsTrue for Assert<true> {}`, `24412772848167653000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(incomplete_features)]</span>\n<span class="token attribute attr-name">#![feature(generic_const_exprs)]</span>\n\n<span class="token keyword">fn</span> check_size<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>val<span class="token punctuation">:</span> T<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n    Assert<span class="token operator">&lt;</span><span class="token punctuation">{</span> core<span class="token punctuation">::</span>mem<span class="token punctuation">::</span>size_of<span class="token punctuation">::</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">768</span> <span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">:</span> IsTrue<span class="token punctuation">,</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//...</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 修复 main 函数中的错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0u8</span><span class="token punctuation">;</span> <span class="token number">767</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 * 768 = 768</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0i32</span><span class="token punctuation">;</span> <span class="token number">191</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4 * 192 = 768</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"hello你好"</span><span class="token punctuation">;</span> <span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 16 * 48 = 768，&amp;str is a string reference, containing a pointer and string length in it, so it takes two word long, in x86-64, 1 word = 8 bytes</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>_<span class="token operator">|</span> <span class="token string">"hello你好"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 24 * 32 = 768，String is a smart pointer struct, it has three fields: pointer, length and capacity, each takes 8 bytes</span>\n    <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token char string">\'中\'</span><span class="token punctuation">;</span> <span class="token number">191</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 192 * 4 = 768</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">enum</span> Assert<span class="token operator">&lt;</span><span class="token keyword">const</span> CHECK<span class="token punctuation">:</span> bool<span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">trait</span> IsTrue <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> IsTrue <span class="token keyword">for</span> Assert<span class="token operator">&lt;</span><span class="token keyword">true</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="特征"><a href="#%E7%89%B9%E5%BE%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>特征</h2>\n<p>特征 Trait 可以告诉编译器一个特定的类型所具有的、且能跟其它类型共享的特性。我们可以使用特征通过抽象的方式来定义这种共享行为，还可以使用特征约束来限定一个泛型类型必须要具有某个特定的行为。</p>\n<blockquote>\n<p>特征跟其它语言的接口较为类似，但是仍然有一些区别</p>\n</blockquote>\n<h3 id="问题一-19"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65995043200554400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Sheep { naked: bool, name: String }\n\nimpl Sheep {\n    fn is_naked(&self) -> bool {\n        self.naked\n    }\n\n    fn shear(&mut self) {\n        if self.is_naked() {\n            // Sheep 结构体上定义的方法可以调用 Sheep 所实现的特征的方法\n            println!(&quot;{} is already naked...&quot;, self.name());\n        } else {\n            println!(&quot;{} gets a haircut!&quot;, self.name);\n\n            self.naked = true;\n        }\n    }\n}\n\ntrait Animal {\n    // 关联函数签名；Self 指代实现者的类型\n    // 例如我们在为 Pig 类型实现特征时，那 new 函数就会返回一个 Pig 类型的实例，这里的 Self 指代的就是 Pig 类型\n    fn new(name: String) -> Self;\n\n    // 方法签名\n    fn name(&self) -> String;\n\n    fn noise(&self) -> String;\n\n    // 方法还能提供默认的定义实现\n    fn talk(&self) {\n        println!(&quot;{} says {}&quot;, self.name(), self.noise());\n    }\n}\n\nimpl Animal for Sheep {\n    // Self 被替换成具体的实现者类型：Sheep\n    fn new(name: String) -> Sheep {\n        Sheep { name: name, naked: false }\n    }\n\n    fn name(&self) -> String {\n        self.name.clone()\n    }\n\n    fn noise(&self) -> String {\n        if self.is_naked() {\n            &quot;baaaaah?&quot;.to_string()\n        } else {\n            &quot;baaaaah!&quot;.to_string()\n        }\n    }\n\n    // 默认的特征方法可以被重写\n    fn talk(&self) {\n        println!(&quot;{} pauses briefly... {}&quot;, self.name, self.noise());\n    }\n}\n\nfn main() {\n    // 这里的类型注释时必须的\n    let mut dolly: Sheep = Animal::new(&quot;Dolly&quot;.to_string());\n    // 尝试去除类型注释，看看会发生什么\n\n    dolly.talk();\n    dolly.shear();\n    dolly.talk();\n}`, `65995043200554400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Sheep <span class="token punctuation">{</span> naked<span class="token punctuation">:</span> bool<span class="token punctuation">,</span> name<span class="token punctuation">:</span> String <span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Sheep <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">is_naked</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> bool <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>naked\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">shear</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">is_naked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// Sheep 结构体上定义的方法可以调用 Sheep 所实现的特征的方法</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} is already naked..."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} gets a haircut!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n            <span class="token keyword">self</span><span class="token punctuation">.</span>naked <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Animal <span class="token punctuation">{</span>\n    <span class="token comment">// 关联函数签名；Self 指代实现者的类型</span>\n    <span class="token comment">// 例如我们在为 Pig 类型实现特征时，那 new 函数就会返回一个 Pig 类型的实例，这里的 Self 指代的就是 Pig 类型</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 方法签名</span>\n    <span class="token keyword">fn</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n\n    <span class="token comment">// 方法还能提供默认的定义实现</span>\n    <span class="token keyword">fn</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} says {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Animal <span class="token keyword">for</span> Sheep <span class="token punctuation">{</span>\n    <span class="token comment">// Self 被替换成具体的实现者类型：Sheep</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">-></span> Sheep <span class="token punctuation">{</span>\n        Sheep <span class="token punctuation">{</span> name<span class="token punctuation">:</span> name<span class="token punctuation">,</span> naked<span class="token punctuation">:</span> <span class="token keyword">false</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">is_naked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token string">"baaaaah?"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token string">"baaaaah!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 默认的特征方法可以被重写</span>\n    <span class="token keyword">fn</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} pauses briefly... {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 这里的类型注释时必须的</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> dolly<span class="token punctuation">:</span> Sheep <span class="token operator">=</span> Animal<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Dolly"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 尝试去除类型注释，看看会发生什么</span>\n\n    dolly<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    dolly<span class="token punctuation">.</span><span class="token function">shear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    dolly<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-19"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81654324132780820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 完成两个 \\`impl\\` 语句块\n// 不要修改 \\`main\\` 中的代码\ntrait Hello {\n    fn say_hi(&self) -> String {\n        String::from(&quot;hi&quot;)\n    }\n\n    fn say_something(&self) -> String;\n}\n\nstruct Student {}\nimpl Hello for Student {\n}\nstruct Teacher {}\nimpl Hello for Teacher {\n}\n\nfn main() {\n    let s = Student {};\n    assert_eq!(s.say_hi(), &quot;hi&quot;);\n    assert_eq!(s.say_something(), &quot;I\'m a good student&quot;);\n\n    let t = Teacher {};\n    assert_eq!(t.say_hi(), &quot;Hi, I\'m your new teacher&quot;);\n    assert_eq!(t.say_something(), &quot;I\'m not a bad teacher&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `81654324132780820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 完成两个 `impl` 语句块</span>\n<span class="token comment">// 不要修改 `main` 中的代码</span>\n<span class="token keyword">trait</span> Hello <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">say_something</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Student <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">impl</span> Hello <span class="token keyword">for</span> Student <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Teacher <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">impl</span> Hello <span class="token keyword">for</span> Teacher <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> Student <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">say_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"I\'m a good student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> t <span class="token operator">=</span> Teacher <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hi, I\'m your new teacher"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">say_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"I\'m not a bad teacher"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-139"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-139" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96618709676710670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 完成两个 \\`impl\\` 语句块\n// 不要修改 \\`main\\` 中的代码\ntrait Hello {\n    fn say_hi(&self) -> String {\n        String::from(&quot;hi&quot;)\n    }\n\n    fn say_something(&self) -> String;\n}\n\nstruct Student {}\nimpl Hello for Student {\n    fn say_something(&self) -> String {\n        String::from(&quot;I\'m a good student&quot;)\n    }\n}\nstruct Teacher {}\nimpl Hello for Teacher {\n    fn say_hi(&self) -> String {\n        String::from(&quot;Hi, I\'m your new teacher&quot;)\n    }\n\n    fn say_something(&self) -> String {\n        String::from(&quot;I\'m not a bad teacher&quot;)\n    }\n}\n\nfn main() {\n    let s = Student {};\n    assert_eq!(s.say_hi(), &quot;hi&quot;);\n    assert_eq!(s.say_something(), &quot;I\'m a good student&quot;);\n\n    let t = Teacher {};\n    assert_eq!(t.say_hi(), &quot;Hi, I\'m your new teacher&quot;);\n    assert_eq!(t.say_something(), &quot;I\'m not a bad teacher&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `96618709676710670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 完成两个 `impl` 语句块</span>\n<span class="token comment">// 不要修改 `main` 中的代码</span>\n<span class="token keyword">trait</span> Hello <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">say_something</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Student <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">impl</span> Hello <span class="token keyword">for</span> Student <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">say_something</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I\'m a good student"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Teacher <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">impl</span> Hello <span class="token keyword">for</span> Teacher <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Hi, I\'m your new teacher"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">say_something</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I\'m not a bad teacher"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> Student <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">say_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"I\'m a good student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> t <span class="token operator">=</span> Teacher <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">say_hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hi, I\'m your new teacher"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">say_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"I\'m not a bad teacher"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-19"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>我们可以使用 <code class="language-text">#[derive]</code> 属性来派生一些特征，对于这些特征编译器会自动进行默认实现，对于日常代码开发而言，这是非常方便的，例如大家经常用到的 Debug 特征，就是直接通过派生来获取默认实现，而无需我们手动去完成这个工作</p>\n<p>想要查看更多信息，可以访问<a href="https://course.rs/appendix/derive.html" target="_blank" rel="nofollow noreferrer noopener">这里</a></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68282071150852230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// \\`Centimeters\\`, 一个元组结构体，可以被比较大小\n#[derive(PartialEq, PartialOrd)]\nstruct Centimeters(f64);\n\n// \\`Inches\\`, 一个元组结构体可以被打印\n#[derive(Debug)]\nstruct Inches(i32);\n\nimpl Inches {\n    fn to_centimeters(&self) -> Centimeters {\n        let &Inches(inches) = self;\n\n        Centimeters(inches as f64 * 2.54)\n    }\n}\n\n// 添加一些属性让代码工作\n// 不要修改其它代码！\nstruct Seconds(i32);\n\nfn main() {\n    let _one_second = Seconds(1);\n\n    println!(&quot;One second looks like: {:?}&quot;, _one_second);\n    let _this_is_true = _one_second == _one_second;\n    let _this_is_true = _one_second > _one_second;\n\n    let foot = Inches(12);\n\n    println!(&quot;One foot equals {:?}&quot;, foot);\n\n    let meter = Centimeters(100.0);\n\n    let cmp =\n        if foot.to_centimeters() < meter {\n            &quot;smaller&quot;\n        } else {\n            &quot;bigger&quot;\n        };\n\n    println!(&quot;One foot is {} than one meter.&quot;, cmp);\n}`, `68282071150852230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// `Centimeters`, 一个元组结构体，可以被比较大小</span>\n<span class="token attribute attr-name">#[derive(PartialEq, PartialOrd)]</span>\n<span class="token keyword">struct</span> <span class="token function">Centimeters</span><span class="token punctuation">(</span>f64<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// `Inches`, 一个元组结构体可以被打印</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> <span class="token function">Inches</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Inches <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">to_centimeters</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Centimeters <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token operator">&amp;</span><span class="token function">Inches</span><span class="token punctuation">(</span>inches<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>\n\n        <span class="token function">Centimeters</span><span class="token punctuation">(</span>inches <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">2.54</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 添加一些属性让代码工作</span>\n<span class="token comment">// 不要修改其它代码！</span>\n<span class="token keyword">struct</span> <span class="token function">Seconds</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _one_second <span class="token operator">=</span> <span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One second looks like: {:?}"</span><span class="token punctuation">,</span> _one_second<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _this_is_true <span class="token operator">=</span> _one_second <span class="token operator">==</span> _one_second<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _this_is_true <span class="token operator">=</span> _one_second <span class="token operator">></span> _one_second<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> foot <span class="token operator">=</span> <span class="token function">Inches</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One foot equals {:?}"</span><span class="token punctuation">,</span> foot<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> meter <span class="token operator">=</span> <span class="token function">Centimeters</span><span class="token punctuation">(</span><span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> cmp <span class="token operator">=</span>\n        <span class="token keyword">if</span> foot<span class="token punctuation">.</span><span class="token function">to_centimeters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> meter <span class="token punctuation">{</span>\n            <span class="token string">"smaller"</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token string">"bigger"</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One foot is {} than one meter."</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-140"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-140" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59613390274205870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// \\`Centimeters\\`, 一个元组结构体，可以被比较大小\n#[derive(PartialEq, PartialOrd)]\nstruct Centimeters(f64);\n\n// \\`Inches\\`, 一个元组结构体可以被打印\n#[derive(Debug)]\nstruct Inches(i32);\n\nimpl Inches {\n    fn to_centimeters(&self) -> Centimeters {\n        let &Inches(inches) = self;\n\n        Centimeters(inches as f64 * 2.54)\n    }\n}\n\n// 添加一些属性让代码工作\n// 不要修改其它代码！\n#[derive(PartialEq, PartialOrd, Debug)]\nstruct Seconds(i32);\n\nfn main() {\n    let _one_second = Seconds(1);\n\n    println!(&quot;One second looks like: {:?}&quot;, _one_second);\n    let _this_is_true = _one_second == _one_second;\n    let _this_is_true = _one_second > _one_second;\n\n    let foot = Inches(12);\n\n    println!(&quot;One foot equals {:?}&quot;, foot);\n\n    let meter = Centimeters(100.0);\n\n    let cmp = if foot.to_centimeters() < meter {\n        &quot;smaller&quot;\n    } else {\n        &quot;bigger&quot;\n    };\n\n    println!(&quot;One foot is {} than one meter.&quot;, cmp);\n}`, `59613390274205870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// `Centimeters`, 一个元组结构体，可以被比较大小</span>\n<span class="token attribute attr-name">#[derive(PartialEq, PartialOrd)]</span>\n<span class="token keyword">struct</span> <span class="token function">Centimeters</span><span class="token punctuation">(</span>f64<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// `Inches`, 一个元组结构体可以被打印</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> <span class="token function">Inches</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Inches <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">to_centimeters</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Centimeters <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token operator">&amp;</span><span class="token function">Inches</span><span class="token punctuation">(</span>inches<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>\n\n        <span class="token function">Centimeters</span><span class="token punctuation">(</span>inches <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">2.54</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 添加一些属性让代码工作</span>\n<span class="token comment">// 不要修改其它代码！</span>\n<span class="token attribute attr-name">#[derive(PartialEq, PartialOrd, Debug)]</span>\n<span class="token keyword">struct</span> <span class="token function">Seconds</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _one_second <span class="token operator">=</span> <span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One second looks like: {:?}"</span><span class="token punctuation">,</span> _one_second<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _this_is_true <span class="token operator">=</span> _one_second <span class="token operator">==</span> _one_second<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _this_is_true <span class="token operator">=</span> _one_second <span class="token operator">></span> _one_second<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> foot <span class="token operator">=</span> <span class="token function">Inches</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One foot equals {:?}"</span><span class="token punctuation">,</span> foot<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> meter <span class="token operator">=</span> <span class="token function">Centimeters</span><span class="token punctuation">(</span><span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> cmp <span class="token operator">=</span> <span class="token keyword">if</span> foot<span class="token punctuation">.</span><span class="token function">to_centimeters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> meter <span class="token punctuation">{</span>\n        <span class="token string">"smaller"</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token string">"bigger"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"One foot is {} than one meter."</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-18"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>在 Rust 中，许多运算符都可以被重载，事实上，运算符仅仅是特征方法调用的语法糖。例如 a + b 中的 + 是 std::ops::Add 特征的 add 方法调用，因此我们可以为自定义类型实现该特征来支持该类型的加法运算。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59428957715026210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops;\n\n// 实现 fn multiply 方法\n// 如上所述，\\`+\\` 需要 \\`T\\` 类型实现 \\`std::ops::Add\\` 特征\n// 那么, \\`*\\` 运算符需要实现什么特征呢? 你可以在这里找到答案: https://doc.rust-lang.org/core/ops/\nfn multiply\n\nfn main() {\n    assert_eq!(6, multiply(2u8, 3u8));\n    assert_eq!(5.0, multiply(1.0, 5.0));\n\n    println!(&quot;Success!&quot;)\n}`, `59428957715026210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">;</span>\n\n<span class="token comment">// 实现 fn multiply 方法</span>\n<span class="token comment">// 如上所述，`+` 需要 `T` 类型实现 `std::ops::Add` 特征</span>\n<span class="token comment">// 那么, `*` 运算符需要实现什么特征呢? 你可以在这里找到答案: https://doc.rust-lang.org/core/ops/</span>\n<span class="token keyword">fn</span> multiply\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">2u8</span><span class="token punctuation">,</span> <span class="token number">3u8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-141"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-141" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83387486150897990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops;\n\n// 实现 fn multiply 方法\n// 如上所述，\\`+\\` 需要 \\`T\\` 类型实现 \\`std::ops::Add\\` 特征\n// 那么, \\`*\\` 运算符需要实现什么特征呢? 你可以在这里找到答案: https://doc.rust-lang.org/core/ops/\nfn multiply<T: ops::Mul<Output = T>>(a: T, b: T) -> T {\n    a * b\n}\n\nfn main() {\n    assert_eq!(6, multiply(2u8, 3u8));\n    assert_eq!(5.0, multiply(1.0, 5.0));\n\n    println!(&quot;Success!&quot;)\n}`, `83387486150897990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">;</span>\n\n<span class="token comment">// 实现 fn multiply 方法</span>\n<span class="token comment">// 如上所述，`+` 需要 `T` 类型实现 `std::ops::Add` 特征</span>\n<span class="token comment">// 那么, `*` 运算符需要实现什么特征呢? 你可以在这里找到答案: https://doc.rust-lang.org/core/ops/</span>\n<span class="token keyword">fn</span> multiply<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> ops<span class="token punctuation">::</span>Mul<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> T<span class="token punctuation">,</span> b<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> T <span class="token punctuation">{</span>\n    a <span class="token operator">*</span> b\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">2u8</span><span class="token punctuation">,</span> <span class="token number">3u8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-18"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35024453211089555000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要修改 \\`main\\` 中的代码!\nuse std::ops;\n\nstruct Foo;\nstruct Bar;\n\nstruct FooBar;\n\nstruct BarFoo;\n\n// 下面的代码实现了自定义类型的相加： Foo + Bar = FooBar\nimpl ops::Add<Bar> for Foo {\n    type Output = FooBar;\n\n    fn add(self, _rhs: Bar) -> FooBar {\n        FooBar\n    }\n}\n\nimpl ops::Sub<Foo> for Bar {\n    type Output = BarFoo;\n\n    fn sub(self, _rhs: Foo) -> BarFoo {\n        BarFoo\n    }\n}\n\nfn main() {\n    // 不要修改下面代码\n    // 你需要为 FooBar 派生一些特征来让代码工作\n    assert_eq!(Foo + Bar, FooBar);\n    assert_eq!(Foo - Bar, BarFoo);\n\n    println!(&quot;Success!&quot;)\n}`, `35024453211089555000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要修改 `main` 中的代码!</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">;</span>\n\n<span class="token keyword">struct</span> Foo<span class="token punctuation">;</span>\n<span class="token keyword">struct</span> Bar<span class="token punctuation">;</span>\n\n<span class="token keyword">struct</span> FooBar<span class="token punctuation">;</span>\n\n<span class="token keyword">struct</span> BarFoo<span class="token punctuation">;</span>\n\n<span class="token comment">// 下面的代码实现了自定义类型的相加： Foo + Bar = FooBar</span>\n<span class="token keyword">impl</span> ops<span class="token punctuation">::</span>Add<span class="token operator">&lt;</span>Bar<span class="token operator">></span> <span class="token keyword">for</span> Foo <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> FooBar<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> _rhs<span class="token punctuation">:</span> Bar<span class="token punctuation">)</span> <span class="token punctuation">-></span> FooBar <span class="token punctuation">{</span>\n        FooBar\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> ops<span class="token punctuation">::</span>Sub<span class="token operator">&lt;</span>Foo<span class="token operator">></span> <span class="token keyword">for</span> Bar <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> BarFoo<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> _rhs<span class="token punctuation">:</span> Foo<span class="token punctuation">)</span> <span class="token punctuation">-></span> BarFoo <span class="token punctuation">{</span>\n        BarFoo\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 不要修改下面代码</span>\n    <span class="token comment">// 你需要为 FooBar 派生一些特征来让代码工作</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Foo <span class="token operator">+</span> Bar<span class="token punctuation">,</span> FooBar<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Foo <span class="token operator">-</span> Bar<span class="token punctuation">,</span> BarFoo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-142"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-142" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16962621109244203000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，不要修改 \\`main\\` 中的代码!\nuse std::ops;\n\nstruct Foo;\nstruct Bar;\n\n#[derive(PartialEq, Debug)]\nstruct FooBar;\n\n#[derive(PartialEq, Debug)]\nstruct BarFoo;\n\n// 下面的代码实现了自定义类型的相加： Foo + Bar = FooBar\nimpl ops::Add<Bar> for Foo {\n    type Output = FooBar;\n\n    fn add(self, _rhs: Bar) -> FooBar {\n        FooBar\n    }\n}\n\nimpl ops::Sub<Bar> for Foo {\n    type Output = BarFoo;\n\n    fn sub(self, _rhs: Bar) -> BarFoo {\n        BarFoo\n    }\n}\n\nfn main() {\n    // 不要修改下面代码\n    // 你需要为 FooBar 派生一些特征来让代码工作\n    assert_eq!(Foo + Bar, FooBar);\n    assert_eq!(Foo - Bar, BarFoo);\n\n    println!(&quot;Success!&quot;)\n}`, `16962621109244203000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，不要修改 `main` 中的代码!</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">;</span>\n\n<span class="token keyword">struct</span> Foo<span class="token punctuation">;</span>\n<span class="token keyword">struct</span> Bar<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(PartialEq, Debug)]</span>\n<span class="token keyword">struct</span> FooBar<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(PartialEq, Debug)]</span>\n<span class="token keyword">struct</span> BarFoo<span class="token punctuation">;</span>\n\n<span class="token comment">// 下面的代码实现了自定义类型的相加： Foo + Bar = FooBar</span>\n<span class="token keyword">impl</span> ops<span class="token punctuation">::</span>Add<span class="token operator">&lt;</span>Bar<span class="token operator">></span> <span class="token keyword">for</span> Foo <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> FooBar<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> _rhs<span class="token punctuation">:</span> Bar<span class="token punctuation">)</span> <span class="token punctuation">-></span> FooBar <span class="token punctuation">{</span>\n        FooBar\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> ops<span class="token punctuation">::</span>Sub<span class="token operator">&lt;</span>Bar<span class="token operator">></span> <span class="token keyword">for</span> Foo <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> BarFoo<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> _rhs<span class="token punctuation">:</span> Bar<span class="token punctuation">)</span> <span class="token punctuation">-></span> BarFoo <span class="token punctuation">{</span>\n        BarFoo\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 不要修改下面代码</span>\n    <span class="token comment">// 你需要为 FooBar 派生一些特征来让代码工作</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Foo <span class="token operator">+</span> Bar<span class="token punctuation">,</span> FooBar<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Foo <span class="token operator">-</span> Bar<span class="token punctuation">,</span> BarFoo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-17"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>除了使用具体类型来作为函数参数，我们还能通过 impl Trait 的方式来指定实现了该特征的参数：该参数能接受的类型必须要实现指定的特征。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36868209283817955000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现 \\`fn summary\\`\n// 修复错误且不要移除任何代码行\ntrait Summary {\n    fn summarize(&self) -> String;\n}\n\n#[derive(Debug)]\nstruct Post {\n    title: String,\n    author: String,\n    content: String,\n}\n\nimpl Summary for Post {\n    fn summarize(&self) -> String {\n        format!(&quot;The author of post {} is {}&quot;, self.title, self.author)\n    }\n}\n\n#[derive(Debug)]\nstruct Weibo {\n    username: String,\n    content: String,\n}\n\nimpl Summary for Weibo {\n    fn summarize(&self) -> String {\n        format!(&quot;{} published a weibo {}&quot;, self.username, self.content)\n    }\n}\n\nfn main() {\n    let post = Post {\n        title: &quot;Popular Rust&quot;.to_string(),\n        author: &quot;Sunface&quot;.to_string(),\n        content: &quot;Rust is awesome!&quot;.to_string(),\n    };\n    let weibo = Weibo {\n        username: &quot;sunface&quot;.to_string(),\n        content: &quot;Weibo seems to be worse than Tweet&quot;.to_string(),\n    };\n\n    summary(post);\n    summary(weibo);\n\n    println!(&quot;{:?}&quot;, post);\n    println!(&quot;{:?}&quot;, weibo);\n}\n\n// 在下面实现 \\`fn summary\\` 函数`, `36868209283817955000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现 `fn summary`</span>\n<span class="token comment">// 修复错误且不要移除任何代码行</span>\n<span class="token keyword">trait</span> Summary <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Post <span class="token punctuation">{</span>\n    title<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    author<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Post <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"The author of post {} is {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>author<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Weibo <span class="token punctuation">{</span>\n    username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Weibo <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{} published a weibo {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> post <span class="token operator">=</span> Post <span class="token punctuation">{</span>\n        title<span class="token punctuation">:</span> <span class="token string">"Popular Rust"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        author<span class="token punctuation">:</span> <span class="token string">"Sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        content<span class="token punctuation">:</span> <span class="token string">"Rust is awesome!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> weibo <span class="token operator">=</span> Weibo <span class="token punctuation">{</span>\n        username<span class="token punctuation">:</span> <span class="token string">"sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        content<span class="token punctuation">:</span> <span class="token string">"Weibo seems to be worse than Tweet"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">summary</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">summary</span><span class="token punctuation">(</span>weibo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> post<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> weibo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 在下面实现 `fn summary` 函数</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-143"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-143" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66811781881963530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 实现 \\`fn summary\\`\n// 修复错误且不要移除任何代码行\ntrait Summary {\n    fn summarize(&self) -> String;\n}\n\n#[derive(Debug)]\nstruct Post {\n    title: String,\n    author: String,\n    content: String,\n}\n\nimpl Summary for Post {\n    fn summarize(&self) -> String {\n        format!(&quot;The author of post {} is {}&quot;, self.title, self.author)\n    }\n}\n\n#[derive(Debug)]\nstruct Weibo {\n    username: String,\n    content: String,\n}\n\nimpl Summary for Weibo {\n    fn summarize(&self) -> String {\n        format!(&quot;{} published a weibo {}&quot;, self.username, self.content)\n    }\n}\n\nfn summary(item: &impl Summary) {\n    item.summarize();\n}\n\nfn main() {\n    let post = Post {\n        title: &quot;Popular Rust&quot;.to_string(),\n        author: &quot;Sunface&quot;.to_string(),\n        content: &quot;Rust is awesome!&quot;.to_string(),\n    };\n    let weibo = Weibo {\n        username: &quot;sunface&quot;.to_string(),\n        content: &quot;Weibo seems to be worse than Tweet&quot;.to_string(),\n    };\n\n    summary(&post);\n    summary(&weibo);\n\n    println!(&quot;{:?}&quot;, post);\n    println!(&quot;{:?}&quot;, weibo);\n}\n\n// 在下面实现 \\`fn summary\\` 函数`, `66811781881963530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 实现 `fn summary`</span>\n<span class="token comment">// 修复错误且不要移除任何代码行</span>\n<span class="token keyword">trait</span> Summary <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Post <span class="token punctuation">{</span>\n    title<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    author<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Post <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"The author of post {} is {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>author<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Weibo <span class="token punctuation">{</span>\n    username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    content<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Summary <span class="token keyword">for</span> Weibo <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">summarize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{} published a weibo {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">summary</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">impl</span> Summary<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    item<span class="token punctuation">.</span><span class="token function">summarize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> post <span class="token operator">=</span> Post <span class="token punctuation">{</span>\n        title<span class="token punctuation">:</span> <span class="token string">"Popular Rust"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        author<span class="token punctuation">:</span> <span class="token string">"Sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        content<span class="token punctuation">:</span> <span class="token string">"Rust is awesome!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> weibo <span class="token operator">=</span> Weibo <span class="token punctuation">{</span>\n        username<span class="token punctuation">:</span> <span class="token string">"sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        content<span class="token punctuation">:</span> <span class="token string">"Weibo seems to be worse than Tweet"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">summary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">summary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>weibo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> post<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> weibo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 在下面实现 `fn summary` 函数</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-9"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<p>我们还可以在函数的返回值中使用 impl Trait 语法。然后只有在返回值是同一个类型时，才能这么使用，如果返回值是不同的类型，你可能更需要特征对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80174940895485360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Sheep {}\nstruct Cow {}\n\ntrait Animal {\n    fn noise(&self) -> String;\n}\n\nimpl Animal for Sheep {\n    fn noise(&self) -> String {\n        &quot;baaaaah!&quot;.to_string()\n    }\n}\n\nimpl Animal for Cow {\n    fn noise(&self) -> String {\n        &quot;moooooo!&quot;.to_string()\n    }\n}\n\n// 返回一个类型，该类型实现了 Animal 特征，但是我们并不能在编译期获知具体返回了哪个类型\n// 修复这里的错误，你可以使用虚假的随机，也可以使用特征对象\nfn random_animal(random_number: f64) -> impl Animal {\n    if random_number < 0.5 {\n        Sheep {}\n    } else {\n        Cow {}\n    }\n}\n\nfn main() {\n    let random_number = 0.234;\n    let animal = random_animal(random_number);\n    println!(&quot;You\'ve randomly chosen an animal, and it says {}&quot;, animal.noise());\n}`, `80174940895485360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Sheep <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Cow <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Animal <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Animal <span class="token keyword">for</span> Sheep <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token string">"baaaaah!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Animal <span class="token keyword">for</span> Cow <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token string">"moooooo!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 返回一个类型，该类型实现了 Animal 特征，但是我们并不能在编译期获知具体返回了哪个类型</span>\n<span class="token comment">// 修复这里的错误，你可以使用虚假的随机，也可以使用特征对象</span>\n<span class="token keyword">fn</span> <span class="token function">random_animal</span><span class="token punctuation">(</span>random_number<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">impl</span> Animal <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> random_number <span class="token operator">&lt;</span> <span class="token number">0.5</span> <span class="token punctuation">{</span>\n        Sheep <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        Cow <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> random_number <span class="token operator">=</span> <span class="token number">0.234</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> animal <span class="token operator">=</span> <span class="token function">random_animal</span><span class="token punctuation">(</span>random_number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"You\'ve randomly chosen an animal, and it says {}"</span><span class="token punctuation">,</span> animal<span class="token punctuation">.</span><span class="token function">noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-144"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-144" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84389399911988410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Sheep {}\nstruct Cow {}\n\ntrait Animal {\n    fn noise(&self) -> String;\n}\n\nimpl Animal for Sheep {\n    fn noise(&self) -> String {\n        &quot;baaaaah!&quot;.to_string()\n    }\n}\n\nimpl Animal for Cow {\n    fn noise(&self) -> String {\n        &quot;moooooo!&quot;.to_string()\n    }\n}\n\n// 返回一个类型，该类型实现了 Animal 特征，但是我们并不能在编译期获知具体返回了哪个类型\n// 修复这里的错误，你可以使用虚假的随机，也可以使用特征对象\nfn random_animal(random_number: f64) -> Box<dyn Animal> {\n    if random_number < 0.5 {\n        Box::new(Sheep {})\n    } else {\n        Box::new(Cow {})\n    }\n}\n\nfn main() {\n    let random_number = 0.234;\n    let animal = random_animal(random_number);\n    println!(\n        &quot;You\'ve randomly chosen an animal, and it says {}&quot;,\n        animal.noise()\n    );\n}`, `84389399911988410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> Sheep <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Cow <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Animal <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Animal <span class="token keyword">for</span> Sheep <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token string">"baaaaah!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Animal <span class="token keyword">for</span> Cow <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">noise</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token string">"moooooo!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 返回一个类型，该类型实现了 Animal 特征，但是我们并不能在编译期获知具体返回了哪个类型</span>\n<span class="token comment">// 修复这里的错误，你可以使用虚假的随机，也可以使用特征对象</span>\n<span class="token keyword">fn</span> <span class="token function">random_animal</span><span class="token punctuation">(</span>random_number<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> Animal<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> random_number <span class="token operator">&lt;</span> <span class="token number">0.5</span> <span class="token punctuation">{</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Sheep <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Cow <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> random_number <span class="token operator">=</span> <span class="token number">0.234</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> animal <span class="token operator">=</span> <span class="token function">random_animal</span><span class="token punctuation">(</span>random_number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span>\n        <span class="token string">"You\'ve randomly chosen an animal, and it says {}"</span><span class="token punctuation">,</span>\n        animal<span class="token punctuation">.</span><span class="token function">noise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-8"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<p>impl Trait 语法非常直观简洁，但它实际上是特征约束的语法糖。</p>\n<p>当使用泛型参数时，我们往往需要为该参数指定特定的行为，这种指定方式就是通过特征约束来实现的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51282661894944014000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    assert_eq!(sum(1, 2), 3);\n}\n\n// 通过两种方法使用特征约束来实现 \\`fn sum\\`\nfn sum<T>(x: T, y: T) -> T {\n    x + y\n}`, `51282661894944014000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过两种方法使用特征约束来实现 `fn sum`</span>\n<span class="token keyword">fn</span> sum<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> T <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-145"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-145" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27028565483748280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Add;\n\nfn main() {\n    assert_eq!(sum(1, 2), 3);\n}\n\n// 通过两种方法使用特征约束来实现 \\`fn sum\\`\nfn sum<T: Add<Output = T>>(x: T, y: T) -> T {\n    x + y\n}`, `27028565483748280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Add<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过两种方法使用特征约束来实现 `fn sum`</span>\n<span class="token keyword">fn</span> sum<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Add<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> T <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97656885084138320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Add;\n\nfn main() {\n    assert_eq!(sum(1, 2), 3);\n}\n\n// 通过两种方法使用特征约束来实现 \\`fn sum\\`\nfn sum<T>(x: T, y: T) -> T\nwhere\n    T: Add<Output = T>,\n{\n    x + y\n}`, `97656885084138320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Add<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过两种方法使用特征约束来实现 `fn sum`</span>\n<span class="token keyword">fn</span> sum<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> T\n<span class="token keyword">where</span>\n    T<span class="token punctuation">:</span> Add<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">></span><span class="token punctuation">,</span>\n<span class="token punctuation">{</span>\n    x <span class="token operator">+</span> y\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-8"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75558948935429980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复代码中的错误\nstruct Pair<T> {\n    x: T,\n    y: T,\n}\n\nimpl<T> Pair<T> {\n    fn new(x: T, y: T) -> Self {\n        Self {\n            x,\n            y,\n        }\n    }\n}\n\nimpl<T: std::fmt::Debug + PartialOrd> Pair<T> {\n    fn cmp_display(&self) {\n        if self.x >= self.y {\n            println!(&quot;The largest member is x = {:?}&quot;, self.x);\n        } else {\n            println!(&quot;The largest member is y = {:?}&quot;, self.y);\n        }\n    }\n}\n\nstruct Unit(i32);\n\nfn main() {\n    let pair = Pair{\n        x: Unit(1),\n        y: Unit(3)\n    };\n\n    pair.cmp_display();\n}`, `75558948935429980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复代码中的错误</span>\n<span class="token keyword">struct</span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">></span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>\n        <span class="token keyword">Self</span> <span class="token punctuation">{</span>\n            x<span class="token punctuation">,</span>\n            y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug <span class="token operator">+</span> PartialOrd<span class="token operator">></span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">cmp_display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">>=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The largest member is x = {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The largest member is y = {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> <span class="token function">Unit</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> pair <span class="token operator">=</span> Pair<span class="token punctuation">{</span>\n        x<span class="token punctuation">:</span> <span class="token function">Unit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        y<span class="token punctuation">:</span> <span class="token function">Unit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    pair<span class="token punctuation">.</span><span class="token function">cmp_display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-146"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-146" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97997049301363200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复代码中的错误\nstruct Pair<T> {\n    x: T,\n    y: T,\n}\n\nimpl<T> Pair<T> {\n    fn new(x: T, y: T) -> Self {\n        Self { x, y }\n    }\n}\n\nimpl<T: std::fmt::Debug + PartialOrd> Pair<T> {\n    fn cmp_display(&self) {\n        if self.x >= self.y {\n            println!(&quot;The largest member is x = {:?}&quot;, self.x);\n        } else {\n            println!(&quot;The largest member is y = {:?}&quot;, self.y);\n        }\n    }\n}\n\n#[derive(Debug, PartialOrd, PartialEq)]\nstruct Unit(i32);\n\nfn main() {\n    let pair = Pair {\n        x: Unit(1),\n        y: Unit(3),\n    };\n\n    pair.cmp_display();\n}`, `97997049301363200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复代码中的错误</span>\n<span class="token keyword">struct</span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">></span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">,</span> y<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>\n        <span class="token keyword">Self</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug <span class="token operator">+</span> PartialOrd<span class="token operator">></span> Pair<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">cmp_display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">>=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The largest member is x = {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The largest member is y = {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug, PartialOrd, PartialEq)]</span>\n<span class="token keyword">struct</span> <span class="token function">Unit</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> pair <span class="token operator">=</span> Pair <span class="token punctuation">{</span>\n        x<span class="token punctuation">:</span> <span class="token function">Unit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        y<span class="token punctuation">:</span> <span class="token function">Unit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    pair<span class="token punctuation">.</span><span class="token function">cmp_display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十-4"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70740037900761375000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn example1() {\n    // \\`T: Trait\\` 是最常使用的方式\n    // \\`T: Fn(u32) -> u32\\` 说明 \\`T\\` 只能接收闭包类型的参数\n    struct Cacher<T: Fn(u32) -> u32> {\n        calculation: T,\n        value: Option<u32>,\n    }\n\n    impl<T: Fn(u32) -> u32> Cacher<T> {\n        fn new(calculation: T) -> Cacher<T> {\n            Cacher {\n                calculation,\n                value: None,\n            }\n        }\n\n        fn value(&mut self, arg: u32) -> u32 {\n            match self.value {\n                Some(v) => v,\n                None => {\n                    let v = (self.calculation)(arg);\n                    self.value = Some(v);\n                    v\n                },\n            }\n        }\n    }\n\n    let mut cacher = Cacher::new(|x| x+1);\n    assert_eq!(cacher.value(10), __);\n    assert_eq!(cacher.value(15), __);\n}\n\nfn example2() {\n    // 还可以使用 \\`where\\` 来约束 T\n    struct Cacher<T>\n        where T: Fn(u32) -> u32,\n    {\n        calculation: T,\n        value: Option<u32>,\n    }\n\n    impl<T> Cacher<T>\n        where T: Fn(u32) -> u32,\n    {\n        fn new(calculation: T) -> Cacher<T> {\n            Cacher {\n                calculation,\n                value: None,\n            }\n        }\n\n        fn value(&mut self, arg: u32) -> u32 {\n            match self.value {\n                Some(v) => v,\n                None => {\n                    let v = (self.calculation)(arg);\n                    self.value = Some(v);\n                    v\n                },\n            }\n        }\n    }\n\n    let mut cacher = Cacher::new(|x| x+1);\n    assert_eq!(cacher.value(20), __);\n    assert_eq!(cacher.value(25), __);\n}\n\n\n\nfn main() {\n    example1();\n    example2();\n\n    println!(&quot;Success!&quot;)\n}`, `70740037900761375000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">example1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// `T: Trait` 是最常使用的方式</span>\n    <span class="token comment">// `T: Fn(u32) -> u32` 说明 `T` 只能接收闭包类型的参数</span>\n    <span class="token keyword">struct</span> Cacher<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token operator">></span> <span class="token punctuation">{</span>\n        calculation<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n        value<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>u32<span class="token operator">></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token operator">></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>calculation<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n            Cacher <span class="token punctuation">{</span>\n                calculation<span class="token punctuation">,</span>\n                value<span class="token punctuation">:</span> None<span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> arg<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n            <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token punctuation">{</span>\n                <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=></span> v<span class="token punctuation">,</span>\n                None <span class="token operator">=></span> <span class="token punctuation">{</span>\n                    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>calculation<span class="token punctuation">)</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    v\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> cacher <span class="token operator">=</span> Cacher<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">example2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 还可以使用 `where` 来约束 T</span>\n    <span class="token keyword">struct</span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span>\n        <span class="token keyword">where</span> T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n        calculation<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n        value<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>u32<span class="token operator">></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span>\n        <span class="token keyword">where</span> T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>calculation<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n            Cacher <span class="token punctuation">{</span>\n                calculation<span class="token punctuation">,</span>\n                value<span class="token punctuation">:</span> None<span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> arg<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n            <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token punctuation">{</span>\n                <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=></span> v<span class="token punctuation">,</span>\n                None <span class="token operator">=></span> <span class="token punctuation">{</span>\n                    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>calculation<span class="token punctuation">)</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    v\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> cacher <span class="token operator">=</span> Cacher<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">example1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">example2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-147"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-147" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7796503257047771000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn example1() {\n    // \\`T: Trait\\` 是最常使用的方式\n    // \\`T: Fn(u32) -> u32\\` 说明 \\`T\\` 只能接收闭包类型的参数\n    struct Cacher<T: Fn(u32) -> u32> {\n        calculation: T,\n        value: Option<u32>,\n    }\n\n    impl<T: Fn(u32) -> u32> Cacher<T> {\n        fn new(calculation: T) -> Cacher<T> {\n            Cacher {\n                calculation,\n                value: None,\n            }\n        }\n\n        fn value(&mut self, arg: u32) -> u32 {\n            match self.value {\n                Some(v) => v,\n                None => {\n                    let v = (self.calculation)(arg);\n                    self.value = Some(v);\n                    v\n                }\n            }\n        }\n    }\n\n    let mut cacher = Cacher::new(|x| x + 1);\n    assert_eq!(cacher.value(10), 11);\n    assert_eq!(cacher.value(15), 11);\n}\n\nfn example2() {\n    // 还可以使用 \\`where\\` 来约束 T\n    struct Cacher<T>\n    where\n        T: Fn(u32) -> u32,\n    {\n        calculation: T,\n        value: Option<u32>,\n    }\n\n    impl<T> Cacher<T>\n    where\n        T: Fn(u32) -> u32,\n    {\n        fn new(calculation: T) -> Cacher<T> {\n            Cacher {\n                calculation,\n                value: None,\n            }\n        }\n\n        fn value(&mut self, arg: u32) -> u32 {\n            match self.value {\n                Some(v) => v,\n                None => {\n                    let v = (self.calculation)(arg);\n                    self.value = Some(v);\n                    v\n                }\n            }\n        }\n    }\n\n    let mut cacher = Cacher::new(|x| x + 1);\n    assert_eq!(cacher.value(20), 21);\n    assert_eq!(cacher.value(25), 21);\n}\n\nfn main() {\n    example1();\n    example2();\n\n    println!(&quot;Success!&quot;)\n}`, `7796503257047771000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">example1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// `T: Trait` 是最常使用的方式</span>\n    <span class="token comment">// `T: Fn(u32) -> u32` 说明 `T` 只能接收闭包类型的参数</span>\n    <span class="token keyword">struct</span> Cacher<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token operator">></span> <span class="token punctuation">{</span>\n        calculation<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n        value<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>u32<span class="token operator">></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token operator">></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>calculation<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n            Cacher <span class="token punctuation">{</span>\n                calculation<span class="token punctuation">,</span>\n                value<span class="token punctuation">:</span> None<span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> arg<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n            <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token punctuation">{</span>\n                <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=></span> v<span class="token punctuation">,</span>\n                None <span class="token operator">=></span> <span class="token punctuation">{</span>\n                    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>calculation<span class="token punctuation">)</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    v\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> cacher <span class="token operator">=</span> Cacher<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">example2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 还可以使用 `where` 来约束 T</span>\n    <span class="token keyword">struct</span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span>\n    <span class="token keyword">where</span>\n        T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n        calculation<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n        value<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>u32<span class="token operator">></span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token operator">></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span>\n    <span class="token keyword">where</span>\n        T<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32<span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>calculation<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">-></span> Cacher<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n            Cacher <span class="token punctuation">{</span>\n                calculation<span class="token punctuation">,</span>\n                value<span class="token punctuation">:</span> None<span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> arg<span class="token punctuation">:</span> u32<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n            <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token punctuation">{</span>\n                <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=></span> v<span class="token punctuation">,</span>\n                None <span class="token operator">=></span> <span class="token punctuation">{</span>\n                    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>calculation<span class="token punctuation">)</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">self</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">Some</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    v\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> cacher <span class="token operator">=</span> Cacher<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>cacher<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">example1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">example2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="特征对象"><a href="#%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>特征对象</h2>\n<p>在特征练习中，我们已经知道当函数返回多个类型时，impl Trait 是无法使用的</p>\n<p>对于数组而言，其中一个限制就是无法存储不同类型的元素，但是通过之前的学习，大家应该知道枚举可以在部分场景解决这种问题，但是这种方法局限性较大。此时就需要我们的主角登场了</p>\n<h3 id="问题一-20"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>Rust 编译器需要知道一个函数的返回类型占用多少内存空间。由于特征的不同实现类型可能会占用不同的内存，因此通过 impl Trait 返回多个类型是不被允许的，但是我们可以返回一个 dyn 特征对象来解决问题</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95949746628095590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Bird {\n    fn quack(&self) -> String;\n}\n\nstruct Duck;\nimpl Duck {\n    fn swim(&self) {\n        println!(&quot;Look, the duck is swimming&quot;)\n    }\n}\nstruct Swan;\nimpl Swan {\n    fn fly(&self) {\n        println!(&quot;Look, the duck.. oh sorry, the swan is flying&quot;)\n    }\n}\n\nimpl Bird for Duck {\n    fn quack(&self) -> String{\n        &quot;duck duck&quot;.to_string()\n    }\n}\n\nimpl Bird for Swan {\n    fn quack(&self) -> String{\n        &quot;swan swan&quot;.to_string()\n    }\n}\n\nfn main() {\n    // 填空\n    let duck = __;\n    duck.swim();\n\n    let bird = hatch_a_bird(2);\n    // 变成鸟儿后，它忘记了如何游，因此以下代码会报错\n    // bird.swim();\n    // 但它依然可以叫唤\n    assert_eq!(bird.quack(), &quot;duck duck&quot;);\n\n    let bird = hatch_a_bird(1);\n    // 这只鸟儿忘了如何飞翔，因此以下代码会报错\n    // bird.fly();\n    // 但它也可以叫唤\n    assert_eq!(bird.quack(), &quot;swan swan&quot;);\n\n    println!(&quot;Success!&quot;)\n}\n\n// 实现以下函数\nfn hatch_a_bird...`, `95949746628095590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Bird <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Duck<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">swim</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck is swimming"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Swan<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck.. oh sorry, the swan is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">{</span>\n        <span class="token string">"duck duck"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">{</span>\n        <span class="token string">"swan swan"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> duck <span class="token operator">=</span> __<span class="token punctuation">;</span>\n    duck<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> bird <span class="token operator">=</span> <span class="token function">hatch_a_bird</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 变成鸟儿后，它忘记了如何游，因此以下代码会报错</span>\n    <span class="token comment">// bird.swim();</span>\n    <span class="token comment">// 但它依然可以叫唤</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"duck duck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> bird <span class="token operator">=</span> <span class="token function">hatch_a_bird</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 这只鸟儿忘了如何飞翔，因此以下代码会报错</span>\n    <span class="token comment">// bird.fly();</span>\n    <span class="token comment">// 但它也可以叫唤</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"swan swan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 实现以下函数</span>\n<span class="token keyword">fn</span> hatch_a_bird<span class="token punctuation">...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-148"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-148" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67023780222662040000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Bird {\n    fn quack(&self) -> String;\n}\n\nstruct Duck;\nimpl Duck {\n    fn swim(&self) {\n        println!(&quot;Look, the duck is swimming&quot;)\n    }\n}\nstruct Swan;\nimpl Swan {\n    fn fly(&self) {\n        println!(&quot;Look, the duck.. oh sorry, the swan is flying&quot;)\n    }\n}\n\nimpl Bird for Duck {\n    fn quack(&self) -> String{\n        &quot;duck duck&quot;.to_string()\n    }\n}\n\nimpl Bird for Swan {\n    fn quack(&self) -> String{\n        &quot;swan swan&quot;.to_string()\n    }\n}\n\nfn main() {\n    // 填空\n    let duck = Duck{};\n    duck.swim();\n\n    let bird = hatch_a_bird(2);\n    // 变成鸟儿后，它忘记了如何游，因此以下代码会报错\n    // bird.swim();\n    // 但它依然可以叫唤\n    assert_eq!(bird.quack(), &quot;duck duck&quot;);\n\n    let bird = hatch_a_bird(1);\n    // 这只鸟儿忘了如何飞翔，因此以下代码会报错\n    // bird.fly();\n    // 但它也可以叫唤\n    assert_eq!(bird.quack(), &quot;swan swan&quot;);\n\n    println!(&quot;Success!&quot;)\n}\n\n// 实现以下函数\nfn hatch_a_bird(bird: u8) -> Box<dyn Bird> {\n    match bird {\n        1 => Box::new(Swan{}),\n        _ => Box::new(Duck{}),\n    }\n}`, `67023780222662040000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Bird <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Duck<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">swim</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck is swimming"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Swan<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck.. oh sorry, the swan is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">{</span>\n        <span class="token string">"duck duck"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">{</span>\n        <span class="token string">"swan swan"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> duck <span class="token operator">=</span> Duck<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    duck<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> bird <span class="token operator">=</span> <span class="token function">hatch_a_bird</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 变成鸟儿后，它忘记了如何游，因此以下代码会报错</span>\n    <span class="token comment">// bird.swim();</span>\n    <span class="token comment">// 但它依然可以叫唤</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"duck duck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> bird <span class="token operator">=</span> <span class="token function">hatch_a_bird</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 这只鸟儿忘了如何飞翔，因此以下代码会报错</span>\n    <span class="token comment">// bird.fly();</span>\n    <span class="token comment">// 但它也可以叫唤</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"swan swan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 实现以下函数</span>\n<span class="token keyword">fn</span> <span class="token function">hatch_a_bird</span><span class="token punctuation">(</span>bird<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> Bird<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> bird <span class="token punctuation">{</span>\n        <span class="token number">1</span> <span class="token operator">=></span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Swan<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Duck<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-20"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>在数组中使用特征对象</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5645384196759262000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Bird {\n    fn quack(&self);\n}\n\nstruct Duck;\nimpl Duck {\n    fn fly(&self) {\n        println!(&quot;Look, the duck is flying&quot;)\n    }\n}\nstruct Swan;\nimpl Swan {\n    fn fly(&self) {\n        println!(&quot;Look, the duck.. oh sorry, the swan is flying&quot;)\n    }\n}\n\nimpl Bird for Duck {\n    fn quack(&self) {\n        println!(&quot;{}&quot;, &quot;duck duck&quot;);\n    }\n}\n\nimpl Bird for Swan {\n    fn quack(&self) {\n        println!(&quot;{}&quot;, &quot;swan swan&quot;);\n    }\n}\n\nfn main() {\n    // 填空\n    let birds __;\n\n    for bird in birds {\n        bird.quack();\n        // 当 duck 和 swan 变成 bird 后，它们都忘了如何翱翔于天际，只记得该怎么叫唤了。。\n        // 因此，以下代码会报错\n        // bird.fly();\n    }\n}`, `5645384196759262000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Bird <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Duck<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Swan<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck.. oh sorry, the swan is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"duck duck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"swan swan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> birds __<span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> bird <span class="token keyword">in</span> birds <span class="token punctuation">{</span>\n        bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 当 duck 和 swan 变成 bird 后，它们都忘了如何翱翔于天际，只记得该怎么叫唤了。。</span>\n        <span class="token comment">// 因此，以下代码会报错</span>\n        <span class="token comment">// bird.fly();</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-149"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-149" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28432058796973060000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::BitXor;\n\ntrait Bird {\n    fn quack(&self);\n}\n\nstruct Duck;\nimpl Duck {\n    fn fly(&self) {\n        println!(&quot;Look, the duck is flying&quot;)\n    }\n}\nstruct Swan;\nimpl Swan {\n    fn fly(&self) {\n        println!(&quot;Look, the duck.. oh sorry, the swan is flying&quot;)\n    }\n}\n\nimpl Bird for Duck {\n    fn quack(&self) {\n        println!(&quot;{}&quot;, &quot;duck duck&quot;);\n    }\n}\n\nimpl Bird for Swan {\n    fn quack(&self) {\n        println!(&quot;{}&quot;, &quot;swan swan&quot;);\n    }\n}\n\nfn main() {\n    // 填空\n    let birds: [Box<dyn Bird>; 2] = [Box::new(Duck {}), Box::new(Swan {})];\n\n    for bird in birds {\n        bird.quack();\n        // 当 duck 和 swan 变成 bird 后，它们都忘了如何翱翔于天际，只记得该怎么叫唤了。。\n        // 因此，以下代码会报错\n        // bird.fly();\n    }\n}`, `28432058796973060000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>BitXor<span class="token punctuation">;</span>\n\n<span class="token keyword">trait</span> Bird <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Duck<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> Swan<span class="token punctuation">;</span>\n<span class="token keyword">impl</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Look, the duck.. oh sorry, the swan is flying"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Duck <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"duck duck"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Bird <span class="token keyword">for</span> Swan <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">quack</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"swan swan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> birds<span class="token punctuation">:</span> <span class="token punctuation">[</span>Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> Bird<span class="token operator">></span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Duck <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Swan <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> bird <span class="token keyword">in</span> birds <span class="token punctuation">{</span>\n        bird<span class="token punctuation">.</span><span class="token function">quack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 当 duck 和 swan 变成 bird 后，它们都忘了如何翱翔于天际，只记得该怎么叫唤了。。</span>\n        <span class="token comment">// 因此，以下代码会报错</span>\n        <span class="token comment">// bird.fly();</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-20"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p><code class="language-text">&amp;dyn and Box&lt;dyn&gt;</code></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55676797899222530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\ntrait Draw {\n    fn draw(&self) -> String;\n}\n\nimpl Draw for u8 {\n    fn draw(&self) -> String {\n        format!(&quot;u8: {}&quot;, *self)\n    }\n}\n\nimpl Draw for f64 {\n    fn draw(&self) -> String {\n        format!(&quot;f64: {}&quot;, *self)\n    }\n}\n\nfn main() {\n    let x = 1.1f64;\n    let y = 8u8;\n\n    // draw x\n    draw_with_box(__);\n\n    // draw y\n    draw_with_ref(&y);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn draw_with_box(x: Box<dyn Draw>) {\n    x.draw();\n}\n\nfn draw_with_ref(x: __) {\n    x.draw();\n}`, `55676797899222530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">trait</span> Draw <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Draw <span class="token keyword">for</span> u8 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"u8: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Draw <span class="token keyword">for</span> f64 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"f64: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1.1f64</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">8u8</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// draw x</span>\n    <span class="token function">draw_with_box</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// draw y</span>\n    <span class="token function">draw_with_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">draw_with_box</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> Draw<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">draw_with_ref</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> __<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-150"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-150" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13656382484498696000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\ntrait Draw {\n    fn draw(&self) -> String;\n}\n\nimpl Draw for u8 {\n    fn draw(&self) -> String {\n        format!(&quot;u8: {}&quot;, *self)\n    }\n}\n\nimpl Draw for f64 {\n    fn draw(&self) -> String {\n        format!(&quot;f64: {}&quot;, *self)\n    }\n}\n\nfn main() {\n    let x = 1.1f64;\n    let y = 8u8;\n\n    // draw x\n    draw_with_box(Box::new(x));\n\n    // draw y\n    draw_with_ref(&y);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn draw_with_box(x: Box<dyn Draw>) {\n    x.draw();\n}\n\nfn draw_with_ref(x: &dyn Draw) {\n    x.draw();\n}`, `13656382484498696000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">trait</span> Draw <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Draw <span class="token keyword">for</span> u8 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"u8: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Draw <span class="token keyword">for</span> f64 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"f64: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1.1f64</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">8u8</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// draw x</span>\n    <span class="token function">draw_with_box</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// draw y</span>\n    <span class="token function">draw_with_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">draw_with_box</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> Draw<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">draw_with_ref</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">dyn</span> Draw<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-19"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>静态分发和动态分发 <a href="https://course.rs/basic/trait/trait-object.html#%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8A%A8%E6%80%81%E5%88%86%E5%8F%91" target="_blank" rel="nofollow noreferrer noopener">Static and Dynamic dispatch</a></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28061142888152048000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Foo {\n    fn method(&self) -> String;\n}\n\nimpl Foo for u8 {\n    fn method(&self) -> String { format!(&quot;u8: {}&quot;, *self) }\n}\n\nimpl Foo for String {\n    fn method(&self) -> String { format!(&quot;string: {}&quot;, *self) }\n}\n\n// 通过泛型实现以下函数\nfn static_dispatch...\n\n// 通过特征对象实现以下函数\nfn dynamic_dispatch...\n\nfn main() {\n    let x = 5u8;\n    let y = &quot;Hello&quot;.to_string();\n\n    static_dispatch(x);\n    dynamic_dispatch(&y);\n\n    println!(&quot;Success!&quot;)\n}`, `28061142888152048000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Foo <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Foo <span class="token keyword">for</span> u8 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"u8: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Foo <span class="token keyword">for</span> String <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"string: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过泛型实现以下函数</span>\n<span class="token keyword">fn</span> static_dispatch<span class="token punctuation">...</span>\n\n<span class="token comment">// 通过特征对象实现以下函数</span>\n<span class="token keyword">fn</span> dynamic_dispatch<span class="token punctuation">...</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5u8</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">static_dispatch</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">dynamic_dispatch</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-151"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-151" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8010636986070386000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Foo {\n    fn method(&self) -> String;\n}\n\nimpl Foo for u8 {\n    fn method(&self) -> String { format!(&quot;u8: {}&quot;, *self) }\n}\n\nimpl Foo for String {\n    fn method(&self) -> String { format!(&quot;string: {}&quot;, *self) }\n}\n\n// 通过泛型实现以下函数\nfn static_dispatch<T: Foo>(a: T) {\n    a.method();\n}\n\n// 通过特征对象实现以下函数\nfn dynamic_dispatch(a: &dyn Foo) {\n    a.method();\n}\n\nfn main() {\n    let x = 5u8;\n    let y = &quot;Hello&quot;.to_string();\n\n    static_dispatch(x);\n    dynamic_dispatch(&y);\n\n    println!(&quot;Success!&quot;)\n}`, `8010636986070386000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Foo <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Foo <span class="token keyword">for</span> u8 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"u8: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Foo <span class="token keyword">for</span> String <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span> <span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"string: {}"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过泛型实现以下函数</span>\n<span class="token keyword">fn</span> static_dispatch<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Foo<span class="token operator">></span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 通过特征对象实现以下函数</span>\n<span class="token keyword">fn</span> <span class="token function">dynamic_dispatch</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">dyn</span> Foo<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5u8</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">static_dispatch</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">dynamic_dispatch</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-19"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>一个特征能变成特征对象，首先该特征必须是对象安全的，即该特征的所有方法都必须拥有以下特点：</p>\n<ul>\n<li>返回类型不能是 Self</li>\n<li>不能使用泛型参数</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30483525798225973000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用至少两种方法让代码工作\n// 不要添加/删除任何代码行\ntrait MyTrait {\n    fn f(&self) -> Self;\n}\n\nimpl MyTrait for u32 {\n    fn f(&self) -> Self { 42 }\n}\n\nimpl MyTrait for String {\n    fn f(&self) -> Self { self.clone() }\n}\n\nfn my_function(x: Box<dyn MyTrait>)  {\n    x.f()\n}\n\nfn main() {\n    my_function(Box::new(13_u32));\n    my_function(Box::new(String::from(&quot;abc&quot;)));\n\n    println!(&quot;Success!&quot;)\n}`, `30483525798225973000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用至少两种方法让代码工作</span>\n<span class="token comment">// 不要添加/删除任何代码行</span>\n<span class="token keyword">trait</span> MyTrait <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> MyTrait <span class="token keyword">for</span> u32 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token number">42</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> MyTrait <span class="token keyword">for</span> String <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">my_function</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">my_function</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">13_u32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">my_function</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-152"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-152" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5003081552989253000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用至少两种方法让代码工作\n// 不要添加/删除任何代码行\ntrait MyTrait {\n    fn f(&self) -> Box<dyn MyTrait>;\n}\n\nimpl MyTrait for u32 {\n    fn f(&self) -> Box<dyn MyTrait> {\n        Box::new(42)\n    }\n}\n\nimpl MyTrait for String {\n    fn f(&self) -> Box<dyn MyTrait> {\n        Box::new(self.clone())\n    }\n}\n\nfn my_function(x: Box<dyn MyTrait>) -> Box<dyn MyTrait> {\n    x.f()\n}\n\nfn main() {\n    my_function(Box::new(13_u32));\n    my_function(Box::new(String::from(&quot;abc&quot;)));\n\n    println!(&quot;Success!&quot;)\n}`, `5003081552989253000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用至少两种方法让代码工作</span>\n<span class="token comment">// 不要添加/删除任何代码行</span>\n<span class="token keyword">trait</span> MyTrait <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> MyTrait <span class="token keyword">for</span> u32 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span> <span class="token punctuation">{</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> MyTrait <span class="token keyword">for</span> String <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span> <span class="token punctuation">{</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">my_function</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> MyTrait<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">my_function</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">13_u32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">my_function</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="进一步深入特征"><a href="#%E8%BF%9B%E4%B8%80%E6%AD%A5%E6%B7%B1%E5%85%A5%E7%89%B9%E5%BE%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>进一步深入特征</h2>\n<h3 id="问题一-21"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>关联类型主要用于提升代码的可读性，例如以下代码</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63906669487517930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n    pub trait CacheableItem: Clone + Default + fmt::Debug + Decodable + Encodable {\n        type Address: AsRef<[u8]> + Clone + fmt::Debug + Eq + Hash;\n        fn is_null(&self) -> bool;\n    }\n}`, `63906669487517930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">trait</span> CacheableItem<span class="token punctuation">:</span> Clone <span class="token operator">+</span> Default <span class="token operator">+</span> fmt<span class="token punctuation">::</span>Debug <span class="token operator">+</span> Decodable <span class="token operator">+</span> Encodable <span class="token punctuation">{</span>\n        <span class="token keyword">type</span> Address<span class="token punctuation">:</span> AsRef<span class="token operator">&lt;</span><span class="token punctuation">[</span>u8<span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">+</span> Clone <span class="token operator">+</span> fmt<span class="token punctuation">::</span>Debug <span class="token operator">+</span> Eq <span class="token operator">+</span> Hash<span class="token punctuation">;</span>\n        <span class="token keyword">fn</span> <span class="token function">is_null</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> bool<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>相比 <code class="language-text">AsRef&lt;[u8]&gt; + Clone + fmt::Debug + Eq + Hash</code>，Address 的使用可以极大的减少其它类型在实现该特征时所需的模版代码</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88932729840433680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Container(i32, i32);\n\n// 使用关联类型实现重新实现以下特征\n// trait Contains {\n//    type A;\n//    type B;\n\ntrait Contains<A, B> {\n    fn contains(&self, _: &A, _: &B) -> bool;\n    fn first(&self) -> i32;\n    fn last(&self) -> i32;\n}\n\nimpl Contains<i32, i32> for Container {\n    fn contains(&self, number_1: &i32, number_2: &i32) -> bool {\n        (&self.0 == number_1) && (&self.1 == number_2)\n    }\n    // Grab the first number.\n    fn first(&self) -> i32 { self.0 }\n\n    // Grab the last number.\n    fn last(&self) -> i32 { self.1 }\n}\n\nfn difference<A, B, C: Contains<A, B>>(container: &C) -> i32 {\n    container.last() - container.first()\n}\n\nfn main() {\n    let number_1 = 3;\n    let number_2 = 10;\n\n    let container = Container(number_1, number_2);\n\n    println!(&quot;Does container contain {} and {}: {}&quot;,\n        &number_1, &number_2,\n        container.contains(&number_1, &number_2));\n    println!(&quot;First number: {}&quot;, container.first());\n    println!(&quot;Last number: {}&quot;, container.last());\n\n    println!(&quot;The difference is: {}&quot;, difference(&container));\n}`, `88932729840433680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> <span class="token function">Container</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 使用关联类型实现重新实现以下特征</span>\n<span class="token comment">// trait Contains {</span>\n<span class="token comment">//    type A;</span>\n<span class="token comment">//    type B;</span>\n\n<span class="token keyword">trait</span> Contains<span class="token operator">&lt;</span>A<span class="token punctuation">,</span> B<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token operator">&amp;</span>A<span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token operator">&amp;</span>B<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool<span class="token punctuation">;</span>\n    <span class="token keyword">fn</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32<span class="token punctuation">;</span>\n    <span class="token keyword">fn</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Contains<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> i32<span class="token operator">></span> <span class="token keyword">for</span> Container <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> number_1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">,</span> number_2<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool <span class="token punctuation">{</span>\n        <span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">==</span> number_1<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">==</span> number_2<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">// Grab the first number.</span>\n    <span class="token keyword">fn</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">}</span>\n\n    <span class="token comment">// Grab the last number.</span>\n    <span class="token keyword">fn</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> difference<span class="token operator">&lt;</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> C<span class="token punctuation">:</span> Contains<span class="token operator">&lt;</span>A<span class="token punctuation">,</span> B<span class="token operator">>></span><span class="token punctuation">(</span>container<span class="token punctuation">:</span> <span class="token operator">&amp;</span>C<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    container<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> container<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> number_1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> number_2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token function">Container</span><span class="token punctuation">(</span>number_1<span class="token punctuation">,</span> number_2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Does container contain {} and {}: {}"</span><span class="token punctuation">,</span>\n        <span class="token operator">&amp;</span>number_1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>number_2<span class="token punctuation">,</span>\n        container<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>number_2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"First number: {}"</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Last number: {}"</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The difference is: {}"</span><span class="token punctuation">,</span> <span class="token function">difference</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-153"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-153" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40547764137205400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Container(i32, i32);\n\n// 使用关联类型实现重新实现以下特征\ntrait Contains {\n    type A;\n    type B;\n    fn contains(&self, _: &Self::A, _: &Self::B) -> bool;\n    fn first(&self) -> i32;\n    fn last(&self) -> i32;\n}\n\n// trait Contains<A, B> {\n//     fn contains(&self, _: &A, _: &B) -> bool;\n//     fn first(&self) -> i32;\n//     fn last(&self) -> i32;\n// }\n\nimpl Contains for Container {\n    type A = i32;\n\n    type B = i32;\n\n    fn contains(&self, number_1: &i32, number_2: &i32) -> bool {\n        (&self.0 == number_1) && (&self.1 == number_2)\n    }\n\n    // Grab the first number.\n    fn first(&self) -> i32 {\n        self.0\n    }\n\n    // Grab the last number.\n    fn last(&self) -> i32 {\n        self.1\n    }\n}\n\nfn difference<C: Contains>(container: &C) -> i32 {\n    container.last() - container.first()\n}\n\nfn main() {\n    let number_1 = 3;\n    let number_2 = 10;\n\n    let container = Container(number_1, number_2);\n\n    println!(\n        &quot;Does container contain {} and {}: {}&quot;,\n        number_1,\n        number_2,\n        container.contains(&number_1, &number_2)\n    );\n    println!(&quot;First number: {}&quot;, container.first());\n    println!(&quot;Last number: {}&quot;, container.last());\n\n    println!(&quot;The difference is: {}&quot;, difference(&container));\n}`, `40547764137205400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> <span class="token function">Container</span><span class="token punctuation">(</span>i32<span class="token punctuation">,</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 使用关联类型实现重新实现以下特征</span>\n<span class="token keyword">trait</span> Contains <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> A<span class="token punctuation">;</span>\n    <span class="token keyword">type</span> B<span class="token punctuation">;</span>\n    <span class="token keyword">fn</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span>A<span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span>B<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool<span class="token punctuation">;</span>\n    <span class="token keyword">fn</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32<span class="token punctuation">;</span>\n    <span class="token keyword">fn</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// trait Contains&lt;A, B> {</span>\n<span class="token comment">//     fn contains(&amp;self, _: &amp;A, _: &amp;B) -> bool;</span>\n<span class="token comment">//     fn first(&amp;self) -> i32;</span>\n<span class="token comment">//     fn last(&amp;self) -> i32;</span>\n<span class="token comment">// }</span>\n\n<span class="token keyword">impl</span> Contains <span class="token keyword">for</span> Container <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> A <span class="token operator">=</span> i32<span class="token punctuation">;</span>\n\n    <span class="token keyword">type</span> B <span class="token operator">=</span> i32<span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> number_1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">,</span> number_2<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> bool <span class="token punctuation">{</span>\n        <span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">==</span> number_1<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">==</span> number_2<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Grab the first number.</span>\n    <span class="token keyword">fn</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Grab the last number.</span>\n    <span class="token keyword">fn</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">1</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> difference<span class="token operator">&lt;</span>C<span class="token punctuation">:</span> Contains<span class="token operator">></span><span class="token punctuation">(</span>container<span class="token punctuation">:</span> <span class="token operator">&amp;</span>C<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    container<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> container<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> number_1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> number_2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token function">Container</span><span class="token punctuation">(</span>number_1<span class="token punctuation">,</span> number_2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span>\n        <span class="token string">"Does container contain {} and {}: {}"</span><span class="token punctuation">,</span>\n        number_1<span class="token punctuation">,</span>\n        number_2<span class="token punctuation">,</span>\n        container<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>number_2<span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"First number: {}"</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Last number: {}"</span><span class="token punctuation">,</span> container<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The difference is: {}"</span><span class="token punctuation">,</span> <span class="token function">difference</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>container<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-21"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>当我们使用泛型类型参数时，可以为该泛型参数指定一个具体的默认类型，这样当实现该特征时，如果该默认类型可以使用，那用户再无需手动指定具体的类型。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54681717377547190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Sub;\n\n#[derive(Debug, PartialEq)]\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\n// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用\nimpl __ {\n    type Output = Self;\n\n    fn sub(self, other: Self) -> Self::Output {\n        Point {\n            x: self.x - other.x,\n            y: self.y - other.y,\n        }\n    }\n}\n\nfn main() {\n    assert_eq!(Point { x: 2, y: 3 } - Point { x: 1, y: 0 },\n        Point { x: 1, y: 3 });\n\n    println!(&quot;Success!&quot;)\n}`, `54681717377547190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Sub<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用</span>\n<span class="token keyword">impl</span> __ <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">::</span>Output <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span>\n            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span>\n            y<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token operator">-</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-154"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-154" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97119916430515260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Sub;\n\n#[derive(Debug, PartialEq)]\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\n// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用\nimpl <T: Sub<Output = T>> Sub<Point<T>> for Point<T> {\n    type Output = Self;\n\n    fn sub(self, other: Self) -> Self::Output {\n        Point {\n            x: self.x - other.x,\n            y: self.y - other.y,\n        }\n    }\n}\n\nfn main() {\n    assert_eq!(Point { x: 2, y: 3 } - Point { x: 1, y: 0 },\n        Point { x: 1, y: 3 });\n\n    println!(&quot;Success!&quot;)\n}`, `97119916430515260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Sub<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用</span>\n<span class="token keyword">impl</span> <span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Sub<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span> Sub<span class="token operator">&lt;</span>Point<span class="token operator">&lt;</span>T<span class="token operator">>></span> <span class="token keyword">for</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">::</span>Output <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span>\n            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span>\n            y<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token operator">-</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56403099435182090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Sub;\n\n#[derive(Debug, PartialEq)]\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\n// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用\nimpl <T: Sub<Output = T>> Sub<Self> for Point<T> {\n    type Output = Self;\n\n    fn sub(self, other: Self) -> Self::Output {\n        Point {\n            x: self.x - other.x,\n            y: self.y - other.y,\n        }\n    }\n}\n\nfn main() {\n    assert_eq!(Point { x: 2, y: 3 } - Point { x: 1, y: 0 },\n        Point { x: 1, y: 3 });\n\n    println!(&quot;Success!&quot;)\n}`, `56403099435182090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Sub<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用</span>\n<span class="token keyword">impl</span> <span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Sub<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span> Sub<span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">></span> <span class="token keyword">for</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">::</span>Output <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span>\n            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span>\n            y<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token operator">-</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24533155105716253000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::ops::Sub;\n\n#[derive(Debug, PartialEq)]\nstruct Point<T> {\n    x: T,\n    y: T,\n}\n\n// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用\nimpl <T: Sub<Output = T>> Sub for Point<T> {\n    type Output = Self;\n\n    fn sub(self, other: Self) -> Self::Output {\n        Point {\n            x: self.x - other.x,\n            y: self.y - other.y,\n        }\n    }\n}\n\nfn main() {\n    assert_eq!(Point { x: 2, y: 3 } - Point { x: 1, y: 0 },\n        Point { x: 1, y: 3 });\n\n    println!(&quot;Success!&quot;)\n}`, `24533155105716253000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span>Sub<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>\n<span class="token keyword">struct</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 用三种方法填空: 其中两种使用默认的泛型参数，另外一种不使用</span>\n<span class="token keyword">impl</span> <span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Sub<span class="token operator">&lt;</span>Output <span class="token operator">=</span> T<span class="token operator">>></span> Sub <span class="token keyword">for</span> Point<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> Output <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span><span class="token punctuation">::</span>Output <span class="token punctuation">{</span>\n        Point <span class="token punctuation">{</span>\n            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span>\n            y<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token operator">-</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-21"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>在 Rust 中，两个不同特征的方法完全可以同名，且你可以为同一个类型同时实现这两个特征。这种情况下，就出现了一个问题：该如何调用这两个特征上定义的同名方法。为了解决这个问题，我们需要使用完全限定语法(Fully Qualified Syntax)。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15312415542053714000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait UsernameWidget {\n    fn get(&self) -> String;\n}\n\ntrait AgeWidget {\n    fn get(&self) -> u8;\n}\n\nstruct Form {\n    username: String,\n    age: u8,\n}\n\nimpl UsernameWidget for Form {\n    fn get(&self) -> String {\n        self.username.clone()\n    }\n}\n\nimpl AgeWidget for Form {\n    fn get(&self) -> u8 {\n        self.age\n    }\n}\n\nfn main() {\n    let form = Form{\n        username: &quot;rustacean&quot;.to_owned(),\n        age: 28,\n    };\n\n    // 如果你反注释下面一行代码，将看到一个错误: Fully Qualified Syntax\n    // 毕竟，这里有好几个同名的 \\`get\\` 方法\n    //\n    // println!(&quot;{}&quot;, form.get());\n\n    let username = UsernameWidget::get(&form);\n    assert_eq!(&quot;rustacean&quot;.to_owned(), username);\n    let age = AgeWidget::get(&form); // 你还可以使用以下语法 \\`<Form as AgeWidget>::get\\`\n    assert_eq!(28, age);\n\n    println!(&quot;Success!&quot;)\n}`, `15312415542053714000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> UsernameWidget <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> AgeWidget <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u8<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Form <span class="token punctuation">{</span>\n    username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> UsernameWidget <span class="token keyword">for</span> Form <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> AgeWidget <span class="token keyword">for</span> Form <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u8 <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>age\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> form <span class="token operator">=</span> Form<span class="token punctuation">{</span>\n        username<span class="token punctuation">:</span> <span class="token string">"rustacean"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 如果你反注释下面一行代码，将看到一个错误: Fully Qualified Syntax</span>\n    <span class="token comment">// 毕竟，这里有好几个同名的 `get` 方法</span>\n    <span class="token comment">//</span>\n    <span class="token comment">// println!("{}", form.get());</span>\n\n    <span class="token keyword">let</span> username <span class="token operator">=</span> UsernameWidget<span class="token punctuation">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token string">"rustacean"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> age <span class="token operator">=</span> AgeWidget<span class="token punctuation">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 你还可以使用以下语法 `&lt;Form as AgeWidget>::get`</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70034131973929070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Pilot {\n    fn fly(&self) -> String;\n}\n\ntrait Wizard {\n    fn fly(&self) -> String;\n}\n\nstruct Human;\n\nimpl Pilot for Human {\n    fn fly(&self) -> String {\n        String::from(&quot;This is your captain speaking.&quot;)\n    }\n}\n\nimpl Wizard for Human {\n    fn fly(&self) -> String {\n        String::from(&quot;Up!&quot;)\n    }\n}\n\nimpl Human {\n    fn fly(&self) -> String {\n        String::from(&quot;*waving arms furiously*&quot;)\n    }\n}\n\nfn main() {\n    let person = Human;\n\n    assert_eq!(__, &quot;This is your captain speaking.&quot;);\n    assert_eq!(__, &quot;Up!&quot;);\n\n    assert_eq!(__, &quot;*waving arms furiously*&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `70034131973929070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Pilot <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Wizard <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Human<span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Pilot <span class="token keyword">for</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"This is your captain speaking."</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Wizard <span class="token keyword">for</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Up!"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"*waving arms furiously*"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> person <span class="token operator">=</span> Human<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token string">"This is your captain speaking."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token string">"Up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token string">"*waving arms furiously*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-155"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-155" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58843504187542160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Pilot {\n    fn fly(&self) -> String;\n}\n\ntrait Wizard {\n    fn fly(&self) -> String;\n}\n\nstruct Human;\n\nimpl Pilot for Human {\n    fn fly(&self) -> String {\n        String::from(&quot;This is your captain speaking.&quot;)\n    }\n}\n\nimpl Wizard for Human {\n    fn fly(&self) -> String {\n        String::from(&quot;Up!&quot;)\n    }\n}\n\nimpl Human {\n    fn fly(&self) -> String {\n        String::from(&quot;*waving arms furiously*&quot;)\n    }\n}\n\nfn main() {\n    let person = Human;\n\n    assert_eq!(Pilot::fly(&person), &quot;This is your captain speaking.&quot;);\n    assert_eq!(Wizard::fly(&person), &quot;Up!&quot;);\n\n    assert_eq!(person.fly(), &quot;*waving arms furiously*&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `58843504187542160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Pilot <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Wizard <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Human<span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Pilot <span class="token keyword">for</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"This is your captain speaking."</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Wizard <span class="token keyword">for</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Up!"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Human <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"*waving arms furiously*"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> person <span class="token operator">=</span> Human<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Pilot<span class="token punctuation">::</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"This is your captain speaking."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>Wizard<span class="token punctuation">::</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Up!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"*waving arms furiously*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-20"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>有些时候我们希望在特征上实现类似继承的特性，例如让一个特征 A 使用另一个特征 B 的功能。这种情况下，一个类型要实现特征 A 首先要实现特征 B， 特征 B 就被称为 supertrait</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80195829594140620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Person {\n    fn name(&self) -> String;\n}\n\n// Person 是 Student 的 supertrait .\n// 实现 Student 需要同时实现 Person.\ntrait Student: Person {\n    fn university(&self) -> String;\n}\n\ntrait Programmer {\n    fn fav_language(&self) -> String;\n}\n\n// CompSciStudent (computer science student) 是 Programmer\n// 和 Student 的 subtrait. 实现 CompSciStudent 需要先实现这两个 supertraits.\ntrait CompSciStudent: Programmer + Student {\n    fn git_username(&self) -> String;\n}\n\nfn comp_sci_student_greeting(student: &dyn CompSciStudent) -> String {\n    format!(\n        &quot;My name is {} and I attend {}. My favorite language is {}. My Git username is {}&quot;,\n        student.name(),\n        student.university(),\n        student.fav_language(),\n        student.git_username()\n    )\n}\n\nstruct CSStudent {\n    name: String,\n    university: String,\n    fav_language: String,\n    git_username: String\n}\n\n// 为 CSStudent 实现所需的特征\nimpl ...\n\nfn main() {\n    let student = CSStudent {\n        name: &quot;Sunfei&quot;.to_string(),\n        university: &quot;XXX&quot;.to_string(),\n        fav_language: &quot;Rust&quot;.to_string(),\n        git_username: &quot;sunface&quot;.to_string()\n    };\n\n    // 填空\n    println!(&quot;{}&quot;, comp_sci_student_greeting(__));\n}`, `80195829594140620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Person <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Person 是 Student 的 supertrait .</span>\n<span class="token comment">// 实现 Student 需要同时实现 Person.</span>\n<span class="token keyword">trait</span> Student<span class="token punctuation">:</span> Person <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">university</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Programmer <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fav_language</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// CompSciStudent (computer science student) 是 Programmer</span>\n<span class="token comment">// 和 Student 的 subtrait. 实现 CompSciStudent 需要先实现这两个 supertraits.</span>\n<span class="token keyword">trait</span> CompSciStudent<span class="token punctuation">:</span> Programmer <span class="token operator">+</span> Student <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">git_username</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">comp_sci_student_greeting</span><span class="token punctuation">(</span>student<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">dyn</span> CompSciStudent<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span>\n        <span class="token string">"My name is {} and I attend {}. My favorite language is {}. My Git username is {}"</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">university</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">fav_language</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">git_username</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> CSStudent <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    university<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    fav_language<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    git_username<span class="token punctuation">:</span> String\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 为 CSStudent 实现所需的特征</span>\n<span class="token keyword">impl</span> <span class="token punctuation">...</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> student <span class="token operator">=</span> CSStudent <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> <span class="token string">"Sunfei"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        university<span class="token punctuation">:</span> <span class="token string">"XXX"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        fav_language<span class="token punctuation">:</span> <span class="token string">"Rust"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        git_username<span class="token punctuation">:</span> <span class="token string">"sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token function">comp_sci_student_greeting</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-156"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-156" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78030983632884860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait Person {\n    fn name(&self) -> String;\n}\n\n// Person 是 Student 的 supertrait\n// 实现 Student 需要同时实现 Person\ntrait Student: Person {\n    fn university(&self) -> String;\n}\n\ntrait Programmer {\n    fn fav_language(&self) -> String;\n}\n\n// CompSciStudent (computer science student) 是 Programmer\n// 和 Student 的 subtrait 实现 CompSciStudent 需要先实现这两个 supertraits\ntrait CompSciStudent: Programmer + Student {\n    fn git_username(&self) -> String;\n}\n\nfn comp_sci_student_greeting(student: &dyn CompSciStudent) -> String {\n    format!(\n        &quot;My name is {} and I attend {}. My favorite language is {}. My Git username is {}&quot;,\n        student.name(),\n        student.university(),\n        student.fav_language(),\n        student.git_username()\n    )\n}\n\nstruct CSStudent {\n    name: String,\n    university: String,\n    fav_language: String,\n    git_username: String,\n}\n\nimpl Person for CSStudent {\n    fn name(&self) -> String {\n        self.name.clone()\n    }\n}\n\nimpl Student for CSStudent {\n    fn university(&self) -> String {\n        self.university.clone()\n    }\n}\n\nimpl Programmer for CSStudent {\n    fn fav_language(&self) -> String {\n        self.fav_language.clone()\n    }\n}\n\n// 为 CSStudent 实现所需的特征\nimpl CompSciStudent for CSStudent {\n    fn git_username(&self) -> String {\n        self.git_username.clone()\n    }\n}\n\nfn main() {\n    let student = CSStudent {\n        name: &quot;Sunfei&quot;.to_string(),\n        university: &quot;XXX&quot;.to_string(),\n        fav_language: &quot;Rust&quot;.to_string(),\n        git_username: &quot;sunface&quot;.to_string(),\n    };\n\n    // 填空\n    println!(&quot;{}&quot;, comp_sci_student_greeting(&student));\n}`, `78030983632884860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> Person <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Person 是 Student 的 supertrait</span>\n<span class="token comment">// 实现 Student 需要同时实现 Person</span>\n<span class="token keyword">trait</span> Student<span class="token punctuation">:</span> Person <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">university</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">trait</span> Programmer <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fav_language</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// CompSciStudent (computer science student) 是 Programmer</span>\n<span class="token comment">// 和 Student 的 subtrait 实现 CompSciStudent 需要先实现这两个 supertraits</span>\n<span class="token keyword">trait</span> CompSciStudent<span class="token punctuation">:</span> Programmer <span class="token operator">+</span> Student <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">git_username</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">comp_sci_student_greeting</span><span class="token punctuation">(</span>student<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">dyn</span> CompSciStudent<span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    <span class="token function">format!</span><span class="token punctuation">(</span>\n        <span class="token string">"My name is {} and I attend {}. My favorite language is {}. My Git username is {}"</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">university</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">fav_language</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        student<span class="token punctuation">.</span><span class="token function">git_username</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> CSStudent <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    university<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    fav_language<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    git_username<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Person <span class="token keyword">for</span> CSStudent <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Student <span class="token keyword">for</span> CSStudent <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">university</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>university<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Programmer <span class="token keyword">for</span> CSStudent <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fav_language</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>fav_language<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 为 CSStudent 实现所需的特征</span>\n<span class="token keyword">impl</span> CompSciStudent <span class="token keyword">for</span> CSStudent <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">git_username</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>git_username<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> student <span class="token operator">=</span> CSStudent <span class="token punctuation">{</span>\n        name<span class="token punctuation">:</span> <span class="token string">"Sunfei"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        university<span class="token punctuation">:</span> <span class="token string">"XXX"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        fav_language<span class="token punctuation">:</span> <span class="token string">"Rust"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        git_username<span class="token punctuation">:</span> <span class="token string">"sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 填空</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token function">comp_sci_student_greeting</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>student<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-20"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>关于孤儿原则的详细介绍请参见 <a href="https://course.rs/basic/trait/trait#%E7%89%B9%E5%BE%81%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%AE%9E%E7%8E%B0%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%AD%A4%E5%84%BF%E8%A7%84%E5%88%99" target="_blank" rel="nofollow noreferrer noopener">特征定义与实现的位置孤儿规则</a> 和 <a href="https://course.rs/basic/trait/advance-trait.html#%E5%9C%A8%E5%A4%96%E9%83%A8%E7%B1%BB%E5%9E%8B%E4%B8%8A%E5%AE%9E%E7%8E%B0%E5%A4%96%E9%83%A8%E7%89%B9%E5%BE%81newtype" target="_blank" rel="nofollow noreferrer noopener">在外部类型上实现外部特征</a>。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16040395836667787000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt;\n\n// 定义一个 newtype \\`Pretty\\`\n\n\nimpl fmt::Display for Pretty {\n    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n        write!(f, &quot;\\&quot;{}\\&quot;&quot;, self.0.clone() + &quot;, world&quot;)\n    }\n}\n\nfn main() {\n    let w = Pretty(&quot;hello&quot;.to_string());\n    println!(&quot;w = {}&quot;, w);\n}`, `16040395836667787000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">;</span>\n\n<span class="token comment">// 定义一个 newtype `Pretty`</span>\n\n\n<span class="token keyword">impl</span> fmt<span class="token punctuation">::</span>Display <span class="token keyword">for</span> Pretty <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> fmt<span class="token punctuation">::</span>Formatter<span class="token punctuation">)</span> <span class="token punctuation">-></span> fmt<span class="token punctuation">::</span>Result <span class="token punctuation">{</span>\n        <span class="token function">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"\\"{}\\""</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", world"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> w <span class="token operator">=</span> <span class="token function">Pretty</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"w = {}"</span><span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-157"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-157" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32659613257840325000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt;\n\n// 定义一个 newtype \\`Pretty\\`\n\nstruct Pretty(String);\n\nimpl fmt::Display for Pretty {\n    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n        write!(f, &quot;\\&quot;{}\\&quot;&quot;, self.0.clone() + &quot;, world&quot;)\n    }\n}\n\nfn main() {\n    let w = Pretty(&quot;hello&quot;.to_string());\n    println!(&quot;w = {}&quot;, w);\n}`, `32659613257840325000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">;</span>\n\n<span class="token comment">// 定义一个 newtype `Pretty`</span>\n\n<span class="token keyword">struct</span> <span class="token function">Pretty</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> fmt<span class="token punctuation">::</span>Display <span class="token keyword">for</span> Pretty <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> fmt<span class="token punctuation">::</span>Formatter<span class="token punctuation">)</span> <span class="token punctuation">-></span> fmt<span class="token punctuation">::</span>Result <span class="token punctuation">{</span>\n        <span class="token function">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"\\"{}\\""</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", world"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> w <span class="token operator">=</span> <span class="token function">Pretty</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"w = {}"</span><span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="集合类型"><a href="#%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>集合类型</h1>\n<h2 id="动态字符串-string"><a href="#%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2-string" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>动态字符串 String</h2>\n<h3 id="问题一-22"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>std::string::String 是 UTF-8 编码、可增长的动态字符串，它也是我们日常开发中最常用的字符串类型，同时对于它所拥有的内容拥有所有权</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40999725304639290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\n// 1. 不要使用 \\`to_string()\\`\n// 2. 不要添加/删除任何代码行\nfn main() {\n    let mut s: String = &quot;hello, &quot;;\n    s.push_str(&quot;world&quot;.to_string());\n    s.push(__);\n\n    move_ownership(s);\n\n    assert_eq!(s, &quot;hello, world!&quot;);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn move_ownership(s: String) {\n    println!(&quot;ownership of \\&quot;{}\\&quot; is moved here!&quot;, s)\n}`, `40999725304639290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token comment">// 1. 不要使用 `to_string()`</span>\n<span class="token comment">// 2. 不要添加/删除任何代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> <span class="token string">"hello, "</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">move_ownership</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">move_ownership</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ownership of \\"{}\\" is moved here!"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-158"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-158" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67089587073513540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\n// 1. 不要使用 \\`to_string()\\`\n// 2. 不要添加/删除任何代码行\nfn main() {\n    let mut s: String = String::from(&quot;hello, &quot;);\n    s.push_str(&&quot;world&quot;.to_string());\n    s.push(\'!\');\n\n    move_ownership(&s);\n\n    assert_eq!(s, &quot;hello, world!&quot;);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn move_ownership(s: &str) {\n    println!(&quot;ownership of \\&quot;{}\\&quot; is moved here!&quot;, s)\n}`, `67089587073513540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token comment">// 1. 不要使用 `to_string()`</span>\n<span class="token comment">// 2. 不要添加/删除任何代码行</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token string">"world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">move_ownership</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">move_ownership</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ownership of \\"{}\\" is moved here!"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-22"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>虽然 String 的底层是 <code class="language-text">Vec&lt;u8&gt;</code> 也就是字节数组的形式存储的，但是它是基于 UTF-8 编码的字符序列。String 分配在堆上、可增长且不是以 null 结尾</p>\n<p>而 &#x26;str 是切片引用类型 <code class="language-text">&amp;[u8]</code>，指向一个合法的 UTF-8 字符序列，总之 &#x26;str 和 String 的关系类似于 <code class="language-text">&amp;[T]</code> 和 <code class="language-text">Vec&lt;T&gt;</code> 。</p>\n<p>参考：<a href="https://course.rs/difficulties/string.html" target="_blank" rel="nofollow noreferrer noopener">易混淆概念解析 - &#x26;str 和 String</a>。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98232073742842400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n   let mut s = String::from(&quot;hello, world&quot;);\n\n   let slice1: &str = __; // 使用两种方法\n   assert_eq!(slice1, &quot;hello, world&quot;);\n\n   let slice2 = __;\n   assert_eq!(slice2, &quot;hello&quot;);\n\n   let slice3: __ = __;\n   slice3.push(\'!\');\n   assert_eq!(slice3, &quot;hello, world!&quot;);\n\n   println!(&quot;Success!&quot;)\n}`, `98232073742842400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> slice1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> __<span class="token punctuation">;</span> <span class="token comment">// 使用两种方法</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> <span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> slice2 <span class="token operator">=</span> __<span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice2<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> slice3<span class="token punctuation">:</span> __ <span class="token operator">=</span> __<span class="token punctuation">;</span>\n   slice3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice3<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-159"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-159" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52204164091699590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut s = String::from(&quot;hello, world&quot;);\n\n    let slice1: &str = &s; // 使用两种方法\n    assert_eq!(slice1, &quot;hello, world&quot;);\n\n    let slice2 = &s[0..5];\n    assert_eq!(slice2, &quot;hello&quot;);\n\n    let mut slice3: String = s;\n    slice3.push(\'!\');\n    assert_eq!(slice3, &quot;hello, world!&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `52204164091699590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice1<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span> <span class="token comment">// 使用两种方法</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> <span class="token string">"hello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice2<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> slice3<span class="token punctuation">:</span> String <span class="token operator">=</span> s<span class="token punctuation">;</span>\n    slice3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">\'!\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice3<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-22"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99427563655668560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 问题:  我们的代码中发生了多少次堆内存分配？\n// 你的回答:\nfn main() {\n    // 基于 \\`&str\\` 类型创建一个 String,\n    // 字符串字面量的类型是 \\`&str\\`\n   let s: String = String::from(&quot;hello, world!&quot;);\n\n   // 创建一个切片引用指向 String \\`s\\`\n   let slice: &str = &s;\n\n   // 基于刚创建的切片来创建一个 String\n   let s: String = slice.to_string();\n\n   assert_eq!(s, &quot;hello, world!&quot;);\n\n   println!(&quot;Success!&quot;)\n}`, `99427563655668560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 问题:  我们的代码中发生了多少次堆内存分配？</span>\n<span class="token comment">// 你的回答:</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 基于 `&amp;str` 类型创建一个 String,</span>\n    <span class="token comment">// 字符串字面量的类型是 `&amp;str`</span>\n   <span class="token keyword">let</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 创建一个切片引用指向 String `s`</span>\n   <span class="token keyword">let</span> slice<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n\n   <span class="token comment">// 基于刚创建的切片来创建一个 String</span>\n   <span class="token keyword">let</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-160"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-160" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91516429915921400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 问题:  我们的代码中发生了多少次堆内存分配？\n// 你的回答: 2\nfn main() {\n    // 基于 \\`&str\\` 类型创建一个 String,\n    // 字符串字面量的类型是 \\`&str\\`\n   let s: String = String::from(&quot;hello, world!&quot;);\n\n   // 创建一个切片引用指向 String \\`s\\`\n   let slice: &str = &s;\n\n   // 基于刚创建的切片来创建一个 String\n   let s: String = slice.to_string();\n\n   assert_eq!(s, &quot;hello, world!&quot;);\n\n   println!(&quot;Success!&quot;)\n}`, `91516429915921400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 问题:  我们的代码中发生了多少次堆内存分配？</span>\n<span class="token comment">// 你的回答: 2</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 基于 `&amp;str` 类型创建一个 String,</span>\n    <span class="token comment">// 字符串字面量的类型是 `&amp;str`</span>\n   <span class="token keyword">let</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 创建一个切片引用指向 String `s`</span>\n   <span class="token keyword">let</span> slice<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n\n   <span class="token comment">// 基于刚创建的切片来创建一个 String</span>\n   <span class="token keyword">let</span> s<span class="token punctuation">:</span> String <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-21"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>由于 String 都是 UTF-8 编码的，这会带来几个影响:</p>\n<ul>\n<li>如果你需要的是非 UTF-8 字符串，可以考虑 <a href="https://doc.rust-lang.org/stable/std/ffi/struct.OsString.html" target="_blank" rel="nofollow noreferrer noopener">OsString</a></li>\n<li>无法通过索引的方式访问一个 String</li>\n</ul>\n<p>具体请看 <a href="https://course.rs/basic/compound-type/string-slice.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B4%A2%E5%BC%95" target="_blank" rel="nofollow noreferrer noopener">字符串索引</a></p>\n<p>我们无法通过索引的方式访问字符串中的某个字符，但是可以通过切片的方式来获取字符串的某一部分 <code class="language-text">&amp;s1[start..end]</code></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6422127883995033000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nfn main() {\n    let s = String::from(&quot;hello, 世界&quot;);\n    let slice1 = s[0]; //提示: \\`h\\` 在 UTF-8 编码中只占用 1 个字节\n    assert_eq!(slice1, &quot;h&quot;);\n\n    let slice2 = &s[3..5];// 提示: \\`中\\` 在 UTF-8 编码中占用 3 个字节\n    assert_eq!(slice2, &quot;世&quot;);\n\n    // 迭代 s 中的所有字符\n    for (i, c) in s.__ {\n        if i == 7 {\n            assert_eq!(c, \'世\')\n        }\n    }\n\n    println!(&quot;Success!&quot;)\n}`, `6422127883995033000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, 世界"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//提示: `h` 在 UTF-8 编码中只占用 1 个字节</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 提示: `中` 在 UTF-8 编码中占用 3 个字节</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice2<span class="token punctuation">,</span> <span class="token string">"世"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 迭代 s 中的所有字符</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">in</span> s<span class="token punctuation">.</span>__ <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">7</span> <span class="token punctuation">{</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token char string">\'世\'</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-161"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-161" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29966853500852175000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nfn main() {\n    let s = String::from(&quot;hello, 世界&quot;);\n    let slice1 = &s[0..1]; //提示: \\`h\\` 在 UTF-8 编码中只占用 1 个字节\n    assert_eq!(slice1, &quot;h&quot;);\n\n    let slice2 = &s[7..10]; // 提示: \\`中\\` 在 UTF-8 编码中占用 3 个字节\n    assert_eq!(slice2, &quot;世&quot;);\n\n    // 迭代 s 中的所有字符\n    for (i, c) in s.chars().enumerate() {\n        if i == 7 {\n            assert_eq!(c, \'世\')\n        }\n    }\n\n    println!(&quot;Success!&quot;)\n}`, `29966853500852175000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello, 世界"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//提示: `h` 在 UTF-8 编码中只占用 1 个字节</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">..</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 提示: `中` 在 UTF-8 编码中占用 3 个字节</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice2<span class="token punctuation">,</span> <span class="token string">"世"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 迭代 s 中的所有字符</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token keyword">in</span> s<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">7</span> <span class="token punctuation">{</span>\n            <span class="token function">assert_eq!</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token char string">\'世\'</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-21"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>我们可以使用 <a href="https://docs.rs/utf8_slice/1.0.0/utf8_slice/fn.slice.html" target="_blank" rel="nofollow noreferrer noopener">utf8_slice</a> 来按照字符的自然索引方式对 UTF-8 字符串进行切片访问，与之前的切片方式相比，它索引的是字符，而之前的方式索引的是字节</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92280123374955020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use utf8_slice;\nfn main() {\n   let s = &quot;The 🚀 goes to the 🌑!&quot;;\n\n   let rocket = utf8_slice::slice(s, 4, 5);\n   // Will equal &quot;🚀&quot;\n}`, `92280123374955020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> utf8_slice<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"The 🚀 goes to the 🌑!"</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> rocket <span class="token operator">=</span> utf8_slice<span class="token punctuation">::</span><span class="token function">slice</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token comment">// Will equal "🚀"</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52108733929569270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 提示: 也许你需要使用 from_utf8 方法\n// 填空\nfn main() {\n    let mut s = String::new();\n    __;\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // 将字节数组转换成 String\n    let s1 = __;\n\n\n    assert_eq!(s, s1);\n\n    println!(&quot;Success!&quot;)\n}`, `52108733929569270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 提示: 也许你需要使用 from_utf8 方法</span>\n<span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    __<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 将字节数组转换成 String</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> __<span class="token punctuation">;</span>\n\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-162"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-162" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7231099757749204000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 提示: 也许你需要使用 from_utf8 方法\n// 填空\nfn main() {\n    let mut s = String::new();\n    s.push_str(&quot;hello&quot;);\n\n    let v = vec![104, 101, 108, 108, 111];\n\n    // 将字节数组转换成 String\n    let s1 = String::from_utf8(v).unwrap();\n\n    assert_eq!(s, s1);\n\n    println!(&quot;Success!&quot;)\n}`, `7231099757749204000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 提示: 也许你需要使用 from_utf8 方法</span>\n<span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 将字节数组转换成 String</span>\n    <span class="token keyword">let</span> s1 <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from_utf8</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-18"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>事实上 String 是一个智能指针，它作为一个结构体存储在栈上，然后指向存储在堆上的字符串底层数据</p>\n<p>存储在栈上的智能指针结构体由三部分组成：一个指针只指向堆上的字节数组，已使用的长度以及已分配的容量 capacity (已使用的长度小于等于已分配的容量，当容量不够时，会重新分配内存空间)</p>\n<p>如果 String 的当前容量足够，那么添加字符将不会导致新的内存分配</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82425937495894490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改下面的代码以打印如下内容:\n// 25\n// 25\n// 25\n// 循环中不会发生任何内存分配\nfn main() {\n    let mut s = String::new();\n\n    println!(&quot;{}&quot;, s.capacity());\n\n    for _ in 0..2 {\n        s.push_str(&quot;hello&quot;);\n        println!(&quot;{}&quot;, s.capacity());\n    }\n\n    println!(&quot;Success!&quot;)\n}`, `82425937495894490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改下面的代码以打印如下内容:</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 循环中不会发生任何内存分配</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>\n        s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-163"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-163" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98244705714725240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修改下面的代码以打印如下内容:\n// 25\n// 25\n// 25\n// 循环中不会发生任何内存分配\nfn main() {\n    let mut s = String::with_capacity(25);\n\n    println!(&quot;{}&quot;, s.capacity());\n\n    for _ in 0..2 {\n        s.push_str(&quot;hello&quot;);\n        println!(&quot;{}&quot;, s.capacity());\n    }\n\n    println!(&quot;Success!&quot;)\n}`, `98244705714725240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修改下面的代码以打印如下内容:</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 25</span>\n<span class="token comment">// 循环中不会发生任何内存分配</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>\n        s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-10"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78589384389918490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::mem;\n\nfn main() {\n    let story = String::from(&quot;Rust By Practice&quot;);\n\n    // 阻止 String 的数据被自动 drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.__();\n    let len = story.__();\n    let capacity = story.__();\n\n    assert_eq!(16, len);\n\n    // 我们可以基于 ptr 指针、长度和容量来重新构建 String.\n    // 这种操作必须标记为 unsafe，因为我们需要自己来确保这里的操作是安全的\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(&quot;Success!&quot;)\n}`, `78589384389918490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> story <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Rust By Practice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 阻止 String 的数据被自动 drop</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> story <span class="token operator">=</span> mem<span class="token punctuation">::</span>ManuallyDrop<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>story<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> ptr <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> len <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> capacity <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 我们可以基于 ptr 指针、长度和容量来重新构建 String.</span>\n    <span class="token comment">// 这种操作必须标记为 unsafe，因为我们需要自己来确保这里的操作是安全的</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token keyword">unsafe</span> <span class="token punctuation">{</span> String<span class="token punctuation">::</span><span class="token function">from_raw_parts</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> len<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>story<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-164"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-164" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25251382329204960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::mem;\n\nfn main() {\n    let story = String::from(&quot;Rust By Practice&quot;);\n\n    // 阻止 String 的数据被自动 drop\n    let mut story = mem::ManuallyDrop::new(story);\n\n    let ptr = story.as_mut_ptr();\n    let len = story.len();\n    let capacity = story.capacity();\n\n    assert_eq!(16, len);\n\n    // 我们可以基于 ptr 指针、长度和容量来重新构建 String.\n    // 这种操作必须标记为 unsafe，因为我们需要自己来确保这里的操作是安全的\n    let s = unsafe { String::from_raw_parts(ptr, len, capacity) };\n\n    assert_eq!(*story, s);\n\n    println!(&quot;Success!&quot;)\n}`, `25251382329204960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>mem<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> story <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Rust By Practice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 阻止 String 的数据被自动 drop</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> story <span class="token operator">=</span> mem<span class="token punctuation">::</span>ManuallyDrop<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>story<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> ptr <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">as_mut_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> len <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> capacity <span class="token operator">=</span> story<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 我们可以基于 ptr 指针、长度和容量来重新构建 String.</span>\n    <span class="token comment">// 这种操作必须标记为 unsafe，因为我们需要自己来确保这里的操作是安全的</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token keyword">unsafe</span> <span class="token punctuation">{</span> String<span class="token punctuation">::</span><span class="token function">from_raw_parts</span><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> len<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>story<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="动态数组-vector"><a href="#%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84-vector" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>动态数组 Vector</h2>\n<p>相比 <code class="language-text">[T; N]</code> 形式的数组，Vector 最大的特点就是可以动态调整长度</p>\n<h3 id="问题一-23"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27406569516894663000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [u8; 3] = [1, 2, 3];\n\n    let v = Vec::from(arr);\n    is_vec(v);\n\n    let v = vec![1, 2, 3];\n    is_vec(v);\n\n    // vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...\n    let v = vec!(1, 2, 3);\n    is_vec(v);\n\n    // ...在下面的代码中, v 是 Vec<[u8; 3]> , 而不是 Vec<u8>\n    // 使用 Vec::new 和 \\`for\\` 来重写下面这段代码\n    let v1 = vec!(arr);\n    is_vec(v1);\n\n    assert_eq!(v, v1);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn is_vec(v: Vec<u8>) {}`, `27406569516894663000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>u8<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ...在下面的代码中, v 是 Vec&lt;[u8; 3]> , 而不是 Vec&lt;u8></span>\n    <span class="token comment">// 使用 Vec::new 和 `for` 来重写下面这段代码</span>\n    <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">is_vec</span><span class="token punctuation">(</span>v<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-165"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-165" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86956079059063300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let arr: [u8; 3] = [1, 2, 3];\n\n    let v = Vec::from(arr);\n    is_vec(&v);\n\n    let v = vec![1, 2, 3];\n    is_vec(&v);\n\n    // vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...\n    let v = vec!(1, 2, 3);\n    is_vec(&v);\n\n    // vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...\n    let v = vec!{1, 2, 3};\n    is_vec(&v);\n\n    // ...在下面的代码中, v 是 Vec<[u8; 3]> , 而不是 Vec<u8>\n    // 使用 Vec::new 和 \\`for\\` 来重写下面这段代码\n    let mut v1 = Vec::new();\n    for i in &v {\n        v1.push(*i)\n    }\n    is_vec(&v1);\n\n    assert_eq!(v, v1);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn is_vec(v: &Vec<u8>) {}`, `86956079059063300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> arr<span class="token punctuation">:</span> <span class="token punctuation">[</span>u8<span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// vec!(..) 和 vec![..] 是同样的宏，宏可以使用 []、()、{}三种形式，因此...</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token macro-rules function">vec!</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ...在下面的代码中, v 是 Vec&lt;[u8; 3]> , 而不是 Vec&lt;u8></span>\n    <span class="token comment">// 使用 Vec::new 和 `for` 来重写下面这段代码</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v1 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">&amp;</span>v <span class="token punctuation">{</span>\n        v1<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">*</span>i<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">is_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">is_vec</span><span class="token punctuation">(</span>v<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-23"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>Vec 可以使用 extend 方法进行扩展</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84494021525271990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut v1 = Vec::from([1, 2, 4]);\n    v1.pop();\n    v1.push(3);\n\n    let mut v2 = Vec::new();\n    v2.__;\n\n    assert_eq!(v1, v2);\n\n    println!(&quot;Success!&quot;)\n}`, `84494021525271990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v1 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v1<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v1<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v2 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v2<span class="token punctuation">.</span>__<span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-166"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-166" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63943596217531830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    let mut v1 = Vec::from([1, 2, 4]);\n    v1.pop();\n    v1.push(3);\n\n    let mut v2 = Vec::new();\n    v2.extend(&v1);\n\n    assert_eq!(v1, v2);\n\n    println!(&quot;Success!&quot;)\n}`, `63943596217531830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v1 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v1<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v1<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v2 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    v2<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-23"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>只要为 Vec 实现了 <code class="language-text">From&lt;T&gt;</code> 特征，那么 T 就可以被转换成 Vec。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11492227337005124000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n   // array -> Vec\n   // impl From<[T; N]> for Vec\n   let arr = [1, 2, 3];\n   let v1 = __(arr);\n   let v2: Vec<i32> = arr.__();\n\n   assert_eq!(v1, v2);\n\n\n   // String -> Vec\n   // impl From<String> for Vec\n   let s = &quot;hello&quot;.to_string();\n   let v1: Vec<u8> = s.__();\n\n   let s = &quot;hello&quot;.to_string();\n   let v2 = s.into_bytes();\n   assert_eq!(v1, v2);\n\n   // impl<\'_> From<&\'_ str> for Vec\n   let s = &quot;hello&quot;;\n   let v3 = Vec::__(s);\n   assert_eq!(v2, v3);\n\n   // 迭代器 Iterators 可以通过 collect 变成 Vec\n   let v4: Vec<i32> = [0; 10].into_iter().collect();\n   assert_eq!(v4, vec![0; 10]);\n\n   println!(&quot;Success!&quot;)\n}`, `11492227337005124000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token comment">// array -> Vec</span>\n   <span class="token comment">// impl From&lt;[T; N]> for Vec</span>\n   <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token function">__</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v2<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n   <span class="token comment">// String -> Vec</span>\n   <span class="token comment">// impl From&lt;String> for Vec</span>\n   <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v1<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v2 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">into_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// impl&lt;\'_> From&lt;&amp;\'_ str> for Vec</span>\n   <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n   <span class="token keyword">let</span> v3 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">__</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 迭代器 Iterators 可以通过 collect 变成 Vec</span>\n   <span class="token keyword">let</span> v4<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-167"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-167" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48752379564077520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn main() {\n    // array -> Vec\n    // impl From<[T; N]> for Vec\n    let arr = [1, 2, 3];\n    let v1 = Vec::from(arr);\n    let v2: Vec<i32> = arr.into();\n\n    assert_eq!(v1, v2);\n\n    // String -> Vec\n    // impl From<String> for Vec\n    let s = &quot;hello&quot;.to_string();\n    let v1: Vec<u8> = s.into();\n\n    let s = &quot;hello&quot;.to_string();\n    let v2 = s.into_bytes();\n    assert_eq!(v1, v2);\n\n    // impl<\'_> From<&\'_ str> for Vec\n    let s = &quot;hello&quot;;\n    let v3 = Vec::from(s);\n    assert_eq!(v2, v3);\n\n    // 迭代器 Iterators 可以通过 collect 变成 Vec\n    let v4: Vec<i32> = [0; 10].into_iter().collect();\n    assert_eq!(v4, vec![0; 10]);\n\n    println!(&quot;Success!&quot;)\n}`, `48752379564077520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// array -> Vec</span>\n    <span class="token comment">// impl From&lt;[T; N]> for Vec</span>\n    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v1 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v2<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// String -> Vec</span>\n    <span class="token comment">// impl From&lt;String> for Vec</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v1<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>u8<span class="token operator">></span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v2 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">into_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// impl&lt;\'_> From&lt;&amp;\'_ str> for Vec</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> v3 <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 迭代器 Iterators 可以通过 collect 变成 Vec</span>\n    <span class="token keyword">let</span> v4<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-22"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64217349784335440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误并实现缺失的代码\nfn main() {\n    let mut v = Vec::from([1, 2, 3]);\n    for i in 0..5 {\n        println!(&quot;{:?}&quot;, v[i])\n    }\n\n    for i in 0..5 {\n       // 实现这里的代码...\n    }\n\n    assert_eq!(v, vec![2, 3, 4, 5, 6]);\n\n    println!(&quot;Success!&quot;)\n}`, `64217349784335440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误并实现缺失的代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>\n       <span class="token comment">// 实现这里的代码...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-168"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-168" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19565080822347360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误并实现缺失的代码\nfn main() {\n    let mut v = Vec::from([1, 2, 3]);\n    for i in 0..5 {\n        println!(&quot;{:?}&quot;, v.get(i))\n    }\n\n    for i in 0..5 {\n        // match i {\n        //     0..=2 => v[i] += 1,\n        //     _ => v.push(i + 2)\n        // }\n\n        if let Some(x) = v.get(i) {\n            v[i] = x + 1\n        } else {\n            v.push(i + 2)\n        }\n        // 实现这里的代码...\n    }\n\n    assert_eq!(v, vec![2, 3, 4, 5, 6]);\n\n    println!(&quot;Success!&quot;)\n}`, `19565080822347360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误并实现缺失的代码</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>\n        <span class="token comment">// match i {</span>\n        <span class="token comment">//     0..=2 => v[i] += 1,</span>\n        <span class="token comment">//     _ => v.push(i + 2)</span>\n        <span class="token comment">// }</span>\n\n        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token function">Some</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            v<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">// 实现这里的代码...</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-22"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>与 String 的切片类似，Vec 也可以使用切片。如果说 Vec 是可变的，那它的切片就是不可变或者说只读的，我们可以通过 &#x26; 来获取切片</p>\n<p>在 Rust 中，将切片作为参数进行传递是更常见的使用方式，例如当一个函数只需要可读性时，那传递 Vec 或 String 的切片 <code class="language-text">&amp;[T]</code> / <code class="language-text">&amp;str</code> 会更加适合</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4616910414062403000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut v = vec![1, 2, 3];\n\n    let slice1 = &v[..];\n    // 越界访问将导致 panic.\n    // 修改时必须使用 \\`v.len\\`\n    let slice2 = &v[0..4];\n\n    assert_eq!(slice1, slice2);\n\n    // 切片是只读的\n    // 注意：切片和 \\`&Vec\\` 是不同的类型，后者仅仅是 \\`Vec\\` 的引用，并可以通过解引用直接获取 \\`Vec\\`\n    let vec_ref: &mut Vec<i32> = &mut v;\n    (*vec_ref).push(4);\n    let slice3 = &mut v[0..3];\n    slice3.push(4);\n\n    assert_eq!(slice3, &[1, 2, 3, 4]);\n\n    println!(&quot;Success!&quot;)\n}`, `4616910414062403000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 越界访问将导致 panic.</span>\n    <span class="token comment">// 修改时必须使用 `v.len`</span>\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> slice2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 切片是只读的</span>\n    <span class="token comment">// 注意：切片和 `&amp;Vec` 是不同的类型，后者仅仅是 `Vec` 的引用，并可以通过解引用直接获取 `Vec`</span>\n    <span class="token keyword">let</span> vec_ref<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">;</span>\n    <span class="token punctuation">(</span><span class="token operator">*</span>vec_ref<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> slice3 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    slice3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice3<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-169"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-169" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61443343934204320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut v = vec![1, 2, 3];\n\n    let slice1 = &v[..];\n    // 越界访问将导致 panic.\n    // 修改时必须使用 \\`v.len\\`\n    let slice2 = &v[0..v.len()];\n\n    assert_eq!(slice1, slice2);\n\n    // 切片是只读的\n    // 注意：切片和 \\`&Vec\\` 是不同的类型，后者仅仅是 \\`Vec\\` 的引用，并可以通过解引用直接获取 \\`Vec\\`\n    let vec_ref: &mut Vec<i32> = &mut v;\n    (*vec_ref).push(4);\n    let slice3 = &mut v[0..];\n    // slice3.push(4);\n\n    assert_eq!(slice3, &[1, 2, 3, 4]);\n\n    println!(&quot;Success!&quot;)\n}`, `61443343934204320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> slice1 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// 越界访问将导致 panic.</span>\n    <span class="token comment">// 修改时必须使用 `v.len`</span>\n    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span>v<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> slice2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 切片是只读的</span>\n    <span class="token comment">// 注意：切片和 `&amp;Vec` 是不同的类型，后者仅仅是 `Vec` 的引用，并可以通过解引用直接获取 `Vec`</span>\n    <span class="token keyword">let</span> vec_ref<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> Vec<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">;</span>\n    <span class="token punctuation">(</span><span class="token operator">*</span>vec_ref<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> slice3 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">// slice3.push(4);</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>slice3<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-19"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>容量 capacity 是已经分配好的内存空间，用于存储未来添加到 Vec 中的元素。而长度 len 则是当前 Vec 中已经存储的元素数量。如果要添加新元素时，长度将要超过已有的容量，那容量会自动进行增长：Rust 会重新分配一块更大的内存空间，然后将之前的 Vec 拷贝过去，因此，这里就会发生新的内存分配（目前 Rust 的容量调整策略是加倍，例如 2 -> 4 -> 8 ..）。</p>\n<p>若这段代码会频繁发生，那频繁的内存分配会大幅影响我们系统的性能，最好的办法就是提前分配好足够的容量，尽量减少内存分配。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32031682227535495000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut vec = Vec::with_capacity(10);\n\n    assert_eq!(vec.len(), __);\n    assert_eq!(vec.capacity(), 10);\n\n    // 由于提前设置了足够的容量，这里的循环不会造成任何内存分配...\n    for i in 0..10 {\n        vec.push(i);\n    }\n    assert_eq!(vec.len(), __);\n    assert_eq!(vec.capacity(), __);\n\n    // ...但是下面的代码会造成新的内存分配\n    vec.push(11);\n    assert_eq!(vec.len(), 11);\n    assert!(vec.capacity() >= 11);\n\n\n    // 填写一个合适的值，在 \\`for\\` 循环运行的过程中，不会造成任何内存分配\n    let mut vec = Vec::with_capacity(__);\n    for i in 0..100 {\n        vec.push(i);\n    }\n\n    assert_eq!(vec.len(), __);\n    assert_eq!(vec.capacity(), __);\n\n    println!(&quot;Success!&quot;)\n}`, `32031682227535495000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 由于提前设置了足够的容量，这里的循环不会造成任何内存分配...</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>\n        vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ...但是下面的代码会造成新的内存分配</span>\n    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n    <span class="token comment">// 填写一个合适的值，在 `for` 循环运行的过程中，不会造成任何内存分配</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100</span> <span class="token punctuation">{</span>\n        vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-170"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-170" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54613195643506390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\nfn main() {\n    let mut vec = Vec::with_capacity(10);\n\n    assert_eq!(vec.len(), 0);\n    assert_eq!(vec.capacity(), 10);\n\n    // 由于提前设置了足够的容量，这里的循环不会造成任何内存分配...\n    for i in 0..10 {\n        vec.push(i);\n    }\n    assert_eq!(vec.len(), 10);\n    assert_eq!(vec.capacity(), 10);\n\n    // ...但是下面的代码会造成新的内存分配\n    vec.push(11);\n    assert_eq!(vec.len(), 11);\n    assert!(vec.capacity() >= 11);\n\n\n    // 填写一个合适的值，在 \\`for\\` 循环运行的过程中，不会造成任何内存分配\n    let mut vec = Vec::with_capacity(100);\n    for i in 0..100 {\n        vec.push(i);\n    }\n\n    assert_eq!(vec.len(), 100);\n    assert_eq!(vec.capacity(), 100);\n\n    println!(&quot;Success!&quot;)\n}`, `54613195643506390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 由于提前设置了足够的容量，这里的循环不会造成任何内存分配...</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>\n        vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ...但是下面的代码会造成新的内存分配</span>\n    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n    <span class="token comment">// 填写一个合适的值，在 `for` 循环运行的过程中，不会造成任何内存分配</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> Vec<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100</span> <span class="token punctuation">{</span>\n        vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-11"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<p>Vec 中的元素必须是相同的类型，例如以下代码会发生错误:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77252835636637240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let v = vec![1, 2.0, 3];\n}`, `77252835636637240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>但是我们可以使用枚举或特征对象来存储不同的类型</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44053616656111270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nenum IpAddr {\n    V4(String),\n    V6(String),\n}\nfn main() {\n    // 填空\n    let v : Vec<IpAddr>= __;\n\n    // 枚举的比较需要派生 PartialEq 特征\n    assert_eq!(v[0], IpAddr::V4(&quot;127.0.0.1&quot;.to_string()));\n    assert_eq!(v[1], IpAddr::V6(&quot;::1&quot;.to_string()));\n\n    println!(&quot;Success!&quot;)\n}`, `44053616656111270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> IpAddr <span class="token punctuation">{</span>\n    <span class="token function">V4</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">V6</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> v <span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>IpAddr<span class="token operator">>=</span> __<span class="token punctuation">;</span>\n\n    <span class="token comment">// 枚举的比较需要派生 PartialEq 特征</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> IpAddr<span class="token punctuation">::</span><span class="token function">V4</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> IpAddr<span class="token punctuation">::</span><span class="token function">V6</span><span class="token punctuation">(</span><span class="token string">"::1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-171"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-171" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56200970737738840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug, PartialEq)]\nenum IpAddr {\n    V4(String),\n    V6(String),\n}\nfn main() {\n    // 填空\n    let v: Vec<IpAddr> = vec![\n        IpAddr::V4(&quot;127.0.0.1&quot;.to_string()),\n        IpAddr::V6(&quot;::1&quot;.to_string()),\n    ];\n\n    // 枚举的比较需要派生 PartialEq 特征\n    assert_eq!(v[0], IpAddr::V4(&quot;127.0.0.1&quot;.to_string()));\n    assert_eq!(v[1], IpAddr::V6(&quot;::1&quot;.to_string()));\n\n    println!(&quot;Success!&quot;)\n}`, `56200970737738840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>\n<span class="token keyword">enum</span> IpAddr <span class="token punctuation">{</span>\n    <span class="token function">V4</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">V6</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>IpAddr<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>\n        IpAddr<span class="token punctuation">::</span><span class="token function">V4</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        IpAddr<span class="token punctuation">::</span><span class="token function">V6</span><span class="token punctuation">(</span><span class="token string">"::1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 枚举的比较需要派生 PartialEq 特征</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> IpAddr<span class="token punctuation">::</span><span class="token function">V4</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> IpAddr<span class="token punctuation">::</span><span class="token function">V6</span><span class="token punctuation">(</span><span class="token string">"::1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-9"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66168789025789534000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait IpAddr {\n    fn display(&self);\n}\n\nstruct V4(String);\nimpl IpAddr for V4 {\n    fn display(&self) {\n        println!(&quot;ipv4: {:?}&quot;,self.0)\n    }\n}\nstruct V6(String);\nimpl IpAddr for V6 {\n    fn display(&self) {\n        println!(&quot;ipv6: {:?}&quot;,self.0)\n    }\n}\n\nfn main() {\n    // 填空\n    let v: __= vec![\n        Box::new(V4(&quot;127.0.0.1&quot;.to_string())),\n        Box::new(V6(&quot;::1&quot;.to_string())),\n    ];\n\n    for ip in v {\n        ip.display();\n    }\n}`, `66168789025789534000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> IpAddr <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> <span class="token function">V4</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">impl</span> IpAddr <span class="token keyword">for</span> V4 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ipv4: {:?}"</span><span class="token punctuation">,</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> <span class="token function">V6</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">impl</span> IpAddr <span class="token keyword">for</span> V6 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ipv6: {:?}"</span><span class="token punctuation">,</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> __<span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token function">V4</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token function">V6</span><span class="token punctuation">(</span><span class="token string">"::1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> ip <span class="token keyword">in</span> v <span class="token punctuation">{</span>\n        ip<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-172"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-172" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29358574543421657000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`trait IpAddr {\n    fn display(&self);\n}\n\nstruct V4(String);\nimpl IpAddr for V4 {\n    fn display(&self) {\n        println!(&quot;ipv4: {:?}&quot;, self.0)\n    }\n}\nstruct V6(String);\nimpl IpAddr for V6 {\n    fn display(&self) {\n        println!(&quot;ipv6: {:?}&quot;, self.0)\n    }\n}\n\nfn main() {\n    // 填空\n    let v: Vec<Box<dyn IpAddr>> = vec![\n        Box::new(V4(&quot;127.0.0.1&quot;.to_string())),\n        Box::new(V6(&quot;::1&quot;.to_string())),\n    ];\n\n    for ip in v {\n        ip.display();\n    }\n}`, `29358574543421657000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">trait</span> IpAddr <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> <span class="token function">V4</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">impl</span> IpAddr <span class="token keyword">for</span> V4 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ipv4: {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">struct</span> <span class="token function">V6</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">impl</span> IpAddr <span class="token keyword">for</span> V6 <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"ipv6: {:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 填空</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>Box<span class="token operator">&lt;</span><span class="token keyword">dyn</span> IpAddr<span class="token operator">>></span> <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token function">V4</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token function">V6</span><span class="token punctuation">(</span><span class="token string">"::1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> ip <span class="token keyword">in</span> v <span class="token punctuation">{</span>\n        ip<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="kv-存储-hashmap"><a href="#kv-%E5%AD%98%E5%82%A8-hashmap" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>KV 存储 HashMap</h2>\n<p>HashMap 默认使用 <code class="language-text">SipHash 1-3</code> 哈希算法，该算法对于抵抗 HashDos 攻击非常有效。在性能方面，如果你的 key 是中型大小的，那该算法非常不错，但是如果是小型的 key（例如整数）亦或是大型的 key（例如字符串），那你需要采用社区提供的其它算法来提高性能</p>\n<p>哈希表的算法是基于 Google 的 <a href="https://abseil.io/blog/20180927-swisstables" target="_blank" rel="nofollow noreferrer noopener">SwissTable</a>，你可以在这里找到 C++ 的实现，同时在 <a href="https://www.youtube.com/watch?v=ncHmEUmJZf4" target="_blank" rel="nofollow noreferrer noopener">CppCon talk</a> 上也有关于算法如何工作的演讲</p>\n<h3 id="问题一-24"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73255277076293350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nuse std::collections::HashMap;\nfn main() {\n    let mut scores = HashMap::new();\n    scores.insert(&quot;Sunface&quot;, 98);\n    scores.insert(&quot;Daniel&quot;, 95);\n    scores.insert(&quot;Ashley&quot;, 69.0);\n    scores.insert(&quot;Katie&quot;, &quot;58&quot;);\n\n    // get 返回一个 Option<&V> 枚举值\n    let score = scores.get(&quot;Sunface&quot;);\n    assert_eq!(score, Some(98));\n\n    if scores.contains_key(&quot;Daniel&quot;) {\n        // 索引返回一个值 V\n        let score = scores[&quot;Daniel&quot;];\n        assert_eq!(score, __);\n        scores.remove(&quot;Daniel&quot;);\n    }\n\n    assert_eq!(scores.len(), __);\n\n    for (name, score) in scores {\n        println!(&quot;The score of {} is {}&quot;, name, score)\n    }\n}`, `73255277076293350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> scores <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Sunface"</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Ashley"</span><span class="token punctuation">,</span> <span class="token number">69.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Katie"</span><span class="token punctuation">,</span> <span class="token string">"58"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// get 返回一个 Option&lt;&amp;V> 枚举值</span>\n    <span class="token keyword">let</span> score <span class="token operator">=</span> scores<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> scores<span class="token punctuation">.</span><span class="token function">contains_key</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// 索引返回一个值 V</span>\n        <span class="token keyword">let</span> score <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token string">"Daniel"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        scores<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>scores<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">in</span> scores <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The score of {} is {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> score<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-173"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-173" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27468295696944378000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nuse std::collections::HashMap;\nfn main() {\n    let mut scores = HashMap::new();\n    scores.insert(&quot;Sunface&quot;, 98);\n    scores.insert(&quot;Daniel&quot;, 95);\n    scores.insert(&quot;Ashley&quot;, 69);\n    scores.insert(&quot;Katie&quot;, 58);\n\n    // get 返回一个 Option<&V> 枚举值\n    let score = scores.get(&quot;Sunface&quot;);\n    assert_eq!(score, Some(&98));\n\n    if scores.contains_key(&quot;Daniel&quot;) {\n        // 索引返回一个值 V\n        let score = scores[&quot;Daniel&quot;];\n        assert_eq!(score, 95);\n        scores.remove(&quot;Daniel&quot;);\n    }\n\n    assert_eq!(scores.len(), 3);\n\n    for (name, score) in scores {\n        println!(&quot;The score of {} is {}&quot;, name, score)\n    }\n}`, `27468295696944378000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> scores <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Sunface"</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Ashley"</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    scores<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Katie"</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// get 返回一个 Option&lt;&amp;V> 枚举值</span>\n    <span class="token keyword">let</span> score <span class="token operator">=</span> scores<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Sunface"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> scores<span class="token punctuation">.</span><span class="token function">contains_key</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// 索引返回一个值 V</span>\n        <span class="token keyword">let</span> score <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token string">"Daniel"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token function">assert_eq!</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        scores<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Daniel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>scores<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">in</span> scores <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"The score of {} is {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> score<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-24"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48332560803877400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::collections::HashMap;\nfn main() {\n    let teams = [\n        (&quot;Chinese Team&quot;, 100),\n        (&quot;American Team&quot;, 10),\n        (&quot;France Team&quot;, 50),\n    ];\n\n    let mut teams_map1 = HashMap::new();\n    for team in &teams {\n        teams_map1.insert(team.0, team.1);\n    }\n\n    // 使用两种方法实现 team_map2\n    // 提示:其中一种方法是使用 \\`collect\\` 方法\n    let teams_map2...\n\n    assert_eq!(teams_map1, teams_map2);\n\n    println!(&quot;Success!&quot;)\n}`, `48332560803877400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> teams <span class="token operator">=</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">(</span><span class="token string">"Chinese Team"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span><span class="token string">"American Team"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span><span class="token string">"France Team"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> teams_map1 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> team <span class="token keyword">in</span> <span class="token operator">&amp;</span>teams <span class="token punctuation">{</span>\n        teams_map1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>team<span class="token number">.0</span><span class="token punctuation">,</span> team<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 使用两种方法实现 team_map2</span>\n    <span class="token comment">// 提示:其中一种方法是使用 `collect` 方法</span>\n    <span class="token keyword">let</span> teams_map2<span class="token punctuation">...</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>teams_map1<span class="token punctuation">,</span> teams_map2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-174"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-174" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28611553947371094000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::collections::HashMap;\nfn main() {\n    let teams = [\n        (&quot;Chinese Team&quot;, 100),\n        (&quot;American Team&quot;, 10),\n        (&quot;France Team&quot;, 50),\n    ];\n\n    let mut teams_map1 = HashMap::new();\n    for team in &teams {\n        teams_map1.insert(team.0, team.1);\n    }\n\n    // 使用两种方法实现 team_map2\n    // 提示:其中一种方法是使用 \\`collect\\` 方法\n    // let teams_map2 = teams.into_iter().collect();\n    let teams_map2 = HashMap::from(teams);\n\n    assert_eq!(teams_map1, teams_map2);\n\n    println!(&quot;Success!&quot;)\n}`, `28611553947371094000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> teams <span class="token operator">=</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">(</span><span class="token string">"Chinese Team"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span><span class="token string">"American Team"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span><span class="token string">"France Team"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> teams_map1 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">for</span> team <span class="token keyword">in</span> <span class="token operator">&amp;</span>teams <span class="token punctuation">{</span>\n        teams_map1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>team<span class="token number">.0</span><span class="token punctuation">,</span> team<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 使用两种方法实现 team_map2</span>\n    <span class="token comment">// 提示:其中一种方法是使用 `collect` 方法</span>\n    <span class="token comment">// let teams_map2 = teams.into_iter().collect();</span>\n    <span class="token keyword">let</span> teams_map2 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>teams<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>teams_map1<span class="token punctuation">,</span> teams_map2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-24"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20133187136112763000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::collections::HashMap;\nfn main() {\n    // 编译器可以根据后续的使用情况帮我自动推断出 HashMap 的类型，当然你也可以显式地标注类型：HashMap<&str, u8>\n    let mut player_stats = HashMap::new();\n\n    // 查询指定的 key, 若不存在时，则插入新的 kv 值\n    player_stats.entry(&quot;health&quot;).or_insert(100);\n\n    assert_eq!(player_stats[&quot;health&quot;], __);\n\n    // 通过函数来返回新的值\n    player_stats.entry(&quot;health&quot;).or_insert_with(random_stat_buff);\n    assert_eq!(player_stats[&quot;health&quot;], __);\n\n    let health = player_stats.entry(&quot;health&quot;).or_insert(50);\n    assert_eq!(health, __);\n    *health -= 50;\n    assert_eq!(*health, __);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn random_stat_buff() -> u8 {\n    // 为了简单，我们没有使用随机，而是返回一个固定的值\n    42\n}`, `20133187136112763000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 编译器可以根据后续的使用情况帮我自动推断出 HashMap 的类型，当然你也可以显式地标注类型：HashMap&lt;&amp;str, u8></span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> player_stats <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 查询指定的 key, 若不存在时，则插入新的 kv 值</span>\n    player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>player_stats<span class="token punctuation">[</span><span class="token string">"health"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 通过函数来返回新的值</span>\n    player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert_with</span><span class="token punctuation">(</span>random_stat_buff<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>player_stats<span class="token punctuation">[</span><span class="token string">"health"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> health <span class="token operator">=</span> player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>health<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token operator">*</span>health <span class="token operator">-=</span> <span class="token number">50</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>health<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">random_stat_buff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u8 <span class="token punctuation">{</span>\n    <span class="token comment">// 为了简单，我们没有使用随机，而是返回一个固定的值</span>\n    <span class="token number">42</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-175"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-175" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18756350535571743000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nuse std::collections::HashMap;\nfn main() {\n    // 编译器可以根据后续的使用情况帮我自动推断出 HashMap 的类型，当然你也可以显式地标注类型：HashMap<&str, u8>\n    let mut player_stats = HashMap::new();\n\n    // 查询指定的 key, 若不存在时，则插入新的 kv 值\n    player_stats.entry(&quot;health&quot;).or_insert(100);\n\n    assert_eq!(player_stats[&quot;health&quot;], 100);\n\n    // 通过函数来返回新的值\n    player_stats.entry(&quot;health&quot;).or_insert_with(random_stat_buff);\n    assert_eq!(player_stats[&quot;health&quot;], 100);\n\n    let health = player_stats.entry(&quot;health&quot;).or_insert(50);\n    assert_eq!(health, &100);\n    *health -= 50;\n    assert_eq!(*health, 50);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn random_stat_buff() -> u8 {\n    // 为了简单，我们没有使用随机，而是返回一个固定的值\n    42\n}`, `18756350535571743000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 编译器可以根据后续的使用情况帮我自动推断出 HashMap 的类型，当然你也可以显式地标注类型：HashMap&lt;&amp;str, u8></span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> player_stats <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 查询指定的 key, 若不存在时，则插入新的 kv 值</span>\n    player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>player_stats<span class="token punctuation">[</span><span class="token string">"health"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 通过函数来返回新的值</span>\n    player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert_with</span><span class="token punctuation">(</span>random_stat_buff<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>player_stats<span class="token punctuation">[</span><span class="token string">"health"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> health <span class="token operator">=</span> player_stats<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token string">"health"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>health<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token operator">*</span>health <span class="token operator">-=</span> <span class="token number">50</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>health<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">random_stat_buff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> u8 <span class="token punctuation">{</span>\n    <span class="token comment">// 为了简单，我们没有使用随机，而是返回一个固定的值</span>\n    <span class="token number">42</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-23"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>任何实现了 Eq 和 Hash 特征的类型都可以用于 HashMap 的 key，包括:</p>\n<ul>\n<li>bool（很少用到，因为它只能表达两种 key）</li>\n<li>int, uint 以及它们的变体，例如 u8、i32 等</li>\n<li>String 和 &#x26;str（提示: HashMap 的 key 是 String 类型时，你其实可以使用 &#x26;str 配合 get 方法进行查询）</li>\n</ul>\n<p>需要注意的是，f32 和 f64 并没有实现 Hash，原因是浮点数精度的问题会导致它们无法进行相等比较。</p>\n<p>如果一个集合类型的所有字段都实现了 Eq 和 Hash，那该集合类型会自动实现 Eq 和 Hash。例如 <code class="language-text">Vect&lt;T&gt;</code> 要实现 Hash，那么首先需要 T 实现 Hash</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9560634017765212000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\n// 提示: \\`derive\\` 是实现一些常用特征的好办法\nuse std::collections::HashMap;\n\nstruct Viking {\n    name: String,\n    country: String,\n}\n\nimpl Viking {\n    fn new(name: &str, country: &str) -> Viking {\n        Viking {\n            name: name.to_string(),\n            country: country.to_string(),\n        }\n    }\n}\n\nfn main() {\n    // 使用 HashMap 来存储 viking 的生命值\n    let vikings = HashMap::from([\n        (Viking::new(&quot;Einar&quot;, &quot;Norway&quot;), 25),\n        (Viking::new(&quot;Olaf&quot;, &quot;Denmark&quot;), 24),\n        (Viking::new(&quot;Harald&quot;, &quot;Iceland&quot;), 12),\n    ]);\n\n    // 使用 derive 的方式来打印 viking 的当前状态\n    for (viking, health) in &vikings {\n        println!(&quot;{:?} has {} hp&quot;, viking, health);\n    }\n}`, `9560634017765212000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token comment">// 提示: `derive` 是实现一些常用特征的好办法</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n\n<span class="token keyword">struct</span> Viking <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    country<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Viking <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> country<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Viking <span class="token punctuation">{</span>\n        Viking <span class="token punctuation">{</span>\n            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            country<span class="token punctuation">:</span> country<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用 HashMap 来存储 viking 的生命值</span>\n    <span class="token keyword">let</span> vikings <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Einar"</span><span class="token punctuation">,</span> <span class="token string">"Norway"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Olaf"</span><span class="token punctuation">,</span> <span class="token string">"Denmark"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Harald"</span><span class="token punctuation">,</span> <span class="token string">"Iceland"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 derive 的方式来打印 viking 的当前状态</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>viking<span class="token punctuation">,</span> health<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">&amp;</span>vikings <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?} has {} hp"</span><span class="token punctuation">,</span> viking<span class="token punctuation">,</span> health<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>关于容量，我们在之前的 Vector 中有详细的介绍，而 HashMap 也可以调整容量：你可以通过 <code class="language-text">HashMap::with_capacity(uint)</code> 使用指定的容量来初始化，或者使用 <code class="language-text">HashMap::new()</code>，后者会提供一个默认的初始化容量</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="37235925648654940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::collections::HashMap;\nfn main() {\n    let mut map: HashMap<i32, i32> = HashMap::with_capacity(100);\n    map.insert(1, 2);\n    map.insert(3, 4);\n    // 事实上，虽然我们使用了 100 容量来初始化，但是 map 的容量很可能会比 100 更多\n    assert!(map.capacity() >= 100);\n\n    // 对容量进行收缩，你提供的值仅仅是一个允许的最小值，实际上，Rust 会根据当前存储的数据量进行自动设置，当然，这个值会尽量靠近你提供的值，同时还可能会预留一些调整空间\n\n    map.shrink_to(50);\n    assert!(map.capacity() >= 50);\n\n    // 让 Rust 自行调整到一个合适的值，剩余策略同上\n    map.shrink_to_fit();\n    assert!(map.capacity() >= 2);\n    println!(&quot;Success!&quot;)\n}`, `37235925648654940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> map<span class="token punctuation">:</span> HashMap<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> i32<span class="token operator">></span> <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    map<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    map<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 事实上，虽然我们使用了 100 容量来初始化，但是 map 的容量很可能会比 100 更多</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 对容量进行收缩，你提供的值仅仅是一个允许的最小值，实际上，Rust 会根据当前存储的数据量进行自动设置，当然，这个值会尽量靠近你提供的值，同时还可能会预留一些调整空间</span>\n\n    map<span class="token punctuation">.</span><span class="token function">shrink_to</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 让 Rust 自行调整到一个合适的值，剩余策略同上</span>\n    map<span class="token punctuation">.</span><span class="token function">shrink_to_fit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-176"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-176" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98943183112129380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误\n// 提示: \\`derive\\` 是实现一些常用特征的好办法\nuse std::collections::HashMap;\n\n#[derive(Eq, Hash, PartialEq, Debug)]\nstruct Viking {\n    name: String,\n    country: String,\n}\n\nimpl Viking {\n    fn new(name: &str, country: &str) -> Viking {\n        Viking {\n            name: name.to_string(),\n            country: country.to_string(),\n        }\n    }\n}\n\nfn main() {\n    // 使用 HashMap 来存储 viking 的生命值\n    let vikings = HashMap::from([\n        (Viking::new(&quot;Einar&quot;, &quot;Norway&quot;), 25),\n        (Viking::new(&quot;Olaf&quot;, &quot;Denmark&quot;), 24),\n        (Viking::new(&quot;Harald&quot;, &quot;Iceland&quot;), 12),\n    ]);\n\n    // 使用 derive 的方式来打印 viking 的当前状态\n    for (viking, health) in &vikings {\n        println!(&quot;{:?} has {} hp&quot;, viking, health);\n    }\n}`, `98943183112129380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误</span>\n<span class="token comment">// 提示: `derive` 是实现一些常用特征的好办法</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n\n<span class="token attribute attr-name">#[derive(Eq, Hash, PartialEq, Debug)]</span>\n<span class="token keyword">struct</span> Viking <span class="token punctuation">{</span>\n    name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    country<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Viking <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> country<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Viking <span class="token punctuation">{</span>\n        Viking <span class="token punctuation">{</span>\n            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            country<span class="token punctuation">:</span> country<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 使用 HashMap 来存储 viking 的生命值</span>\n    <span class="token keyword">let</span> vikings <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Einar"</span><span class="token punctuation">,</span> <span class="token string">"Norway"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Olaf"</span><span class="token punctuation">,</span> <span class="token string">"Denmark"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">(</span>Viking<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Harald"</span><span class="token punctuation">,</span> <span class="token string">"Iceland"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 使用 derive 的方式来打印 viking 的当前状态</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>viking<span class="token punctuation">,</span> health<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">&amp;</span>vikings <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?} has {} hp"</span><span class="token punctuation">,</span> viking<span class="token punctuation">,</span> health<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-23"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>对于实现了 Copy 特征的类型，例如 i32，那类型的值会被拷贝到 HashMap 中。而对于有所有权的类型，例如 String，它们的值的所有权将被转移到 HashMap 中</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39367785679321890000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，尽可能少的去修改代码\n// 不要移除任何代码行！\nuse std::collections::HashMap;\nfn main() {\n  let v1 = 10;\n  let mut m1 = HashMap::new();\n  m1.insert(v1, v1);\n  println!(&quot;v1 is still usable after inserting to hashmap : {}&quot;, v1);\n\n  let v2 = &quot;hello&quot;.to_string();\n  let mut m2 = HashMap::new();\n  // 所有权在这里发生了转移\n  m2.insert(v2, v1);\n\n  assert_eq!(v2, &quot;hello&quot;);\n\n   println!(&quot;Success!&quot;)\n}`, `39367785679321890000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，尽可能少的去修改代码</span>\n<span class="token comment">// 不要移除任何代码行！</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> <span class="token keyword">mut</span> m1 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  m1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"v1 is still usable after inserting to hashmap : {}"</span><span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">let</span> v2 <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> <span class="token keyword">mut</span> m2 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// 所有权在这里发生了转移</span>\n  m2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在开头，我们提到过如果现有的 <code class="language-text">SipHash 1-3</code> 的性能无法满足你的需求，那么可以使用社区提供的替代算法。</p>\n<p>例如其中一个社区库的使用方式如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67934200620670484000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n   use std:#️⃣:BuildHasherDefault;\n   use std::collections::HashMap;\n   // 引入第三方的哈希函数\n   use twox_hash::XxHash64;\n\n   let mut hash: HashMap<_, _, BuildHasherDefault<XxHash64>> = Default::default();\n   hash.insert(42, &quot;the answer&quot;);\n   assert_eq!(hash.get(&42), Some(&&quot;the answer&quot;));\n}`, `67934200620670484000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">use</span> std<span class="token punctuation">:</span>#️⃣<span class="token punctuation">:</span>BuildHasherDefault<span class="token punctuation">;</span>\n   <span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n   <span class="token comment">// 引入第三方的哈希函数</span>\n   <span class="token keyword">use</span> twox_hash<span class="token punctuation">::</span>XxHash64<span class="token punctuation">;</span>\n\n   <span class="token keyword">let</span> <span class="token keyword">mut</span> hash<span class="token punctuation">:</span> HashMap<span class="token operator">&lt;</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> BuildHasherDefault<span class="token operator">&lt;</span>XxHash64<span class="token operator">>></span> <span class="token operator">=</span> Default<span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   hash<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">"the answer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token string">"the answer"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-177"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-177" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97084721318772790000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复错误，尽可能少的去修改代码\n// 不要移除任何代码行！\nuse std::collections::HashMap;\nfn main() {\n  let v1 = 10;\n  let mut m1 = HashMap::new();\n  m1.insert(v1, v1);\n  println!(&quot;v1 is still usable after inserting to hashmap : {}&quot;, v1);\n\n  let v2 = &quot;hello&quot;.to_string();\n  let mut m2 = HashMap::new();\n  // 所有权在这里发生了转移\n  m2.insert(&v2, v1);\n\n  assert_eq!(v2, &quot;hello&quot;);\n\n   println!(&quot;Success!&quot;)\n}`, `97084721318772790000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复错误，尽可能少的去修改代码</span>\n<span class="token comment">// 不要移除任何代码行！</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>HashMap<span class="token punctuation">;</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> v1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> <span class="token keyword">mut</span> m1 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  m1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"v1 is still usable after inserting to hashmap : {}"</span><span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">let</span> v2 <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> <span class="token keyword">mut</span> m2 <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// 所有权在这里发生了转移</span>\n  m2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v2<span class="token punctuation">,</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">assert_eq!</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="生命周期"><a href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>生命周期</h1>\n<h2 id="基础"><a href="#%E5%9F%BA%E7%A1%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础</h2>\n<h3 id="问题一-25"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>编译器通过生命周期来确保所有的借用都是合法的，典型的，一个变量在创建时生命周期随之开始，销毁时生命周期也随之结束。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28677046263524033000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 为 \\`i\\` 和 \\`borrow2\\` 标注合适的生命周期范围 */\n\n// \\`i\\` 拥有最长的生命周期，因为它的作用域完整的包含了 \\`borrow1\\` 和 \\`borrow2\\` 。\n// 而 \\`borrow1\\` 和 \\`borrow2\\` 的生命周期并无关联，因为它们的作用域没有重叠\nfn main() {\n    let i = 3;\n    {\n        let borrow1 = &i; // \\`borrow1\\` 生命周期开始. ──┐\n        //                                           │\n        println!(&quot;borrow1: {}&quot;, borrow1); //         │\n    }   // \\`borrow1\\` 生命周期结束. ────────────────────┘\n    {\n        let borrow2 = &i;\n\n        println!(&quot;borrow2: {}&quot;, borrow2);\n    }\n}`, `28677046263524033000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 为 `i` 和 `borrow2` 标注合适的生命周期范围 */</span>\n\n<span class="token comment">// `i` 拥有最长的生命周期，因为它的作用域完整的包含了 `borrow1` 和 `borrow2` 。</span>\n<span class="token comment">// 而 `borrow1` 和 `borrow2` 的生命周期并无关联，因为它们的作用域没有重叠</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> borrow1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span> <span class="token comment">// `borrow1` 生命周期开始. ──┐</span>\n        <span class="token comment">//                                           │</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"borrow1: {}"</span><span class="token punctuation">,</span> borrow1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//         │</span>\n    <span class="token punctuation">}</span>   <span class="token comment">// `borrow1` 生命周期结束. ────────────────────┘</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> borrow2 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"borrow2: {}"</span><span class="token punctuation">,</span> borrow2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-178"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-178" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19969083631218100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 为 \\`i\\` 和 \\`borrow2\\` 标注合适的生命周期范围 */\n\n// \\`i\\` 拥有最长的生命周期，因为它的作用域完整的包含了 \\`borrow1\\` 和 \\`borrow2\\` 。\n// 而 \\`borrow1\\` 和 \\`borrow2\\` 的生命周期并无关联，因为它们的作用域没有重叠\nfn main() {\n    let i = 3;\n    {\n        let borrow1 = &i; // \\`borrow1\\` 生命周期开始. ──┐\n        //                                           │\n        println!(&quot;borrow1: {}&quot;, borrow1); //         │\n    }   // \\`borrow1\\` 生命周期结束. ────────────────────┘\n    {\n        let borrow2 = &i; // \\`borrow2\\` 生命周期开始. ──┐\n        //                                           │\n        println!(&quot;borrow2: {}&quot;, borrow2); //         │\n    }   // \\`borrow2\\` 生命周期结束. ────────────────────┘\n}`, `19969083631218100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 为 `i` 和 `borrow2` 标注合适的生命周期范围 */</span>\n\n<span class="token comment">// `i` 拥有最长的生命周期，因为它的作用域完整的包含了 `borrow1` 和 `borrow2` 。</span>\n<span class="token comment">// 而 `borrow1` 和 `borrow2` 的生命周期并无关联，因为它们的作用域没有重叠</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> borrow1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span> <span class="token comment">// `borrow1` 生命周期开始. ──┐</span>\n        <span class="token comment">//                                           │</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"borrow1: {}"</span><span class="token punctuation">,</span> borrow1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//         │</span>\n    <span class="token punctuation">}</span>   <span class="token comment">// `borrow1` 生命周期结束. ────────────────────┘</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> borrow2 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span> <span class="token comment">// `borrow2` 生命周期开始. ──┐</span>\n        <span class="token comment">//                                           │</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"borrow2: {}"</span><span class="token punctuation">,</span> borrow2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//         │</span>\n    <span class="token punctuation">}</span>   <span class="token comment">// `borrow2` 生命周期结束. ────────────────────┘</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-25"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>示例</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6874694160626315000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n    {\n        let x = 5;            // ----------+-- \'b\n                              //           |\n        let r = &x;           // --+-- \'a  |\n                              //   |       |\n        println!(&quot;r: {}&quot;, r); //   |       |\n                              // --+       |\n    }                         // ----------+\n}`, `6874694160626315000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token comment">// ----------+-- \'b</span>\n                              <span class="token comment">//           |</span>\n        <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>           <span class="token comment">// --+-- \'a  |</span>\n                              <span class="token comment">//   |       |</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"r: {}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//   |       |</span>\n                              <span class="token comment">// --+       |</span>\n    <span class="token punctuation">}</span>                         <span class="token comment">// ----------+</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49277262223124144000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 像上面的示例一样，为 \\`r\\` 和 \\`x\\` 标准生命周期，然后从生命周期的角度解释一下为什么编译错误 */\n\nfn main() {\n    {\n        let r;                // ---------+-- \'a\n                              //          |\n        {                     //          |\n            let x = 5;        // -+-- \'b  |\n            r = &x;           //  |       |\n        }                     // -+       |\n                              //          |\n        println!(&quot;r: {}&quot;, r); //          |\n    }                         // ---------+\n}`, `49277262223124144000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 像上面的示例一样，为 `r` 和 `x` 标准生命周期，然后从生命周期的角度解释一下为什么编译错误 */</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> r<span class="token punctuation">;</span>                <span class="token comment">// ---------+-- \'a</span>\n                              <span class="token comment">//          |</span>\n        <span class="token punctuation">{</span>                     <span class="token comment">//          |</span>\n            <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>        <span class="token comment">// -+-- \'b  |</span>\n            r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>           <span class="token comment">//  |       |</span>\n        <span class="token punctuation">}</span>                     <span class="token comment">// -+       |</span>\n                              <span class="token comment">//          |</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"r: {}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//          |</span>\n    <span class="token punctuation">}</span>                         <span class="token comment">// ---------+</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-179"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-179" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<p>r 变量被赋予了生命周期 ‘a，x 被赋予了生命周期 ‘b，从图示上可以明显看出生命周期 ‘b 比 ‘a 小很多</p>\n<p>在编译期，Rust 会比较两个变量的生命周期，结果发现 r 明明拥有生命周期 ‘a，但是却引用了一个小得多的生命周期 ‘b，在这种情况下，编译器会认为我们的程序存在风险，因此拒绝运行。</p>\n<p>如果想要编译通过，也很简单，只要 ‘b 比 ‘a 大就好。总之，x 变量只要比 r 活得久，那么 r 就能随意引用 x 且不会存在危险：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15069845178911123000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 像上面的示例一样，为 \\`r\\` 和 \\`x\\` 标准生命周期，然后从生命周期的角度解释一下为什么编译错误 */\n\nfn main() {\n    {\n        let r;                // ---------+-- \'a\n                              //          |\n        {                     //          |\n            let x = 5;        // -+-- \'b  |\n            r = &x;           //  |       |\n        }                     // -+       |\n                              //          |\n        println!(&quot;r: {}&quot;, r); //          |\n    }                         // ---------+\n}`, `15069845178911123000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 像上面的示例一样，为 `r` 和 `x` 标准生命周期，然后从生命周期的角度解释一下为什么编译错误 */</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> r<span class="token punctuation">;</span>                <span class="token comment">// ---------+-- \'a</span>\n                              <span class="token comment">//          |</span>\n        <span class="token punctuation">{</span>                     <span class="token comment">//          |</span>\n            <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>        <span class="token comment">// -+-- \'b  |</span>\n            r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>           <span class="token comment">//  |       |</span>\n        <span class="token punctuation">}</span>                     <span class="token comment">// -+       |</span>\n                              <span class="token comment">//          |</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"r: {}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//          |</span>\n    <span class="token punctuation">}</span>                         <span class="token comment">// ---------+</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-25"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>Rust 的借用检查器使用显式的生命周期标注来确定一个引用的合法范围。但是对于用户来说，我们在大多数场景下，都无需手动去标注生命周期，原因是编译器会在某些情况下自动应用生命周期消除规则。</p>\n<p>在了解编译器使用哪些规则帮我们消除生命周期之前，首先还是需要知道该如何手动标记生命周期。</p>\n<p>大家先忽略生命周期消除规则，让我们看看，函数签名中的生命周期有哪些限制:</p>\n<ul>\n<li>需要为每个引用标注上合适的生命周期</li>\n<li>返回值中的引用，它的生命周期要么跟某个引用参数相同，要么是 <code class="language-text">&#39;static</code></li>\n</ul>\n<p>示例</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81791817805002310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 引用参数中的生命周期 \'a 至少要跟函数活得一样久\nfn print_one<\'a>(x: &\'a i32) {\n    println!(&quot;\\`print_one\\`: x is {}&quot;, x);\n}\n\n// 可变引用依然需要标准生命周期\nfn add_one<\'a>(x: &\'a mut i32) {\n    *x += 1;\n}\n\n// 下面代码中，每个参数都拥有自己独立的生命周期，事实上，这个例子足够简单，因此它们应该被标记上相同的生命周期 \\`\'a\\`，但是对于复杂的例子而言，独立的生命周期标注是可能存在的\nfn print_multi<\'a, \'b>(x: &\'a i32, y: &\'b i32) {\n    println!(&quot;\\`print_multi\\`: x is {}, y is {}&quot;, x, y);\n}\n\n// 返回一个通过参数传入的引用是很常见的，但是这种情况下需要标注上正确的生命周期\nfn pass_x<\'a, \'b>(x: &\'a i32, _: &\'b i32) -> &\'a i32 { x }\n\nfn main() {\n    let x = 7;\n    let y = 9;\n\n    print_one(&x);\n    print_multi(&x, &y);\n\n    let z = pass_x(&x, &y);\n    print_one(z);\n\n    let mut t = 3;\n    add_one(&mut t);\n    print_one(&t);\n}`, `81791817805002310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 引用参数中的生命周期 \'a 至少要跟函数活得一样久</span>\n<span class="token keyword">fn</span> print_one<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print_one`: x is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 可变引用依然需要标准生命周期</span>\n<span class="token keyword">fn</span> add_one<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">mut</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token operator">*</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 下面代码中，每个参数都拥有自己独立的生命周期，事实上，这个例子足够简单，因此它们应该被标记上相同的生命周期 `\'a`，但是对于复杂的例子而言，独立的生命周期标注是可能存在的</span>\n<span class="token keyword">fn</span> print_multi<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print_multi`: x is {}, y is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 返回一个通过参数传入的引用是很常见的，但是这种情况下需要标注上正确的生命周期</span>\n<span class="token keyword">fn</span> pass_x<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token punctuation">{</span> x <span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_one</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_multi</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token function">pass_x</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_one</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> t <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n    <span class="token function">add_one</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_one</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47748144228150940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加合适的生命周期标注，让下面的代码工作 */\nfn longest(x: &str, y: &str) -> &str {\n    if x.len() > y.len() {\n        x\n    } else {\n        y\n    }\n}\n\nfn main() {}`, `47748144228150940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加合适的生命周期标注，让下面的代码工作 */</span>\n<span class="token keyword">fn</span> <span class="token function">longest</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        x\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        y\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-180"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-180" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80854723681190280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加合适的生命周期标注，让下面的代码工作 */\nfn longest<\'a>(x: &\'a str, y: &\'a str) -> &\'a str {\n    if x.len() > y.len() {\n        x\n    } else {\n        y\n    }\n}\n\nfn main() {}`, `80854723681190280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加合适的生命周期标注，让下面的代码工作 */</span>\n<span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        x\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        y\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-24"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15075815134867532000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用三种方法修复下面的错误  */\nfn invalid_output<\'a>() -> &\'a String {\n    &String::from(&quot;foo&quot;)\n}\n\nfn main() {\n}`, `15075815134867532000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用三种方法修复下面的错误  */</span>\n<span class="token keyword">fn</span> invalid_output<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> String <span class="token punctuation">{</span>\n    <span class="token operator">&amp;</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-181"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-181" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80493086492172440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用三种方法修复下面的错误  */\nfn invalid_output() -> String {\n    String::from(&quot;foo&quot;)\n}\n\nfn main() {\n}`, `80493086492172440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用三种方法修复下面的错误  */</span>\n<span class="token keyword">fn</span> <span class="token function">invalid_output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-24"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56336174543903720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// \\`print_refs\\` 有两个引用参数，它们的生命周期 \\`\'a\\` 和 \\`\'b\\` 至少得跟函数活得一样久\nfn print_refs<\'a, \'b>(x: &\'a i32, y: &\'b i32) {\n    println!(&quot;x is {} and y is {}&quot;, x, y);\n}\n\n/* 让下面的代码工作 */\nfn failed_borrow<\'a>() {\n    let _x = 12;\n\n    // ERROR: \\`_x\\` 活得不够久does not live long enough\n    let y: &\'a i32 = &_x;\n\n    // 在函数内使用 \\`\'a\\` 将会报错，原因是 \\`&_x\\` 的生命周期显然比 \\`\'a\\` 要小\n    // 你不能将一个小的生命周期强转成大的\n}\n\nfn main() {\n    let (four, nine) = (4, 9);\n\n\n    print_refs(&four, &nine);\n    // 这里，four 和 nice 的生命周期必须要比函数 print_refs 长\n\n    failed_borrow();\n    // \\`failed_borrow\\`  没有传入任何引用去限制生命周期 \\`\'a\\`，因此，此时的 \\`\'a\\` 生命周期是没有任何限制的，它默认是 \\`\'static\\`\n}`, `56336174543903720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// `print_refs` 有两个引用参数，它们的生命周期 `\'a` 和 `\'b` 至少得跟函数活得一样久</span>\n<span class="token keyword">fn</span> print_refs<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is {} and y is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 让下面的代码工作 */</span>\n<span class="token keyword">fn</span> failed_borrow<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _x <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ERROR: `_x` 活得不够久does not live long enough</span>\n    <span class="token keyword">let</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token operator">=</span> <span class="token operator">&amp;</span>_x<span class="token punctuation">;</span>\n\n    <span class="token comment">// 在函数内使用 `\'a` 将会报错，原因是 `&amp;_x` 的生命周期显然比 `\'a` 要小</span>\n    <span class="token comment">// 你不能将一个小的生命周期强转成大的</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>four<span class="token punctuation">,</span> nine<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n    <span class="token function">print_refs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>four<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nine<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 这里，four 和 nice 的生命周期必须要比函数 print_refs 长</span>\n\n    <span class="token function">failed_borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// `failed_borrow`  没有传入任何引用去限制生命周期 `\'a`，因此，此时的 `\'a` 生命周期是没有任何限制的，它默认是 `\'static`</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-182"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-182" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19819562807621206000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// \\`print_refs\\` 有两个引用参数，它们的生命周期 \\`\'a\\` 和 \\`\'b\\` 至少得跟函数活得一样久\nfn print_refs<\'a, \'b>(x: &\'a i32, y: &\'b i32) {\n    println!(&quot;x is {} and y is {}&quot;, x, y);\n}\n\n/* 让下面的代码工作 */\nfn failed_borrow() {\n    let _x = 12;\n\n    // ERROR: \\`_x\\` 活得不够久does not live long enough\n    let y = &_x;\n\n    // 在函数内使用 \\`\'a\\` 将会报错，原因是 \\`&_x\\` 的生命周期显然比 \\`\'a\\` 要小\n    // 你不能将一个小的生命周期强转成大的\n}\n\nfn main() {\n    let (four, nine) = (4, 9);\n\n    print_refs(&four, &nine);\n    // 这里，four 和 nice 的生命周期必须要比函数 print_refs 长\n\n    failed_borrow();\n    // \\`failed_borrow\\`  没有传入任何引用去限制生命周期 \\`\'a\\`，因此，此时的 \\`\'a\\` 生命周期是没有任何限制的，它默认是 \\`\'static\\`\n}`, `19819562807621206000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// `print_refs` 有两个引用参数，它们的生命周期 `\'a` 和 `\'b` 至少得跟函数活得一样久</span>\n<span class="token keyword">fn</span> print_refs<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is {} and y is {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 让下面的代码工作 */</span>\n<span class="token keyword">fn</span> <span class="token function">failed_borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _x <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// ERROR: `_x` 活得不够久does not live long enough</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>_x<span class="token punctuation">;</span>\n\n    <span class="token comment">// 在函数内使用 `\'a` 将会报错，原因是 `&amp;_x` 的生命周期显然比 `\'a` 要小</span>\n    <span class="token comment">// 你不能将一个小的生命周期强转成大的</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>four<span class="token punctuation">,</span> nine<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_refs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>four<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nine<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 这里，four 和 nice 的生命周期必须要比函数 print_refs 长</span>\n\n    <span class="token function">failed_borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// `failed_borrow`  没有传入任何引用去限制生命周期 `\'a`，因此，此时的 `\'a` 生命周期是没有任何限制的，它默认是 `\'static`</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-20"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32166965960788275000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 增加合适的生命周期标准，让代码工作 */\n\n// \\`i32\\` 的引用必须比 \\`Borrowed\\` 活得更久\n#[derive(Debug)]\nstruct Borrowed(&i32);\n\n// 类似的，下面两个引用也必须比结构体 \\`NamedBorrowed\\` 活得更久\n#[derive(Debug)]\nstruct NamedBorrowed {\n    x: &i32,\n    y: &i32,\n}\n\n#[derive(Debug)]\nenum Either {\n    Num(i32),\n    Ref(&i32),\n}\n\nfn main() {\n    let x = 18;\n    let y = 15;\n\n    let single = Borrowed(&x);\n    let double = NamedBorrowed { x: &x, y: &y };\n    let reference = Either::Ref(&x);\n    let number    = Either::Num(y);\n\n    println!(&quot;x is borrowed in {:?}&quot;, single);\n    println!(&quot;x and y are borrowed in {:?}&quot;, double);\n    println!(&quot;x is borrowed in {:?}&quot;, reference);\n    println!(&quot;y is *not* borrowed in {:?}&quot;, number);\n}`, `32166965960788275000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 增加合适的生命周期标准，让代码工作 */</span>\n\n<span class="token comment">// `i32` 的引用必须比 `Borrowed` 活得更久</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> <span class="token function">Borrowed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 类似的，下面两个引用也必须比结构体 `NamedBorrowed` 活得更久</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NamedBorrowed <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> Either <span class="token punctuation">{</span>\n    <span class="token function">Num</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> single <span class="token operator">=</span> <span class="token function">Borrowed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> double <span class="token operator">=</span> NamedBorrowed <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>y <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> reference <span class="token operator">=</span> Either<span class="token punctuation">::</span><span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> number    <span class="token operator">=</span> Either<span class="token punctuation">::</span><span class="token function">Num</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is borrowed in {:?}"</span><span class="token punctuation">,</span> single<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x and y are borrowed in {:?}"</span><span class="token punctuation">,</span> double<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is borrowed in {:?}"</span><span class="token punctuation">,</span> reference<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"y is *not* borrowed in {:?}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-183"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-183" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29744293374274953000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 增加合适的生命周期标准，让代码工作 */\n\n// \\`i32\\` 的引用必须比 \\`Borrowed\\` 活得更久\n#[derive(Debug)]\nstruct Borrowed<\'a>(&\'a i32);\n\n// 类似的，下面两个引用也必须比结构体 \\`NamedBorrowed\\` 活得更久\n#[derive(Debug)]\nstruct NamedBorrowed<\'a, \'b> {\n    x: &\'a i32,\n    y: &\'b i32,\n}\n\n#[derive(Debug)]\nenum Either<\'a> {\n    Num(i32),\n    Ref(&\'a i32),\n}\n\nfn main() {\n    let x = 18;\n    let y = 15;\n\n    let single = Borrowed(&x);\n    let double = NamedBorrowed { x: &x, y: &y };\n    let reference = Either::Ref(&x);\n    let number    = Either::Num(y);\n\n    println!(&quot;x is borrowed in {:?}&quot;, single);\n    println!(&quot;x and y are borrowed in {:?}&quot;, double);\n    println!(&quot;x is borrowed in {:?}&quot;, reference);\n    println!(&quot;y is *not* borrowed in {:?}&quot;, number);\n}`, `29744293374274953000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 增加合适的生命周期标准，让代码工作 */</span>\n\n<span class="token comment">// `i32` 的引用必须比 `Borrowed` 活得更久</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Borrowed<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 类似的，下面两个引用也必须比结构体 `NamedBorrowed` 活得更久</span>\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NamedBorrowed<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">enum</span> Either<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Num</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> single <span class="token operator">=</span> <span class="token function">Borrowed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> double <span class="token operator">=</span> NamedBorrowed <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span>y <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> reference <span class="token operator">=</span> Either<span class="token punctuation">::</span><span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> number    <span class="token operator">=</span> Either<span class="token punctuation">::</span><span class="token function">Num</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is borrowed in {:?}"</span><span class="token punctuation">,</span> single<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x and y are borrowed in {:?}"</span><span class="token punctuation">,</span> double<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"x is borrowed in {:?}"</span><span class="token punctuation">,</span> reference<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"y is *not* borrowed in {:?}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题七-12"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76594183755581370000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 让代码工作 */\n\n#[derive(Debug)]\nstruct NoCopyType {}\n\n#[derive(Debug)]\nstruct Example<\'a, \'b> {\n    a: &\'a u32,\n    b: &\'b NoCopyType\n}\n\nfn main()\n{\n  let var_a = 35;\n  let example: Example;\n\n  {\n    let var_b = NoCopyType {};\n\n    /* 修复错误 */\n    example = Example { a: &var_a, b: &var_b };\n  }\n\n  println!(&quot;(Success!) {:?}&quot;, example);\n}`, `76594183755581370000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 让代码工作 */</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Example<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> u32<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> NoCopyType\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n  <span class="token keyword">let</span> var_a <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>\n  <span class="token keyword">let</span> example<span class="token punctuation">:</span> Example<span class="token punctuation">;</span>\n\n  <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> var_b <span class="token operator">=</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">/* 修复错误 */</span>\n    example <span class="token operator">=</span> Example <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token operator">&amp;</span>var_a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token operator">&amp;</span>var_b <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"(Success!) {:?}"</span><span class="token punctuation">,</span> example<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-184"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-184" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89128368048999990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 让代码工作 */\n\n#[derive(Debug)]\nstruct NoCopyType {}\n\n#[derive(Debug)]\nstruct Example<\'a, \'b> {\n    a: &\'a u32,\n    b: &\'b NoCopyType,\n}\n\nfn main() {\n    let var_a = 35;\n    let example: Example;\n\n    let var_b = NoCopyType {};\n\n    /* 修复错误 */\n    example = Example {\n        a: &var_a,\n        b: &var_b,\n    };\n\n    println!(&quot;(Success!) {:?}&quot;, example);\n}`, `89128368048999990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 让代码工作 */</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Example<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> u32<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> NoCopyType<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> var_a <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> example<span class="token punctuation">:</span> Example<span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> var_b <span class="token operator">=</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token comment">/* 修复错误 */</span>\n    example <span class="token operator">=</span> Example <span class="token punctuation">{</span>\n        a<span class="token punctuation">:</span> <span class="token operator">&amp;</span>var_a<span class="token punctuation">,</span>\n        b<span class="token punctuation">:</span> <span class="token operator">&amp;</span>var_b<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"(Success!) {:?}"</span><span class="token punctuation">,</span> example<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题八-10"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99762131198247470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct NoCopyType {}\n\n#[derive(Debug)]\n#[allow(dead_code)]\nstruct Example<\'a, \'b> {\n    a: &\'a u32,\n    b: &\'b NoCopyType\n}\n\n/* 修复函数的签名 */\nfn fix_me(foo: &Example) -> &NoCopyType\n{ foo.b }\n\nfn main()\n{\n    let no_copy = NoCopyType {};\n    let example = Example { a: &1, b: &no_copy };\n    fix_me(&example);\n    println!(&quot;Success!&quot;)\n}`, `99762131198247470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token attribute attr-name">#[allow(dead_code)]</span>\n<span class="token keyword">struct</span> Example<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> u32<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> NoCopyType\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 修复函数的签名 */</span>\n<span class="token keyword">fn</span> <span class="token function">fix_me</span><span class="token punctuation">(</span>foo<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Example<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>NoCopyType\n<span class="token punctuation">{</span> foo<span class="token punctuation">.</span>b <span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">let</span> no_copy <span class="token operator">=</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> example <span class="token operator">=</span> Example <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token operator">&amp;</span>no_copy <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">fix_me</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-185"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-185" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22566984629329070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct NoCopyType {}\n\n#[derive(Debug)]\n#[allow(dead_code)]\nstruct Example<\'a, \'b> {\n    a: &\'a u32,\n    b: &\'b NoCopyType,\n}\n\n/* 修复函数的签名 */\nfn fix_me<\'a>(foo: &\'a Example) -> &\'a NoCopyType {\n    foo.b\n}\n\nfn main() {\n    let no_copy = NoCopyType {};\n    let example = Example { a: &1, b: &no_copy };\n    fix_me(&example);\n    println!(&quot;Success!&quot;)\n}`, `22566984629329070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token attribute attr-name">#[allow(dead_code)]</span>\n<span class="token keyword">struct</span> Example<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> u32<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> NoCopyType<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/* 修复函数的签名 */</span>\n<span class="token keyword">fn</span> fix_me<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>foo<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> Example<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> NoCopyType <span class="token punctuation">{</span>\n    foo<span class="token punctuation">.</span>b\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> no_copy <span class="token operator">=</span> NoCopyType <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> example <span class="token operator">=</span> Example <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token operator">&amp;</span>no_copy <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">fix_me</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题九-9"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h3>\n<p>方法的生命周期标注跟函数类似</p>\n<p>示例</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56947688200238740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`struct Owner(i32);\n\nimpl Owner {\n    fn add_one<\'a>(&\'a mut self) { self.0 += 1; }\n    fn print<\'a>(&\'a self) {\n        println!(&quot;\\`print\\`: {}&quot;, self.0);\n    }\n}\n\nfn main() {\n    let mut owner = Owner(18);\n\n    owner.add_one();\n    owner.print();\n}`, `56947688200238740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">struct</span> <span class="token function">Owner</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Owner <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> add_one<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token keyword">fn</span> print<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print`: {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> owner <span class="token operator">=</span> <span class="token function">Owner</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    owner<span class="token punctuation">.</span><span class="token function">add_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    owner<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51712165191925055000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 显式添加生命周期 */\n\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a> ImportantExcerpt<\'a> {\n    fn announce_and_return_part(&self, announcement: &str) -> &str {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {}`, `51712165191925055000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 显式添加生命周期 */</span>\n\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">announce_and_return_part</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>str <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-186"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-186" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2645717912001211000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 显式添加生命周期 */\n\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a> ImportantExcerpt<\'a> {\n    fn announce_and_return_part<\'b>(&\'a self, announcement: &\'b str) -> &\'a str {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {}`, `2645717912001211000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 显式添加生命周期 */</span>\n\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> announce_and_return_part<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64366685003865110000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 显式添加生命周期 */\n\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a: \'b, \'b> ImportantExcerpt<\'a> {\n    fn announce_and_return_part(&\'a self, announcement: &\'b str) -> &\'b str {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {}`, `64366685003865110000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 显式添加生命周期 */</span>\n\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a:</span> <span class="token lifetime-annotation symbol">\'b,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">announce_and_return_part</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28864415309381063000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 显式添加生命周期 */\n\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a> ImportantExcerpt<\'a> {\n    fn announce_and_return_part<\'b>(&\'a self, announcement: &\'b str) -> &\'b str\n    where\n        \'a: \'b,\n    {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {}`, `28864415309381063000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 显式添加生命周期 */</span>\n\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> announce_and_return_part<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str\n    <span class="token keyword">where</span>\n        <span class="token lifetime-annotation symbol">\'a:</span> <span class="token lifetime-annotation symbol">\'b,</span>\n    <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题十-5"><a href="#%E9%97%AE%E9%A2%98%E5%8D%81-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题十</h3>\n<p>有一些生命周期的标注方式很常见，因此编译器提供了一些规则，可以让我们在一些场景下无需去标注生命周期，既节省了敲击键盘的繁琐，又能提升可读性。</p>\n<p>这种规则被称为生命周期消除规则（Elision），该规则之所以存在，仅仅是因为这些场景太通用了，为了方便用户而已。事实上对于借用检查器而言，该有的生命周期一个都不能少，只不过对于用户而言，可以省去一些。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2322144928850522600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 移除所有可以消除的生命周期标注 */\n\nfn nput<\'a>(x: &\'a i32) {\n    println!(&quot;\\`annotated_input\\`: {}&quot;, x);\n}\n\nfn pass<\'a>(x: &\'a i32) -> &\'a i32 { x }\n\nfn longest<\'a, \'b>(x: &\'a str, y: &\'b str) -> &\'a str {\n    x\n}\n\nstruct Owner(i32);\n\nimpl Owner {\n    fn add_one<\'a>(&\'a mut self) { self.0 += 1; }\n    fn print<\'a>(&\'a self) {\n        println!(&quot;\\`print\\`: {}&quot;, self.0);\n    }\n}\n\nstruct Person<\'a> {\n    age: u8,\n    name: &\'a str,\n}\n\nenum Either<\'a> {\n    Num(i32),\n    Ref(&\'a i32),\n}\n\nfn main() {}`, `2322144928850522600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 移除所有可以消除的生命周期标注 */</span>\n\n<span class="token keyword">fn</span> nput<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`annotated_input`: {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> pass<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token punctuation">{</span> x <span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str <span class="token punctuation">{</span>\n    x\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> <span class="token function">Owner</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Owner <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> add_one<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token keyword">fn</span> print<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print`: {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Person<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> Either<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Num</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-187"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-187" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49593010406035055000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 移除所有可以消除的生命周期标注 */\n\nfn nput(x: &i32) {\n    println!(&quot;\\`annotated_input\\`: {}&quot;, x);\n}\n\nfn pass(x: &i32) -> &i32 {\n    x\n}\n\nfn longest<\'a, \'b>(x: &\'a str, y: &\'b str) -> &\'a str {\n    x\n}\n\nstruct Owner(i32);\n\nimpl Owner {\n    fn add_one(&mut self) {\n        self.0 += 1;\n    }\n    fn prin(&self) {\n        println!(&quot;\\`print\\`: {}&quot;, self.0);\n    }\n}\n\nstruct Person<\'a> {\n    age: u8,\n    name: &\'a str,\n}\n\nenum Either<\'a> {\n    Num(i32),\n    Ref(&\'a i32),\n}\n\nfn main() {}`, `49593010406035055000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 移除所有可以消除的生命周期标注 */</span>\n\n<span class="token keyword">fn</span> <span class="token function">nput</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`annotated_input`: {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">pass</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span>i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span>i32 <span class="token punctuation">{</span>\n    x\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> longest<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str <span class="token punctuation">{</span>\n    x\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> <span class="token function">Owner</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">impl</span> Owner <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">add_one</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">fn</span> <span class="token function">prin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print`: {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Person<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    age<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>\n    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> Either<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Num</span><span class="token punctuation">(</span>i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="static-and-t-static"><a href="#static-and-t-static" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>&#x26;‘static and T: ‘static</h2>\n<h3 id="问题一-26"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>‘static 是一个 Rust 保留的生命周期名称，在之前我们可能已经见过好几次了:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52495455443891960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n   // 引用的生命周期是 \'static :\n   let s: &\'static str = &quot;hello world&quot;;\n\n   // \'static 也可以用于特征约束中:\n   fn generic<T>(x: T) where T: \'static {}\n}`, `52495455443891960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token comment">// 引用的生命周期是 \'static :</span>\n   <span class="token keyword">let</span> s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// \'static 也可以用于特征约束中:</span>\n   <span class="token keyword">fn</span> generic<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token keyword">where</span> T<span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">\'static</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>虽然它们都是 ‘static，但是也稍有不同。</p>\n<p>作为一个引用生命周期，&#x26;‘static 说明该引用指向的数据可以跟程序活得一样久，但是该引用的生命周期依然有可能被强转为一个更短的生命周期。</p>\n<p>有好几种方法可以将一个变量标记为 ‘static 生命周期，其中两种都是和保存在二进制文件中相关（例如字符串字面量就是保存在二进制文件中，它的生命周期是 ‘static）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41230662110606885000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用两种方法填空 */\nfn main() {\n    __;\n    need_static(v);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn need_static(r : &\'static str) {\n    assert_eq!(r, &quot;hello&quot;);\n}`, `41230662110606885000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用两种方法填空 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    __<span class="token punctuation">;</span>\n    <span class="token function">need_static</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">need_static</span><span class="token punctuation">(</span>r <span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-188"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-188" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6345916337117852000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用两种方法填空 */\nfn main() {\n    let v: &\'static str = &quot;hello&quot;;\n    need_static(v);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn need_static(r : &\'static str) {\n    assert_eq!(r, &quot;hello&quot;);\n}`, `6345916337117852000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用两种方法填空 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n    <span class="token function">need_static</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">need_static</span><span class="token punctuation">(</span>r <span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68675624962116360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用两种方法填空 */\nfn main() {\n    let v = &quot;hello&quot;;\n    need_static(v);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn need_static(r : &\'static str) {\n    assert_eq!(r, &quot;hello&quot;);\n}`, `68675624962116360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用两种方法填空 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>\n    <span class="token function">need_static</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">need_static</span><span class="token punctuation">(</span>r <span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-26"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>使用 Box::leak 也可以产生 ‘static 生命周期</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15874868224876714000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct Config {\n    a: String,\n    b: String,\n}\nstatic mut config: Option<&mut Config> = None;\n\n/* 让代码工作，但不要修改函数的签名 */\nfn init() -> Option<&\'static mut Config> {\n    Some(&mut Config {\n        a: &quot;A&quot;.to_string(),\n        b: &quot;B&quot;.to_string(),\n    })\n}\n\nfn main() {\n    unsafe {\n        config = init();\n\n        println!(&quot;{:?}&quot;,config)\n    }\n}`, `15874868224876714000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Config <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">mut</span> config<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> Config<span class="token operator">></span> <span class="token operator">=</span> None<span class="token punctuation">;</span>\n\n<span class="token comment">/* 让代码工作，但不要修改函数的签名 */</span>\n<span class="token keyword">fn</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> <span class="token keyword">mut</span> Config<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> Config <span class="token punctuation">{</span>\n        a<span class="token punctuation">:</span> <span class="token string">"A"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        b<span class="token punctuation">:</span> <span class="token string">"B"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">unsafe</span> <span class="token punctuation">{</span>\n        config <span class="token operator">=</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span>config<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-189"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-189" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26058484915823186000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct Config {\n    a: String,\n    b: String,\n}\nstatic mut config: Option<&mut Config> = None;\n\n/* 让代码工作，但不要修改函数的签名 */\nfn init() -> Option<&\'static mut Config> {\n    Some(Box::leak(Box::new(Config {\n        a: &quot;A&quot;.to_string(),\n        b: &quot;B&quot;.to_string(),\n    })))\n}\n\nfn main() {\n    unsafe {\n        config = init();\n\n        println!(&quot;{:?}&quot;, config)\n    }\n}`, `26058484915823186000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Config <span class="token punctuation">{</span>\n    a<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n    b<span class="token punctuation">:</span> String<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">mut</span> config<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> Config<span class="token operator">></span> <span class="token operator">=</span> None<span class="token punctuation">;</span>\n\n<span class="token comment">/* 让代码工作，但不要修改函数的签名 */</span>\n<span class="token keyword">fn</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> <span class="token keyword">mut</span> Config<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Some</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">leak</span><span class="token punctuation">(</span>Box<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>Config <span class="token punctuation">{</span>\n        a<span class="token punctuation">:</span> <span class="token string">"A"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        b<span class="token punctuation">:</span> <span class="token string">"B"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">unsafe</span> <span class="token punctuation">{</span>\n        config <span class="token operator">=</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-26"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>&#x26;‘static 只能说明引用指向的数据是能一直存活的，但是引用本身依然受限于它的作用域</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50589038041101510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    {\n        // 字符串字面量能跟程序活得一样久，因此 \\`static_string\\` 的生命周期是 \\`\'static\\`\n        let static_string = &quot;I\'m in read-only memory&quot;;\n        println!(&quot;static_string: {}&quot;, static_string);\n\n        // 当 \\`static_string\\` 超出作用域时，该引用就无法再被使用，但是引用指向的数据（字符串字面量）依然保存在二进制 binary 所占用的内存中\n    }\n\n    println!(&quot;static_string reference remains alive: {}&quot;, static_string);\n}`, `50589038041101510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">// 字符串字面量能跟程序活得一样久，因此 `static_string` 的生命周期是 `\'static`</span>\n        <span class="token keyword">let</span> static_string <span class="token operator">=</span> <span class="token string">"I\'m in read-only memory"</span><span class="token punctuation">;</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"static_string: {}"</span><span class="token punctuation">,</span> static_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">// 当 `static_string` 超出作用域时，该引用就无法再被使用，但是引用指向的数据（字符串字面量）依然保存在二进制 binary 所占用的内存中</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"static_string reference remains alive: {}"</span><span class="token punctuation">,</span> static_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-190"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-190" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43105230417620730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 字符串字面量能跟程序活得一样久，因此 \\`static_string\\` 的生命周期是 \\`\'static\\`\n    let static_string = &quot;I\'m in read-only memory&quot;;\n    println!(&quot;static_string: {}&quot;, static_string);\n\n    // 当 \\`static_string\\` 超出作用域时，该引用就无法再被使用，但是引用指向的数据（字符串字面量）依然保存在二进制 binary 所占用的内存中\n\n    println!(&quot;static_string reference remains alive: {}&quot;, static_string);\n}`, `43105230417620730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 字符串字面量能跟程序活得一样久，因此 `static_string` 的生命周期是 `\'static`</span>\n    <span class="token keyword">let</span> static_string <span class="token operator">=</span> <span class="token string">"I\'m in read-only memory"</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"static_string: {}"</span><span class="token punctuation">,</span> static_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 当 `static_string` 超出作用域时，该引用就无法再被使用，但是引用指向的数据（字符串字面量）依然保存在二进制 binary 所占用的内存中</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"static_string reference remains alive: {}"</span><span class="token punctuation">,</span> static_string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-25"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>&#x26;‘static 可以被强转成一个较短的生命周期</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30003745920770350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 声明一个 static 常量，它拥有 \\`\'static\\` 生命周期.\nstatic NUM: i32 = 18;\n\n// 返回常量 \\`Num\\` 的引用，注意，这里的生命周期从 \\`\'static\\` 强转为 \\`\'a\\`\nfn coerce_static<\'a>(_: &\'a i32) -> &\'a i32 {\n    &NUM\n}\n\nfn main() {\n    {\n        let lifetime_num = 9;\n\n        let coerced_static = coerce_static(&lifetime_num);\n\n        println!(&quot;coerced_static: {}&quot;, coerced_static);\n    }\n\n    println!(&quot;NUM: {} stays accessible!&quot;, NUM);\n}`, `30003745920770350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 声明一个 static 常量，它拥有 `\'static` 生命周期.</span>\n<span class="token keyword">static</span> NUM<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 返回常量 `Num` 的引用，注意，这里的生命周期从 `\'static` 强转为 `\'a`</span>\n<span class="token keyword">fn</span> coerce_static<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>_<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token punctuation">{</span>\n    <span class="token operator">&amp;</span>NUM\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> lifetime_num <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">let</span> coerced_static <span class="token operator">=</span> <span class="token function">coerce_static</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>lifetime_num<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"coerced_static: {}"</span><span class="token punctuation">,</span> coerced_static<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"NUM: {} stays accessible!"</span><span class="token punctuation">,</span> NUM<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-25"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>关于 ‘static 的特征约束详细解释，请参见 <a href="https://course.rs/advance/lifetime/static.html#t-static" target="_blank" rel="nofollow noreferrer noopener">Rust 语言圣经</a>，这里就不再赘述。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74670498342946590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 让代码工作 */\nuse std::fmt::Debug;\n\nfn print_it<T: Debug + \'static>(input: T) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn print_it1(input: impl Debug + \'static) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn print_it2<T: Debug + \'static>(input: &T) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn main() {\n    // i 是有所有权的数据，并没有包含任何引用，因此它是 \'static\n    let i = 5;\n    print_it(i);\n\n    // 但是 &i 是一个引用，生命周期受限于作用域，因此它不是 \'static\n    print_it(&i);\n\n    print_it1(&i);\n\n    // 但是下面的代码可以正常运行 !\n    print_it2(&i);\n}`, `74670498342946590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 让代码工作 */</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> print_it<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_it1</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">impl</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_it2<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// i 是有所有权的数据，并没有包含任何引用，因此它是 \'static</span>\n    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token function">print_it</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 但是 &amp;i 是一个引用，生命周期受限于作用域，因此它不是 \'static</span>\n    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_it1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 但是下面的代码可以正常运行 !</span>\n    <span class="token function">print_it2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-191"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-191" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49134426719157000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 让代码工作 */\nuse std::fmt::Debug;\n\nfn print_it<T: Debug + \'static>(input: T) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn print_it1(input: impl Debug + \'static) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn print_it2<T: Debug + \'static>(input: &T) {\n    println!(&quot;\'static value passed in is: {:?}&quot;, input);\n}\n\nfn main() {\n    // i 是有所有权的数据，并没有包含任何引用，因此它是 \'static\n    // static i: i32 = 5;\n    const i: i32 = 5;\n    print_it(i);\n\n    // 但是 &i 是一个引用，生命周期受限于 main 作用域，因此它不是 \'static\n    print_it(&i);\n\n    print_it1(&i);\n\n    // 但是下面的代码可以正常运行 !\n    print_it2(&i);\n}`, `49134426719157000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 让代码工作 */</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> print_it<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_it1</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">impl</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_it2<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"\'static value passed in is: {:?}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// i 是有所有权的数据，并没有包含任何引用，因此它是 \'static</span>\n    <span class="token comment">// static i: i32 = 5;</span>\n    <span class="token keyword">const</span> i<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>\n    <span class="token function">print_it</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 但是 &amp;i 是一个引用，生命周期受限于 main 作用域，因此它不是 \'static</span>\n    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_it1</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 但是下面的代码可以正常运行 !</span>\n    <span class="token function">print_it2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-21"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1300558160132192500"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt::Display;\n\nfn main() {\n  let mut string = &quot;First&quot;.to_owned();\n\n  string.push_str(string.to_uppercase().as_str());\n  print_a(&string);\n  print_b(&string);\n  print_c(&string); // Compilation error\n  print_d(&string); // Compilation error\n  print_e(&string);\n  print_f(&string);\n  print_g(&string); // Compilation error\n}\n\nfn print_a<T: Display + \'static>(t: &T) {\n  println!(&quot;{}&quot;, t);\n}\n\nfn print_b<T>(t: &T)\nwhere\n  T: Display + \'static,\n{\n  println!(&quot;{}&quot;, t);\n}\n\nfn print_c(t: &\'static dyn Display) {\n  println!(&quot;{}&quot;, t)\n}\n\nfn print_d(t: &\'static impl Display) {\n  println!(&quot;{}&quot;, t)\n}\n\nfn print_e(t: &(dyn Display + \'static)) {\n  println!(&quot;{}&quot;, t)\n}\n\nfn print_f(t: &(impl Display + \'static)) {\n  println!(&quot;{}&quot;, t)\n}\n\nfn print_g(t: &\'static String) {\n  println!(&quot;{}&quot;, t);\n}`, `1300558160132192500`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Display<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> <span class="token keyword">mut</span> string <span class="token operator">=</span> <span class="token string">"First"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">print_a</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">print_b</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">print_c</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n  <span class="token function">print_d</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n  <span class="token function">print_e</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">print_f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">print_g</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_a<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_b<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n  T<span class="token punctuation">:</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static,</span>\n<span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_c</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> <span class="token keyword">dyn</span> Display<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_d</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> <span class="token keyword">impl</span> Display<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_e</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">dyn</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static))</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_f</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">impl</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static))</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_g</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'static</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-192"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-192" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86813802557085430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt::Display;\n\nfn main() {\n    let mut string = &quot;First&quot;.to_owned();\n\n    string.push_str(string.to_uppercase().as_str());\n    print_a(&string);\n    print_b(&string);\n    print_c(&string); // Compilation error\n    print_d(&string); // Compilation error\n    print_e(&string);\n    print_f(&string);\n    print_g(&string); // Compilation error\n}\n\nfn print_a<T: Display + \'static>(t: &T) {\n    println!(&quot;{}&quot;, t);\n}\n\nfn print_b<T>(t: &T)\nwhere\n    T: Display + \'static,\n{\n    println!(&quot;{}&quot;, t);\n}\n\nfn print_c<\'a>(t: &\'a dyn Display) {\n    println!(&quot;{}&quot;, t)\n}\n\nfn print_d<\'a>(t: &\'a impl Display) {\n    println!(&quot;{}&quot;, t)\n}\n\nfn print_e(t: &(dyn Display + \'static)) {\n    println!(&quot;{}&quot;, t)\n}\n\nfn print_f(t: &(impl Display + \'static)) {\n    println!(&quot;{}&quot;, t)\n}\n\nfn print_g<\'a>(t: &\'a String) {\n    println!(&quot;{}&quot;, t);\n}`, `86813802557085430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Display<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> string <span class="token operator">=</span> <span class="token string">"First"</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_a</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_b</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_c</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n    <span class="token function">print_d</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n    <span class="token function">print_e</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print_g</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compilation error</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_a<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_b<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n    T<span class="token punctuation">:</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static,</span>\n<span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_c<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">dyn</span> Display<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_d<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">impl</span> Display<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_e</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">dyn</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static))</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print_f</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">impl</span> Display <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'static))</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> print_g<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="深入"><a href="#%E6%B7%B1%E5%85%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>深入</h2>\n<h3 id="问题一-27"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>就像泛型类型可以有约束一样，生命周期也可以有约束，如下所示：</p>\n<ul>\n<li><code class="language-text">T: &#39;a</code>，所有引用在 T 必须超过生命周期 ‘a</li>\n<li><code class="language-text">T: Trait + &#39;a</code>: T 必须实现特征 Trait 并且所有引用在 T 必须超过生命周期 ‘a</li>\n</ul>\n<p>示例</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6186083043565116000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt::Debug; // 特征约束使用\n\n#[derive(Debug)]\nstruct Ref<\'a, T: \'a>(&\'a T);\n// \\`Ref\\` 包含对泛型类型 \\`T\\` 的引用，该泛型类型具有\n// 未知的生命周期 \\`\'a\\`. \\`T\\` 是约定任何\n// 引用在 \\`T\\` 必须大于 \\`\'a\\` 。此外，在生命周期\n// 里 \\`Ref\\` 不能超过 \\`\'a\\`。\n\n// 使用 \\`Debug\\` 特征打印的通用函数。\nfn print<T>(t: T) where\n    T: Debug {\n    println!(&quot;\\`print\\`: t is {:?}&quot;, t);\n}\n\n// 这里引用 \\`T\\` 使用 where \\`T\\` 实现\n// \\`Debug\\` 和所有引用 \\`T\\` 都要比 \\`\'a\\` 长\n// 此外，\\`\'a\\`必须要比函数声明周期长\nfn print_ref<\'a, T>(t: &\'a T) where\n    T: Debug + \'a {\n    println!(&quot;\\`print_ref\\`: t is {:?}&quot;, t);\n}\n\nfn main() {\n    let x = 7;\n    let ref_x = Ref(&x);\n\n    print_ref(&ref_x);\n    print(ref_x);\n}`, `6186083043565116000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Debug<span class="token punctuation">;</span> <span class="token comment">// 特征约束使用</span>\n\n<span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Ref<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> T<span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// `Ref` 包含对泛型类型 `T` 的引用，该泛型类型具有</span>\n<span class="token comment">// 未知的生命周期 `\'a`. `T` 是约定任何</span>\n<span class="token comment">// 引用在 `T` 必须大于 `\'a` 。此外，在生命周期</span>\n<span class="token comment">// 里 `Ref` 不能超过 `\'a`。</span>\n\n<span class="token comment">// 使用 `Debug` 特征打印的通用函数。</span>\n<span class="token keyword">fn</span> print<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token keyword">where</span>\n    T<span class="token punctuation">:</span> Debug <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print`: t is {:?}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 这里引用 `T` 使用 where `T` 实现</span>\n<span class="token comment">// `Debug` 和所有引用 `T` 都要比 `\'a` 长</span>\n<span class="token comment">// 此外，`\'a`必须要比函数声明周期长</span>\n<span class="token keyword">fn</span> print_ref<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> T<span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T<span class="token punctuation">)</span> <span class="token keyword">where</span>\n    T<span class="token punctuation">:</span> Debug <span class="token operator">+</span> <span class="token lifetime-annotation symbol">\'a</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"`print_ref`: t is {:?}"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ref_x <span class="token operator">=</span> <span class="token function">Ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">print_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ref_x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>ref_x<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44747229767090720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用生命周期注释结构体\n1. \\`r\\` 和 \\`s\\` 必须是不同生命周期\n2. \\`s\\` 的生命周期需要大于 \'r\'\n*/\nstruct DoubleRef<T> {\n    r: &T,\n    s: &T\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `44747229767090720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用生命周期注释结构体\n1. `r` 和 `s` 必须是不同生命周期\n2. `s` 的生命周期需要大于 \'r\'\n*/</span>\n<span class="token keyword">struct</span> DoubleRef<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>\n    r<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T<span class="token punctuation">,</span>\n    s<span class="token punctuation">:</span> <span class="token operator">&amp;</span>T\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-193"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-193" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56317349023050210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用生命周期注释结构体\n1. \\`r\\` 和 \\`s\\` 必须是不同生命周期\n2. \\`s\\` 的生命周期需要大于 \'r\'\n*/\nstruct DoubleRef<\'a, \'b: \'a, T> {\n    r: &\'a T,\n    s: &\'b T,\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `56317349023050210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使用生命周期注释结构体\n1. `r` 和 `s` 必须是不同生命周期\n2. `s` 的生命周期需要大于 \'r\'\n*/</span>\n<span class="token keyword">struct</span> DoubleRef<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b:</span> <span class="token lifetime-annotation symbol">\'a,</span> T<span class="token operator">></span> <span class="token punctuation">{</span>\n    r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T<span class="token punctuation">,</span>\n    s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> T<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-27"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19820726227808084000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加类型约束使下面代码正常运行 */\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a, \'b> ImportantExcerpt<\'a> {\n    fn announce_and_return_part(&\'a self, announcement: &\'b str) -> &\'b str {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `19820726227808084000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加类型约束使下面代码正常运行 */</span>\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">announce_and_return_part</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-194"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-194" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44486785470653640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加类型约束使下面代码正常运行 */\nstruct ImportantExcerpt<\'a> {\n    part: &\'a str,\n}\n\nimpl<\'a: \'b, \'b> ImportantExcerpt<\'a> {\n    fn announce_and_return_part(&\'a self, announcement: &\'b str) -> &\'b str {\n        println!(&quot;Attention please: {}&quot;, announcement);\n        self.part\n    }\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `44486785470653640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加类型约束使下面代码正常运行 */</span>\n<span class="token keyword">struct</span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    part<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a:</span> <span class="token lifetime-annotation symbol">\'b,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> ImportantExcerpt<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">announce_and_return_part</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> announcement<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> str <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Attention please: {}"</span><span class="token punctuation">,</span> announcement<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>part\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-27"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75376015798552020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加类型约束使下面代码正常运行 */\nfn f<\'a, \'b>(x: &\'a i32, mut y: &\'b i32) {\n    y = x;\n    let r: &\'b &\'a i32 = &&0;\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `75376015798552020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加类型约束使下面代码正常运行 */</span>\n<span class="token keyword">fn</span> f<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> <span class="token keyword">mut</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token operator">=</span> <span class="token operator">&amp;&amp;</span><span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-195"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-195" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16716463773756619000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加类型约束使下面代码正常运行 */\nfn f<\'a: \'b, \'b>(x: &\'a i32, mut y: &\'b i32) {\n    y = x;\n    let r: &\'b &\'a i32 = &&0;\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `16716463773756619000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加类型约束使下面代码正常运行 */</span>\n<span class="token keyword">fn</span> f<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a:</span> <span class="token lifetime-annotation symbol">\'b,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> <span class="token keyword">mut</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token operator">=</span> <span class="token operator">&amp;&amp;</span><span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45534581863688815000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加类型约束使下面代码正常运行 */\nfn f<\'a, \'b>(x: &\'a i32, mut y: &\'b i32)\nwhere\n    \'a: \'b,\n{\n    y = x;\n    let r: &\'b &\'a i32 = &&0;\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `45534581863688815000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加类型约束使下面代码正常运行 */</span>\n<span class="token keyword">fn</span> f<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">,</span> <span class="token keyword">mut</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n    <span class="token lifetime-annotation symbol">\'a:</span> <span class="token lifetime-annotation symbol">\'b,</span>\n<span class="token punctuation">{</span>\n    y <span class="token operator">=</span> x<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32 <span class="token operator">=</span> <span class="token operator">&amp;&amp;</span><span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-26"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>类型约束可能在生命周期中排名更高。这些约束指定了一个约束对于所有生命周期都为真。例如，诸如此类的约束 <code class="language-text">for&lt;&#39;a&gt; &amp;&#39;a T: PartialEq&lt;i32&gt;</code> 需要如下实现：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55995831268068704000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`impl<\'a> PartialEq<i32> for &\'a T {\n   // ...\n}`, `55995831268068704000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> PartialEq<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token keyword">for</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T <span class="token punctuation">{</span>\n   <span class="token comment">// ...</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>然后可以用于将一个 <code class="language-text">&amp;&#39;a T</code> 与任何生命周期进行比较 i32。</p>\n<p>这里只能使用更高级别的约束，因为引用的生命周期比函数上任何可能的生命周期参数都短。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30761924989243950000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加 HRTB 使下面代码正常运行！ */\nfn call_on_ref_zero<\'a, F>(f: F) where F: Fn(&\'a i32) {\n    let zero = 0;\n    f(&zero);\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `30761924989243950000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加 HRTB 使下面代码正常运行！ */</span>\n<span class="token keyword">fn</span> call_on_ref_zero<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> F<span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">:</span> F<span class="token punctuation">)</span> <span class="token keyword">where</span> F<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>zero<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-196"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-196" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40164652310682270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 添加 HRTB 使下面代码正常运行！ */\nfn call_on_ref_zero<\'a, F>(f: F)\nwhere\n    for<\'b> F: Fn(&\'b i32),\n{\n    let zero = 0;\n    f(&zero);\n}\n\nfn main() {\n    println!(&quot;Success!&quot;)\n}`, `40164652310682270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 添加 HRTB 使下面代码正常运行！ */</span>\n<span class="token keyword">fn</span> call_on_ref_zero<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> F<span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">:</span> F<span class="token punctuation">)</span>\n<span class="token keyword">where</span>\n    <span class="token keyword">for</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> F<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> i32<span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">let</span> zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>zero<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-26"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>在解释 NLL 之前，我们先看一段代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14235351428587295000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   let mut s = String::from(&quot;hello&quot;);\n\n    let r1 = &s;\n    let r2 = &s;\n    println!(&quot;{} and {}&quot;, r1, r2);\n\n    let r3 = &mut s;\n    println!(&quot;{}&quot;, r3);\n}`, `14235351428587295000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{} and {}"</span><span class="token punctuation">,</span> r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> r3 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> r3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>根据我们目前的知识，这段代码会因为违反 Rust 中的借用规则而导致错误。</p>\n<p>但是，如果您执行 cargo run，那么一切都没问题，那么这里发生了什么？</p>\n<p>编译器在作用域结束之前判断不再使用引用的能力称为非词法生命周期（简称 NLL）。</p>\n<p>有了这种能力，编译器就知道最后一次使用引用是什么时候，并根据这些知识优化借用规则。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28791520779379433000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`let mut u = 0i32;\nlet mut v = 1i32;\nlet mut w = 2i32;\n\n// lifetime of \\`a\\` = α ∪ β ∪ γ\nlet mut a = &mut u;     // --+ α. lifetime of \\`&mut u\\`  --+ lexical &quot;lifetime&quot; of \\`&mut u\\`,\\`&mut u\\`, \\`&mut w\\` and \\`a\\`\nuse(a);                 //   |                            |\n*a = 3; // <-----------------+                            |\n...                     //                                |\na = &mut v;             // --+ β. lifetime of \\`&mut v\\`    |\nuse(a);                 //   |                            |\n*a = 4; // <-----------------+                            |\n...                     //                                |\na = &mut w;             // --+ γ. lifetime of \\`&mut w\\`    |\nuse(a);                 //   |                            |\n*a = 5; // <-----------------+ <--------------------------+`, `28791520779379433000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">let</span> <span class="token keyword">mut</span> u <span class="token operator">=</span> <span class="token number">0i32</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> <span class="token number">1i32</span><span class="token punctuation">;</span>\n<span class="token keyword">let</span> <span class="token keyword">mut</span> w <span class="token operator">=</span> <span class="token number">2i32</span><span class="token punctuation">;</span>\n\n<span class="token comment">// lifetime of `a` = α ∪ β ∪ γ</span>\n<span class="token keyword">let</span> <span class="token keyword">mut</span> a <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> u<span class="token punctuation">;</span>     <span class="token comment">// --+ α. lifetime of `&amp;mut u`  --+ lexical "lifetime" of `&amp;mut u`,`&amp;mut u`, `&amp;mut w` and `a`</span>\n<span class="token keyword">use</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">//   |                            |</span>\n<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// &lt;-----------------+                            |</span>\n<span class="token punctuation">...</span>                     <span class="token comment">//                                |</span>\na <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">;</span>             <span class="token comment">// --+ β. lifetime of `&amp;mut v`    |</span>\n<span class="token keyword">use</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">//   |                            |</span>\n<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// &lt;-----------------+                            |</span>\n<span class="token punctuation">...</span>                     <span class="token comment">//                                |</span>\na <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> w<span class="token punctuation">;</span>             <span class="token comment">// --+ γ. lifetime of `&amp;mut w`    |</span>\n<span class="token keyword">use</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">//   |                            |</span>\n<span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// &lt;-----------------+ &lt;--------------------------+</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>学习了 NLL 之后，我们现在可以很容易地理解再借用了。</p>\n<p>示例</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99872546151824700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[derive(Debug)]\nstruct Point {\n    x: i32,\n    y: i32,\n}\n\nimpl Point {\n    fn move_to(&mut self, x: i32, y: i32) {\n        self.x = x;\n        self.y = y;\n    }\n}\n\nfn main() {\n    let mut p = Point { x: 0, y: 0 };\n    let r = &mut p;\n    // 这里是再借用\n    let rr: &Point = &*r;\n\n    println!(&quot;{:?}&quot;, rr); // 这里结束再借用\n\n    // 再借用结束，现在我们可以继续使用 \\`r\\`\n    r.move_to(10, 10);\n    println!(&quot;{:?}&quot;, r);\n}`, `99872546151824700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>\n<span class="token keyword">struct</span> Point <span class="token punctuation">{</span>\n    x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n    y<span class="token punctuation">:</span> i32<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span> Point <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">move_to</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> x<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>\n        <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> p <span class="token operator">=</span> Point <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> p<span class="token punctuation">;</span>\n    <span class="token comment">// 这里是再借用</span>\n    <span class="token keyword">let</span> rr<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Point <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token operator">*</span>r<span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> rr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这里结束再借用</span>\n\n    <span class="token comment">// 再借用结束，现在我们可以继续使用 `r`</span>\n    r<span class="token punctuation">.</span><span class="token function">move_to</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56590844646028394000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 通过重新排序一些代码使下面代码正常运行 */\nfn main() {\n    let mut data = 10;\n    let ref1 = &mut data;\n    let ref2 = &mut *ref1;\n\n    *ref1 += 1;\n    *ref2 += 2;\n\n    println!(&quot;{}&quot;, data);\n}`, `56590844646028394000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 通过重新排序一些代码使下面代码正常运行 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> data <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ref1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> data<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ref2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token operator">*</span>ref1<span class="token punctuation">;</span>\n\n    <span class="token operator">*</span>ref1 <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    <span class="token operator">*</span>ref2 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-197"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-197" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16285709915533840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 通过重新排序一些代码使下面代码正常运行 */\nfn main() {\n    let mut data = 10;\n    let ref1 = &mut data;\n    let ref2 = &mut *ref1;\n\n    *ref2 += 2;\n    *ref1 += 1;\n\n    println!(&quot;{}&quot;, data);\n}`, `16285709915533840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 通过重新排序一些代码使下面代码正常运行 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> data <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ref1 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> data<span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ref2 <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token operator">*</span>ref1<span class="token punctuation">;</span>\n\n    <span class="token operator">*</span>ref2 <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n    <span class="token operator">*</span>ref1 <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-22"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>未约束的生命周期：在 <a href="https://doc.rust-lang.org/nomicon/unbounded-lifetimes.html" target="_blank" rel="nofollow noreferrer noopener">Nomicon - Unbounded Lifetimes</a> 中查看更多信息。</p>\n<p>更多省略规则</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73942710427220620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`impl<\'a> Reader for BufReader<\'a> {\n    // \'a 在以下方法中不使用\n}\n\n// 可以写为：\nimpl Reader for BufReader<\'_> {\n\n}\n\\`\\`\n\n\\`\\`\\`rust\n// Rust 2015\nstruct Ref<\'a, T: \'a> {\n    field: &\'a T\n}\n\n// Rust 2018\nstruct Ref<\'a, T> {\n    field: &\'a T\n}`, `73942710427220620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> Reader <span class="token keyword">for</span> BufReader<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// \'a 在以下方法中不使用</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 可以写为：</span>\n<span class="token keyword">impl</span> Reader <span class="token keyword">for</span> BufReader<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'_</span><span class="token operator">></span> <span class="token punctuation">{</span>\n\n<span class="token punctuation">}</span>\n``\n\n```rust\n<span class="token comment">// Rust 2015</span>\n<span class="token keyword">struct</span> Ref<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> T<span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    field<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T\n<span class="token punctuation">}</span>\n\n<span class="token comment">// Rust 2018</span>\n<span class="token keyword">struct</span> Ref<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> T<span class="token operator">></span> <span class="token punctuation">{</span>\n    field<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> T\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78384796073793960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使下面代码正常运行 */\nstruct Interface<\'a> {\n    manager: &\'a mut Manager<\'a>\n}\n\nimpl<\'a> Interface<\'a> {\n    pub fn noop(self) {\n        println!(&quot;interface consumed&quot;);\n    }\n}\n\nstruct Manager<\'a> {\n    text: &\'a str\n}\n\nstruct List<\'a> {\n    manager: Manager<\'a>,\n}\n\nimpl<\'a> List<\'a> {\n    pub fn get_interface(&\'a mut self) -> Interface {\n        Interface {\n            manager: &mut self.manager\n        }\n    }\n}\n\nfn main() {\n    let mut list = List {\n        manager: Manager {\n            text: &quot;hello&quot;\n        }\n    };\n\n    list.get_interface().noop();\n\n    println!(&quot;Interface should be dropped here and the borrow released&quot;);\n\n    use_list(&list);\n}\n\nfn use_list(list: &List) {\n    println!(&quot;{}&quot;, list.manager.text);\n}`, `78384796073793960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使下面代码正常运行 */</span>\n<span class="token keyword">struct</span> Interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    manager<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">mut</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> Interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">noop</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"interface consumed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    text<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> List<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    manager<span class="token punctuation">:</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> List<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">get_interface</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> <span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Interface <span class="token punctuation">{</span>\n        Interface <span class="token punctuation">{</span>\n            manager<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>manager\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> list <span class="token operator">=</span> List <span class="token punctuation">{</span>\n        manager<span class="token punctuation">:</span> Manager <span class="token punctuation">{</span>\n            text<span class="token punctuation">:</span> <span class="token string">"hello"</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    list<span class="token punctuation">.</span><span class="token function">get_interface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Interface should be dropped here and the borrow released"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">use_list</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">use_list</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span>List<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-198"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-198" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19712987869153340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使下面代码正常运行 */\nstruct Interface<\'a, \'b> {\n    manager: &\'b mut Manager<\'a>,\n}\n\nimpl<\'a, \'b> Interface<\'a, \'b> {\n    pub fn noop(self) {\n        println!(&quot;interface consumed&quot;);\n    }\n}\n\nstruct Manager<\'a> {\n    text: &\'a str,\n}\n\nstruct List<\'a> {\n    manager: Manager<\'a>,\n}\n\nimpl<\'a> List<\'a> {\n    pub fn get_interface<\'b>(&\'b mut self) -> Interface<\'a, \'b> {\n        Interface {\n            manager: &mut self.manager,\n        }\n    }\n}\n\nfn main() {\n    let mut list = List {\n        manager: Manager { text: &quot;hello&quot; },\n    };\n\n    list.get_interface().noop();\n\n    println!(&quot;Interface should be dropped here and the borrow released&quot;);\n\n    use_list(&list);\n}\n\nfn use_list(list: &List) {\n    println!(&quot;{}&quot;, list.manager.text);\n}`, `19712987869153340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 使下面代码正常运行 */</span>\n<span class="token keyword">struct</span> Interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    manager<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> <span class="token keyword">mut</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> Interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">noop</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"interface consumed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    text<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'a</span> str<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> List<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    manager<span class="token punctuation">:</span> Manager<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> List<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a</span><span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> get_interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">\'b</span> <span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Interface<span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">\'a,</span> <span class="token lifetime-annotation symbol">\'b</span><span class="token operator">></span> <span class="token punctuation">{</span>\n        Interface <span class="token punctuation">{</span>\n            manager<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>manager<span class="token punctuation">,</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> list <span class="token operator">=</span> List <span class="token punctuation">{</span>\n        manager<span class="token punctuation">:</span> Manager <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">"hello"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    list<span class="token punctuation">.</span><span class="token function">get_interface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Interface should be dropped here and the borrow released"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">use_list</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">use_list</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span>List<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span>manager<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="返回值和错误处理"><a href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E5%92%8C%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>返回值和错误处理</h1>\n<h2 id="panic-深入剖析"><a href="#panic-%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>panic! 深入剖析</h2>\n<h3 id="问题一-28"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>Rust 中最简单的错误处理方式就是使用 panic。它会打印出一条错误信息并打印出栈调用情况，最终结束当前线程:</p>\n<ul>\n<li>若 panic 发生在 main 线程，那程序会随之退出</li>\n<li>如果是在生成的（spawn）子线程中发生 panic，那么当前的线程会结束，但是程序依然会继续运行</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96976298846489310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn drink(beverage: &str) {\n    if beverage == &quot;lemonade&quot; {\n        println!(&quot;Success!&quot;);\n        // 实现下面的代码\n        __\n     }\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}\n\nfn main() {\n    drink(__);\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}`, `96976298846489310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">drink</span><span class="token punctuation">(</span>beverage<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> beverage <span class="token operator">==</span> <span class="token string">"lemonade"</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 实现下面的代码</span>\n        __\n     <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">drink</span><span class="token punctuation">(</span>__<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-199"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-199" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45424989631996350000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\nfn drink(beverage: &str) {\n    if beverage == &quot;lemonade&quot; {\n        println!(&quot;Success!&quot;);\n        // 实现下面的代码\n        panic!(&quot;32&quot;)\n    }\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}\n\nfn main() {\n    drink(&quot;lemonade&quot;);\n\n    println!(&quot;Exercise Failed if printing out this line!&quot;);\n}`, `45424989631996350000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token keyword">fn</span> <span class="token function">drink</span><span class="token punctuation">(</span>beverage<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> beverage <span class="token operator">==</span> <span class="token string">"lemonade"</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 实现下面的代码</span>\n        <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"32"</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">drink</span><span class="token punctuation">(</span><span class="token string">"lemonade"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Exercise Failed if printing out this line!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-28"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57178651483481380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复所有的 panic，让代码工作\nfn main() {\n    assert_eq!(&quot;abc&quot;.as_bytes(), [96, 97, 98]);\n\n    let v = vec![1, 2, 3];\n    let ele = v[3];\n    let ele = v.get(3).unwrap();\n\n    // 大部分时候编译器是可以帮我们提前发现溢出错误，并阻止编译通过。但是也有一些时候，这种溢出问题直到运行期才会出现\n    let v = production_rate_per_hour(2);\n\n    divide(15, 0);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn divide(x:u8, y:u8) {\n    println!(&quot;{}&quot;, x / y)\n}\n\nfn production_rate_per_hour(speed: u8) -> f64 {\n    let cph: u8 = 221;\n    match speed {\n        1..=4 => (speed * cph) as f64,\n        5..=8 => (speed * cph) as f64 * 0.9,\n        9..=10 => (speed * cph) as f64 * 0.77,\n        _ => 0 as f64,\n    }\n}\n\npub fn working_items_per_minute(speed: u8) -> u32 {\n    (production_rate_per_hour(speed) / 60 as f64) as u32\n}`, `57178651483481380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复所有的 panic，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 大部分时候编译器是可以帮我们提前发现溢出错误，并阻止编译通过。但是也有一些时候，这种溢出问题直到运行期才会出现</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">divide</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span>u8<span class="token punctuation">,</span> y<span class="token punctuation">:</span>u8<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x <span class="token operator">/</span> y<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span>speed<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> f64 <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> cph<span class="token punctuation">:</span> u8 <span class="token operator">=</span> <span class="token number">221</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> speed <span class="token punctuation">{</span>\n        <span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">4</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64<span class="token punctuation">,</span>\n        <span class="token number">5</span><span class="token punctuation">..=</span><span class="token number">8</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">,</span>\n        <span class="token number">9</span><span class="token punctuation">..=</span><span class="token number">10</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">0.77</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token number">0</span> <span class="token keyword">as</span> f64<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">working_items_per_minute</span><span class="token punctuation">(</span>speed<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n    <span class="token punctuation">(</span><span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token keyword">as</span> f64<span class="token punctuation">)</span> <span class="token keyword">as</span> u32\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-200"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-200" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74859335535498380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 修复所有的 panic，让代码工作\nfn main() {\n    assert_eq!(&quot;abc&quot;.as_bytes(), [97, 98, 99]);\n\n    let v = vec![1, 2, 3];\n    let ele = v[2];\n    let ele = v.get(3);\n\n    // 大部分时候编译器是可以帮我们提前发现溢出错误，并阻止编译通过。但是也有一些时候，这种溢出问题直到运行期才会出现\n    let v = production_rate_per_hour(2);\n\n    divide(15, 1);\n\n    println!(&quot;Success!&quot;)\n}\n\nfn divide(x: u8, y: u8) {\n    println!(&quot;{}&quot;, x / y)\n}\n\nfn production_rate_per_hour(speed: u8) -> f64 {\n    let cph: u8 = 21;\n    match speed {\n        1..=4 => (speed * cph) as f64,\n        5..=8 => (speed * cph) as f64 * 0.9,\n        9..=10 => (speed * cph) as f64 * 0.77,\n        _ => 0 as f64,\n    }\n}\n\npub fn working_items_per_minute(speed: u8) -> u32 {\n    (production_rate_per_hour(speed) / 60 as f64) as u32\n}`, `74859335535498380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 修复所有的 panic，让代码工作</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> ele <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 大部分时候编译器是可以帮我们提前发现溢出错误，并阻止编译通过。但是也有一些时候，这种溢出问题直到运行期才会出现</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">divide</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> u8<span class="token punctuation">,</span> y<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x <span class="token operator">/</span> y<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span>speed<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> f64 <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> cph<span class="token punctuation">:</span> u8 <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> speed <span class="token punctuation">{</span>\n        <span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">4</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64<span class="token punctuation">,</span>\n        <span class="token number">5</span><span class="token punctuation">..=</span><span class="token number">8</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">,</span>\n        <span class="token number">9</span><span class="token punctuation">..=</span><span class="token number">10</span> <span class="token operator">=></span> <span class="token punctuation">(</span>speed <span class="token operator">*</span> cph<span class="token punctuation">)</span> <span class="token keyword">as</span> f64 <span class="token operator">*</span> <span class="token number">0.77</span><span class="token punctuation">,</span>\n        _ <span class="token operator">=></span> <span class="token number">0</span> <span class="token keyword">as</span> f64<span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">working_items_per_minute</span><span class="token punctuation">(</span>speed<span class="token punctuation">:</span> u8<span class="token punctuation">)</span> <span class="token punctuation">-></span> u32 <span class="token punctuation">{</span>\n    <span class="token punctuation">(</span><span class="token function">production_rate_per_hour</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token keyword">as</span> f64<span class="token punctuation">)</span> <span class="token keyword">as</span> u32\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-28"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>默认情况下，栈调用只会展示最基本的信息</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39458337738181880000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`thread \'main\' panicked at \'index out of bounds: the len is 3 but the index is 99\', src/main.rs:4:5\nnote: run with \\`RUST_BACKTRACE=1\\` environment variable to display a backtrace`, `39458337738181880000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">thread <span class="token string">\'main\'</span> panicked at <span class="token string">\'index out of bounds: the len is 3 but the index is 99\'</span>, src/main.rs:4:5\nnote: run with <span class="token variable"><span class="token variable">`</span><span class="token assign-left variable">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span><span class="token variable">`</span></span> environment variable to display a backtrace</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>但是有时候，我们还希望获取更详细的信息</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81439577201395630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`## 填空以打印全部的调用栈\n## 提示: 你可以在之前的默认 panic 信息中找到相关线索\n\\$ __ cargo run\nthread \'main\' panicked at \'assertion failed: \\`(left == right)\\`\n  left: \\`[97, 98, 99]\\`,\n right: \\`[96, 97, 98]\\`\', src/main.rs:3:5\nstack backtrace:\n   0: rust_begin_unwind\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/std/src/panicking.rs:498:5\n   1: core::panicking::panic_fmt\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/panicking.rs:116:14\n   2: core::panicking::assert_failed_inner\n   3: core::panicking::assert_failed\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/panicking.rs:154:5\n   4: study_cargo::main\n             at ./src/main.rs:3:5\n   5: core::ops::function::FnOnce::call_once\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/ops/function.rs:227:5\nnote: Some details are omitted, run with \\`RUST_BACKTRACE=full\\` for a verbose backtrace.`, `81439577201395630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token comment">## 填空以打印全部的调用栈</span>\n<span class="token comment">## 提示: 你可以在之前的默认 panic 信息中找到相关线索</span>\n$ __ cargo run\nthread <span class="token string">\'main\'</span> panicked at <span class="token string">\'assertion failed: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">(</span>left <span class="token operator">==</span> right<span class="token punctuation">)</span><span class="token variable">`</span></span>\n  left: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span><span class="token number">97</span>, <span class="token number">98</span>, <span class="token number">99</span><span class="token punctuation">]</span><span class="token variable">`</span></span>,\n right: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span><span class="token number">96</span>, <span class="token number">97</span>, <span class="token number">98</span><span class="token punctuation">]</span><span class="token variable">`</span></span>\'</span>, src/main.rs:3:5\nstack backtrace:\n   <span class="token number">0</span>: rust_begin_unwind\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/std/src/panicking.rs:498:5\n   <span class="token number">1</span>: core::panicking::panic_fmt\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/panicking.rs:116:14\n   <span class="token number">2</span>: core::panicking::assert_failed_inner\n   <span class="token number">3</span>: core::panicking::assert_failed\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/panicking.rs:154:5\n   <span class="token number">4</span>: study_cargo::main\n             at ./src/main.rs:3:5\n   <span class="token number">5</span>: core::ops::function::FnOnce::call_once\n             at /rustc/9d1b2106e23b1abd32fce1f17267604a5102f57a/library/core/src/ops/function.rs:227:5\nnote: Some details are omitted, run with <span class="token variable"><span class="token variable">`</span><span class="token assign-left variable">RUST_BACKTRACE</span><span class="token operator">=</span>full<span class="token variable">`</span></span> <span class="token keyword">for</span> a verbose backtrace.</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-201"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-201" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71597210376133520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`\\$ RUST_BACKTRACE=full cargo run`, `71597210376133520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token assign-left variable">RUST_BACKTRACE</span><span class="token operator">=</span>full cargo run</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h2 id="返回值-result-和-"><a href="#%E8%BF%94%E5%9B%9E%E5%80%BC-result-%E5%92%8C-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>返回值 Result 和 ?</h2>\n<h3 id="问题一-29"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p><code class="language-text">Result&lt;T&gt;</code> 是一个枚举类型用于描述返回的结果或错误，它包含两个成员（变体 variants）:</p>\n<ul>\n<li>Ok(T): 返回一个结果值 T</li>\n<li>Err(e): 返回一个错误，e 是具体的错误值</li>\n</ul>\n<p>简而言之，如果期待一个正确的结果，就返回 Ok，反之则是 Err。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79233713484193800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nuse std::num::ParseIntError;\n\nfn multiply(n1_str: &str, n2_str: &str) -> __ {\n    let n1 = n1_str.parse::<i32>();\n    let n2 = n2_str.parse::<i32>();\n    Ok(n1.unwrap() * n2.unwrap())\n}\n\nfn main() {\n    let result = multiply(&quot;10&quot;, &quot;2&quot;);\n    assert_eq!(result, __);\n\n    let result = multiply(&quot;t&quot;, &quot;2&quot;);\n    assert_eq!(result.__, 8);\n\n    println!(&quot;Success!&quot;)\n}`, `79233713484193800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> __ <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n1 <span class="token operator">=</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> n2 <span class="token operator">=</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">Ok</span><span class="token punctuation">(</span>n1<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> n2<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>__<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-202"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-202" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53707165631315370000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空并修复错误\nuse std::num::ParseIntError;\n\nfn multiply(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    let n1 = n1_str.parse::<i32>();\n    let n2 = n2_str.parse::<i32>();\n    Ok(n1.unwrap() * n2.unwrap())\n}\n\nfn main() {\n    let result = multiply(&quot;10&quot;, &quot;2&quot;);\n    assert_eq!(result, Ok(20));\n\n    let result = multiply(&quot;4&quot;, &quot;2&quot;);\n    assert_eq!(result.unwrap(), 8);\n\n    println!(&quot;Success!&quot;)\n}`, `53707165631315370000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n1 <span class="token operator">=</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> n2 <span class="token operator">=</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">Ok</span><span class="token punctuation">(</span>n1<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> n2<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-29"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>? 跟 unwrap 非常像，但是 ? 会返回一个错误，而不是直接 panic</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49854651009990180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用 ? 来实现 multiply\n// 不要使用 unwrap !\nfn multiply(n1_str: &str, n2_str: &str) -> __ {\n}\n\nfn main() {\n    assert_eq!(multiply(&quot;3&quot;, &quot;4&quot;).unwrap(), 12);\n    println!(&quot;Success!&quot;)\n}`, `49854651009990180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用 ? 来实现 multiply</span>\n<span class="token comment">// 不要使用 unwrap !</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> __ <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-203"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-203" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30799130465083690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用 ? 来实现 multiply\n// 不要使用 unwrap !\nfn multiply(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    let n1 = n1_str.parse::<i32>()?;\n    let n2 = n2_str.parse::<i32>()?;\n    Ok(n1 * n2)\n}\n\nfn main() {\n    assert_eq!(multiply(&quot;3&quot;, &quot;4&quot;).unwrap(), 12);\n    println!(&quot;Success!&quot;)\n}`, `30799130465083690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用 ? 来实现 multiply</span>\n<span class="token comment">// 不要使用 unwrap !</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> n1 <span class="token operator">=</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> n2 <span class="token operator">=</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>\n    <span class="token function">Ok</span><span class="token punctuation">(</span>n1 <span class="token operator">*</span> n2<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-29"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59568880488685300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fs::File;\nuse std::io::{self, Read};\n\nfn read_file1() -> Result<String, io::Error> {\n    let f = File::open(&quot;hello.txt&quot;);\n    let mut f = match f {\n        Ok(file) => file,\n        Err(e) => return Err(e),\n    };\n\n    let mut s = String::new();\n    match f.read_to_string(&mut s) {\n        Ok(_) => Ok(s),\n        Err(e) => Err(e),\n    }\n}\n\n// 填空\n// 不要修改其它代码\nfn read_file2() -> Result<String, io::Error> {\n    let mut s = String::new();\n\n    __;\n\n    Ok(s)\n}\n\nfn main() {\n    assert_eq!(read_file1().unwrap_err().to_string(), read_file2().unwrap_err().to_string());\n    println!(&quot;Success!&quot;)\n}`, `59568880488685300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">,</span> Read<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">read_file1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=></span> file<span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 填空</span>\n<span class="token comment">// 不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">read_file2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    __<span class="token punctuation">;</span>\n\n    <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">read_file1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">read_file2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-204"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-204" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48170945923093545000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fs::File;\nuse std::io::{self, Read};\n\nfn read_file1() -> Result<String, io::Error> {\n    let f = File::open(&quot;hello.txt&quot;);\n    let mut f = match f {\n        Ok(file) => file,\n        Err(e) => return Err(e),\n    };\n\n    let mut s = String::new();\n    match f.read_to_string(&mut s) {\n        Ok(_) => Ok(s),\n        Err(e) => Err(e),\n    }\n}\n\n// 填空\n// 不要修改其它代码\nfn read_file2() -> Result<String, io::Error> {\n    let mut s = String::new();\n\n    File::open(&quot;hello.txt&quot;)?.read_to_string(&mut s)?;\n\n    Ok(s)\n}\n\nfn main() {\n    assert_eq!(\n        read_file1().unwrap_err().to_string(),\n        read_file2().unwrap_err().to_string()\n    );\n    println!(&quot;Success!&quot;)\n}`, `48170945923093545000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span>File<span class="token punctuation">;</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">,</span> Read<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">read_file1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> f <span class="token operator">=</span> File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=></span> file<span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">match</span> f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 填空</span>\n<span class="token comment">// 不要修改其它代码</span>\n<span class="token keyword">fn</span> <span class="token function">read_file2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> io<span class="token punctuation">::</span>Error<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> String<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    File<span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"hello.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>\n\n    <span class="token function">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>\n        <span class="token function">read_file1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">read_file2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-27"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>map 和 and_then 是两个常用的组合器（combinator），可以用于 <code class="language-text">Result&lt;T, E&gt;</code> (也可用于 <code class="language-text">Option&lt;T&gt;</code>)</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72275675574559500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用两种方式填空: map, and then\nfn add_two(n_str: &str) -> Result<i32, ParseIntError> {\n   n_str.parse::<i32>().__\n}\n\nfn main() {\n    assert_eq!(add_two(&quot;4&quot;).unwrap(), 6);\n\n    println!(&quot;Success!&quot;)\n}`, `72275675574559500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用两种方式填空: map, and then</span>\n<span class="token keyword">fn</span> <span class="token function">add_two</span><span class="token punctuation">(</span>n_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n   n_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">add_two</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-205"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-205" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65373683586207470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用两种方式填空: map, and then\nfn add_two(n_str: &str) -> Result<i32, ParseIntError> {\n    n_str.parse::<i32>().map(|x| x + 2)\n}\n\nfn main() {\n    assert_eq!(add_two(&quot;4&quot;).unwrap(), 6);\n\n    println!(&quot;Success!&quot;)\n}`, `65373683586207470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用两种方式填空: map, and then</span>\n<span class="token keyword">fn</span> <span class="token function">add_two</span><span class="token punctuation">(</span>n_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    n_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">add_two</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73737237869529170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用两种方式填空: map, and then\nfn add_two(n_str: &str) -> Result<i32, ParseIntError> {\n    n_str.parse::<i32>().and_then(|x| Ok(x + 2))\n}\n\nfn main() {\n    assert_eq!(add_two(&quot;4&quot;).unwrap(), 6);\n\n    println!(&quot;Success!&quot;)\n}`, `73737237869529170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用两种方式填空: map, and then</span>\n<span class="token keyword">fn</span> <span class="token function">add_two</span><span class="token punctuation">(</span>n_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    n_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> <span class="token function">Ok</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">add_two</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-27"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6584907194055444000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 \\`unwrap\\`\n// 但是这种写法实在过于啰嗦..\nfn multiply(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    match n1_str.parse::<i32>() {\n        Ok(n1)  => {\n            match n2_str.parse::<i32>() {\n                Ok(n2)  => {\n                    Ok(n1 * n2)\n                },\n                Err(e) => Err(e),\n            }\n        },\n        Err(e) => Err(e),\n    }\n}\n\n// 重写上面的 \\`multiply\\` ，让它尽量简洁\n// 提示：使用 \\`and_then\\` 和 \\`map\\`\nfn multiply1(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    // 实现...\n}\n\nfn print(result: Result<i32, ParseIntError>) {\n    match result {\n        Ok(n)  => println!(&quot;n is {}&quot;, n),\n        Err(e) => println!(&quot;Error: {}&quot;, e),\n    }\n}\n\nfn main() {\n    let twenty = multiply1(&quot;10&quot;, &quot;2&quot;);\n    print(twenty);\n\n    // 下面的调用会提供更有帮助的错误信息\n    let tt = multiply(&quot;t&quot;, &quot;2&quot;);\n    print(tt);\n\n    println!(&quot;Success!&quot;)\n}`, `6584907194055444000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 `unwrap`</span>\n<span class="token comment">// 但是这种写法实在过于啰嗦..</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token punctuation">{</span>\n            <span class="token keyword">match</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token function">Ok</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token punctuation">{</span>\n                    <span class="token function">Ok</span><span class="token punctuation">(</span>n1 <span class="token operator">*</span> n2<span class="token punctuation">)</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 重写上面的 `multiply` ，让它尽量简洁</span>\n<span class="token comment">// 提示：使用 `and_then` 和 `map`</span>\n<span class="token keyword">fn</span> <span class="token function">multiply1</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现...</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> result <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> twenty <span class="token operator">=</span> <span class="token function">multiply1</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>twenty<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 下面的调用会提供更有帮助的错误信息</span>\n    <span class="token keyword">let</span> tt <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-206"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-206" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7184168848458072000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 \\`unwrap\\`\n// 但是这种写法实在过于啰嗦..\nfn multiply(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    match n1_str.parse::<i32>() {\n        Ok(n1) => match n2_str.parse::<i32>() {\n            Ok(n2) => Ok(n1 * n2),\n            Err(e) => Err(e),\n        },\n        Err(e) => Err(e),\n    }\n}\n\n// 重写上面的 \\`multiply\\` ，让它尽量简洁\n// 提示：使用 \\`and_then\\` 和 \\`map\\`\nfn multiply1(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    // 实现...\n    let a = n1_str.parse::<i32>()?;\n    let b = n2_str.parse::<i32>()?;\n    Ok(a + b)\n}\n\nfn print(result: Result<i32, ParseIntError>) {\n    match result {\n        Ok(n) => println!(&quot;n is {}&quot;, n),\n        Err(e) => println!(&quot;Error: {}&quot;, e),\n    }\n}\n\nfn main() {\n    let twenty = multiply1(&quot;10&quot;, &quot;2&quot;);\n    print(twenty);\n\n    // 下面的调用会提供更有帮助的错误信息\n    let tt = multiply(&quot;4&quot;, &quot;2&quot;);\n    print(tt);\n\n    println!(&quot;Success!&quot;)\n}`, `7184168848458072000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 `unwrap`</span>\n<span class="token comment">// 但是这种写法实在过于啰嗦..</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">match</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">Ok</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Ok</span><span class="token punctuation">(</span>n1 <span class="token operator">*</span> n2<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 重写上面的 `multiply` ，让它尽量简洁</span>\n<span class="token comment">// 提示：使用 `and_then` 和 `map`</span>\n<span class="token keyword">fn</span> <span class="token function">multiply1</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现...</span>\n    <span class="token keyword">let</span> a <span class="token operator">=</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> b <span class="token operator">=</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>\n    <span class="token function">Ok</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> result <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> twenty <span class="token operator">=</span> <span class="token function">multiply1</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>twenty<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 下面的调用会提供更有帮助的错误信息</span>\n    <span class="token keyword">let</span> tt <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7593334575757881000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 \\`unwrap\\`\n// 但是这种写法实在过于啰嗦..\nfn multiply(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    match n1_str.parse::<i32>() {\n        Ok(n1) => match n2_str.parse::<i32>() {\n            Ok(n2) => Ok(n1 * n2),\n            Err(e) => Err(e),\n        },\n        Err(e) => Err(e),\n    }\n}\n\n// 重写上面的 \\`multiply\\` ，让它尽量简洁\n// 提示：使用 \\`and_then\\` 和 \\`map\\`\nfn multiply1(n1_str: &str, n2_str: &str) -> Result<i32, ParseIntError> {\n    // 实现...\n    n1_str\n        .parse::<i32>()\n        .and_then(|x| n2_str.parse::<i32>().map(|y| x * y))\n}\n\nfn print(result: Result<i32, ParseIntError>) {\n    match result {\n        Ok(n) => println!(&quot;n is {}&quot;, n),\n        Err(e) => println!(&quot;Error: {}&quot;, e),\n    }\n}\n\nfn main() {\n    let twenty = multiply1(&quot;10&quot;, &quot;2&quot;);\n    print(twenty);\n\n    // 下面的调用会提供更有帮助的错误信息\n    let tt = multiply(&quot;t&quot;, &quot;2&quot;);\n    print(tt);\n\n    println!(&quot;Success!&quot;)\n}`, `7593334575757881000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用 Result 重写后，我们使用模式匹配的方式来处理，而无需使用 `unwrap`</span>\n<span class="token comment">// 但是这种写法实在过于啰嗦..</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> n1_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">match</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">Ok</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Ok</span><span class="token punctuation">(</span>n1 <span class="token operator">*</span> n2<span class="token punctuation">)</span><span class="token punctuation">,</span>\n            <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 重写上面的 `multiply` ，让它尽量简洁</span>\n<span class="token comment">// 提示：使用 `and_then` 和 `map`</span>\n<span class="token keyword">fn</span> <span class="token function">multiply1</span><span class="token punctuation">(</span>n1_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> n2_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token comment">// 实现...</span>\n    n1_str\n        <span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token operator">|</span>x<span class="token operator">|</span> n2_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>y<span class="token operator">|</span> x <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> result <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> twenty <span class="token operator">=</span> <span class="token function">multiply1</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>twenty<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 下面的调用会提供更有帮助的错误信息</span>\n    <span class="token keyword">let</span> tt <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span>tt<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-23"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>如果我们要在代码中到处使用 <code class="language-text">std::result::Result&lt;T, ParseIntError&gt;</code>，那毫无疑问，代码将变得特别冗长和啰嗦，对于这种情况，可以使用类型别名来解决。</p>\n<p>例如在标准库中，就在大量使用这种方式来简化代码: io::Result</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99771154584014860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 填空\ntype __;\n\n// 使用上面的别名来引用原来的 \\`Result\\` 类型\nfn multiply(first_number_str: &str, second_number_str: &str) -> Res<i32> {\n    first_number_str.parse::<i32>().and_then(|first_number| {\n        second_number_str.parse::<i32>().map(|second_number| first_number * second_number)\n    })\n}\n\n// 同样, 这里也使用了类型别名来简化代码\nfn print(result: Res<i32>) {\n    match result {\n        Ok(n)  => println!(&quot;n is {}&quot;, n),\n        Err(e) => println!(&quot;Error: {}&quot;, e),\n    }\n}\n\nfn main() {\n    print(multiply(&quot;10&quot;, &quot;2&quot;));\n    print(multiply(&quot;t&quot;, &quot;2&quot;));\n\n    println!(&quot;Success!&quot;)\n}`, `99771154584014860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 填空</span>\n<span class="token keyword">type</span> __<span class="token punctuation">;</span>\n\n<span class="token comment">// 使用上面的别名来引用原来的 `Result` 类型</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>first_number_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> second_number_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Res<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    first_number_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token punctuation">|</span>first_number<span class="token punctuation">|</span></span> <span class="token punctuation">{</span>\n        second_number_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>second_number<span class="token operator">|</span> first_number <span class="token operator">*</span> second_number<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 同样, 这里也使用了类型别名来简化代码</span>\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> Res<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> result <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>  <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 fn main 中使用 Result，一个典型的 main 函数长这样:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50482195391395316000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    println!(&quot;Hello World!&quot;);\n}`, `50482195391395316000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>事实上 main 函数还可以返回一个 Result 类型：如果 main 函数内部发生了错误，那该错误会被返回并且打印出一条错误的 debug 信息</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69014594915738090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\nfn main() -> Result<(), ParseIntError> {\n    let number_str = &quot;10&quot;;\n    let number = match number_str.parse::<i32>() {\n        Ok(number)  => number,\n        Err(e) => return Err(e),\n    };\n    println!(&quot;{}&quot;, number);\n    Ok(())\n}`, `69014594915738090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ParseIntError<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> number_str <span class="token operator">=</span> <span class="token string">"10"</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token keyword">match</span> number_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>  <span class="token operator">=></span> number<span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-207"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-207" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80277554774284850000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::num::ParseIntError;\n\n// 填空\ntype Res<T> = Result<T, ParseIntError>;\n\n// 使用上面的别名来引用原来的 \\`Result\\` 类型\nfn multiply(first_number_str: &str, second_number_str: &str) -> Res<i32> {\n    first_number_str.parse::<i32>().and_then(|first_number| {\n        second_number_str\n            .parse::<i32>()\n            .map(|second_number| first_number * second_number)\n    })\n}\n\n// 同样, 这里也使用了类型别名来简化代码\nfn print(result: Res<i32>) {\n    match result {\n        Ok(n) => println!(&quot;n is {}&quot;, n),\n        Err(e) => println!(&quot;Error: {}&quot;, e),\n    }\n}\n\nfn main() {\n    print(multiply(&quot;10&quot;, &quot;2&quot;));\n    print(multiply(&quot;t&quot;, &quot;2&quot;));\n\n    println!(&quot;Success!&quot;)\n}`, `80277554774284850000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>num<span class="token punctuation">::</span>ParseIntError<span class="token punctuation">;</span>\n\n<span class="token comment">// 填空</span>\n<span class="token keyword">type</span> Res<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">=</span> Result<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> ParseIntError<span class="token operator">></span><span class="token punctuation">;</span>\n\n<span class="token comment">// 使用上面的别名来引用原来的 `Result` 类型</span>\n<span class="token keyword">fn</span> <span class="token function">multiply</span><span class="token punctuation">(</span>first_number_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">,</span> second_number_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span>str<span class="token punctuation">)</span> <span class="token punctuation">-></span> Res<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    first_number_str<span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token punctuation">|</span>first_number<span class="token punctuation">|</span></span> <span class="token punctuation">{</span>\n        second_number_str\n            <span class="token punctuation">.</span>parse<span class="token punctuation">::</span><span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token operator">|</span>second_number<span class="token operator">|</span> first_number <span class="token operator">*</span> second_number<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 同样, 这里也使用了类型别名来简化代码</span>\n<span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> Res<span class="token operator">&lt;</span>i32<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">match</span> result <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"n is {}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Error: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="包和模块"><a href="#%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>包和模块</h1>\n<h2 id="包-crate"><a href="#%E5%8C%85-crate" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>包 Crate</h2>\n<h3 id="问题一-30"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>package 是你通过 Cargo 创建的工程或项目，因此在 package 的根目录下会有一个 Cargo.toml 文件。</p>\n<p>创建一个 package，拥有以下目录结构:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53582434931479716000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.\n├── Cargo.toml\n└── src\n    └── main.rs\n\n1 directory, 2 files`, `53582434931479716000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">.\n├── Cargo.toml\n└── src\n    └── main.rs\n\n1 directory, 2 files</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92623623463689730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# in Cargo.toml\n[package]\nname = &quot;hello-package&quot;\nversion = &quot;0.1.0&quot;\nedition = &quot;2021&quot;`, `92623623463689730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="toml"\n              >\n                <span class="gatsby-code-button-language">toml</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="toml"><pre style="counter-reset: linenumber NaN" class="language-toml line-numbers"><code class="language-toml"><span class="token comment"># in Cargo.toml</span>\n<span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>\n<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">"hello-package"</span>\n<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">"0.1.0"</span>\n<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">"2021"</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-208"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-208" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56967302761918530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`cargo new hello-package`, `56967302761918530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">cargo new hello-package</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="问题二-30"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>创建一个 package，拥有以下目录结构</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30773493071529700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.\n├── Cargo.toml\n└── src\n    └── lib.rs\n\n1 directory, 2 files`, `30773493071529700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">.\n├── Cargo.toml\n└── src\n    └── lib.rs\n\n1 directory, 2 files</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72706913852313470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# in Cargo.toml\n[package]\nname = &quot;hello-package1&quot;\nversion = &quot;0.1.0&quot;\nedition = &quot;2021&quot;`, `72706913852313470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="toml"\n              >\n                <span class="gatsby-code-button-language">toml</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="toml"><pre style="counter-reset: linenumber NaN" class="language-toml line-numbers"><code class="language-toml"><span class="token comment"># in Cargo.toml</span>\n<span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>\n<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">"hello-package1"</span>\n<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">"0.1.0"</span>\n<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">"2021"</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-209"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-209" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4981754940690574000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`cargo new --lib hello-package1`, `4981754940690574000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">cargo new --lib hello-package1</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="问题三-30"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95763401743033660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 使用你的答案填空 */\n\n// Q: package 1# 和 2# 的区别是什么 ?\n// A: __`, `95763401743033660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">/* 使用你的答案填空 */\n\n// Q: package 1# 和 2# 的区别是什么 ?\n// A: __</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-210"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-210" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<h3 id="问题四-28"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>一个包可以是二进制也可以一个依赖库。每一个包都有一个包根，例如二进制包的包根是 src/main.rs，库包的包根是 src/lib.rs。包根是编译器开始处理源代码文件的地方，同时也是包模块树的根部</p>\n<p>在 package hello-package 中，有一个二进制包，该包与 package 同名: hello-package, 其中 src/main.rs 是该二进制包的包根</p>\n<p>与 hello-package 类似，hello-package1 同样包含一个包，但是与之前的二进制包不同，该 package 包含的是库包，其中 src/lib.rs 是其包根</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84665148782617380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 填空 */\n\n// Q: package \\`hello-package1\\` 中的库包名称是?\n// A: __`, `84665148782617380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">/* 填空 */\n\n// Q: package `hello-package1` 中的库包名称是?\n// A: __</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-211"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-211" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<p>hello-package1</p>\n<h3 id="问题五-28"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>为 hello-package 添加一个库包，并且完成以下目录结构的填空:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18757549672810200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# 填空\n.\n├── Cargo.lock\n├── Cargo.toml\n├── src\n│   ├── __\n│   └── __`, `18757549672810200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text"># 填空\n.\n├── Cargo.lock\n├── Cargo.toml\n├── src\n│   ├── __\n│   └── __</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在上一个步骤后，我们的 hello-package 中已经存在两个包：一个二进制包和一个库包，两个包的名称都与 package 相同：hello-package。</p>\n<h4 id="我的解答-212"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-212" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22964726006429470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# FILL in the blanks\n.\n├── Cargo.lock\n├── Cargo.toml\n├── src\n│   ├── main.rs\n│   └── lib.rs`, `22964726006429470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text"># FILL in the blanks\n.\n├── Cargo.lock\n├── Cargo.toml\n├── src\n│   ├── main.rs\n│   └── lib.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题六-24"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h3>\n<p>一个 package 最多只能包含一个库包，但是却可以包含多个二进制包：通过将二进制文件放入到 src/bin 目录下实现: 该目录下的每个文件都是一个独立的二进制包，包名与文件名相同，不再与 package 的名称相同</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67625455572864745000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# 创建一个 package 包含以下包：\n# 1. 三个二进制包: \\`hello-package\\`, \\`main1\\` and \\`main2\\`\n# 2. 一个库包\n# 并完成以下目录结构的填空\n.\n├── Cargo.toml\n├── Cargo.lock\n├── src\n│   ├── __\n│   ├── __\n│   └── __\n│       └── __\n│       └── __\n├── tests # 存放集成测试文件的目录\n│   └── some_integration_tests.rs\n├── benches # 存放 benchmark 文件的目录 dir for benchmark files\n│   └── simple_bench.rs\n└── examples # 存放示例文件的目录\n    └── simple_example.rs`, `67625455572864745000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text"># 创建一个 package 包含以下包：\n# 1. 三个二进制包: `hello-package`, `main1` and `main2`\n# 2. 一个库包\n# 并完成以下目录结构的填空\n.\n├── Cargo.toml\n├── Cargo.lock\n├── src\n│   ├── __\n│   ├── __\n│   └── __\n│       └── __\n│       └── __\n├── tests # 存放集成测试文件的目录\n│   └── some_integration_tests.rs\n├── benches # 存放 benchmark 文件的目录 dir for benchmark files\n│   └── simple_bench.rs\n└── examples # 存放示例文件的目录\n    └── simple_example.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>可以看到，上面的 package 结构非常标准，你可以在很多 Rust 项目中看到该结构的身影</p>\n<h4 id="我的解答-213"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-213" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41065466525791265000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# Create a package which contains\n# 1. three binary crates: \\`hello-package\\`, \\`main1\\` and \\`main2\\`\n# 2. one library crate\n# describe the directory tree below\n.\n├── Cargo.toml\n├── Cargo.lock\n├── src\n│   ├── main.rs\n│   ├── lib.rs\n│   └── bin\n│       └── main1.rs\n│       └── main2.rs\n├── tests # directory for integrated tests files\n│   └── some_integration_tests.rs\n├── benches # dir for benchmark files\n│   └── simple_bench.rs\n└── examples # dir for example files\n    └── simple_example.rs`, `41065466525791265000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text"># Create a package which contains\n# 1. three binary crates: `hello-package`, `main1` and `main2`\n# 2. one library crate\n# describe the directory tree below\n.\n├── Cargo.toml\n├── Cargo.lock\n├── src\n│   ├── main.rs\n│   ├── lib.rs\n│   └── bin\n│       └── main1.rs\n│       └── main2.rs\n├── tests # directory for integrated tests files\n│   └── some_integration_tests.rs\n├── benches # dir for benchmark files\n│   └── simple_bench.rs\n└── examples # dir for example files\n    └── simple_example.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="模块-module"><a href="#%E6%A8%A1%E5%9D%97-module" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模块 Module</h2>\n<h3 id="问题一-31"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>之前我们创建了一个 package hello-package，它的目录结构在经过多次修改后，变成了以下模样</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52636480906365256000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.\n├── Cargo.toml\n├── src\n│   ├── lib.rs\n│   └── main.rs`, `52636480906365256000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">.\n├── Cargo.toml\n├── src\n│   ├── lib.rs\n│   └── main.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面，我们来为其中的库包创建一些模块，然后在二进制包中使用这些模块</p>\n<p>根据以下的模块树描述实现模块 <code class="language-text">front_of_house</code></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13879680846190645000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`库包的根(src/lib.rs)\n └── front_of_house\n     ├── hosting\n     │   ├── add_to_waitlist\n     │   └── seat_at_table\n     └── serving\n         ├── take_order\n         ├── serve_order\n         ├── take_payment\n         └── complain`, `13879680846190645000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">库包的根(src/lib.rs)\n └── front_of_house\n     ├── hosting\n     │   ├── add_to_waitlist\n     │   └── seat_at_table\n     └── serving\n         ├── take_order\n         ├── serve_order\n         ├── take_payment\n         └── complain</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60463273322739090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 填空\n// in __.rs\n\nmod front_of_house {\n    // 实现此模块\n}`, `60463273322739090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 填空</span>\n<span class="token comment">// in __.rs</span>\n\n<span class="token keyword">mod</span> front_of_house <span class="token punctuation">{</span>\n    <span class="token comment">// 实现此模块</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-214"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-214" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19182196679029540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\nmod front_of_house {\n    mod hosting {\n        fn add_to_waitlist() {}\n\n        fn seat_at_table() {}\n    }\n\n    mod serving {\n        fn take_order() {}\n\n        fn serve_order() {}\n\n        fn take_payment() {}\n\n        fn complain() {} \n    }\n}`, `19182196679029540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n<span class="token keyword">mod</span> front_of_house <span class="token punctuation">{</span>\n    <span class="token keyword">mod</span> hosting <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">mod</span> serving <span class="token punctuation">{</span>\n        <span class="token keyword">fn</span> <span class="token function">take_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">take_payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">fn</span> <span class="token function">complain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> \n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-31"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>让我们在库包的根中定义一个函数 <code class="language-text">eat_at_restaurant</code>, 然后在该函数中调用之前创建的函数 <code class="language-text">eat_at_restaurant</code></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47002994862766150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\n// 填空并修复错误\n\n// 提示：你需要通过 \\`pub\\` 将一些项标记为公有的，这样模块 \\`front_of_house\\` 中的项才能被模块外的项访问\nmod front_of_house {\n   /* ...snip... */\n}\n\npub fn eat_at_restaurant() {\n   // 使用绝对路径调用\n   __.add_to_waitlist();\n\n   // 使用相对路径调用\n   __.add_to_waitlist();\n}`, `47002994862766150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token comment">// 填空并修复错误</span>\n\n<span class="token comment">// 提示：你需要通过 `pub` 将一些项标记为公有的，这样模块 `front_of_house` 中的项才能被模块外的项访问</span>\n<span class="token keyword">mod</span> front_of_house <span class="token punctuation">{</span>\n   <span class="token comment">/* ...snip... */</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token comment">// 使用绝对路径调用</span>\n   __<span class="token punctuation">.</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   <span class="token comment">// 使用相对路径调用</span>\n   __<span class="token punctuation">.</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-215"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-215" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26655841027472360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\npub mod front_of_house {\n    pub mod hosting {\n        pub fn add_to_waitlist() {}\n\n        pub fn seat_at_table() {}\n    }\n\n    pub mod serving {\n        pub fn take_order() {}\n\n        pub fn serve_order() {}\n\n        pub fn take_payment() {}\n\n        // Maybe you don\'t want the guest hearing the your complaining about them\n        // So just make it private\n        fn complain() {} \n    }\n}\n\npub fn eat_at_restaurant() {\n    // 绝对路径\n    crate::front_of_house::hosting::add_to_waitlist();\n\n    // 相对路径\n    front_of_house::hosting::add_to_waitlist();\n}`, `26655841027472360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> front_of_house <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">mod</span> hosting <span class="token punctuation">{</span>\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">pub</span> <span class="token keyword">mod</span> serving <span class="token punctuation">{</span>\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n        <span class="token comment">// Maybe you don\'t want the guest hearing the your complaining about them</span>\n        <span class="token comment">// So just make it private</span>\n        <span class="token keyword">fn</span> <span class="token function">complain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> \n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 绝对路径</span>\n    <span class="token keyword">crate</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 相对路径</span>\n    front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-31"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>我们还可以使用 super 来导入父模块中的项</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3359671958895349000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\nmod back_of_house {\n    fn fix_incorrect_order() {\n        cook_order();\n        // 使用三种方式填空\n        // 1. 使用关键字 \\`super\\`\n        // 2. 使用绝对路径\n        __.serve_order();\n    }\n\n    fn cook_order() {}\n}`, `3359671958895349000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token keyword">mod</span> back_of_house <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fix_incorrect_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// 使用三种方式填空</span>\n        <span class="token comment">// 1. 使用关键字 `super`</span>\n        <span class="token comment">// 2. 使用绝对路径</span>\n        __<span class="token punctuation">.</span><span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-216"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-216" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59841595149400910000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`mod back_of_house {\n    fn fix_incorrect_order() {\n        cook_order();\n        super::front_of_house::serving::serve_order();\n    }\n\n    fn cook_order() {}\n}`, `59841595149400910000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">mod</span> back_of_house <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fix_incorrect_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">super</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">::</span>serving<span class="token punctuation">::</span><span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83836226610414320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`mod back_of_house {\n    fn fix_incorrect_order() {\n        cook_order();\n        crate::front_of_house::serving::serve_order();\n    }\n\n    fn cook_order() {}\n}`, `83836226610414320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">mod</span> back_of_house <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function">fix_incorrect_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">crate</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">::</span>serving<span class="token punctuation">::</span><span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">fn</span> <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-29"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>将模块分离并放入独立的文件中</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39527079633032060000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\npub mod front_of_house {\n   pub mod hosting {\n      pub fn add_to_waitlist() {}\n\n      pub fn seat_at_table() -> String {\n            String::from(&quot;sit down please&quot;)\n      }\n   }\n\n   pub mod serving {\n      pub fn take_order() {}\n\n      pub fn serve_order() {}\n\n      pub fn take_payment() {}\n\n      // 我猜你不希望顾客听到你在抱怨他们，因此让这个函数私有化吧\n      fn complain() {}\n   }\n}\n\npub fn eat_at_restaurant() -> String {\n   front_of_house::hosting::add_to_waitlist();\n\n   back_of_house::cook_order();\n\n   String::from(&quot;yummy yummy!&quot;)\n}\n\npub mod back_of_house {\n   pub fn fix_incorrect_order() {\n      cook_order();\n      crate::front_of_house::serving::serve_order();\n   }\n\n   pub fn cook_order() {}\n}`, `39527079633032060000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> front_of_house <span class="token punctuation">{</span>\n   <span class="token keyword">pub</span> <span class="token keyword">mod</span> hosting <span class="token punctuation">{</span>\n      <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n      <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n            String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sit down please"</span><span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n   <span class="token punctuation">}</span>\n\n   <span class="token keyword">pub</span> <span class="token keyword">mod</span> serving <span class="token punctuation">{</span>\n      <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n      <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n      <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n      <span class="token comment">// 我猜你不希望顾客听到你在抱怨他们，因此让这个函数私有化吧</span>\n      <span class="token keyword">fn</span> <span class="token function">complain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n   front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   back_of_house<span class="token punctuation">::</span><span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n   String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"yummy yummy!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> back_of_house <span class="token punctuation">{</span>\n   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">fix_incorrect_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">crate</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">::</span>serving<span class="token punctuation">::</span><span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n\n   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>请将上面的模块和代码分离到以下目录文件中</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47793544860700480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.\n├── Cargo.toml\n├── src\n│   ├── back_of_house.rs\n│   ├── front_of_house\n│   │   ├── hosting.rs\n│   │   ├── mod.rs\n│   │   └── serving.rs\n│   ├── lib.rs\n│   └── main.rs`, `47793544860700480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">.\n├── Cargo.toml\n├── src\n│   ├── back_of_house.rs\n│   ├── front_of_house\n│   │   ├── hosting.rs\n│   │   ├── mod.rs\n│   │   └── serving.rs\n│   ├── lib.rs\n│   └── main.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66384748485236330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/lib.rs\n\n// IMPLEMENT...`, `66384748485236330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/lib.rs</span>\n\n<span class="token comment">// IMPLEMENT...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51961247293347100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/back_of_house.rs\n\n// IMPLEMENT...`, `51961247293347100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/back_of_house.rs</span>\n\n<span class="token comment">// IMPLEMENT...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96456752328717550000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/mod.rs\n\n// IMPLEMENT...`, `96456752328717550000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/mod.rs</span>\n\n<span class="token comment">// IMPLEMENT...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95279580084707120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/hosting.rs\n\n// IMPLEMENT...`, `95279580084707120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/hosting.rs</span>\n\n<span class="token comment">// IMPLEMENT...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80398324622241460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/serving.rs\n\n// IMPLEMENT...`, `80398324622241460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/serving.rs</span>\n\n<span class="token comment">// IMPLEMENT...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-217"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-217" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74824226317646220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/lib.rs\n\nmod front_of_house;\nmod back_of_house;\npub fn eat_at_restaurant() -> String {\n    front_of_house::hosting::add_to_waitlist();\n\n    back_of_house::cook_order();\n\n    String::from(&quot;yummy yummy!&quot;)\n}`, `74824226317646220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/lib.rs</span>\n\n<span class="token keyword">mod</span> front_of_house<span class="token punctuation">;</span>\n<span class="token keyword">mod</span> back_of_house<span class="token punctuation">;</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    back_of_house<span class="token punctuation">::</span><span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"yummy yummy!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88122792503360200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/back_of_house.rs\n\nuse crate::front_of_house;\npub fn fix_incorrect_order() {\n    cook_order();\n    front_of_house::serving::serve_order();\n}\n\npub fn cook_order() {}`, `88122792503360200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/back_of_house.rs</span>\n\n<span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">;</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">fix_incorrect_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    front_of_house<span class="token punctuation">::</span>serving<span class="token punctuation">::</span><span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">cook_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18178152893316524000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/mod.rs\n\npub mod hosting;\npub mod serving;`, `18178152893316524000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/mod.rs</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> hosting<span class="token punctuation">;</span>\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> serving<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76874226189754940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/hosting.rs\n\npub fn add_to_waitlist() {}\n\npub fn seat_at_table() -> String {\n    String::from(&quot;sit down please&quot;)\n}`, `76874226189754940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/hosting.rs</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_to_waitlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sit down please"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45053609089368480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/front_of_house/serving.rs\n\npub fn take_order() {}\n\npub fn serve_order() {}\n\npub fn take_payment() {}\n\n// Maybe you don\'t want the guest hearing the your complaining about them\n// So just make it private\nfn complain() {} `, `45053609089368480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/front_of_house/serving.rs</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">serve_order</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">take_payment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token comment">// Maybe you don\'t want the guest hearing the your complaining about them</span>\n<span class="token comment">// So just make it private</span>\n<span class="token keyword">fn</span> <span class="token function">complain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> </code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题五-29"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h3>\n<p>从二进制包中访问库包的代码，此时你的项目结构应该如下所示</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30551738795137106000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`.\n├── Cargo.toml\n├── src\n│   ├── back_of_house.rs\n│   ├── front_of_house\n│   │   ├── hosting.rs\n│   │   ├── mod.rs\n│   │   └── serving.rs\n│   ├── lib.rs\n│   └── main.rs`, `30551738795137106000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">.\n├── Cargo.toml\n├── src\n│   ├── back_of_house.rs\n│   ├── front_of_house\n│   │   ├── hosting.rs\n│   │   ├── mod.rs\n│   │   └── serving.rs\n│   ├── lib.rs\n│   └── main.rs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在我们可以从二进制包中发起函数调用了</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42247039931627660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/main.rs\n\n// 填空并修复错误\nfn main() {\n    assert_eq!(__, &quot;sit down please&quot;);\n    assert_eq!(__,&quot;yummy yummy!&quot;);\n}`, `42247039931627660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/main.rs</span>\n\n<span class="token comment">// 填空并修复错误</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token string">"sit down please"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span><span class="token string">"yummy yummy!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-218"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-218" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47521988164111390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`mod front_of_house;\n\nfn main() {\n    assert_eq!(front_of_house::hosting::seat_at_table(), &quot;sit down please&quot;);\n    assert_eq!(hello_package::eat_at_restaurant(),&quot;yummy yummy!&quot;);\n}`, `47521988164111390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">mod</span> front_of_house<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sit down please"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span>hello_package<span class="token punctuation">::</span><span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"yummy yummy!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="使用-use-引入模块及受限可见性"><a href="#%E4%BD%BF%E7%94%A8-use-%E5%BC%95%E5%85%A5%E6%A8%A1%E5%9D%97%E5%8F%8A%E5%8F%97%E9%99%90%E5%8F%AF%E8%A7%81%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 use 引入模块及受限可见性</h2>\n<h3 id="问题一-32"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h3>\n<p>使用 use 可以将两个同名类型引入到当前作用域中，但是别忘了 as 关键字</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11462605800446312000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt::Result;\nuse std::io::Result;\n\nfn main() {}`, `11462605800446312000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Result<span class="token punctuation">;</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>Result<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-219"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-219" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43452779239835210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::fmt::Result;\nuse std::io::Result as IoResult;\n\nfn main() {}`, `43452779239835210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span>Result<span class="token punctuation">;</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>io<span class="token punctuation">::</span>Result <span class="token keyword">as</span> IoResult<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题二-32"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h3>\n<p>如果我们在使用来自同一个包或模块中的多个不同项，那么可以通过简单的方式将它们一次性引入进来</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83227175360806760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 使用两种方式填空\n// 不要添加新的代码行\nuse std::collections::__;\n\nfn main() {\n    let _c1:HashMap<&str, i32> = HashMap::new();\n    let mut c2 = BTreeMap::new();\n    c2.insert(1, &quot;a&quot;);\n    let _c3: HashSet<i32> = HashSet::new();\n}`, `83227175360806760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 使用两种方式填空</span>\n<span class="token comment">// 不要添加新的代码行</span>\n<span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>__<span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _c1<span class="token punctuation">:</span>HashMap<span class="token operator">&lt;</span><span class="token operator">&amp;</span>str<span class="token punctuation">,</span> i32<span class="token operator">></span> <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> c2 <span class="token operator">=</span> BTreeMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    c2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _c3<span class="token punctuation">:</span> HashSet<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> HashSet<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-220"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-220" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98069708804754640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::collections::*;\n\nfn main() {\n    let _c1:HashMap<&str, i32> = HashMap::new();\n    let mut c2 = BTreeMap::new();\n    c2.insert(1, &quot;a&quot;);\n    let _c3: HashSet<i32> = HashSet::new();\n}`, `98069708804754640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _c1<span class="token punctuation">:</span>HashMap<span class="token operator">&lt;</span><span class="token operator">&amp;</span>str<span class="token punctuation">,</span> i32<span class="token operator">></span> <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> c2 <span class="token operator">=</span> BTreeMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    c2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _c3<span class="token punctuation">:</span> HashSet<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> HashSet<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40441199335590520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`use std::collections::{HashMap, BTreeMap, HashSet};\n\nfn main() {\n    let _c1:HashMap<&str, i32> = HashMap::new();\n    let mut c2 = BTreeMap::new();\n    c2.insert(1, &quot;a&quot;);\n    let _c3: HashSet<i32> = HashSet::new();\n}`, `40441199335590520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">use</span> std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span><span class="token punctuation">{</span>HashMap<span class="token punctuation">,</span> BTreeMap<span class="token punctuation">,</span> HashSet<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> _c1<span class="token punctuation">:</span>HashMap<span class="token operator">&lt;</span><span class="token operator">&amp;</span>str<span class="token punctuation">,</span> i32<span class="token operator">></span> <span class="token operator">=</span> HashMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> <span class="token keyword">mut</span> c2 <span class="token operator">=</span> BTreeMap<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    c2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> _c3<span class="token punctuation">:</span> HashSet<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token operator">=</span> HashSet<span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题三-32"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h3>\n<p>使用 pub use 进行再导出</p>\n<p>在之前创建的 hello-package 的库包中，添加一些代码让下面的代码能够正常工作</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57665695646528725000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n   assert_eq!(hello_package::hosting::seat_at_table(), &quot;sit down please&quot;);\n   assert_eq!(hello_package::eat_at_restaurant(),&quot;yummy yummy!&quot;);\n}`, `57665695646528725000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>hello_package<span class="token punctuation">::</span>hosting<span class="token punctuation">::</span><span class="token function">seat_at_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"sit down please"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token function">assert_eq!</span><span class="token punctuation">(</span>hello_package<span class="token punctuation">::</span><span class="token function">eat_at_restaurant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"yummy yummy!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="我的解答-221"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-221" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h4>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54573891980923660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\n// Add this line\npub use crate::front_of_house::hosting;`, `54573891980923660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token comment">// Add this line</span>\n<span class="token keyword">pub</span> <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>front_of_house<span class="token punctuation">::</span>hosting<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="问题四-30"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h3>\n<p>pub(in Crate)</p>\n<p>有时我们希望某一个项只对特定的包可见，那么就可以使用 pub(in Crate) 语法</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9484149553154930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pub mod a {\n    pub const I: i32 = 3;\n\n    fn semisecret(x: i32) -> i32 {\n        use self:🅱:c::J;\n        x + J\n    }\n\n    pub fn bar(z: i32) -> i32 {\n        semisecret(I) * z\n    }\n    pub fn foo(y: i32) -> i32 {\n        semisecret(I) + y\n    }\n\n    mod b {\n        pub(in crate::a) mod c {\n            pub(in crate::a) const J: i32 = 4;\n        }\n    }\n}`, `9484149553154930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">mod</span> a <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span> <span class="token keyword">const</span> I<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">fn</span> <span class="token function">semisecret</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n        <span class="token keyword">use</span> <span class="token keyword">self</span><span class="token punctuation">:</span>🅱<span class="token punctuation">:</span>c<span class="token punctuation">::</span>J<span class="token punctuation">;</span>\n        x <span class="token operator">+</span> J\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">bar</span><span class="token punctuation">(</span>z<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n        <span class="token function">semisecret</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">*</span> z\n    <span class="token punctuation">}</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">foo</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n        <span class="token function">semisecret</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">+</span> y\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">mod</span> b <span class="token punctuation">{</span>\n        <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>a<span class="token punctuation">)</span> <span class="token keyword">mod</span> c <span class="token punctuation">{</span>\n            <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>a<span class="token punctuation">)</span> <span class="token keyword">const</span> J<span class="token punctuation">:</span> i32 <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65135670660671185000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 一个名为 \\`my_mod\\` 的模块\nmod my_mod {\n    // 模块中的项默认具有私有的可见性\n    fn private_function() {\n        println!(&quot;called \\`my_mod::private_function()\\`&quot;);\n    }\n\n    // 使用 \\`pub\\` 修饰语来改变默认可见性。\n    pub fn function() {\n        println!(&quot;called \\`my_mod::function()\\`&quot;);\n    }\n\n    // 在同一模块中，项可以访问其它项，即使它是私有的。\n    pub fn indirect_access() {\n        print!(&quot;called \\`my_mod::indirect_access()\\`, that\\n> &quot;);\n        private_function();\n    }\n\n    // 模块也可以嵌套\n    pub mod nested {\n        pub fn function() {\n            println!(&quot;called \\`my_mod::nested::function()\\`&quot;);\n        }\n\n        #[allow(dead_code)]\n        fn private_function() {\n            println!(&quot;called \\`my_mod::nested::private_function()\\`&quot;);\n        }\n\n        // 使用 \\`pub(in path)\\` 语法定义的函数只在给定的路径中可见。\n        // \\`path\\` 必须是父模块（parent module）或祖先模块（ancestor module）\n        pub(in crate::my_mod) fn public_function_in_my_mod() {\n            print!(&quot;called \\`my_mod::nested::public_function_in_my_mod()\\`, that\\n > &quot;);\n            public_function_in_nested()\n        }\n\n        // 使用 \\`pub(self)\\` 语法定义的函数则只在当前模块中可见。\n        pub(self) fn public_function_in_nested() {\n            println!(&quot;called \\`my_mod::nested::public_function_in_nested&quot;);\n        }\n\n        // 使用 \\`pub(super)\\` 语法定义的函数只在父模块中可见。\n        pub(super) fn public_function_in_super_mod() {\n            println!(&quot;called my_mod::nested::public_function_in_super_mod&quot;);\n        }\n    }\n\n    pub fn call_public_function_in_my_mod() {\n        print!(&quot;called \\`my_mod::call_public_funcion_in_my_mod()\\`, that\\n> &quot;);\n        nested::public_function_in_my_mod();\n        print!(&quot;> &quot;);\n        nested::public_function_in_super_mod();\n    }\n\n    // \\`pub(crate)\\` 使得函数只在当前包中可见\n    pub(crate) fn public_function_in_crate() {\n        println!(&quot;called \\`my_mod::public_function_in_crate()&quot;);\n    }\n\n    // 嵌套模块的可见性遵循相同的规则\n    mod private_nested {\n        #[allow(dead_code)]\n        pub fn function() {\n            println!(&quot;called \\`my_mod::private_nested::function()\\`&quot;);\n        }\n    }\n}\n\nfn function() {\n    println!(&quot;called \\`function()\\`&quot;);\n}\n\nfn main() {\n    // 模块机制消除了相同名字的项之间的歧义。\n    function();\n    my_mod::function();\n\n    // 公有项，包括嵌套模块内的，都可以在父模块外部访问。\n    my_mod::indirect_access();\n    my_mod::nested::function();\n    my_mod::call_public_function_in_my_mod();\n\n    // pub(crate) 项可以在同一个 crate 中的任何地方访问\n    my_mod::public_function_in_crate();\n\n    // pub(in path) 项只能在指定的模块中访问\n    // 报错！函数 \\`public_function_in_my_mod\\` 是私有的\n    //my_mod::nested::public_function_in_my_mod();\n    // 试一试 ^ 取消该行的注释\n\n    // 模块的私有项不能直接访问，即便它是嵌套在公有模块内部的\n\n    // 报错！\\`private_function\\` 是私有的\n    //my_mod::private_function();\n    // 试一试 ^ 取消此行注释\n\n    // 报错！\\`private_function\\` 是私有的\n    //my_mod::nested::private_function();\n    // 试一试 ^ 取消此行的注释\n\n    // 报错！ \\`private_nested\\` 是私有的\n    //my_mod::private_nested::function();\n    // 试一试 ^ 取消此行的注释\n}`, `65135670660671185000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// 一个名为 `my_mod` 的模块</span>\n<span class="token keyword">mod</span> my_mod <span class="token punctuation">{</span>\n    <span class="token comment">// 模块中的项默认具有私有的可见性</span>\n    <span class="token keyword">fn</span> <span class="token function">private_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::private_function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 使用 `pub` 修饰语来改变默认可见性。</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 在同一模块中，项可以访问其它项，即使它是私有的。</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">indirect_access</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">print!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::indirect_access()`, that\\n> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">private_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 模块也可以嵌套</span>\n    <span class="token keyword">pub</span> <span class="token keyword">mod</span> nested <span class="token punctuation">{</span>\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::nested::function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token attribute attr-name">#[allow(dead_code)]</span>\n        <span class="token keyword">fn</span> <span class="token function">private_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::nested::private_function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token comment">// 使用 `pub(in path)` 语法定义的函数只在给定的路径中可见。</span>\n        <span class="token comment">// `path` 必须是父模块（parent module）或祖先模块（ancestor module）</span>\n        <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">in</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>my_mod<span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function">public_function_in_my_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">print!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::nested::public_function_in_my_mod()`, that\\n > "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token function">public_function_in_nested</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token comment">// 使用 `pub(self)` 语法定义的函数则只在当前模块中可见。</span>\n        <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function">public_function_in_nested</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::nested::public_function_in_nested"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token comment">// 使用 `pub(super)` 语法定义的函数只在父模块中可见。</span>\n        <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function">public_function_in_super_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called my_mod::nested::public_function_in_super_mod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">call_public_function_in_my_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">print!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::call_public_funcion_in_my_mod()`, that\\n> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        nested<span class="token punctuation">::</span><span class="token function">public_function_in_my_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token function">print!</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        nested<span class="token punctuation">::</span><span class="token function">public_function_in_super_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// `pub(crate)` 使得函数只在当前包中可见</span>\n    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token punctuation">)</span> <span class="token keyword">fn</span> <span class="token function">public_function_in_crate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::public_function_in_crate()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// 嵌套模块的可见性遵循相同的规则</span>\n    <span class="token keyword">mod</span> private_nested <span class="token punctuation">{</span>\n        <span class="token attribute attr-name">#[allow(dead_code)]</span>\n        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `my_mod::private_nested::function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"called `function()`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 模块机制消除了相同名字的项之间的歧义。</span>\n    <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    my_mod<span class="token punctuation">::</span><span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 公有项，包括嵌套模块内的，都可以在父模块外部访问。</span>\n    my_mod<span class="token punctuation">::</span><span class="token function">indirect_access</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    my_mod<span class="token punctuation">::</span>nested<span class="token punctuation">::</span><span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    my_mod<span class="token punctuation">::</span><span class="token function">call_public_function_in_my_mod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// pub(crate) 项可以在同一个 crate 中的任何地方访问</span>\n    my_mod<span class="token punctuation">::</span><span class="token function">public_function_in_crate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// pub(in path) 项只能在指定的模块中访问</span>\n    <span class="token comment">// 报错！函数 `public_function_in_my_mod` 是私有的</span>\n    <span class="token comment">//my_mod::nested::public_function_in_my_mod();</span>\n    <span class="token comment">// 试一试 ^ 取消该行的注释</span>\n\n    <span class="token comment">// 模块的私有项不能直接访问，即便它是嵌套在公有模块内部的</span>\n\n    <span class="token comment">// 报错！`private_function` 是私有的</span>\n    <span class="token comment">//my_mod::private_function();</span>\n    <span class="token comment">// 试一试 ^ 取消此行注释</span>\n\n    <span class="token comment">// 报错！`private_function` 是私有的</span>\n    <span class="token comment">//my_mod::nested::private_function();</span>\n    <span class="token comment">// 试一试 ^ 取消此行的注释</span>\n\n    <span class="token comment">// 报错！ `private_nested` 是私有的</span>\n    <span class="token comment">//my_mod::private_nested::function();</span>\n    <span class="token comment">// 试一试 ^ 取消此行的注释</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1 id="注释和文档"><a href="#%E6%B3%A8%E9%87%8A%E5%92%8C%E6%96%87%E6%A1%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>注释和文档</h1>\n<h2 id="问题一-33"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-33" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29466691414664937000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 只使用注释让下面代码工作! */\nfn main() {\n    todo!();\n    unimplemented!();\n\n    assert_eq!(6, 5 + 3 + 2 + 1 )\n}`, `29466691414664937000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 只使用注释让下面代码工作! */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">unimplemented!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>文档注释会被解析为 HTML 文件，并支持 Markdown 语法。</p>\n<p>在开始之前，我们需要创建一个新的项目用于后面的练习：<code class="language-text">cargo new --lib doc-comments</code></p>\n<p>行文档注释 ///</p>\n<p>为 add_one 函数添加文档</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80497323366904920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n   // in lib.rs\n\n   /// Add one to the given value and return the value\n   ///\n   /// # Examples\n   ///\n   /// \\`\\`\\`\n   /// let arg = 5;\n   /// let answer = my_crate::add_one(arg);\n   ///\n   /// assert_eq!(6, answer);\n   /// \\`\\`\\`\n   pub fn add_one(x: i32) -> i32 {\n      x + 1\n   }\n}`, `80497323366904920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token comment">// in lib.rs</span>\n\n   <span class="token comment">/// Add one to the given value and return the value</span>\n   <span class="token comment">///</span>\n   <span class="token comment">/// # Examples</span>\n   <span class="token comment">///</span>\n   <span class="token comment">/// ```</span>\n   <span class="token comment">/// let arg = 5;</span>\n   <span class="token comment">/// let answer = my_crate::add_one(arg);</span>\n   <span class="token comment">///</span>\n   <span class="token comment">/// assert_eq!(6, answer);</span>\n   <span class="token comment">/// ```</span>\n   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n      x <span class="token operator">+</span> <span class="token number">1</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们可以使用 <code class="language-text">cargo doc --open</code> 来生成 HTML 文件，并自动在浏览器中打开网页。</p>\n<p>块文档注释 <code class="language-text">/** ... */</code>，为函数 <code class="language-text">add_two</code> 添加文档:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19107752914974085000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#![allow(unused)]\nfn main() {\n   /** Add two to the given value and return a new value\n\n   Examples\n\n   let arg = 5;\n   let answer = my_crate::add_two(arg);\n\n   assert_eq!(7, answer);\n\n   */\n   pub fn add_two(x: i32) -> i32 {\n      x + 2\n   }\n}`, `19107752914974085000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#![allow(unused)]</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n   <span class="token comment">/** Add two to the given value and return a new value\n\n   Examples\n\n   let arg = 5;\n   let answer = my_crate::add_two(arg);\n\n   assert_eq!(7, answer);\n\n   */</span>\n   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_two</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n      x <span class="token operator">+</span> <span class="token number">2</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-222"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-222" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99764718288246360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `99764718288246360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题二-33"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-33" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h2>\n<p>为包和模块创建文档注释</p>\n<p>我们还可以创建包和模块的注释，用于描述它们的功能。</p>\n<p>首先，来为我们的库包添加一些文档注释:</p>\n<blockquote>\n<p>注意: 必须要将包、模块注释放置在包根或模块文件的最顶部</p>\n</blockquote>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95941101665877400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//! # 文档注释\n//!\n//! 该库用于文档注释的教学\n\n// in lib.rs\npub mod compute;`, `95941101665877400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">//! # 文档注释</span>\n<span class="token comment">//!</span>\n<span class="token comment">//! 该库用于文档注释的教学</span>\n\n<span class="token comment">// in lib.rs</span>\n<span class="token keyword">pub</span> <span class="token keyword">mod</span> compute<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>同样的，我们还可以使用块注释来达成目的:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33922813610899680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/*! # 文档注释\n\n 该库用于文档注释的教学 */`, `33922813610899680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/*! # 文档注释\n\n 该库用于文档注释的教学 */</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>下一步，创建一个新的模块文件 src/compute.rs，然后在其中添加以下注释:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55417574222851250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//! 本模块用于处理一些复杂计算\n\n// in compute.rs`, `55417574222851250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">//! 本模块用于处理一些复杂计算</span>\n\n<span class="token comment">// in compute.rs</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>然后运行 cargo doc —open 查看下结果。</p>\n<p>文档测试</p>\n<p>之前的 <code class="language-text">add_one</code> 和 <code class="language-text">add_two</code> 的文档注释中，包含了两个示例代码块</p>\n<p>以上示例不仅仅是作为文档用于演示你的函数该如何使用，它的另一个作用就是用于文档测试 cargo test。</p>\n<p>但是在这两个函数的示例中，存在错误，请修复它们并使用 cargo test 获取以下输出结果:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76883379393061980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`running 0 tests\n\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s\n\n   Doc-tests doc-comments\n\nrunning 2 tests\ntest src/lib.rs - add_one (line 11) ... ok\ntest src/lib.rs - add_two (line 26) ... ok\n\ntest result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.55s`, `76883379393061980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">running <span class="token number">0</span> tests\n\n<span class="token builtin class-name">test</span> result: ok. <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span>.00s\n\n   Doc-tests doc-comments\n\nrunning <span class="token number">2</span> tests\n<span class="token builtin class-name">test</span> src/lib.rs - add_one <span class="token punctuation">(</span>line <span class="token number">11</span><span class="token punctuation">)</span> <span class="token punctuation">..</span>. ok\n<span class="token builtin class-name">test</span> src/lib.rs - add_two <span class="token punctuation">(</span>line <span class="token number">26</span><span class="token punctuation">)</span> <span class="token punctuation">..</span>. ok\n\n<span class="token builtin class-name">test</span> result: ok. <span class="token number">2</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span>.55s</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-223"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-223" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76620262162187340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\n/// Add one to the given value and return the value\n///\n/// # Examples\n///\n/// \\`\\`\\`\n/// let arg = 5;\n/// let answer = world_hello::add_one(arg);\n///\n/// assert_eq!(6, answer);\n/// \\`\\`\\`\npub fn add_one(x: i32) -> i32 {\n    x + 1\n}\n\n/** Add two to the given value and return a new value\n\n// 这里本来有 \\`\\`\\`，但和 md 语法冲突，省略不写\nlet arg = 5;\nlet answer = world_hello::add_two(arg);\n\nassert_eq!(7, answer);\n// 这里本来有 \\`\\`\\`，但和 md 语法冲突，省略不写\n\n*/\npub fn add_two(x: i32) -> i32 {\n    x + 2\n}`, `76620262162187340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token comment">/// Add one to the given value and return the value</span>\n<span class="token comment">///</span>\n<span class="token comment">/// # Examples</span>\n<span class="token comment">///</span>\n<span class="token comment">/// ```</span>\n<span class="token comment">/// let arg = 5;</span>\n<span class="token comment">/// let answer = world_hello::add_one(arg);</span>\n<span class="token comment">///</span>\n<span class="token comment">/// assert_eq!(6, answer);</span>\n<span class="token comment">/// ```</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> <span class="token number">1</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/** Add two to the given value and return a new value\n\n// 这里本来有 ```，但和 md 语法冲突，省略不写\nlet arg = 5;\nlet answer = world_hello::add_two(arg);\n\nassert_eq!(7, answer);\n// 这里本来有 ```，但和 md 语法冲突，省略不写\n\n*/</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_two</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n    x <span class="token operator">+</span> <span class="token number">2</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="问题三-33"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-33" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h2>\n<p>有时我们会期望示例的结果是一个 panic。将以下代码添加到 src/compute.rs，并且让 cargo test 成功运行</p>\n<blockquote>\n<p>你只能修改注释，不要修改 fn div</p>\n</blockquote>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22729705228242026000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/compute.rs\n\n/// # Panics\n///\n/// The function panics if the second argument is zero.\n///\n/// \\`\\`\\`rust,should_panic\n/// // panics on division by zero\n/// doc_comments::compute::div(10, 0);\n/// \\`\\`\\`\npub fn div(a: i32, b: i32) -> i32 {\n   if b == 0 {\n      panic!(&quot;Divide-by-zero error&quot;);\n   }\n\n   a / b\n}`, `22729705228242026000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/compute.rs</span>\n\n<span class="token comment">/// # Panics</span>\n<span class="token comment">///</span>\n<span class="token comment">/// The function panics if the second argument is zero.</span>\n<span class="token comment">///</span>\n<span class="token comment">/// ```rust,should_panic</span>\n<span class="token comment">/// // panics on division by zero</span>\n<span class="token comment">/// doc_comments::compute::div(10, 0);</span>\n<span class="token comment">/// ```</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">div</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> b<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> i32 <span class="token punctuation">{</span>\n   <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n      <span class="token function">panic!</span><span class="token punctuation">(</span><span class="token string">"Divide-by-zero error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n\n   a <span class="token operator">/</span> b\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-224"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-224" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28935788544443810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `28935788544443810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题四-31"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h2>\n<p>有时我们会想要隐藏文档，但是保留文档测试</p>\n<p>将以下代码添加到 src/compute.rs</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55235964196168340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in src/compute.rs\n\n/// \\`\\`\\`\n/// # fn try_main() -> Result<(), String> {\n/// let res = doc_comments::compute::try_div(10, 0)?;\n/// # Ok(()) // returning from try_main\n/// # }\n/// # fn main() {\n/// #    try_main().unwrap();\n/// #\n/// # }\n/// \\`\\`\\`\npub fn try_div(a: i32, b: i32) -> Result<i32, String> {\n    if b == 0 {\n        Err(String::from(&quot;Divide-by-zero&quot;))\n    } else {\n        Ok(a / b)\n    }\n}`, `55235964196168340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in src/compute.rs</span>\n\n<span class="token comment">/// ```</span>\n<span class="token comment">/// # fn try_main() -> Result&lt;(), String> {</span>\n<span class="token comment">/// let res = doc_comments::compute::try_div(10, 0)?;</span>\n<span class="token comment">/// # Ok(()) // returning from try_main</span>\n<span class="token comment">/// # }</span>\n<span class="token comment">/// # fn main() {</span>\n<span class="token comment">/// #    try_main().unwrap();</span>\n<span class="token comment">/// #</span>\n<span class="token comment">/// # }</span>\n<span class="token comment">/// ```</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">try_div</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> i32<span class="token punctuation">,</span> b<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Result<span class="token operator">&lt;</span>i32<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>\n        <span class="token function">Err</span><span class="token punctuation">(</span>String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Divide-by-zero"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token function">Ok</span><span class="token punctuation">(</span>a <span class="token operator">/</span> b<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然后修改以上代码已实现两个目标:</p>\n<ul>\n<li>文档注释不能出现在 cargo doc —open 生成的网页中</li>\n<li>运行测试，并成功看到以下结果:</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48862089663440970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`running 0 tests\n\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s\n\n   Doc-tests doc-comments\n\nrunning 4 tests\ntest src/compute.rs - compute::div (line 7) ... ok\ntest src/lib.rs - add_two (line 27) ... ok\ntest src/lib.rs - add_one (line 11) ... ok\ntest src/compute.rs - compute::try_div (line 20) ... ok\n\ntest result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.51s`, `48862089663440970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title=""\n              >\n                \n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">running 0 tests\n\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s\n\n   Doc-tests doc-comments\n\nrunning 4 tests\ntest src/compute.rs - compute::div (line 7) ... ok\ntest src/lib.rs - add_two (line 27) ... ok\ntest src/lib.rs - add_one (line 11) ... ok\ntest src/compute.rs - compute::try_div (line 20) ... ok\n\ntest result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.51s</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-225"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-225" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71021738449764710000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `71021738449764710000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题五-30"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h2>\n<p>代码跳转</p>\n<p>Rust 为我们提供一个非常强大的特性：可以在文档注释中实现代码跳转。</p>\n<p>将以下代码添加到 src/lib.rs:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8754919570688236000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\n/// Add one to the given value and return a [\\`Option\\`] type\npub fn add_three(x: i32) -> Option<i32> {\n    Some(x + 3)\n}`, `8754919570688236000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token comment">/// Add one to the given value and return a [`Option`] type</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_three</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n    <span class="token function">Some</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>除了跳转到标准库中，我们还能跳转到项目中的其它模块。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81612225622131770000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// in lib.rs\n\nmod a {\n    /// Add four to the given value and return a [\\`Option\\`] type\n    /// [\\`crate::MySpecialFormatter\\`]\n    pub fn add_four(x: i32) -> Option<i32> {\n        Some(x + 4)\n    }\n}\n\nstruct MySpecialFormatter;`, `81612225622131770000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// in lib.rs</span>\n\n<span class="token keyword">mod</span> a <span class="token punctuation">{</span>\n    <span class="token comment">/// Add four to the given value and return a [`Option`] type</span>\n    <span class="token comment">/// [`crate::MySpecialFormatter`]</span>\n    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add_four</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span>i32<span class="token operator">></span> <span class="token punctuation">{</span>\n        <span class="token function">Some</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">struct</span> MySpecialFormatter<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>文档属性</p>\n<p>下面是很常用的 <code class="language-text">#[doc]</code> 属性，该属性可以被 rustdoc 所使用。</p>\n<p>inline</p>\n<p>可以用于内联文档, 而不是链接到一个单独的页面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76580011521756640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`#[doc(inline)]\npub use bar::Bar;\n\n/// bar docs\nmod bar {\n    /// the docs for Bar\n    pub struct Bar;\n}`, `76580011521756640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token attribute attr-name">#[doc(inline)]</span>\n<span class="token keyword">pub</span> <span class="token keyword">use</span> bar<span class="token punctuation">::</span>Bar<span class="token punctuation">;</span>\n\n<span class="token comment">/// bar docs</span>\n<span class="token keyword">mod</span> bar <span class="token punctuation">{</span>\n    <span class="token comment">/// the docs for Bar</span>\n    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Bar<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>no_inline</p>\n<p>用于防止链接到单独的页面或其它地方。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94234633380164930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// Example from libcore/prelude\n#[doc(no_inline)]\npub use crate::mem::drop;`, `94234633380164930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// Example from libcore/prelude</span>\n<span class="token attribute attr-name">#[doc(no_inline)]</span>\n<span class="token keyword">pub</span> <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token punctuation">::</span>mem<span class="token punctuation">::</span>drop<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>hidden</p>\n<p>通过这个属性让 rustdoc 不要将下面的项包含在文档中:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60957940367023150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// Example from the futures-rs library\n#[doc(hidden)]\npub use self::async_await::*;`, `60957940367023150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">// Example from the futures-rs library</span>\n<span class="token attribute attr-name">#[doc(hidden)]</span>\n<span class="token keyword">pub</span> <span class="token keyword">use</span> <span class="token keyword">self</span><span class="token punctuation">::</span>async_await<span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>对文档来说，rustdoc 被社区广泛采用，大家所看到的标准库文档也是基于此生成的。</p>\n<h1 id="格式化输出"><a href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>格式化输出</h1>\n<h2 id="问题一-34"><a href="#%E9%97%AE%E9%A2%98%E4%B8%80-34" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题一</h2>\n<p>位置参数</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30286230093192913000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 填空 */\nfn main() {\n    println!(&quot;{0}, this is {1}. {1}, this is {0}&quot;, &quot;Alice&quot;, &quot;Bob&quot;);// => Alice, this is Bob. Bob, this is Alice\n    assert_eq!(format!(&quot;{1}{0}&quot;, 1, 2), __);\n    assert_eq!(format!(__, 1, 2), &quot;2112&quot;);\n    println!(&quot;Success!&quot;);\n}`, `30286230093192913000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 填空 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{0}, this is {1}. {1}, this is {0}"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// => Alice, this is Bob. Bob, this is Alice</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{1}{0}"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"2112"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-226"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-226" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87969615227993930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `87969615227993930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题二-34"><a href="#%E9%97%AE%E9%A2%98%E4%BA%8C-34" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题二</h2>\n<p>具名参数</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99447641355408490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    println!(&quot;{argument}&quot;, argument = &quot;test&quot;); // => &quot;test&quot;\n\n    /* 填空 */\n    assert_eq!(format!(&quot;{name}{}&quot;, 1, __), &quot;21&quot;);\n    assert_eq!(format!(__,a = &quot;a&quot;, b = \'b\', c = 3 ), &quot;a 3 b&quot;);\n\n    /* 修复错误 */\n    // 具名参数必须放在其它参数后面\n    println!(&quot;{abc} {1}&quot;, abc = &quot;def&quot;, 2);\n\n    println!(&quot;Success!&quot;)\n}`, `99447641355408490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{argument}"</span><span class="token punctuation">,</span> argument <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => "test"</span>\n\n    <span class="token comment">/* 填空 */</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{name}{}"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span>__<span class="token punctuation">,</span>a <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token char string">\'b\'</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"a 3 b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">/* 修复错误 */</span>\n    <span class="token comment">// 具名参数必须放在其它参数后面</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{abc} {1}"</span><span class="token punctuation">,</span> abc <span class="token operator">=</span> <span class="token string">"def"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-227"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-227" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17889188838249214000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `17889188838249214000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题三-34"><a href="#%E9%97%AE%E9%A2%98%E4%B8%89-34" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题三</h2>\n<p>字符串对齐</p>\n<p>默认情况下，通过空格来填充字符串</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40893037958359240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 下面两个都是通过 5 个空格来填充\n    println!(&quot;Hello {:5}!&quot;, &quot;x&quot;); // =>  &quot;Hello x    !&quot;\n    println!(&quot;Hello {:1\\$}!&quot;, &quot;x&quot;, 5); // =>  &quot;Hello x    !&quot;\n\n    /* 填空 */\n    assert_eq!(format!(&quot;Hello __!&quot;, 5, &quot;x&quot;), &quot;Hello x    !&quot;);\n    assert_eq!(format!(&quot;Hello __!&quot;, &quot;x&quot;, width = 5), &quot;Hello x    !&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `40893037958359240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 下面两个都是通过 5 个空格来填充</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:5}!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =>  "Hello x    !"</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:1$}!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =>  "Hello x    !"</span>\n\n    <span class="token comment">/* 填空 */</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello __!"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hello x    !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello __!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hello x    !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-228"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-228" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51344480073774520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `51344480073774520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题四-32"><a href="#%E9%97%AE%E9%A2%98%E5%9B%9B-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题四</h2>\n<p>左对齐，右对齐，使用指定的字符填充</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67208879290447050000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 左对齐\n    println!(&quot;Hello {:<5}!&quot;, &quot;x&quot;); // => Hello x    !\n    // 右对齐\n    assert_eq!(format!(&quot;Hello __!&quot;, &quot;x&quot;), &quot;Hello     x!&quot;);\n    // 居中对齐\n    assert_eq!(format!(&quot;Hello __!&quot;, &quot;x&quot;), &quot;Hello   x  !&quot;);\n\n    // 左对齐，并使用 \\`&\\` 填充\n    assert_eq!(format!(&quot;Hello {:&<5}!&quot;, &quot;x&quot;), __);\n\n    println!(&quot;Success!&quot;)\n}`, `67208879290447050000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 左对齐</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:&lt;5}!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello x    !</span>\n    <span class="token comment">// 右对齐</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello __!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hello     x!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 居中对齐</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello __!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hello   x  !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// 左对齐，并使用 `&amp;` 填充</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello {:&amp;&lt;5}!"</span><span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-229"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-229" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75534529660838050000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `75534529660838050000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题五-31"><a href="#%E9%97%AE%E9%A2%98%E4%BA%94-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题五</h2>\n<p>我们还能使用 0 来填充数字</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85577318096928700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    println!(&quot;Hello {:5}!&quot;, 5); // => Hello     5!\n    println!(&quot;Hello {:+}!&quot;, 5); // =>  Hello +5!\n    println!(&quot;Hello {:05}!&quot;, 5); // => Hello 00005!\n    println!(&quot;Hello {:05}!&quot;, -5); // => Hello -0005!\n\n    /* 填空 */\n    assert!(format!(&quot;{number:0>width\\$}&quot;, number=1, width=6) == __);\n\n    println!(&quot;Success!&quot;)\n}`, `85577318096928700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:5}!"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello     5!</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:+}!"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =>  Hello +5!</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:05}!"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello 00005!</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {:05}!"</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello -0005!</span>\n\n    <span class="token comment">/* 填空 */</span>\n    <span class="token function">assert!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"{number:0>width$}"</span><span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">==</span> __<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-230"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-230" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40593210476413624000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `40593210476413624000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题六-25"><a href="#%E9%97%AE%E9%A2%98%E5%85%AD-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题六</h2>\n<p>浮点数精度</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96201841790413130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`/* 填空 */\nfn main() {\n    let v = 3.1415926;\n\n    println!(&quot;{:.1\\$}&quot;, v, 4); // same as {:.4} => 3.1416\n\n    assert_eq!(format!(&quot;__&quot;, v), &quot;3.14&quot;);\n    assert_eq!(format!(&quot;__&quot;, v), &quot;+3.14&quot;);\n    assert_eq!(format!(&quot;__&quot;, v), &quot;3&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `96201841790413130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token comment">/* 填空 */</span>\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token number">3.1415926</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:.1$}"</span><span class="token punctuation">,</span> v<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// same as {:.4} => 3.1416</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"3.14"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"+3.14"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-231"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-231" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27293451973912930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `27293451973912930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题七-13"><a href="#%E9%97%AE%E9%A2%98%E4%B8%83-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题七</h2>\n<p>字符串长度</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4904636770342253000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    let s = &quot;Hello, world!&quot;;\n\n    println!(&quot;{0:.5}&quot;, s); // => Hello\n\n    assert_eq!(format!(&quot;Hello __!&quot;, 3, &quot;abcdefg&quot;), &quot;Hello abc!&quot;);\n\n    println!(&quot;Success!&quot;)\n}`, `4904636770342253000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"Hello, world!"</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{0:.5}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello</span>\n\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"Hello __!"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"abcdefg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Hello abc!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-232"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-232" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33117551552956547000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `33117551552956547000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题八-11"><a href="#%E9%97%AE%E9%A2%98%E5%85%AB-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题八</h2>\n<p>二进制，八进制，十六进制</p>\n<ul>\n<li>format!(”{}”, foo) -> “3735928559”</li>\n<li>format!(“0x{:X}”, foo) -> “0xDEADBEEF”</li>\n<li>format!(“0o{:o}”, foo) -> “0o33653337357”</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11735593806737988000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    assert_eq!(format!(&quot;__&quot;, 27), &quot;0b11011&quot;);\n    assert_eq!(format!(&quot;__&quot;, 27), &quot;0o33&quot;);\n    assert_eq!(format!(&quot;__&quot;, 27), &quot;0x1b&quot;);\n    assert_eq!(format!(&quot;__&quot;, 27), &quot;0x1B&quot;);\n\n    println!(&quot;{:x}!&quot;, 27); // 没有前缀的十六进制 => 1b\n\n    println!(&quot;{:#010b}&quot;, 27); // 使用 0 来填充二进制，宽度为 10 => 0b00011011\n\n    println!(&quot;Success!&quot;)\n}`, `11735593806737988000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"0b11011"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"0o33"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"0x1b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">assert_eq!</span><span class="token punctuation">(</span><span class="token function">format!</span><span class="token punctuation">(</span><span class="token string">"__"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"0x1B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:x}!"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 没有前缀的十六进制 => 1b</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:#010b}"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 0 来填充二进制，宽度为 10 => 0b00011011</span>\n\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-233"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-233" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75167251018424630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `75167251018424630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>\n<h2 id="问题九-10"><a href="#%E9%97%AE%E9%A2%98%E4%B9%9D-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题九</h2>\n<p>捕获环境中的值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48221769108617175000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn get_person() -> String {\n    String::from(&quot;sunface&quot;)\n}\n\nfn get_format() -> (usize, usize) {\n    (4, 1)\n}\n\nfn main() {\n    let person = get_person();\n    println!(&quot;Hello, {person}!&quot;);\n\n    let (width, precision) = get_format();\n    let scores = [(&quot;sunface&quot;, 99.12), (&quot;jack&quot;, 60.34)];\n    /* 让下面的代码输出:\n    sunface:   99.1\n    jack:   60.3\n    */\n    for (name, score) in scores {\n        println!(&quot;{name}: __&quot;);\n    }\n}`, `48221769108617175000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">get_person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> String <span class="token punctuation">{</span>\n    String<span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">get_format</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token punctuation">(</span>usize<span class="token punctuation">,</span> usize<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token function">get_person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, {person}!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">let</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> precision<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">get_format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"sunface"</span><span class="token punctuation">,</span> <span class="token number">99.12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"jack"</span><span class="token punctuation">,</span> <span class="token number">60.34</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token comment">/* 让下面的代码输出:\n    sunface:   99.1\n    jack:   60.3\n    */</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token keyword">in</span> scores <span class="token punctuation">{</span>\n        <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{name}: __"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57315650385795160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fn main() {\n    // 指数\n    println!(&quot;{:2e}&quot;, 1000000000); // => 1e9\n    println!(&quot;{:2E}&quot;, 1000000000); // => 1E9\n\n    // 指针地址\n    let v= vec![1, 2, 3];\n    println!(&quot;{:p}&quot;, v.as_ptr()); // => 0x600002324050\n\n    // 转义\n    println!(&quot;Hello {{}}&quot;); // => Hello {}\n}`, `57315650385795160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 指数</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:2e}"</span><span class="token punctuation">,</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => 1e9</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:2E}"</span><span class="token punctuation">,</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => 1E9</span>\n\n    <span class="token comment">// 指针地址</span>\n    <span class="token keyword">let</span> v<span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"{:p}"</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">as_ptr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => 0x600002324050</span>\n\n    <span class="token comment">// 转义</span>\n    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Hello {{}}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => Hello {}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="我的解答-234"><a href="#%E6%88%91%E7%9A%84%E8%A7%A3%E7%AD%94-234" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我的解答</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87480137814183510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(``, `87480137814183510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="rust"\n              >\n                <span class="gatsby-code-button-language">rust</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="rust"><pre style="counter-reset: linenumber NaN" class="language-rust line-numbers"><code class="language-rust"></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"></span></pre></div>',
excerpt:"背景知识 Rust 语言圣经 变量绑定与解构 问题一 变量只有在初始化后才能被使用 我的解答 问题二 可以使用 mut…",frontmatter:{date:"2023-03-17 23:05:48",path:"/rust-practice-test/",tags:"后端, Rust, 练手测试",title:"Rust练手测试",draft:null}},prePost:{html:'<h1 id="培养-pythonic-思维"><a href="#%E5%9F%B9%E5%85%BB-pythonic-%E6%80%9D%E7%BB%B4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>培养 Pythonic 思维</h1>\n<h2 id="第-1-条：查询自己使用的-python-版本"><a href="#%E7%AC%AC-1-%E6%9D%A1%EF%BC%9A%E6%9F%A5%E8%AF%A2%E8%87%AA%E5%B7%B1%E4%BD%BF%E7%94%A8%E7%9A%84-python-%E7%89%88%E6%9C%AC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 1 条：查询自己使用的 Python 版本</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77676950037619110000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`\\$ python --version\n\\$ python -V\n\\$ python3 --version\n\\$ python3 -V`, `77676950037619110000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ python --version\n$ python -V\n$ python3 --version\n$ python3 -V</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12789882936799146000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`>>> import sys\n>>> print(sys.version_info)\nsys.version_info(major=3, minor=6, micro=15, releaselevel=\'final\', serial=0)\n>>> print(sys.version)\n3.6.15 (default, Apr 20 2022, 13:05:41)\n[GCC 5.4.0 20160609]`, `12789882936799146000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="bash"\n              >\n                <span class="gatsby-code-button-language">bash</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token operator">>></span><span class="token operator">></span> <span class="token function">import</span> sys\n<span class="token operator">>></span><span class="token operator">></span> print<span class="token punctuation">(</span>sys.version_info<span class="token punctuation">)</span>\nsys.version_info<span class="token punctuation">(</span>major<span class="token operator">=</span><span class="token number">3</span>, <span class="token assign-left variable">minor</span><span class="token operator">=</span><span class="token number">6</span>, <span class="token assign-left variable">micro</span><span class="token operator">=</span><span class="token number">15</span>, <span class="token assign-left variable">releaselevel</span><span class="token operator">=</span><span class="token string">\'final\'</span>, <span class="token assign-left variable">serial</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token operator">>></span><span class="token operator">></span> print<span class="token punctuation">(</span>sys.version<span class="token punctuation">)</span>\n<span class="token number">3.6</span>.15 <span class="token punctuation">(</span>default, Apr <span class="token number">20</span> <span class="token number">2022</span>, <span class="token number">13</span>:05:41<span class="token punctuation">)</span>\n<span class="token punctuation">[</span>GCC <span class="token number">5.4</span>.0 <span class="token number">20160609</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 2 于 2020 年 1 月 1 日退场，到这一刻，所有的 bug 修复、安全补丁，以及特性向后移植都会停止。此后，如果你还坚持使用 Python 2，那么会面临很多不利因素，因为它不会再获得正式的维护了。深度依赖 Python 2 代码库的开发者可以考虑用 2to3（Python 预装的工具）与 <a href="https://six.readthedocs.io/" target="_blank" rel="nofollow noreferrer noopener">six</a> 这样的工具过渡到 Python 3。</p>\n<h2 id="第-2-条：遵循-pep-8-风格指南"><a href="#%E7%AC%AC-2-%E6%9D%A1%EF%BC%9A%E9%81%B5%E5%BE%AA-pep-8-%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 2 条：遵循 PEP 8 风格指南</h2>\n<h3 id="与空白有关的建议"><a href="#%E4%B8%8E%E7%A9%BA%E7%99%BD%E6%9C%89%E5%85%B3%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>与空白有关的建议</h3>\n<p>在 Python 中，空白（whitespace）在语法上相当重要。Python 程序员对空白字符的用法尤其在意，因为它们会影响代码的清晰程度。在这方面，大家应该遵循以下几条建议。</p>\n<ul>\n<li>用空格（space）表示缩进，而不要用制表符（tab）。</li>\n<li>和语法相关的每一层缩进都用 4 个空格表示。</li>\n<li>每行不超过 79 个字符。</li>\n<li>对于占据多行的长表达式来说，除了首行之外的其余各行都应该在通常的缩进级别之上再加 4 个空格。</li>\n<li>在同一份文件中，函数与类之间用两个空行隔开。</li>\n<li>在同一个类中，方法与方法之间用一个空行隔开。</li>\n<li>使用字典时，键与冒号之间不加空格，写在同一行的冒号和值之间应该加一个空格。</li>\n<li>给变量赋值时，赋值符号的左边和右边各加一个空格，并且只加一个空格就好。</li>\n<li>给变量的类型做注解（annotation）时，不要把变量名和冒号隔开，但在类型信息前应该有一个空格。</li>\n</ul>\n<h3 id="与命名有关的建议"><a href="#%E4%B8%8E%E5%91%BD%E5%90%8D%E6%9C%89%E5%85%B3%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>与命名有关的建议</h3>\n<p>PEP 8 建议采用不同的方式来给 Python 代码中的各个部分命名，这样在阅读代码时，就可以根据这些名称看出它们在 Python 语言中的角色。遵循以下与命名相关的建议。</p>\n<ul>\n<li>函数、变量及属性用小写字母来拼写，各单词之间用下划线相连，例如：<code class="language-text">lowercase_underscore</code>。</li>\n<li>受保护的实例属性，用一个下划线开头，例如：<code class="language-text">_leading_underscore</code>。</li>\n<li>私有的实例属性，用两个下划线开头，例如：<code class="language-text">__double_leading_underscore</code>。</li>\n<li>类（包括异常）命名时，每个单词的首字母均大写，例如：CapitalizedWord。</li>\n<li>模块级别的常量，所有字母都大写，各单词之间用下划线相连，例如：<code class="language-text">ALL_CAPS</code>。</li>\n<li>类中的实例方法，应该把第一个参数命名为 self，用来表示该对象本身。</li>\n<li>类方法的第一个参数，应该命名为 cls，用来表示这个类本身。</li>\n</ul>\n<h3 id="与表达式和语句有关的建议"><a href="#%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8C%E8%AF%AD%E5%8F%A5%E6%9C%89%E5%85%B3%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>与表达式和语句有关的建议</h3>\n<p>The Zen of Python 中提到：<code class="language-text">每件事都应该有简单的做法，而且最好只有一种</code>。PEP 8 就试着运用这个理念，来规范表达式和语句的写法。</p>\n<ul>\n<li>采用行内否定，即把否定词直接写在要否定的内容前面，而不要放在整个表达式的前面，例如应该写 <code class="language-text">if a is not b</code>，而不是 <code class="language-text">if not a is b</code>。</li>\n<li>不要通过长度判断容器或序列是不是空的，例如不要通过 <code class="language-text">if len(somelist) == 0</code> 判断 somelist 是否为 <code class="language-text">[]</code> 或 <code class="language-text">&#39;&#39;</code> 等空值，而是应该采用 <code class="language-text">if not somelist</code> 这样的写法来判断，因为 Python 会把空值自动评估为 False。</li>\n<li>如果要判断容器或序列里面有没有内容（比如要判断 somelist 是否为 <code class="language-text">[1]</code> 或 <code class="language-text">&#39;hi&#39;</code> 这样非空的值），也不应该通过长度来判断，而是应该采用 <code class="language-text">if somelist</code> 语句，因为 Python 会把非空的值自动判定为 True。</li>\n<li>不要把 if 语句、for 循环、while 循环及 except 复合语句挤在一行。应该把这些语句分成多行来写，这样更加清晰。</li>\n<li>如果表达式一行写不下，可以用括号将其括起来，而且要适当地添加换行与缩进以便于阅读。多行的表达式，应该用括号括起来，而不要用 <code class="language-text">\\</code> 符号续行。</li>\n</ul>\n<h3 id="与引入有关的建议"><a href="#%E4%B8%8E%E5%BC%95%E5%85%A5%E6%9C%89%E5%85%B3%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>与引入有关的建议</h3>\n<p>PEP 8 对于怎样在代码中引入并使用模块，给出了下面几条建议。</p>\n<ul>\n<li>import 语句（含 <code class="language-text">from x import y</code>）总是应该放在文件开头。</li>\n<li>引入模块时，总是应该使用绝对名称，而不应该根据当前模块路径来使用相对名称。例如，要引入 bar 包中的 foo 模块，应该完整地写出 <code class="language-text">from bar import foo</code>，即便当前路径为 bar 包里，也不应该简写为 <code class="language-text">import foo</code>。</li>\n<li>如果一定要用相对名称来编写 import 语句，那就应该明确地写成：<code class="language-text">from . import foo</code>。文件中的 import 语句应该按顺序划分成三个部分：首先引入标准库里的模块，然后引入第三方模块，最后引入自己的模块。属于同一个部分的 import 语句按字母顺序排列。</li>\n</ul>\n<h2 id="第-3-条：了解-bytes-与-str-的区别"><a href="#%E7%AC%AC-3-%E6%9D%A1%EF%BC%9A%E4%BA%86%E8%A7%A3-bytes-%E4%B8%8E-str-%E7%9A%84%E5%8C%BA%E5%88%AB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 3 条：了解 bytes 与 str 的区别</h2>\n<p>Python 有两种类型可以表示字符序列：一种是 bytes，另一种是 str。</p>\n<p>bytes 实例包含的是原始数据，即 8 位的无符号值（通常按照 ASCII 编码标准来显示）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43258514139059320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = b\'h\\x65llo\'\nprint(list(a))\nprint(a)\n\n>>>\n[104, 101, 108, 108, 111]\nb\'hello\'`, `43258514139059320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token string">b\'h\\x65llo\'</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">]</span>\n<span class="token string">b\'hello\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>str 实例包含的是 Unicode 码点（code point，也叫作代码点），这些码点与人类语言之中的文本字符相对应。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71786290160654450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = \'a\\u0300 propos\'\nprint(list(a))\nprint(a)\n\n>>>\n[\'a\', \'̀\', \' \', \'p\', \'r\', \'o\', \'p\', \'o\', \'s\']\nà propos`, `71786290160654450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token string">\'a\\u0300 propos\'</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'̀\'</span><span class="token punctuation">,</span> <span class="token string">\' \'</span><span class="token punctuation">,</span> <span class="token string">\'p\'</span><span class="token punctuation">,</span> <span class="token string">\'r\'</span><span class="token punctuation">,</span> <span class="token string">\'o\'</span><span class="token punctuation">,</span> <span class="token string">\'p\'</span><span class="token punctuation">,</span> <span class="token string">\'o\'</span><span class="token punctuation">,</span> <span class="token string">\'s\'</span><span class="token punctuation">]</span>\nà propos</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>两种不同的字符类型与 Python 中两种常见的使用情况相对应：</p>\n<ul>\n<li>开发者需要操作原始的 8 位值序列，序列里面的这些 8 位值合起来表示一个应该按 UTF-8 或其他标准编码的字符串。</li>\n<li>开发者需要操作通用的 Unicode 字符串，而不是操作某种特定编码的字符串。</li>\n</ul>\n<p>我们通常需要编写两个辅助函数，以便在这两种情况之间转换，确保输入值类型符合开发者的预期形式。</p>\n<p>第一个辅助函数接受 bytes 或 str 实例，并返回 str：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93550233839687810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def to_str(bytes_or_str):\n    if isinstance(bytes_or_str, bytes):\n        value = bytes_or_str.decode(\'utf-8\')\n    else:\n        value = bytes_or_str\n    return value # Instance of str\n\nprint(repr(to_str(b\'foo\')))\nprint(repr(to_str(\'bar\')))\n\n>>>\n\'foo\'\n\'bar\'`, `93550233839687810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">to_str</span><span class="token punctuation">(</span>bytes_or_str<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bytes_or_str<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        value <span class="token operator">=</span> bytes_or_str<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        value <span class="token operator">=</span> bytes_or_str\n    <span class="token keyword">return</span> value <span class="token comment"># Instance of str</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>to_str<span class="token punctuation">(</span><span class="token string">b\'foo\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>to_str<span class="token punctuation">(</span><span class="token string">\'bar\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">\'foo\'</span>\n<span class="token string">\'bar\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>第二个辅助函数也接受 bytes 或 str 实例，但它返回的是 bytes：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68375712723075700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def to_bytes(bytes_or_str):\n    if isinstance(bytes_or_str, str):\n        value = bytes_or_str.encode(\'utf-8\')\n    else:\n        value = bytes_or_str\n    return value # Instance of bytes\n\nprint(repr(to_bytes(b\'foo\')))\nprint(repr(to_bytes(\'bar\')))\n\n>>>\nb\'foo\'\nb\'bar\'`, `68375712723075700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">to_bytes</span><span class="token punctuation">(</span>bytes_or_str<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bytes_or_str<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        value <span class="token operator">=</span> bytes_or_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        value <span class="token operator">=</span> bytes_or_str\n    <span class="token keyword">return</span> value <span class="token comment"># Instance of bytes</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>to_bytes<span class="token punctuation">(</span><span class="token string">b\'foo\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>to_bytes<span class="token punctuation">(</span><span class="token string">\'bar\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">b\'foo\'</span>\n<span class="token string">b\'bar\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 Python 中使用原始的 8 位值与 Unicode 字符串时，有两个问题要注意。</p>\n<p>第一个问题是，bytes 与 str 这两种类型似乎是以相同的方式工作的，但其实例并不相互兼容，所以在传递字符序列的时候必须考虑好其类型。</p>\n<p>可以用 + 操作符将 bytes 添加到 bytes，str 也可以这样。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56926453720418740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(b\'one\' + b\'two\')\nprint(\'one\' + \'two\')\n\n>>>\nb\'onetwo\'\nonetwo`, `56926453720418740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b\'one\'</span> <span class="token operator">+</span> <span class="token string">b\'two\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'one\'</span> <span class="token operator">+</span> <span class="token string">\'two\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">b\'onetwo\'</span>\nonetwo</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但是不能将 str 实例添加到 bytes 实例：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85811613796222750000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`b\'one\' + \'two\'\n\n>>>\nTraceback ...\nTypeError: can\'t concat str to bytes`, `85811613796222750000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token string">b\'one\'</span> <span class="token operator">+</span> <span class="token string">\'two\'</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> can\'t concat <span class="token builtin">str</span> to <span class="token builtin">bytes</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>也不能将 bytes 实例添加到 str 实例：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54488620143895904000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`\'one\' + b\'two\'\n\n>>>\nTraceback ...\nTypeError: can only concatenate str (not &quot;bytes&quot;) to str`, `54488620143895904000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token string">\'one\'</span> <span class="token operator">+</span> <span class="token string">b\'two\'</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> can only concatenate <span class="token builtin">str</span> <span class="token punctuation">(</span><span class="token keyword">not</span> <span class="token string">"bytes"</span><span class="token punctuation">)</span> to <span class="token builtin">str</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>bytes 与 bytes 之间可以用二元操作符（binary operator）来比较大小，str 与 str 之间也可以：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34170346441635434000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert b\'red\' > b\'blue\'\nassert \'red\' > \'blue\'`, `34170346441635434000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> <span class="token string">b\'red\'</span> <span class="token operator">></span> <span class="token string">b\'blue\'</span>\n<span class="token keyword">assert</span> <span class="token string">\'red\'</span> <span class="token operator">></span> <span class="token string">\'blue\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>但是 str 实例不能与 bytes 实例比较：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25782256829635465000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert \'red\' > b\'blue\'\n\n>>>\nTraceback ...\nTypeError: \'>\' not supported between instances of \'str\' and \'bytes\'`, `25782256829635465000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> <span class="token string">\'red\'</span> <span class="token operator">></span> <span class="token string">b\'blue\'</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token string">\'>\'</span> <span class="token keyword">not</span> supported between instances of <span class="token string">\'str\'</span> <span class="token keyword">and</span> <span class="token string">\'bytes\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>反过来也一样，也就是说 bytes 实例不能与 str 实例比较：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34411646548177680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert b\'blue\' < \'red\'\n\n>>>\nTraceback ...\nTypeError: \'<\' not supported between instances of \'bytes\' and \'str\'`, `34411646548177680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> <span class="token string">b\'blue\'</span> <span class="token operator">&lt;</span> <span class="token string">\'red\'</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token string">\'&lt;\'</span> <span class="token keyword">not</span> supported between instances of <span class="token string">\'bytes\'</span> <span class="token keyword">and</span> <span class="token string">\'str\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>判断 bytes 与 str 实例是否相等，总是会评估为假（False），即便这两个实例表示的字符完全相同，它们也不相等。例如，在下面这个例子里，它们表示的字符串都相当于 ASCII 编码之中的 foo。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26887872052797944000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(b\'foo\' == \'foo\')\n\n>>>\nFalse`, `26887872052797944000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b\'foo\'</span> <span class="token operator">==</span> <span class="token string">\'foo\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token boolean">False</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>两种类型的实例都可以出现在 % 操作符的右侧，用来替换左侧那个格式字符串（format string）里面的 %s。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12808660310263775000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(b\'red %s\' % b\'blue\')\nprint(\'red %s\' % \'blue\')\n\n>>>\nb\'red blue\'\nred blue`, `12808660310263775000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b\'red %s\'</span> <span class="token operator">%</span> <span class="token string">b\'blue\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'red %s\'</span> <span class="token operator">%</span> <span class="token string">\'blue\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">b\'red blue\'</span>\nred blue</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果格式字符串是 bytes 类型，那么不能用 str 实例来替换其中的 %s，因为 Python 不知道这个 str 应该按照什么方案来编码。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87639534628220850000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(b\'red %s\' % \'blue\')\n\n>>>\nTraceback ...\nTypeError: %b requires a bytes-like object, or an object that implements _bytes_, not \'str\'`, `87639534628220850000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b\'red %s\'</span> <span class="token operator">%</span> <span class="token string">\'blue\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token operator">%</span>b requires a <span class="token builtin">bytes</span><span class="token operator">-</span>like <span class="token builtin">object</span><span class="token punctuation">,</span> <span class="token keyword">or</span> an <span class="token builtin">object</span> that implements _bytes_<span class="token punctuation">,</span> <span class="token keyword">not</span> <span class="token string">\'str\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但反过来却可以，也就是说如果格式字符串是 str 类型，则可以用 bytes 实例来替换其中的 %s，问题是这可能跟你想要的结果不一样。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62763653751752150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(\'red %s\' % b\'blue\')\n\n>>>\nred b\'blue\'`, `62763653751752150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'red %s\'</span> <span class="token operator">%</span> <span class="token string">b\'blue\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nred <span class="token string">b\'blue\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样做，会让系统在 bytes 实例上面调用 <code class="language-text">__repr__</code> 方法（参见第 75 条），然后用这次调用所得到的结果替换格式字符串里的 %s，因此程序会直接输出 <code class="language-text">b&#39;blue&#39;</code>，而不是像你想的那样，输出 blue 本身。</p>\n<p>第二个问题发生在操作文件句柄的时候，这里的句柄指由内置的 open 函数返回的句柄。这样的句柄默认需要使用 Unicode 字符串操作，而不能采用原始的 bytes。习惯了 Python 2 的开发者，尤其容易碰到这个问题，进而导致程序出现奇怪的错误。例如，向文件写入二进制数据的时候，下面这种写法其实是错误的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79414522332241690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`with open(\'data.bin\', \'w\') as f:\n   f.write(b\'\\xf1\\xf2\\xf3\\xf4\\xf5\')\n\n>>>\nTraceback ...\nTypeError: write() argument must be str, not bytes`, `79414522332241690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'data.bin\'</span><span class="token punctuation">,</span> <span class="token string">\'w\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n   f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b\'\\xf1\\xf2\\xf3\\xf4\\xf5\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> write<span class="token punctuation">(</span><span class="token punctuation">)</span> argument must be <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token keyword">not</span> <span class="token builtin">bytes</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>程序发生异常是因为在调用 open 函数时，指定的是 <code class="language-text">&#39;w&#39;</code> 模式，所以系统要求必须以文本模式写入。如果想用二进制模式，那应该指定 <code class="language-text">&#39;wb&#39;</code> 才对。在文本模式下，write 方法接受的是包含 Unicode 数据的 str 实例，不是包含二进制数据的 bytes 实例。所以，我们得把模式改成 <code class="language-text">&#39;wb&#39;</code> 来解决该问题。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64476698115991860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`with open(\'data.bin\', \'wb\') as f:\n   f.write(b\'\\xf1\\xf2\\xf3\\xf4\\xf5\')`, `64476698115991860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'data.bin\'</span><span class="token punctuation">,</span> <span class="token string">\'wb\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n   f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b\'\\xf1\\xf2\\xf3\\xf4\\xf5\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>读取文件的时候也有类似的问题。例如，如果要把刚才写入的二进制文件读出来，那么不能用下面这种写法，同样需要改成 <code class="language-text">&#39;rb&#39;</code></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43411077722105180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`with open(\'data.bin\', \'r\') as f:\n   data = f.read()\n\n>>>\nTraceback ...\nUnicodeDecodeError: \'utf-8\' codec can\'t decode byte 0xf1 in position 0: invalid continuation byte`, `43411077722105180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'data.bin\'</span><span class="token punctuation">,</span> <span class="token string">\'r\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n   data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nUnicodeDecodeError<span class="token punctuation">:</span> <span class="token string">\'utf-8\'</span> codec can\'t decode byte <span class="token number">0xf1</span> <span class="token keyword">in</span> position <span class="token number">0</span><span class="token punctuation">:</span> invalid continuation byte</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>另一种改法是在调用 open 函数的时候，通过 encoding 参数明确指定编码标准，以确保平台特有的一些行为不会干扰代码的运行效果。例如，假设刚才写到文件里的那些二进制数据表示的是一个采用 ‘cp1252’ 标准（cp1252 是一种老式的 Windows 编码方案）来编码的字符串，则可以这样写</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57917144342461400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`with open(\'data.bin\', \'r\', encoding=\'cp1252\') as f:\n   data f.read()\n\nassert data == \'ioooδ\'`, `57917144342461400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'data.bin\'</span><span class="token punctuation">,</span> <span class="token string">\'r\'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">\'cp1252\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n   data f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token keyword">assert</span> data <span class="token operator">==</span> <span class="token string">\'ioooδ\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样程序就不会出现异常了，但返回的字符串也与读取原始字节数据所返回的有很大区别。通过这个例子，我们要提醒自己注意当前操作系统默认的编码标准（可以执行 <code class="language-text">python3 -c &#39;import locale; print(locale.getpreferredencoding())&#39;</code> 命令查看），了解它与你所期望的是否一致。如果不确定，那就在调用 open 时明确指定 encoding 参数。</p>\n<h2 id="第-4-条：用支持插值的-f-string-取代-c-风格的格式字符串与-strformat-方法"><a href="#%E7%AC%AC-4-%E6%9D%A1%EF%BC%9A%E7%94%A8%E6%94%AF%E6%8C%81%E6%8F%92%E5%80%BC%E7%9A%84-f-string-%E5%8F%96%E4%BB%A3-c-%E9%A3%8E%E6%A0%BC%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E-strformat-%E6%96%B9%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 4 条：用支持插值的 f-string 取代 C 风格的格式字符串与 str.format 方法</h2>\n<p>Python 里面最常用的字符串格式化方式是采用 % 格式化操作符。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79391165332897330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = 0b10111011\nb = 0xc5f\nprint(\'Binary is %d, hex is %d\' % (a, b))\n\n>>>\nBinary is 187, hex is 3167`, `79391165332897330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token number">0b10111011</span>\nb <span class="token operator">=</span> <span class="token number">0xc5f</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Binary is %d, hex is %d\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBinary <span class="token keyword">is</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token builtin">hex</span> <span class="token keyword">is</span> <span class="token number">3167</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但是 C 风格的格式字符串，在 Python 里有四个缺点。</p>\n<ol>\n<li>\n<p>如果 % 右侧那个元组里面的值在类型或顺序上有变化，那么程序可能会因为转换类型时发生不兼容问题而出现错误。例如，下面这个简单的格式化表达式是正确的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94635823390953670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\nformatted = \'%-10s = %.2f\' % (key, value)\nprint(formatted)\n\n>>>\nmy_var     = 1.23`, `94635823390953670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\nformatted <span class="token operator">=</span> <span class="token string">\'%-10s = %.2f\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nmy_var     <span class="token operator">=</span> <span class="token number">1.23</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但如果把 key 跟 value 互换位置，那么程序就会在运行时出现异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17096686674294980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`reordered_tuple = \'%-10s = %.2f\' % (value, key)\n\n>>>\nTraceback ...\nTypeError: must be real number, not str`, `17096686674294980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">reordered_tuple <span class="token operator">=</span> <span class="token string">\'%-10s = %.2f\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span> key<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> must be real number<span class="token punctuation">,</span> <span class="token keyword">not</span> <span class="token builtin">str</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果 % 右侧的写法不变，但左侧那个格式字符串里面的两个说明符对调了顺序，那么程序同样会发生这个错误。</p>\n</li>\n<li>\n<p>在填充模板之前，经常要先对准备填写进去的这个值稍微做一些处理，但这样一来，整个表达式可能就会写得很长，让人觉得比较混乱。下面这段代码用来罗列厨房里的各种食材，现在的这种写法并没有对填入格式字符串里面的那三个值（也就是食材的编号 i、食材的名称 item，以及食材的数量 count）预先做出调整。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57191757747699800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n  (\'avocados\', 1.25),\n  (\'bananas\', 2.5),\n  (\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n  print(\'#%d: %-10s = %.2f\' % (i, item, count))\n\n>>>\n#0: avocados   = 1.25\n#1: bananas    = 2.50\n#2: cherries   = 15.00`, `57191757747699800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'#%d: %-10s = %.2f\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> item<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token comment">#0: avocados   = 1.25</span>\n<span class="token comment">#1: bananas    = 2.50</span>\n<span class="token comment">#2: cherries   = 15.00</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果想让打印出来的信息更好懂，那可能得把这几个值稍微调整一下，但是调整之后，% 操作符右侧的那个三元组就特别长，所以需要多行拆分才能写得下，这会影响程序的可读性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5077950931677155000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n  (\'avocados\', 1.25),\n  (\'bananas\', 2.5),\n  (\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n  print(\'#%d: %-10s = %d\' % (\n     i + 1,\n     item.title(),\n     round(count)))\n\n>>>\n#1: Avocados   = 1\n#2: Bananas    = 2\n#3: Cherries   = 15`, `5077950931677155000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'#%d: %-10s = %d\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>\n     i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n     item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n     <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token comment">#1: Avocados   = 1</span>\n<span class="token comment">#2: Bananas    = 2</span>\n<span class="token comment">#3: Cherries   = 15</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>如果想用同一个值来填充格式字符串里的多个位置，那么必须在 % 操作符右侧的元组中相应地多次重复该值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90897151023231730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`template = \'%s loves food. See %s cook.\'\nname = \'Max\'\nformatted = template % (name, name)\nprint(formatted)\n\n>>>\nMax loves food. See Max cook.`, `90897151023231730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">template <span class="token operator">=</span> <span class="token string">\'%s loves food. See %s cook.\'</span>\nname <span class="token operator">=</span> <span class="token string">\'Max\'</span>\nformatted <span class="token operator">=</span> template <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> name<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMax loves food<span class="token punctuation">.</span> See Max cook<span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果想在填充之前把这个值修改一下，那么必须同时修改多处才行，这尤其烦人，且容易出错。例如，如果这次要填的不是 name 而是 name.title()，那就必须提醒自己，要把所有的 name 都改成 name.title()。若是有的地方改了，有的地方没改，那输出的信息可能就不一致了。</p>\n<p>为了解决上面提到的一些问题，Python 的 % 操作符允许我们用 dict 取代 tuple，这样的话，我们就可以让格式字符串里面的说明符与 dict 里面的键以相应的名称对应起来，例如 %(key)s 这个说明符，意思就是用字符串（s）来表示 dict 里面名为 key 的那个键所保存的值。下面通过这种办法解决刚才讲的第一个缺点，也就是 % 操作符两侧的顺序不匹配问题。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11651268967419015000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\nold_way = \'%-10s = %.2f\' % (key, value)\n\nnew_way = \'%(key)-10s = %(value).2f\' % {\n  \'key\': key, \'value\': value}  # Original\n\nreordered = \'%(key)-10s = %(value).2f\' % {\n  \'value\': value, \'key\': key}  # Swapped\n\nassert old_way == new_way == reordered`, `11651268967419015000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\nold_way <span class="token operator">=</span> <span class="token string">\'%-10s = %.2f\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n\nnew_way <span class="token operator">=</span> <span class="token string">\'%(key)-10s = %(value).2f\'</span> <span class="token operator">%</span> <span class="token punctuation">{</span>\n  <span class="token string">\'key\'</span><span class="token punctuation">:</span> key<span class="token punctuation">,</span> <span class="token string">\'value\'</span><span class="token punctuation">:</span> value<span class="token punctuation">}</span>  <span class="token comment"># Original</span>\n\nreordered <span class="token operator">=</span> <span class="token string">\'%(key)-10s = %(value).2f\'</span> <span class="token operator">%</span> <span class="token punctuation">{</span>\n  <span class="token string">\'value\'</span><span class="token punctuation">:</span> value<span class="token punctuation">,</span> <span class="token string">\'key\'</span><span class="token punctuation">:</span> key<span class="token punctuation">}</span>  <span class="token comment"># Swapped</span>\n\n<span class="token keyword">assert</span> old_way <span class="token operator">==</span> new_way <span class="token operator">==</span> reordered</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法还可以解决刚才讲的第三个缺点，也就是用同一个值替换多个格式说明符的问题。改用这种写法之后，我们就不用在 % 操作符右侧重复这个值了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63491080048744220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`name = \'Max\'\ntemplate = \'%s loves food .See %s cook.\'\nbefore = template % (name, name)  # Tuple\ntemplate = \'%(name)s loves food .See %(name)s cook.\'\nafter = template % {\'name\': name}  # Dictionary\nassert before == after`, `63491080048744220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">name <span class="token operator">=</span> <span class="token string">\'Max\'</span>\ntemplate <span class="token operator">=</span> <span class="token string">\'%s loves food .See %s cook.\'</span>\nbefore <span class="token operator">=</span> template <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> name<span class="token punctuation">)</span>  <span class="token comment"># Tuple</span>\ntemplate <span class="token operator">=</span> <span class="token string">\'%(name)s loves food .See %(name)s cook.\'</span>\nafter <span class="token operator">=</span> template <span class="token operator">%</span> <span class="token punctuation">{</span><span class="token string">\'name\'</span><span class="token punctuation">:</span> name<span class="token punctuation">}</span>  <span class="token comment"># Dictionary</span>\n<span class="token keyword">assert</span> before <span class="token operator">==</span> after</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但是，这种写法会让刚才讲的第二个缺点变得更加严重，因为字典格式字符串的引入，我们必须给每一个值都定义键名，而且要在键名的右侧加冒号，格式化表达式变得更加冗长，看起来也更加混乱。我们把不采用 dict 的写法与采用 dict 的写法对比一下，可以更明确地意识到这种写法的缺点。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87198434663067780000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n(\'avocados\', 1.25),\n(\'bananas\', 2.5),\n(\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n  before = \'#%d: %-10s = %d\' % (\n     i + 1,\n     item.title(),\n     round(count)\n  )\n  after = \'#%(loop)d: %(item)-10s = %(count)d\' % {\n     \'loop\': i + 1,\n     \'item\': item.title(),\n     \'count\': round(count),\n  }\n\n  assert before == after`, `87198434663067780000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n<span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  before <span class="token operator">=</span> <span class="token string">\'#%d: %-10s = %d\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>\n     i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n     item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n     <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n  <span class="token punctuation">)</span>\n  after <span class="token operator">=</span> <span class="token string">\'#%(loop)d: %(item)-10s = %(count)d\'</span> <span class="token operator">%</span> <span class="token punctuation">{</span>\n     <span class="token string">\'loop\'</span><span class="token punctuation">:</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n     <span class="token string">\'item\'</span><span class="token punctuation">:</span> item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n     <span class="token string">\'count\'</span><span class="token punctuation">:</span> <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">assert</span> before <span class="token operator">==</span> after</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>把 dict 写到格式化表达式里面会让代码变多。每个键都至少要写两次：一次是在格式说明符中，还有一次是在字典中作为键，另外，定义字典的时候，可能还要专门用一个变量来表示这个键所对应的值，而且这个变量的名称或许也和键名相同，这样算下来就是三次了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87344093553231430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`soup = \'lentil\'\nformatted = \'Today\\\'s soup is %(soup)s.\' % {\'soup\': soup}\nprint(formatted)\n\n>>>\nToday\'s soup is lentil.`, `87344093553231430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">soup <span class="token operator">=</span> <span class="token string">\'lentil\'</span>\nformatted <span class="token operator">=</span> <span class="token string">\'Today\\\'s soup is %(soup)s.\'</span> <span class="token operator">%</span> <span class="token punctuation">{</span><span class="token string">\'soup\'</span><span class="token punctuation">:</span> soup<span class="token punctuation">}</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nToday\'s soup <span class="token keyword">is</span> lentil<span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>除了要反复写键名，在格式化表达式里面使用 dict 的办法还会让表达式变得特别长，通常必须拆分为多行来写，同时，为了与格式字符串的多行写法相对应，定义字典的时候，也要一行一行地给每个键设定对应的值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48046761726972760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`menu = {\n\'soup\': \'lentil\',\n\'oyster\': \'kumamoto\',\n\'special\': \'schnitzel\',\n}\n\ntemplate = (\'Today\\\'s soup is %(soup)s, \'\n           \'buy one get two %(oyster)s oysters, \'\n           \'and our special entree is %(special)s.\')\nformatted = template % menu\nprint(formatted)\n\n>>>\nToday\'s soup is lentil, buy one get two kumamoto oysters, and our special entree is schnitzel.`, `48046761726972760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">menu <span class="token operator">=</span> <span class="token punctuation">{</span>\n<span class="token string">\'soup\'</span><span class="token punctuation">:</span> <span class="token string">\'lentil\'</span><span class="token punctuation">,</span>\n<span class="token string">\'oyster\'</span><span class="token punctuation">:</span> <span class="token string">\'kumamoto\'</span><span class="token punctuation">,</span>\n<span class="token string">\'special\'</span><span class="token punctuation">:</span> <span class="token string">\'schnitzel\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\ntemplate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">\'Today\\\'s soup is %(soup)s, \'</span>\n           <span class="token string">\'buy one get two %(oyster)s oysters, \'</span>\n           <span class="token string">\'and our special entree is %(special)s.\'</span><span class="token punctuation">)</span>\nformatted <span class="token operator">=</span> template <span class="token operator">%</span> menu\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nToday\'s soup <span class="token keyword">is</span> lentil<span class="token punctuation">,</span> buy one get two kumamoto oysters<span class="token punctuation">,</span> <span class="token keyword">and</span> our special entree <span class="token keyword">is</span> schnitzel<span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为了查看格式字符串中的说明符究竟对应于字典里的哪个键，必须在这两段代码之间来回跳跃，这会令人难以发现其中的 bug。如果要对键名稍做修改，那么必须同步修改格式字符串里的说明符，这更让代码变得相当烦琐，可读性更差。</p>\n</li>\n</ol>\n<h3 id="内置的-format-函数与-str-类的-format-方法"><a href="#%E5%86%85%E7%BD%AE%E7%9A%84-format-%E5%87%BD%E6%95%B0%E4%B8%8E-str-%E7%B1%BB%E7%9A%84-format-%E6%96%B9%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内置的 format 函数与 str 类的 format 方法</h3>\n<p>Python 3 添加了高级字符串格式化（advanced string formatting）机制，它的表达能力比老式 C 风格的格式字符串要强，且不再使用 % 操作符。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25932345923826094000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = 1234.5678\nformatted = format(a, \',.2f\')\nprint(formatted)\nb = \'my string\'\nformatted = format(b, \'^20s\')\nprint(\'*\', formatted, \'*\')\n\n>>>\n1,234.57\n*      my string       *`, `25932345923826094000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token number">1234.5678</span>\nformatted <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">\',.2f\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\nb <span class="token operator">=</span> <span class="token string">\'my string\'</span>\nformatted <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">\'^20s\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'*\'</span><span class="token punctuation">,</span> formatted<span class="token punctuation">,</span> <span class="token string">\'*\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">234.57</span>\n<span class="token operator">*</span>      my string       <span class="token operator">*</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18039435063277810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nformatted = \'{} = {}\'.format(key, value)\nprint(formatted)\n\n>>>\nmy_var = 1.234`, `18039435063277810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nformatted <span class="token operator">=</span> <span class="token string">\'{} = {}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nmy_var <span class="token operator">=</span> <span class="token number">1.234</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>你可以在 {} 里写个冒号，然后把格式说明符写在冒号的右边，用以规定 format 方法所接收的这个值应该按照怎样的格式来调整。在 Python 解释器里输入 help(‘FORMATTING’)，可以详细查看 str.format 使用的这套格式说明符所依据的规则。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72268865707182100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nformatted = \'{:<10} = {:.2f}\'.format(key, value)\nprint(formatted)\n\n>>>\nmy_var     = 1.23`, `72268865707182100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nformatted <span class="token operator">=</span> <span class="token string">\'{:&lt;10} = {:.2f}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nmy_var     <span class="token operator">=</span> <span class="token number">1.23</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>运行过程：系统先把 str.format 方法接收到的每个值传给内置的 format 函数，并找到这个值在字符串里对应的 {}，同时将 {} 里面写的格式也传给 format 函数，例如系统在处理 value 的时候，传的就是 format(value, ‘.2f’)。然后，系统会把 format 函数所返回的结果写在整个格式化字符串 {} 所在的位置。另外，每个类都可以通过 <code class="language-text">__format__</code> 这个特殊的方法定制相应的逻辑，这样的话，format 函数在把该类实例转换成字符串时，就会按照这种逻辑来转换。</p>\n<p>C 风格的格式字符串采用 % 操作符来引导格式说明符，所以如果要将这个符号照原样输出，那就必须转义，也就是连写两个 %。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59336709387585220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(\'%.2f%%\' % 12.5)\nprint(\'{} replaces {{}}\'.format(1.23))\n\n>>>\n12.50%\n1.23 replaces {}`, `59336709387585220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'%.2f%%\'</span> <span class="token operator">%</span> <span class="token number">12.5</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'{} replaces {{}}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">1.23</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">12.50</span><span class="token operator">%</span>\n<span class="token number">1.23</span> replaces <span class="token punctuation">{</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>调用 str.format 方法的时候，也可以给 str 的 {} 里面写上数字，用来指代 format 方法在这个位置所接收到的参数值位置索引。以后即使这些 {} 在格式字符串中的次序有所变动，也不用调换传给 format 方法的那些参数。于是，这就避免了前面讲的第一个缺点所提到的那个顺序问题。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1066709166053891800"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nformatted = \'{1} = {0}\'.format(key, value)\nprint(formatted)\n\n>>>\n1.234 = my_var`, `1066709166053891800`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nformatted <span class="token operator">=</span> <span class="token string">\'{1} = {0}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1.234</span> <span class="token operator">=</span> my_var</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>同一个位置索引可以出现在 str 的多个 {} 里面，这些 {} 指代的都是 format 方法在对应位置所收到的值。这就不需要把这个值重复地传给 format 方法，于是就解决了前面提到的第三个缺点。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44433841404951280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`name = \'Max\'\nformatted = \'{0} loves food. See {0} cook.\'.format(name)\nprint(formatted)\n\n>>>\nMax loves food. See Max cook.`, `44433841404951280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">name <span class="token operator">=</span> <span class="token string">\'Max\'</span>\nformatted <span class="token operator">=</span> <span class="token string">\'{0} loves food. See {0} cook.\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMax loves food<span class="token punctuation">.</span> See Max cook<span class="token punctuation">.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而，这个新的 str.format 方法并没有解决上面讲的第二个缺点。如果在对值做填充之前要先对这个值做出调整，那么用这种方法写出来的代码还是跟原来一样乱，阅读性差。把原来那种写法和现在的新写法对比一下，大家就会看到新写法并不比原来好多少。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55656300229490975000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n    (\'avocados\', 1.25),\n    (\'bananas\', 2.5),\n    (\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n    old_style = \'#%d: %-10s = %d\' % (\n        i + 1,\n        item.title(),\n        round(count))\n    new_style = \'#{}: {:<10s} = {}\'.format(\n        i + 1,\n        item.title(),\n        round(count))\n    assert old_style == new_style`, `55656300229490975000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    old_style <span class="token operator">=</span> <span class="token string">\'#%d: %-10s = %d\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>\n        i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    new_style <span class="token operator">=</span> <span class="token string">\'#{}: {:&lt;10s} = {}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>\n        i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">assert</span> old_style <span class="token operator">==</span> new_style</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>当然，这种 {} 形式的说明符，还支持一些比较高级的用法，例如可以查询 dict 中某个键的值，可以访问 list 里某个位置的元素，还可以把值转化成 Unicode 或 repr 字符串。下面这段代码把这三项特性结合了起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87649009706450780000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`menu = {\n    \'soup\': \'lentil\',\n    \'oyster\': \'kumamoto\',\n    \'special\': \'schnitzel\',\n}\n\nformatted = \'First letter is {menu[oyster][0]!r}\'.format(\n    menu=menu)\nprint(formatted)\n\n>>>\nFirst letter is \'k\'`, `87649009706450780000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">menu <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'soup\'</span><span class="token punctuation">:</span> <span class="token string">\'lentil\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'oyster\'</span><span class="token punctuation">:</span> <span class="token string">\'kumamoto\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'special\'</span><span class="token punctuation">:</span> <span class="token string">\'schnitzel\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nformatted <span class="token operator">=</span> <span class="token string">\'First letter is {menu[oyster][0]!r}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>\n    menu<span class="token operator">=</span>menu<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFirst letter <span class="token keyword">is</span> <span class="token string">\'k\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但是这些特性，依然不能解决前面提到的第四个缺点，也就是键名需要多次重复的那个问题。下面把 C 风格的格式化表达式与新的 str.format 方法对比一下，看看这两种写法在处理键值对形式的数据时有什么区别。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38112100261743210000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`old_template = (\n    \'Today\\\'s soup is %(soup)s, \'\n    \'buy one get two %(oyster)s oysters, \'\n    \'and our special entree is %(special)s.\')\nold_formatted = old_template % {\n    \'soup\': \'lentil\',\n    \'oyster\': \'kumamoto\',\n    \'special\': \'schnitzel\',\n}\n\nnew_template = (\n    \'Today\\\'s soup is {soup}, \'\n    \'buy one get two {oyster} oysters, \'\n    \'and our special entree is {special}.\')\nnew_formatted = new_template.format(\n    soup=\'lentil\',\n    oyster=\'kumamoto\',\n    special=\'schnitzel\',\n)\n\nassert old_formatted == new_formatted`, `38112100261743210000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">old_template <span class="token operator">=</span> <span class="token punctuation">(</span>\n    <span class="token string">\'Today\\\'s soup is %(soup)s, \'</span>\n    <span class="token string">\'buy one get two %(oyster)s oysters, \'</span>\n    <span class="token string">\'and our special entree is %(special)s.\'</span><span class="token punctuation">)</span>\nold_formatted <span class="token operator">=</span> old_template <span class="token operator">%</span> <span class="token punctuation">{</span>\n    <span class="token string">\'soup\'</span><span class="token punctuation">:</span> <span class="token string">\'lentil\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'oyster\'</span><span class="token punctuation">:</span> <span class="token string">\'kumamoto\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'special\'</span><span class="token punctuation">:</span> <span class="token string">\'schnitzel\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nnew_template <span class="token operator">=</span> <span class="token punctuation">(</span>\n    <span class="token string">\'Today\\\'s soup is {soup}, \'</span>\n    <span class="token string">\'buy one get two {oyster} oysters, \'</span>\n    <span class="token string">\'and our special entree is {special}.\'</span><span class="token punctuation">)</span>\nnew_formatted <span class="token operator">=</span> new_template<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>\n    soup<span class="token operator">=</span><span class="token string">\'lentil\'</span><span class="token punctuation">,</span>\n    oyster<span class="token operator">=</span><span class="token string">\'kumamoto\'</span><span class="token punctuation">,</span>\n    special<span class="token operator">=</span><span class="token string">\'schnitzel\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">assert</span> old_formatted <span class="token operator">==</span> new_formatted</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>新写法稍微好一点儿，因为它不用定义 dict 了，所以不需要把键名用 <code class="language-text">&#39; &#39;</code> 给括起来。它的说明符也比旧写法的说明符要简单一些。然而这些优点并不突出。另外，虽然我们在新写法里面，可以访问字典中的键，也可以访问列表中的元素，但这些功能只涵盖了 Python 表达式的一小部分特性，str.format 方法还是没有能够把 Python 表达式的优势充分发挥出来。</p>\n<h3 id="插值格式字符串"><a href="#%E6%8F%92%E5%80%BC%E6%A0%BC%E5%BC%8F%E5%AD%97%E7%AC%A6%E4%B8%B2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>插值格式字符串</h3>\n<p>Python 3.6 添加了一种新的特性，叫作插值格式字符串（interpolatedformat string，简称 f-string），可以解决上面提到的所有问题。新语法特性要求在格式字符串的前面加字母 f 作为前缀，这跟字母 b 与字母 r 的用法类似，也就是分别表示字节形式的字符串与原始的（或者说未经转义的）字符串的前缀。</p>\n<p>f-string 把格式字符串的表达能力发挥到了极致，它彻底解决了上文提到的第四个缺点，也就是键名重复导致的程序冗余问题。我们不用再像使用 C 风格格式表达式时那样专门定义 dict，也不用再像调用 str.format 方法时那样专门把值传给某个参数，这次可以直接在 f-string 的 {} 里面引用当前 Python 范围内的所有名称，进而达到简化的目的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78509577793061390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nformatted = f\'{key} = {value}\'\nprint(formatted)\n\n>>>\nmy_var = 1.234`, `78509577793061390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nformatted <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span><span class="token string">\'</span></span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nmy_var <span class="token operator">=</span> <span class="token number">1.234</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>str.format 方法所支持的那套迷你语言，也就是在 {} 内的冒号右侧所采用的那套规则，现在也可以用到 f-string 里面，而且还可以像早前使用 str.format 时那样，通过 ! 符号把值转化成 Unicode 及 repr 形式的字符串。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23114241364745560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nformatted = f\'{key!r:<10} = {value:.2f}\'\nprint(formatted)\n\n>>>\n\'my_var\'   = 1.23`, `23114241364745560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nformatted <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token conversion-option punctuation">!r</span><span class="token punctuation">:</span><span class="token format-spec">&lt;10</span><span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">\'my_var\'</span>   <span class="token operator">=</span> <span class="token number">1.23</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>同一个问题，使用 f-string 来解决总是比通过 % 操作符使用 C 风格的格式字符串简单，而且也比 str.format 方法简单。下面按照从短到长的顺序把这几种写法所占的篇幅对比一下，每种写法里面的那个赋值符号（=）左侧都对齐到同一个位置，这样很容易看出符号右边的代码到底有多少。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36708499091227820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`key = \'my_var\'\nvalue = 1.234\n\nf_string = f\'{key:<10} = {value:.2f}\'\nc_tuple = \'%-10s = %.2f\' % (key, value)\nstr_args = \'{:<10} = {:.2f}\'.format(key, value)\nstr_kw = \'{key:<10} = {value:.2f}\'.format(key=key,\n                                          value=value)\nc_dict = \'%(key)-10s = %(value).2f\' % {\'key\': key,\n                                       \'value\': value}\nassert c_tuple == c_dict == f_string\nassert str_args == str_kw == f_string`, `36708499091227820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">key <span class="token operator">=</span> <span class="token string">\'my_var\'</span>\nvalue <span class="token operator">=</span> <span class="token number">1.234</span>\n\nf_string <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">:</span><span class="token format-spec">&lt;10</span><span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span>\nc_tuple <span class="token operator">=</span> <span class="token string">\'%-10s = %.2f\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\nstr_args <span class="token operator">=</span> <span class="token string">\'{:&lt;10} = {:.2f}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\nstr_kw <span class="token operator">=</span> <span class="token string">\'{key:&lt;10} = {value:.2f}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token operator">=</span>key<span class="token punctuation">,</span>\n                                          value<span class="token operator">=</span>value<span class="token punctuation">)</span>\nc_dict <span class="token operator">=</span> <span class="token string">\'%(key)-10s = %(value).2f\'</span> <span class="token operator">%</span> <span class="token punctuation">{</span><span class="token string">\'key\'</span><span class="token punctuation">:</span> key<span class="token punctuation">,</span>\n                                       <span class="token string">\'value\'</span><span class="token punctuation">:</span> value<span class="token punctuation">}</span>\n<span class="token keyword">assert</span> c_tuple <span class="token operator">==</span> c_dict <span class="token operator">==</span> f_string\n<span class="token keyword">assert</span> str_args <span class="token operator">==</span> str_kw <span class="token operator">==</span> f_string</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 f-string 方法中，各种 Python 表达式都可以出现在 {} 里，于是这就解决了前面提到的第二个缺点。我们现在可以用相当简洁的写法对需要填充到字符串里面的值做出微调。C 风格的写法与采用 str.format 方法的写法可能会让表达式变得很长，但如果改用 f-string，或许一行就能写完。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36230119874975597000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n    (\'avocados\', 1.25),\n    (\'bananas\', 2.5),\n    (\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n    old_style = \'#%d: %-10s = %d\' % (\n        i + 1,\n        item.title(),\n        round(count))\n    new_style = \'#{}: {:<10s} = {}\'.format(\n        i + 1,\n        item.title(),\n        round(count))\n    f_string = f\'#{i + 1}: {item.title():<10s} = {round(count)}\'\n    assert old_style == new_style == f_string`, `36230119874975597000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    old_style <span class="token operator">=</span> <span class="token string">\'#%d: %-10s = %d\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>\n        i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    new_style <span class="token operator">=</span> <span class="token string">\'#{}: {:&lt;10s} = {}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>\n        i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    f_string <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f\'#</span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&lt;10s</span><span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span>\n    <span class="token keyword">assert</span> old_style <span class="token operator">==</span> new_style <span class="token operator">==</span> f_string</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>要是想表达得更清楚一些，可以把 f-string 写成多行的形式，类似于 C 语言的相邻字符串拼接（adjacent-string concatenation）。这样写虽然比单行的 f-string 要长，但仍然好过另外那两种多行的写法。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3597291214214126600"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pantry = [\n    (\'avocados\', 1.25),\n    (\'bananas\', 2.5),\n    (\'cherries\', 15),\n]\n\nfor i, (item, count) in enumerate(pantry):\n    f_string = (\n        f\'# {i + 1}: \'\n        f\'{item.title():<10s} = \'\n        f\'{round(count)}\'\n    )\n    print(f_string)\n\n>>>\n# 1: Avocados   = 1\n# 2: Bananas    = 2\n# 3: Cherries   = 15`, `3597291214214126600`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pantry <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'avocados\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'bananas\'</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'cherries\'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> count<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pantry<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    f_string <span class="token operator">=</span> <span class="token punctuation">(</span>\n        <span class="token string-interpolation"><span class="token string">f\'# </span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: \'</span></span>\n        <span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&lt;10s</span><span class="token punctuation">}</span></span><span class="token string"> = \'</span></span>\n        <span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span>\n    <span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>f_string<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token comment"># 1: Avocados   = 1</span>\n<span class="token comment"># 2: Bananas    = 2</span>\n<span class="token comment"># 3: Cherries   = 15</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 表达式也可以出现在格式说明符中。例如，下面的代码把小数点之后的位数用变量来表示，然后把这个变量的名字 places 用 {} 括起来放到格式说明符中，这样写比采用硬代码更灵活。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17260270959810642000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`places = 3\nnumber = 1.23456\nprint(f\'My number is {number:.{places}f}\')\n\n>>>\nMy number is 1.235`, `17260270959810642000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">places <span class="token operator">=</span> <span class="token number">3</span>\nnumber <span class="token operator">=</span> <span class="token number">1.23456</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'My number is </span><span class="token interpolation"><span class="token punctuation">{</span>number<span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token punctuation">{</span>places<span class="token punctuation">}</span>f<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMy number <span class="token keyword">is</span> <span class="token number">1.235</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 Python 内置的四种字符串格式化办法里面，f-string 可以简洁而清晰地表达出许多种逻辑，这使它成为程序员的最佳选择。如果你想把值以适当的格式填充到字符串里面，那么首先应该考虑的就是采用 f-string 来实现。</p>\n<h3 id="总结"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>采用 % 操作符把值填充到 C 风格的格式字符串时会遇到许多问题，而且这种写法比较烦琐。</li>\n<li>str.format 方法专门用一套迷你语言来定义它的格式说明符，这套语言给我们提供了一些有用的概念，但是在其他方面，这个方法还是存在与 C 风格的格式字符串一样的多种缺点，所以我们也应该避免使用它。</li>\n<li>f-string 采用新的写法，将值填充到字符串之中，解决了 C 风格的格式字符串所带来的最大问题。f-string 是个简洁而强大的机制，可以直接在格式说明符里嵌入任意 Python 表达式。</li>\n</ol>\n<h2 id="第-5-条：用辅助函数取代复杂的表达式"><a href="#%E7%AC%AC-5-%E6%9D%A1%EF%BC%9A%E7%94%A8%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%A4%8D%E6%9D%82%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 5 条：用辅助函数取代复杂的表达式</h2>\n<p>Python 的语法相当简明，所以有时只用一条表达式就能实现许多逻辑。例如，要把 URL 之中的查询字符串拆分成键值对，那么只需要使用 parse_qs 函数就可以了。下面的例子会解析查询字符串之中的每个参数，并把这些参数跟它们所对应的整数值放到一份字典（dict）里面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10161209148704109000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from urllib.parse import parse_qs\nmy_values = parse_qs(\'red=5&blue=0&green=\',\n                     keep_blank_values=True)\nprint(repr(my_values))\n\n>>>\n{\'red\': [\'5\'], \'blue\': [\'0\'], \'green\': [\'\']}`, `10161209148704109000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> parse_qs\nmy_values <span class="token operator">=</span> parse_qs<span class="token punctuation">(</span><span class="token string">\'red=5&amp;blue=0&amp;green=\'</span><span class="token punctuation">,</span>\n                     keep_blank_values<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>my_values<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'red\'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'5\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'0\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在解析查询字符串时，可以发现，有的参数可能带有多个值，有的参数可能只有一个值，还有的参数可能是空白值，另外也会遇到根本没提供这个参数的情况。下面这三行代码分别通过 get 方法查询结果字典里面的三个参数，这刚好对应三种不同的情况：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61359873908604250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from urllib.parse import parse_qs\nmy_values = parse_qs(\'red=5&blue=0&green=\',\n                     keep_blank_values=True)\n\nprint(\'Red:         \', my_values.get(\'red\'))\nprint(\'Green:       \', my_values.get(\'green\'))\nprint(\'Opacity:     \', my_values.get(\'opacity\'))\n\n>>>\nRed:          [\'5\']\nGreen:        [\'\']\nOpacity:      None`, `61359873908604250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> parse_qs\nmy_values <span class="token operator">=</span> parse_qs<span class="token punctuation">(</span><span class="token string">\'red=5&amp;blue=0&amp;green=\'</span><span class="token punctuation">,</span>\n                     keep_blank_values<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Red:         \'</span><span class="token punctuation">,</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Green:       \'</span><span class="token punctuation">,</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'green\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Opacity:     \'</span><span class="token punctuation">,</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'opacity\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nRed<span class="token punctuation">:</span>          <span class="token punctuation">[</span><span class="token string">\'5\'</span><span class="token punctuation">]</span>\nGreen<span class="token punctuation">:</span>        <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span>\nOpacity<span class="token punctuation">:</span>      <span class="token boolean">None</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果能把参数缺失与参数为空白值这两种情况都默认当成 0，那就更好了。但这样一个小小的逻辑，似乎不值得专门写 if 语句或辅助函数，所以有人会直接用 Boolean 表达式实现。</p>\n<p>Boolean 表达式用 Python 的语法写起来很简单，因为 Python 在对这种表达式求值的时候，会把空白字符串、空白 list 以及 0 值，全都当成 False 看待。所以，只需要把 get 方法查到的结果放在 or 操作符的左边，并且在右边写上 0 就行了。这样的话，只要左边的子表达式为 False，那么整个表达式的值自然就被评估为右边那个表达式的值，也就是 0。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38067464481043810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from urllib.parse import parse_qs\nmy_values = parse_qs(\'red=5&blue=0&green=\',\n                     keep_blank_values=True)\n\n# For query string \'red=5&blue=0&green=\'\nred = my_values.get(\'red\', [\'\'])[0] or 0\ngreen = my_values.get(\'green\', [\'\'])[0] or 0\nopacity = my_values.get(\'opacity\', [\'\'])[0] or 0\nprint(f\'Red:     {red!r}\')\nprint(f\'Green:   {green!r}\')\nprint(f\'Opacity: {opacity!r}\')\n\n>>>\nRed:     \'5\'\nGreen:   0\nOpacity: 0`, `38067464481043810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> parse_qs\nmy_values <span class="token operator">=</span> parse_qs<span class="token punctuation">(</span><span class="token string">\'red=5&amp;blue=0&amp;green=\'</span><span class="token punctuation">,</span>\n                     keep_blank_values<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n\n<span class="token comment"># For query string \'red=5&amp;blue=0&amp;green=\'</span>\nred <span class="token operator">=</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span>\ngreen <span class="token operator">=</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'green\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span>\nopacity <span class="token operator">=</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'opacity\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Red:     </span><span class="token interpolation"><span class="token punctuation">{</span>red<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Green:   </span><span class="token interpolation"><span class="token punctuation">{</span>green<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Opacity: </span><span class="token interpolation"><span class="token punctuation">{</span>opacity<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nRed<span class="token punctuation">:</span>     <span class="token string">\'5\'</span>\nGreen<span class="token punctuation">:</span>   <span class="token number">0</span>\nOpacity<span class="token punctuation">:</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>表达式写成这样，看起来很别扭，而且它并没有完全实现我们想要的效果，因为我们还得保证解析出来的参数值是能够直接参与数学运算的整数。于是，需要通过内置的 int() 把这种表达式所解析出来的字符串转换成整数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65391038460603834000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`red = int(my_values.get(\'red\', [\'\'])[0] or 0)`, `65391038460603834000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">red <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token number">0</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>现在的代码比原来更难读了，因为看上去比原来还要乱。这种代码让人觉得很可怕：如果你是第一次阅读该代码，那必须得把整个表达式逐层拆分，才能明白这行代码的意思，这要花很长时间。代码当然应该写得短一些，但并不意味着非得挤成一行。</p>\n<p>Python 可以用 if/else 结构实现三元的条件表达式，这样写比刚才那种写法更清晰，且能保持代码简短。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18320656159905501000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`red_str = my_values.get(\'red\', [\'\'])\nred = int(red_str[0]) if red_str[0] else 0`, `18320656159905501000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">red_str <span class="token operator">=</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\nred <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>red_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> red_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>但在我们这个例子里，这种写法还是不如完整的多行 if/else 结构好，虽然要多写几行，但非常容易看懂。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5571811896878965000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`green_str = my_values.get(\'green\', [\'\'])\nif green_str[0]:\n    green = int(green_str[0])\nelse:\n    green = 0`, `5571811896878965000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">green_str <span class="token operator">=</span> my_values<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'green\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> green_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>\n    green <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>green_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    green <span class="token operator">=</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果要反复使用这套逻辑，那还是写成辅助函数比较好，即使像下面这个例子一样只用两三次，也还是值得这样做。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55816730237144860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_first_int(values, key, default=0):\n    found = values.get(key, [\'\'])\n    if found[0]:\n        return int(found[0])\n    return default`, `55816730237144860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_first_int</span><span class="token punctuation">(</span>values<span class="token punctuation">,</span> key<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    found <span class="token operator">=</span> values<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> default</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-1"><a href="#%E6%80%BB%E7%BB%93-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Python 的语法很容易把复杂的意思挤到同一行表达式里，这样写很难懂。</li>\n<li>复杂的表达式，尤其是那种需要重复使用的复杂表达式，应该写到辅助函数里面。</li>\n<li>用 if/else 结构写成的条件表达式，要比用 or 与 and 写成的 Boolean 表达式更好懂。</li>\n</ol>\n<h2 id="第-6-条：把数据结构直接拆分到多个变量里，不要专门通过下标访问"><a href="#%E7%AC%AC-6-%E6%9D%A1%EF%BC%9A%E6%8A%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9B%B4%E6%8E%A5%E6%8B%86%E5%88%86%E5%88%B0%E5%A4%9A%E4%B8%AA%E5%8F%98%E9%87%8F%E9%87%8C%EF%BC%8C%E4%B8%8D%E8%A6%81%E4%B8%93%E9%97%A8%E9%80%9A%E8%BF%87%E4%B8%8B%E6%A0%87%E8%AE%BF%E9%97%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 6 条：把数据结构直接拆分到多个变量里，不要专门通过下标访问</h2>\n<p>Python 内置的元组（tuple）类型可以创建不可变的序列，把许多元素依次保存起来。最简单的用法是只用元组保存两个值，例如字典里面的键值对。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81418732659271800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`snack_calories = {\n    \'chips\': 140,\n    \'popcorn\': 80,\n    \'nuts\': 190,\n}\nitems = tuple(snack_calories.items())\nprint(items)\n\n>>>\n((\'chips\', 140), (\'popcorn\', 80), (\'nuts\', 190))`, `81418732659271800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">snack_calories <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'chips\'</span><span class="token punctuation">:</span> <span class="token number">140</span><span class="token punctuation">,</span>\n    <span class="token string">\'popcorn\'</span><span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span>\n    <span class="token string">\'nuts\'</span><span class="token punctuation">:</span> <span class="token number">190</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\nitems <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>snack_calories<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">\'chips\'</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'popcorn\'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'nuts\'</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们可以用整数作下标，通过下标来访问元组里面对应的元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94553234282645640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`item = (\'Peanut butter\', \'Jelly\')\nfirst = item[0]\nsecond = item[1]\nprint(first, \'and\', second)\n\n>>>\nPeanut butter and Jelly`, `94553234282645640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">item <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">\'Peanut butter\'</span><span class="token punctuation">,</span> <span class="token string">\'Jelly\'</span><span class="token punctuation">)</span>\nfirst <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\nsecond <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> <span class="token string">\'and\'</span><span class="token punctuation">,</span> second<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nPeanut butter <span class="token keyword">and</span> Jelly</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>创建好 tuple 之后，就不能通过下标给其中的元素赋新值了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40989644473006080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pair = (\'Chocolate\', \'Peanut butter\')\npair[0] = \'Honey\'\n\n>>>\nTraceback ...\nTypeError: \'tuple\' object does not support item assignment`, `40989644473006080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pair <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">\'Chocolate\'</span><span class="token punctuation">,</span> <span class="token string">\'Peanut butter\'</span><span class="token punctuation">)</span>\npair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">\'Honey\'</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token string">\'tuple\'</span> <span class="token builtin">object</span> does <span class="token keyword">not</span> support item assignment</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 还有一种写法，叫作拆分（unpacking）。这种写法让我们只用一条语句，就可以把元组里面的元素分别赋给多个变量。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6808428232011732000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`item = (\'Peanut butter\', \'Jelly\')\nfirst, second = item  # Unpacking\nprint(first, \'and\', second)\n\n>>>\nPeanut butter and Jelly`, `6808428232011732000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">item <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">\'Peanut butter\'</span><span class="token punctuation">,</span> <span class="token string">\'Jelly\'</span><span class="token punctuation">)</span>\nfirst<span class="token punctuation">,</span> second <span class="token operator">=</span> item  <span class="token comment"># Unpacking</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> <span class="token string">\'and\'</span><span class="token punctuation">,</span> second<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nPeanut butter <span class="token keyword">and</span> Jelly</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>通过 unpacking 来赋值要比通过下标去访问元组内的元素更清晰，而且这种写法所需的代码量通常比较少。当然，赋值操作的左边除了可以罗列单个变量，也可以写成列表、序列或任意深度的可迭代对象（iterable）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7727151643893437000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`favorite_snacks = {\n    \'salty\': (\'pretzels\', 100),\n    \'sweet\': (\'cookies\', 180),\n    \'veggie\': (\'carrots\', 20),\n}\n\n((type1, (name1, cals1)),\n (type2, (name2, cals2)),\n (type3, (name3, cals3))) = favorite_snacks.items()\nprint(f\'Favorite {type1} is {name1} with {cals1} calories\')\nprint(f\'Favorite {type2} is {name2} with {cals2} calories\')\nprint(f\'Favorite {type3} is {name3} with {cals3} calories\')\n\n>>>\nFavorite salty is pretzels with 100 calories\nFavorite sweet is cookies with 180 calories\nFavorite veggie is carrots with 20 calories`, `7727151643893437000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">favorite_snacks <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'salty\'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'pretzels\'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token string">\'sweet\'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'cookies\'</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token string">\'veggie\'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'carrots\'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token punctuation">(</span><span class="token punctuation">(</span>type1<span class="token punctuation">,</span> <span class="token punctuation">(</span>name1<span class="token punctuation">,</span> cals1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n <span class="token punctuation">(</span>type2<span class="token punctuation">,</span> <span class="token punctuation">(</span>name2<span class="token punctuation">,</span> cals2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n <span class="token punctuation">(</span>type3<span class="token punctuation">,</span> <span class="token punctuation">(</span>name3<span class="token punctuation">,</span> cals3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> favorite_snacks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Favorite </span><span class="token interpolation"><span class="token punctuation">{</span>type1<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>name1<span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span>cals1<span class="token punctuation">}</span></span><span class="token string"> calories\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Favorite </span><span class="token interpolation"><span class="token punctuation">{</span>type2<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>name2<span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span>cals2<span class="token punctuation">}</span></span><span class="token string"> calories\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Favorite </span><span class="token interpolation"><span class="token punctuation">{</span>type3<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>name3<span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span>cals3<span class="token punctuation">}</span></span><span class="token string"> calories\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFavorite salty <span class="token keyword">is</span> pretzels <span class="token keyword">with</span> <span class="token number">100</span> calories\nFavorite sweet <span class="token keyword">is</span> cookies <span class="token keyword">with</span> <span class="token number">180</span> calories\nFavorite veggie <span class="token keyword">is</span> carrots <span class="token keyword">with</span> <span class="token number">20</span> calories</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33418921436215742000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`snacks = [(\'bacon\', 350), (\'donut\', 240), (\'muffin\', 190)]\n\nfor rank, (name, calories) in enumerate(snacks, 1):\n    print(f\'#{rank}: {name} has {calories} calories\')\n\n>>>\n#1: bacon has 350 calories\n#2: donut has 240 calories\n#3: muffin has 190 calories`, `33418921436215742000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">snacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">\'bacon\'</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'donut\'</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'muffin\'</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> rank<span class="token punctuation">,</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> calories<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>snacks<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'#</span><span class="token interpolation"><span class="token punctuation">{</span>rank<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> has </span><span class="token interpolation"><span class="token punctuation">{</span>calories<span class="token punctuation">}</span></span><span class="token string"> calories\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token comment">#1: bacon has 350 calories</span>\n<span class="token comment">#2: donut has 240 calories</span>\n<span class="token comment">#3: muffin has 190 calories</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这才是符合 Python 风格的写法（Pythonic 式的写法），我们不需要再通过下标逐层访问了。这种写法可以节省篇幅，而且比较容易理解。</p>\n<p>Python 的 unpacking 机制可以用在许多方面，例如构建列表（参见第 13 条）、给函数设计参数列表（参见第 22 条）、传递关键字参数（参见第 23 条）、接收多个返回值（参见第 19 条）等。</p>\n<p>明智地使用 unpacking 机制，可以实现很多原来必须通过下标才能写出的功能，这让代码变得更加清晰，而且能充分发挥 Python 的优势。</p>\n<h3 id="总结-2"><a href="#%E6%80%BB%E7%BB%93-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>unpacking 是一种特殊的 Python 语法，只需要一行代码，就能把数据结构里面的多个值分别赋给相应的变量。</li>\n<li>unpacking 在 Python 中应用广泛，凡是可迭代的对象都能拆分，无论它里面还有多少层迭代结构。</li>\n<li>尽量通过 unpacking 来拆解序列之中的数据，而不要通过下标访问，这样可以让代码更简洁、更清晰。</li>\n</ol>\n<h2 id="第-7-条：尽量用-enumerate-取代-range"><a href="#%E7%AC%AC-7-%E6%9D%A1%EF%BC%9A%E5%B0%BD%E9%87%8F%E7%94%A8-enumerate-%E5%8F%96%E4%BB%A3-range" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 7 条：尽量用 enumerate 取代 range</h2>\n<p>Python 内置的 range 函数适合用来迭代一系列整数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94637038789517340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from random import randint\n\nrandom_bits = 0\nfor i in range(32):\n    if randint(0, 1):\n        random_bits |= 1 << i\nprint(bin(random_bits))\n\n>>>\n0b100101010010000001011011010011`, `94637038789517340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint\n\nrandom_bits <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        random_bits <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>random_bits<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">0b100101010010000001011011010011</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果要迭代的是某种数据结构，例如字符串列表，那么可以直接在这个序列上面迭代，用不着专门通过 range 设定一个取值范围，然后把这个范围里的每个整数值，依次当成下标来访问列表中的元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86192342841168330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`flavor_list = [\'vanilla\', \'chocolate\', \'pecan\', \'strawberry\']\n\nfor flavor in flavor_list:\n    print(f\'{flavor} is delicious\')\n\n>>>\nvanilla is delicious\nchocolate is delicious\npecan is delicious\nstrawberry is delicious`, `86192342841168330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">flavor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'vanilla\'</span><span class="token punctuation">,</span> <span class="token string">\'chocolate\'</span><span class="token punctuation">,</span> <span class="token string">\'pecan\'</span><span class="token punctuation">,</span> <span class="token string">\'strawberry\'</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> flavor <span class="token keyword">in</span> flavor_list<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>flavor<span class="token punctuation">}</span></span><span class="token string"> is delicious\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nvanilla <span class="token keyword">is</span> delicious\nchocolate <span class="token keyword">is</span> delicious\npecan <span class="token keyword">is</span> delicious\nstrawberry <span class="token keyword">is</span> delicious</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>当然有的时候，在迭代 list 的过程中也需要知道当前处理的这个元素在 list 里的位置。例如，我把爱吃的冰激淋口味写在 <code class="language-text">flavor_list</code> 列表里面，在打印每种口味时，我还想指出这种口味在自己心目中的排名。为了实现这样的功能，我们可以用传统的 range 方式来实现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94898867274806300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`flavor_list = [\'vanilla\', \'chocolate\', \'pecan\', \'strawberry\']\n\nfor i in range(len(flavor_list)):\n    flavor = flavor_list[i]\n    print(f\'{i+1}: {flavor}\')\n\n>>>\n1: vanilla\n2: chocolate\n3: pecan\n4: strawberry`, `94898867274806300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">flavor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'vanilla\'</span><span class="token punctuation">,</span> <span class="token string">\'chocolate\'</span><span class="token punctuation">,</span> <span class="token string">\'pecan\'</span><span class="token punctuation">,</span> <span class="token string">\'strawberry\'</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flavor_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    flavor <span class="token operator">=</span> flavor_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>flavor<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span><span class="token punctuation">:</span> vanilla\n<span class="token number">2</span><span class="token punctuation">:</span> chocolate\n<span class="token number">3</span><span class="token punctuation">:</span> pecan\n<span class="token number">4</span><span class="token punctuation">:</span> strawberry</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class="language-text">range(len(flavor_list))</code> 的写法太过复杂，可以用 enumerate 代替。enumerate 能够把任何一种迭代器（iterator）封装成惰性生成器（lazy generator，参见第 30 条）</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17265666411414493000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`flavor_list = [\'vanilla\', \'chocolate\', \'pecan\', \'strawberry\']\n\nit = enumerate(flavor_list)\nprint(next(it))\nprint(next(it))\n\n>>>\n(0, \'vanilla\')\n(1, \'chocolate\')`, `17265666411414493000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">flavor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'vanilla\'</span><span class="token punctuation">,</span> <span class="token string">\'chocolate\'</span><span class="token punctuation">,</span> <span class="token string">\'pecan\'</span><span class="token punctuation">,</span> <span class="token string">\'strawberry\'</span><span class="token punctuation">]</span>\n\nit <span class="token operator">=</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>flavor_list<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">\'vanilla\'</span><span class="token punctuation">)</span>\n<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'chocolate\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27513194717712540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`flavor_list = [\'vanilla\', \'chocolate\', \'pecan\', \'strawberry\']\n\nfor i, flavor in enumerate(flavor_list):\n    print(f\'{i + 1}: {flavor}\')\n\n>>>\n1: vanilla\n2: chocolate\n3: pecan\n4: strawberry`, `27513194717712540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">flavor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'vanilla\'</span><span class="token punctuation">,</span> <span class="token string">\'chocolate\'</span><span class="token punctuation">,</span> <span class="token string">\'pecan\'</span><span class="token punctuation">,</span> <span class="token string">\'strawberry\'</span><span class="token punctuation">]</span>\n\n<span class="token keyword">for</span> i<span class="token punctuation">,</span> flavor <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>flavor_list<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>flavor<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span><span class="token punctuation">:</span> vanilla\n<span class="token number">2</span><span class="token punctuation">:</span> chocolate\n<span class="token number">3</span><span class="token punctuation">:</span> pecan\n<span class="token number">4</span><span class="token punctuation">:</span> strawberry</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>另外，还可以通过 enumerate 的第二个参数指定起始序号，这样就不用在每次打印的时候去调整了。例如，本例可以从 1 开始计算。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10273659247415767000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for i, flavor in enumerate(flavor_list, 1):\n    print(f\'{i + 1}: {flavor}\')`, `10273659247415767000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> i<span class="token punctuation">,</span> flavor <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>flavor_list<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>flavor<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<h3 id="总结-3"><a href="#%E6%80%BB%E7%BB%93-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>enumerate 函数可以用简洁的代码迭代 iterator，而且可以指出当前这轮循环的序号。</li>\n<li>不要先通过 range 指定下标的取值范围，然后用下标去访问序列，而是应该直接用 enumerate 函数迭代。</li>\n<li>可以通过 enumerate 的第二个参数指定起始序号（默认为 0）。</li>\n</ol>\n<h2 id="第-8-条：用-zip-函数同时遍历两个迭代器"><a href="#%E7%AC%AC-8-%E6%9D%A1%EF%BC%9A%E7%94%A8-zip-%E5%87%BD%E6%95%B0%E5%90%8C%E6%97%B6%E9%81%8D%E5%8E%86%E4%B8%A4%E4%B8%AA%E8%BF%AD%E4%BB%A3%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 8 条：用 zip 函数同时遍历两个迭代器</h2>\n<p>写 Python 代码时，经常会根据某份列表中的对象创建许多与这份列表有关的新列表。下面这样的列表推导机制，可以把表达式运用到源列表的每个元素上面，从而生成一份派生列表（参见第 27 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96085609599501270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`names = [\'Cecilia\', \'Lise\', \'Marie\']\ncounts = [len(n) for n in names]\nprint(counts)\n\n>>>\n[7, 4, 5]`, `96085609599501270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'Cecilia\'</span><span class="token punctuation">,</span> <span class="token string">\'Lise\'</span><span class="token punctuation">,</span> <span class="token string">\'Marie\'</span><span class="token punctuation">]</span>\ncounts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> names<span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>counts<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>派生列表中的元素与源列表中对应位置上面的元素有着一定的关系。如果想同时遍历这两份列表，那可以根据源列表的长度做迭代。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72688736036048590000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`names = [\'Cecilia\', \'Lise\', \'Marie\']\ncounts = [len(n) for n in names]\n\nlongest_name = None\nmax_count = 0\nfor i in range(len(names)):\n    count = counts[i]\n    if count > max_count:\n        longest_name = names[i]\n        max_count = count\n\nprint(longest_name)\n\n>>>\nCecilia`, `72688736036048590000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'Cecilia\'</span><span class="token punctuation">,</span> <span class="token string">\'Lise\'</span><span class="token punctuation">,</span> <span class="token string">\'Marie\'</span><span class="token punctuation">]</span>\ncounts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> names<span class="token punctuation">]</span>\n\nlongest_name <span class="token operator">=</span> <span class="token boolean">None</span>\nmax_count <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    count <span class="token operator">=</span> counts<span class="token punctuation">[</span>i<span class="token punctuation">]</span>\n    <span class="token keyword">if</span> count <span class="token operator">></span> max_count<span class="token punctuation">:</span>\n        longest_name <span class="token operator">=</span> names<span class="token punctuation">[</span>i<span class="token punctuation">]</span>\n        max_count <span class="token operator">=</span> count\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>longest_name<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nCecilia</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法的问题在于，整个循环代码看起来很乱。我们要通过下标访问 names 与 counts 这两个列表里的元素，所以表示下标的那个循环变量 i 在循环体里必须出现两次，这让代码变得不太好懂。改用 enumerate 实现（参见第 7 条）会稍微好一些，但仍然不够理想。</p>\n<p>为了把代码写得更清楚，可以用 Python 内置的 zip 函数来实现。这个函数能把两个或更多的 iterator 封装成惰性生成器（lazy generator）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54609322654316800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for name, count in zip(names, counts):\n    if count > max_count:\n        longest_name = name\n        max_count = count`, `54609322654316800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> counts<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> count <span class="token operator">></span> max_count<span class="token punctuation">:</span>\n        longest_name <span class="token operator">=</span> name\n        max_count <span class="token operator">=</span> count</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>zip 每次只从它封装的那些迭代器里面各自取出一个元素，所以即便源列表很长，程序也不会因为占用内存过多而崩溃。但是，如果输入 zip 的那些列表的长度不一致，那就得小心了。例如，我给 names 列表里又添加了一个名字，但是忘了把它的长度更新到 counts 列表之中。在这种情况下，用 zip 同时遍历这两份列表，会产生奇怪的结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58671018188944220000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`names = [\'Cecilia\', \'Lise\', \'Marie\']\ncounts = [len(n) for n in names]\n\nlongest_name = None\nmax_count = 0\nfor name, count in zip(names, counts):\n    if count > max_count:\n        longest_name = name\n        max_count = count\n\nnames.append(\'Rosalind\')\nfor name, count in zip(names, counts):\n    print(name)\n\n>>>\nCecilia\nLise\nMarie`, `58671018188944220000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'Cecilia\'</span><span class="token punctuation">,</span> <span class="token string">\'Lise\'</span><span class="token punctuation">,</span> <span class="token string">\'Marie\'</span><span class="token punctuation">]</span>\ncounts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> names<span class="token punctuation">]</span>\n\nlongest_name <span class="token operator">=</span> <span class="token boolean">None</span>\nmax_count <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> counts<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> count <span class="token operator">></span> max_count<span class="token punctuation">:</span>\n        longest_name <span class="token operator">=</span> name\n        max_count <span class="token operator">=</span> count\n\nnames<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">\'Rosalind\'</span><span class="token punctuation">)</span>\n<span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> counts<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nCecilia\nLise\nMarie</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>zip 函数只要其中任何一个迭代器处理完毕，它就不再往下走了。于是，循环的次数实际上等于最短的那份列表所具备的长度。一般情况下，我们都是根据某份列表推导出其他几份列表，然后把这些列表一起封装到 zip 里面，由于这些列表长度相同，因此不会遇到刚才的问题。</p>\n<p>在列表长度不同的情况下，zip 函数的提前终止行为可能跟你想实现的效果不一样。所以，如果无法确定这些列表的长度相同，那就不要把它们传给 zip，而是应该传给另一个叫作 <code class="language-text">zip_longest</code> 的函数，这个函数位于内置的 itertools 模块里。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34944312768929354000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nnames = [\'Cecilia\', \'Lise\', \'Marie\']\ncounts = [len(n) for n in names]\n\nlongest_name = None\nmax_count = 0\nfor name, count in zip(names, counts):\n    if count > max_count:\n        longest_name = name\n        max_count = count\n\nnames.append(\'Rosalind\')\n\nfor name, count in itertools.zip_longest(names, counts):\n    print(f\'{name}: {count}\')\n\n>>>\nCecilia: 7\nLise: 4\nMarie: 5\nRosalind: None`, `34944312768929354000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nnames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'Cecilia\'</span><span class="token punctuation">,</span> <span class="token string">\'Lise\'</span><span class="token punctuation">,</span> <span class="token string">\'Marie\'</span><span class="token punctuation">]</span>\ncounts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> names<span class="token punctuation">]</span>\n\nlongest_name <span class="token operator">=</span> <span class="token boolean">None</span>\nmax_count <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> counts<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> count <span class="token operator">></span> max_count<span class="token punctuation">:</span>\n        longest_name <span class="token operator">=</span> name\n        max_count <span class="token operator">=</span> count\n\nnames<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">\'Rosalind\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>zip_longest<span class="token punctuation">(</span>names<span class="token punctuation">,</span> counts<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nCecilia<span class="token punctuation">:</span> <span class="token number">7</span>\nLise<span class="token punctuation">:</span> <span class="token number">4</span>\nMarie<span class="token punctuation">:</span> <span class="token number">5</span>\nRosalind<span class="token punctuation">:</span> <span class="token boolean">None</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果其中有些列表已经遍历完了，那么 <code class="language-text">zip_longest</code> 会用当初传给 fillvalue 参数的那个值来填补空缺（本例中空缺的为字符串 <code class="language-text">&#39;Rosalind&#39;</code> 的长度值），默认的参数值是 None。</p>\n<h3 id="总结-4"><a href="#%E6%80%BB%E7%BB%93-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>内置的 zip 函数可以同时遍历多个迭代器。</li>\n<li>zip 会创建惰性生成器，让它每次只生成一个元组，所以无论输入的数据有多长，它都是一个一个处理的。</li>\n<li>如果提供的迭代器的长度不一致，那么只要其中任何一个迭代完毕，zip 就会停止。如果想按最长的那个迭代器来遍历，那就改用内置的 itertools 模块中的 <code class="language-text">zip_longest</code> 函数。</li>\n</ol>\n<h2 id="第-9-条：不要在-for-与-while-循环后面写-else-块"><a href="#%E7%AC%AC-9-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E5%9C%A8-for-%E4%B8%8E-while-%E5%BE%AA%E7%8E%AF%E5%90%8E%E9%9D%A2%E5%86%99-else-%E5%9D%97" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 9 条：不要在 for 与 while 循环后面写 else 块</h2>\n<p>Python 的循环有一项大多数编程语言都不支持的特性，即可以把 else 块紧跟在整个循环结构的后面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59852216471128480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for i in range(3):\n    print(\'Loop\', i)\nelse:\n    print(\'Else block!\')\n\n>>>\nLoop 0\nLoop 1\nLoop 2\nElse block!`, `59852216471128480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Loop\'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Else block!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLoop <span class="token number">0</span>\nLoop <span class="token number">1</span>\nLoop <span class="token number">2</span>\nElse block!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果循环没有从头到尾执行完（也就是循环提前终止了），那么 else 块里的代码是不会执行的。在循环中使用 break 语句实际上会跳过 else 块。这个与实际想象中的功能差别较大</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90442663577361600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for i in range(3):\n    print(\'Loop\', i)\n    if i == 1:\n        break\nelse:\n    print(\'Else block!\')\n\n>>>\nLoop 0\nLoop 1`, `90442663577361600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Loop\'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n        <span class="token keyword">break</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Else block!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLoop <span class="token number">0</span>\nLoop <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>还有一个奇怪的地方是，如果对空白序列做 for 循环，那么程序立刻就会执行 else 块。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19498871245230440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for x in []:\n    print(\'Never runs\')\nelse:\n    print(\'For Else block!\')\n\n>>>\nFor Else block!`, `19498871245230440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Never runs\'</span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'For Else block!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFor Else block!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>while 循环也是这样，如果首次循环就遇到 False，那么程序也会立刻运行 else 块。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15069841424152530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`while False:\n    print(\'Never runs\')\nelse:\n    print(\'While Else block!\')\n\n>>>\nWhile Else block!`, `15069841424152530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">while</span> <span class="token boolean">False</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Never runs\'</span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'While Else block!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nWhile Else block!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>把 else 设计成这样，是想让你利用它实现搜索逻辑。例如，如果要判断两个数是否互质（也就是除了 1 之外，是不是没有别的数能够同时整除它们），就可以用这种结构实现。先把有可能同时整除它们的数逐个试一遍，如果全都试过之后还是没找到这样的数，那么循环就会从头到尾执行完（这意味着循环没有因为 break 而提前跳出），然后程序就会执行 else 块里的代码。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75842007225368230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = 4\nb = 9\n\nfor i in range(2, min(a, b) + 1):\n    print(\'Testing\', i)\n    if a % i == 0 and b % i == 0:\n        print(\'Not coprime\')\n        break\nelse:\n    print(\'Coprime\')\n\n>>>\nTesting 2\nTesting 3\nTesting 4\nCoprime`, `75842007225368230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token number">4</span>\nb <span class="token operator">=</span> <span class="token number">9</span>\n\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Testing\'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> a <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> b <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Not coprime\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">break</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Coprime\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTesting <span class="token number">2</span>\nTesting <span class="token number">3</span>\nTesting <span class="token number">4</span>\nCoprime</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>实际工作中，会改用辅助函数完成计算。这样的辅助函数有两种常见的写法。</p>\n<ol>\n<li>\n<p>只要发现某个条件成立，就立刻返回，如果始终都没碰到这种情况，那么循环就会完整地执行，让程序返回函数末尾的那个值作为默认返回值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1785857528545498000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def coprime(a, b):\n  for i in range(2, min(a, b) + 1):\n     if a % i == 0 and b % i == 0:\n           return False\n  return True\n\nassert coprime(4, 9)\nassert not coprime(3, 6)`, `1785857528545498000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">coprime</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">if</span> a <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> b <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n           <span class="token keyword">return</span> <span class="token boolean">False</span>\n  <span class="token keyword">return</span> <span class="token boolean">True</span>\n\n<span class="token keyword">assert</span> coprime<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token keyword">not</span> coprime<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>用变量来记录循环过程中有没有碰到这样的情况，如果有，那就用 break 提前跳出循环，如果没有，循环就会完整地执行，无论如何，最后都返回这个变量的值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6429531193429150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def coprime_alternate(a, b):\n  is_coprime = True\n  for i in range(2, min(a, b) + 1):\n     if a % i == 0 and b % i == 0:\n           is_coprime = False\n           break\n  return is_coprime\n\nassert coprime_alternate(4, 9)\nassert not coprime_alternate(3, 6)`, `6429531193429150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">coprime_alternate</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  is_coprime <span class="token operator">=</span> <span class="token boolean">True</span>\n  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">if</span> a <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> b <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n           is_coprime <span class="token operator">=</span> <span class="token boolean">False</span>\n           <span class="token keyword">break</span>\n  <span class="token keyword">return</span> is_coprime\n\n<span class="token keyword">assert</span> coprime_alternate<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token keyword">not</span> coprime_alternate<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ol>\n<p>for/else 或 while/else 结构本身虽然可以实现某些逻辑表达，但它带来的困惑，已经盖过了它的好处。</p>\n<h3 id="总结-5"><a href="#%E6%80%BB%E7%BB%93-5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Python 有种特殊的语法，可以把 else 块紧跟在整个 for 循环或 while 循环的后面。</li>\n<li>只有在整个循环没有因为 break 提前跳出的情况下，else 块才会执行</li>\n<li>把 else 块紧跟在整个循环后面，会让人不太容易看出这段代码的意思，所以要避免这样写。</li>\n</ol>\n<h2 id="第-10-条：用赋值表达式减少重复代码"><a href="#%E7%AC%AC-10-%E6%9D%A1%EF%BC%9A%E7%94%A8%E8%B5%8B%E5%80%BC%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%87%8F%E5%B0%91%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 10 条：用赋值表达式减少重复代码</h2>\n<p>赋值表达式（assignment expression）是 Python3.8 新引入的语法，它会用到海象操作符（walrus operator）。这种写法可以解决某些持续已久的代码重复问题。</p>\n<p>这种表达式很有用，可以在普通的赋值语句无法应用的场合实现赋值，例如可以用在条件表达式的 if 语句里面。赋值表达式的值，就是赋给海象操作符左侧那个标识符的值。</p>\n<p>举个例子。如果有一筐新鲜水果要给果汁店做食材，那我们就可以这样定义其中的内容：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6790137094075899000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fresh_fruit = {\n    \'apple\': 10,\n    \'banana\': 8,\n    \'lemon\': 5,\n}\n\ndef make_lemonade(count):\n    pass\n\ndef out_of_stock():\n    pass\n\ncount = fresh_fruit.get(\'lemon\', 0)\nif count:\n    make_lemonade(count)\nelse:\n    out_of_stock()`, `6790137094075899000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">fresh_fruit <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'apple\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>\n    <span class="token string">\'banana\'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>\n    <span class="token string">\'lemon\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">def</span> <span class="token function">make_lemonade</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n<span class="token keyword">def</span> <span class="token function">out_of_stock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\ncount <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'lemon\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> count<span class="token punctuation">:</span>\n    make_lemonade<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这段代码看上去虽然简单，但还是显得有点儿松散，因为 count 变量虽然定义在整个 if/else 结构之上，然而只有 if 语句才会用到它，else 块根本就不需要使用这个变量。所以，这种写法让人误以为 count 是个重要的变量，if 和 else 都要用到它，但实际上并非如此。</p>\n<p>我们在 Python 里面经常要先获取某个值，然后判断它是否非零，如果是就执行某段代码。对于这种用法，我们以前总是要通过各种技巧，来避免 count 这样的变量重复出现在代码之中，这些技巧有时会让代码变得比较难懂（参考第 5 条里面提到的那些技巧）。Python 引入赋值表达式正是为了解决这样的问题。下面改用海象操作符来写：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1208650678206213400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if count := fresh_fruit.get(\'lemon\', 0):\n    make_lemonade(count)\nelse:\n    out_of_stock()`, `1208650678206213400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">if</span> count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'lemon\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    make_lemonade<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>新代码虽然只省了一行，但读起来却清晰很多，因为这种写法明确体现出 count 变量只与 if 块有关。这个赋值表达式先把 <code class="language-text">:=</code> 右边的值赋给左边的 count 变量，然后对自身求值，也就是把变量的值当成整个表达式的值。由于表达式紧跟着 if，程序会根据它的值是否非零来决定该不该执行 if 块。这种先赋值再判断的做法，正是海象操作符想要表达的意思。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35339576046906675000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`fresh_fruit = {\n    \'apple\': 10,\n    \'banana\': 8,\n    \'lemon\': 5,\n}\n\ndef make_cider(count):\n    pass\n\ncount = fresh_fruit.get(\'apple\', 0)\n\nif count >= 4:\n    make_cider(count)\nelse:\n    out_of_stock()`, `35339576046906675000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">fresh_fruit <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'apple\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>\n    <span class="token string">\'banana\'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>\n    <span class="token string">\'lemon\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">def</span> <span class="token function">make_cider</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\ncount <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'apple\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n\n<span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">:</span>\n    make_cider<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>同理以上代码可以修改如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="580806523388854900"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (count := fresh_fruit.get(\'apple\', 0)) >= 4:\n    make_lemonade(count)\nelse:\n    out_of_stock()`, `580806523388854900`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'apple\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">:</span>\n    make_lemonade<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>与刚才那个例子一样，修改之后的代码也比原来少了一行。但是这次，我们还要注意另外一个现象：赋值表达式本身是放在一对括号里面的。为什么要这样做呢？因为我们要在 if 语句里面把这个表达式的结果跟 4 这个值相比较。刚才柠檬汁的例子没有加括号，因为那时只凭赋值表达式本身的值就能决定 if/else 的走向：只要表达式的值不是 0，程序就进入 if 分支。但是这次不行，这次要把这个赋值表达式放在更大的表达式里面，所以必须用括号把它括起来。当然，在没有必要加括号的情况下，还是尽量别加括号比较好。</p>\n<p>还有一种类似的逻辑也会出现刚才说的重复代码，这指的是：我们要根据情况给某个变量赋予不同的值，紧接着要用这个变量做参数来调用某个函数。例如，若顾客要点香蕉冰沙，那我们首先得把香蕉切成好几份，然后用其中的两份来制作这道冰沙。如果不够两份，那就抛出香蕉不足（OutOfBananas）异常。下面用传统的写法实现这种逻辑：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9510439999662678000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def slice_bananas(count):\n    pass\n\n\nclass OutofBananas(Exception):\n    pass\n\n\ndef make_smoothies(count):\n    pass\n\n\nfresh_fruit = {\n    \'apple\': 10,\n    \'banana\': 8,\n    \'lemon\': 5,\n}\n\npieces = 0\ncount = fresh_fruit.get(\'banana\', 0)\nif count >= 2:\n    pieces = slice_bananas(count)\n\ntry:\n    smoothies = make_smoothies(pieces)\nexcept OutofBananas:\n    out_of_stock()`, `9510439999662678000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">slice_bananas</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">OutofBananas</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">make_smoothies</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\nfresh_fruit <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'apple\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>\n    <span class="token string">\'banana\'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>\n    <span class="token string">\'lemon\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\npieces <span class="token operator">=</span> <span class="token number">0</span>\ncount <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    smoothies <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">except</span> OutofBananas<span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>还有一种传统的写法也很常见，就是把 if/else 结构上方那条 pieces = 0 的赋值语句移动到 else 块中。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75122560829893480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`count = fresh_fruit.get(\'banana\', 0)\nif count >= 2:\n    pieces = slice_bananas(count)\nelse:\n    pieces = 0\n\ntry:\n    smoothies = make_smoothies(pieces)\nexcept OutofBananas:\n    out_of_stock()`, `75122560829893480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">count <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> <span class="token number">0</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    smoothies <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">except</span> OutofBananas<span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法看上去稍微有点儿怪，因为 if 与 else 这两个分支都给 pieces 变量定义了初始值。根据 Python 的作用域规则，这种分别定义变量初始值的写法是成立的（参见第 21 条）。虽说成立，但这样写看起来比较别扭，所以很多人喜欢用第一种写法，也就是在进入 if/else 结构之前，先把 pieces 的初始值给设置好。</p>\n<p>改用海象操作符来实现，可以少写一行代码，而且能够压低 count 变量的地位，让它只出现在 if 块里，这样我们就能更清楚地意识到 pieces 变量才是整段代码的重点。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13593155294062530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pieces = 0\nif (count := fresh_fruit.get(\'banana\', 0)) >= 2:\n    pieces = slice_bananas(count)\n\ntry:\n    smoothies = make_smoothies(pieces)\nexcept OutofBananas:\n    out_of_stock()`, `13593155294062530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pieces <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    smoothies <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">except</span> OutofBananas<span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>对于在 if 与 else 分支里面分别定义 pieces 变量的写法来说，海象操作符也能让代码变得清晰，因为这次不用再把 count 变量放到整个 if/else 块的上方了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2924842499729952000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (count := fresh_fruit.get(\'banana\', 0)) >= 2:\n    pieces = slice_bananas(count)\nelse:\n    pieces = 0\n\ntry:\n    smoothies = make_smoothies(pieces)\nexcept OutofBananas:\n    out_of_stock()`, `2924842499729952000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> <span class="token number">0</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    smoothies <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">except</span> OutofBananas<span class="token punctuation">:</span>\n    out_of_stock<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 新手经常会遇到这样一种困难，就是找不到好办法来实现 switch/case 结构。最接近这种结构的做法是在 if/else 结构里面继续嵌套 if/else 结构，或者使用 if/elif/else 结构。</p>\n<p>例如，我们想按照一定的顺序自动给客人制作饮品，这样就不用点餐了。下面这段逻辑先判断能不能做香蕉冰沙，如果不能，就做苹果汁，还不行，就做柠檬汁：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71775176197256950000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`count = fresh_fruit.get(\'banana\', 0)\nif count >= 2:\n    pieces = slice_bananas(count)\n    to_enjoy = make_smoothies(pieces)\nelse:\n    count = fresh_fruit.get(\'apple\', 0)\n    if count >= 4:\n        to_enjoy = make_cider(count)\n    else:\n        count = fresh_fruit.get(\'lemon\', 0)\n        if count:\n            to_enjoy = make_lemonade(count)\n        else:\n            to_enjoy = \'Nothing\'`, `71775176197256950000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">count <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n    to_enjoy <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    count <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'apple\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> count <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">:</span>\n        to_enjoy <span class="token operator">=</span> make_cider<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        count <span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'lemon\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n        <span class="token keyword">if</span> count<span class="token punctuation">:</span>\n            to_enjoy <span class="token operator">=</span> make_lemonade<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            to_enjoy <span class="token operator">=</span> <span class="token string">\'Nothing\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种难看的写法其实在 Python 代码里特别常见。幸好现在有了海象操作符，让我们能够轻松地模拟出很接近 switch/case 的方案。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49814675100474730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`if (count := fresh_fruit.get(\'banana\', 0)) >= 2:\n    pieces = slice_bananas(count)\n    to_enjoy = make_smoothies(pieces)\nelif (count := fresh_fruit.get(\'apple\', 0)) >= 4:\n    to_enjoy = make_cider(count)\nelif count := fresh_fruit.get(\'lemon\', 0):\n    to_enjoy = make_lemonade(count)\nelse:\n    to_enjoy = \'Nothing\'`, `49814675100474730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'banana\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>\n    pieces <span class="token operator">=</span> slice_bananas<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n    to_enjoy <span class="token operator">=</span> make_smoothies<span class="token punctuation">(</span>pieces<span class="token punctuation">)</span>\n<span class="token keyword">elif</span> <span class="token punctuation">(</span>count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'apple\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">:</span>\n    to_enjoy <span class="token operator">=</span> make_cider<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">elif</span> count <span class="token punctuation">:</span><span class="token operator">=</span> fresh_fruit<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'lemon\'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    to_enjoy <span class="token operator">=</span> make_lemonade<span class="token punctuation">(</span>count<span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    to_enjoy <span class="token operator">=</span> <span class="token string">\'Nothing\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个版本只比原来短五行，但是看起来却清晰得多，因为嵌套深度与缩进层数都变少了。只要碰到刚才那种难看的结构，我们就应该考虑能不能改用海象操作符来写。</p>\n<p>Python 新手还会遇到一个困难，就是缺少 do/while 循环结构。例如，我们要把新来的水果做成果汁并且装到瓶子里面，直到水果用完为止。下面先用普通的 while 循环来实现：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66412212249631500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def pick_fruit():\n    pass\n\n\ndef make_juice(fruit, count):\n    pass\n\n\nbottles = []\nfresh_fruit = pick_fruit()\nwhile fresh_fruit:\n    for fruit, count in fresh_fruit.items():\n        batch = make_juice(fruit, count)\n        bottles.extend(batch)\n    fresh_fruit = pick_fruit()`, `66412212249631500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">pick_fruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">make_juice</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\nbottles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\nfresh_fruit <span class="token operator">=</span> pick_fruit<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">while</span> fresh_fruit<span class="token punctuation">:</span>\n    <span class="token keyword">for</span> fruit<span class="token punctuation">,</span> count <span class="token keyword">in</span> fresh_fruit<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        batch <span class="token operator">=</span> make_juice<span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> count<span class="token punctuation">)</span>\n        bottles<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batch<span class="token punctuation">)</span>\n    fresh_fruit <span class="token operator">=</span> pick_fruit<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法必须把 <code class="language-text">fresh_fruit = pick_fruit()</code> 写两次，第一次是在进入 while 循环之前，因为我们要给 <code class="language-text">fresh_fruit</code> 设定初始值，第二次是在 while 循环体的末尾，因为我们得把下一轮需要处理的水果列表填充到 <code class="language-text">fresh_fruit</code> 里面。如果想复用这行代码，可以考虑 loop-and-a-half 模式。这个模式虽然能消除重复，但是会让 while 循环看起来很笨，因为它成了无限循环，程序只能通过 break 语句跳出这个循环。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9135341119689655000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`bottles = []\nwhile True:\n   fresh_fruit = pick_fruit()\n   if not fresh_fruit:\n      break\n    for fruit, count in fresh_fruit.items():\n        batch = make_juice(fruit, count)\n        bottles.extend(batch)`, `9135341119689655000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">bottles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>\n   fresh_fruit <span class="token operator">=</span> pick_fruit<span class="token punctuation">(</span><span class="token punctuation">)</span>\n   <span class="token keyword">if</span> <span class="token keyword">not</span> fresh_fruit<span class="token punctuation">:</span>\n      <span class="token keyword">break</span>\n    <span class="token keyword">for</span> fruit<span class="token punctuation">,</span> count <span class="token keyword">in</span> fresh_fruit<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        batch <span class="token operator">=</span> make_juice<span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> count<span class="token punctuation">)</span>\n        bottles<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batch<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>有了海象操作符，就不需要使用 <code class="language-text">loop-and-a-half</code> 模式了，我们可以在每轮循环的开头给 <code class="language-text">fresh_fruit</code> 变量赋值，并根据变量的值来决定要不要继续循环。这个写法简单易读，所以应该成为首选方案。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22586598186368324000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`bottles = []\nwhile fresh_fruit := pick_fruit():\n    for fruit, count in fresh_fruit.items():\n        batch = make_juice(fruit, count)\n        bottles.extend(batch)`, `22586598186368324000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">bottles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n<span class="token keyword">while</span> fresh_fruit <span class="token punctuation">:</span><span class="token operator">=</span> pick_fruit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> fruit<span class="token punctuation">,</span> count <span class="token keyword">in</span> fresh_fruit<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        batch <span class="token operator">=</span> make_juice<span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> count<span class="token punctuation">)</span>\n        bottles<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>batch<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在其他一些场合，赋值表达式也能缩减重复代码（参见第 29 条）。总之，如果某个表达式或赋值操作多次出现在一组代码里面，那就可以考虑用赋值表达式把这段代码改得简单一些。</p>\n<h3 id="总结-6"><a href="#%E6%80%BB%E7%BB%93-6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>赋值表达式通过海象操作符（:=）给变量赋值，并且让这个值成为这条表达式的结果，于是，我们可以利用这项特性来缩减代码。如果赋值表达式是大表达式里的一部分，就得用一对括号把它括起来。</li>\n<li>虽说 Python 不支持 switch/case 与 do/while 结构，但可以利用赋值表达式清晰地模拟出这种逻辑。</li>\n</ol>\n<h1 id="列表与字典"><a href="#%E5%88%97%E8%A1%A8%E4%B8%8E%E5%AD%97%E5%85%B8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>列表与字典</h1>\n<h2 id="第-11-条：学会对序列做切片"><a href="#%E7%AC%AC-11-%E6%9D%A1%EF%BC%9A%E5%AD%A6%E4%BC%9A%E5%AF%B9%E5%BA%8F%E5%88%97%E5%81%9A%E5%88%87%E7%89%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 11 条：学会对序列做切片</h2>\n<p>Python 有这样一种写法，可以从序列里面切割（slice）出一部分内容，让我们能够轻松地获取原序列的某个子集合。最简单的用法就是切割内置的 list、str 与 bytes。其实，凡是实现了 <code class="language-text">__getitem__</code> 与 <code class="language-text">__setitem__</code> 这两个特殊方法的类都可以切割（参见第 43 条）。</p>\n<p>最基本的写法是用 <code class="language-text">somelist[start:end]</code> 这一形式来切割，也就是从 start 开始一直取到 end 这个位置，但不包含 end 本身的元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26576338460567884000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(\'Middle two:   \', a[3:5])\nprint(\'All but ends: \', a[1:7])\n\n>>>\nMiddle two:    [\'d\', \'e\']\nAll but ends:  [\'b\', \'c\', \'d\', \'e\', \'f\', \'g\']`, `26576338460567884000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Middle two:   \'</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'All but ends: \'</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMiddle two<span class="token punctuation">:</span>    <span class="token punctuation">[</span><span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">]</span>\nAll but ends<span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果是从头开始切割列表，那就应该省略冒号左侧的下标 0，这样看起来更清晰。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77705558904446860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert a[:5] == a[0:5]`, `77705558904446860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>如果一直取到列表末尾，那就应该省略冒号右侧的下标，因为用不着专门把它写出来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70978013508480070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert a[5:] == a[5:len(a)]`, `70978013508480070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>用负数作下标表示从列表末尾往前算。下面这些切割方式，即便是刚看到这段代码的人也应该能明白是什么意思。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89168810150721930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(a[:]) # [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(a[:5]) # [\'a\', \'b\', \'c\', \'d\', \'e\']\nprint(a[:-1]) # [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\']\nprint(a[4:]) # [\'e\', \'f\', \'g\', \'h\']\nprint(a[-3:]) # [\'f\', \'g\', \'h\']\nprint(a[2:5]) # [\'c\', \'d\', \'e\']\nprint(a[2:-1]) # [\'c\', \'d\', \'e\', \'f\', \'g\']\nprint(a[-3:-1]) # [\'f\', \'g\']`, `89168810150721930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'a\', \'b\', \'c\', \'d\', \'e\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'e\', \'f\', \'g\', \'h\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'f\', \'g\', \'h\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'c\', \'d\', \'e\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'c\', \'d\', \'e\', \'f\', \'g\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># [\'f\', \'g\']</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果起点与终点所确定的范围超出了列表的边界，那么系统会自动忽略不存在的元素。利用这项特性，很容易就能构造出一个最多只有若干元素的输入序列，例如：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18656483873028160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`first_twenty_items = a[:20]\nlast_twenty_items = a[-20:]`, `18656483873028160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">first_twenty_items <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span>\nlast_twenty_items <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>切割时所用的下标可以越界，但是直接访问列表时却不行，那样会让程序抛出异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28298807133160354000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a[20]\n\n>>>\nTraceback ...\nIndexError: list index out of range`, `28298807133160354000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nIndexError<span class="token punctuation">:</span> <span class="token builtin">list</span> index out of <span class="token builtin">range</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>切割出来的列表是一份全新的列表。即便把某个元素换掉，也不会影响原列表中的相应位置。那个位置上的元素还是旧值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42946885069586990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nb = a[3:]\nprint(\'Before:\', b)\nb[1] = 99\nprint(\'After: \', b)\nprint(\'No change:\', a)\n\n>>>\nBefore: [\'d\', \'e\', \'f\', \'g\', \'h\']\nAfter:  [\'d\', 99, \'f\', \'g\', \'h\']\nNo change: [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']`, `42946885069586990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nb <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before:\'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>\nb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">99</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After: \'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'No change:\'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nAfter<span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nNo change<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>切片可以出现在赋值符号的左侧，表示用右侧那些元素把原列表中位于这个范围之内的元素换掉。与 unpacking 形式的赋值不同，这种赋值不要求等号两边所指定的元素个数必须相同（如果是做 unpacking，那么等号左侧用来接收数值的变量个数必须与等号右边所提供的数值个数一致，例如 <code class="language-text">a, b = c[:2]</code>，参见第 6 条）。在原列表中，位于切片范围之前和之后的那些元素会予以保留，但是列表的长度可能有所变化。例如在下面这个例子中，列表会变短，因为赋值符号右侧只提供了 3 个值，但是左侧那个切片却涵盖了 5 个值，列表会比原来少两个元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11192691648497166000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(\'Before \', a)\na[2:7] = [99, 22, 14]\nprint(\'After  \', a)\n\n>>>\nBefore  [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nAfter   [\'a\', \'b\', 99, 22, 14, \'h\']`, `11192691648497166000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before \'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\na<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After  \'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore  <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nAfter   <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面这段代码会使列表变长，因为赋值符号右侧的元素数量比左侧那个切片所涵盖的元素数量要多。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72763451092944840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(\'Before \', a)\na[2:3] = [47, 11]\nprint(\'After  \', a)\n\n>>>\nBefore  [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nAfter   [\'a\', \'b\', 47, 11, \'d\', \'e\', \'f\', \'g\', \'h\']`, `72763451092944840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before \'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\na<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After  \'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore  <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nAfter   <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>起止位置都留空的切片，如果出现在赋值符号右侧，那么表示给这个列表做副本，这样制作出来的新列表内容和原列表相同，但身份不同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41525026473834600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`b = a[:]\nassert b == a and b is not a`, `41525026473834600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">b <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>\n<span class="token keyword">assert</span> b <span class="token operator">==</span> a <span class="token keyword">and</span> b <span class="token keyword">is</span> <span class="token keyword">not</span> a</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>把不带起止下标的切片放在赋值符号左边，表示是用右边那个列表的副本把左侧列表的全部内容替换掉（注意，左侧列表依然保持原来的身份，系统不会分配新的列表）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4020602956085639000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nb = a\nc = a[:]\nprint(\'Before a\', a)\nprint(\'Before b\', b)\nprint(\'Before c\', b)\na[:] = [101, 102, 103]\nassert b is a and c is not a  # Still the same list object\nprint(\'After a \', a)  # Now has different contents\nprint(\'After b \', b)  # Same list, so same contents as a\nprint(\'After c \', c)  # Not same list, same contents as a\n\n>>>\nBefore a [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nBefore b [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nBefore c [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nAfter a  [101, 102, 103]\nAfter b  [101, 102, 103]\nAfter c  [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']`, `4020602956085639000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nb <span class="token operator">=</span> a\nc <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before a\'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before b\'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before c\'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>\na<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">]</span>\n<span class="token keyword">assert</span> b <span class="token keyword">is</span> a <span class="token keyword">and</span> c <span class="token keyword">is</span> <span class="token keyword">not</span> a  <span class="token comment"># Still the same list object</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After a \'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>  <span class="token comment"># Now has different contents</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After b \'</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>  <span class="token comment"># Same list, so same contents as a</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After c \'</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>  <span class="token comment"># Not same list, same contents as a</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore a <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nBefore b <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nBefore c <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\nAfter a  <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">]</span>\nAfter b  <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">]</span>\nAfter c  <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-7"><a href="#%E6%80%BB%E7%BB%93-7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>切片要尽可能写得简单一些：如果从头开始选取，就省略起始下标 0；如果选到序列末尾，就省略终止下标。</li>\n<li>切片允许起始下标或终止下标越界，所以很容易就能表达“取开头多少个元素”（例如 <code class="language-text">a[:20]</code>）或“取末尾多少个元素”（例如 <code class="language-text">a[-20:0]</code>）等含义，而不用担心切片是否真有这么多元素。</li>\n<li>把切片放在赋值符号的左侧可以将原列表中这段范围内的元素用赋值符号右侧的元素替换掉，但可能会改变原列表的长度。</li>\n</ol>\n<h2 id="第-12-条：不要在切片里同时指定起止下标与步进"><a href="#%E7%AC%AC-12-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E5%9C%A8%E5%88%87%E7%89%87%E9%87%8C%E5%90%8C%E6%97%B6%E6%8C%87%E5%AE%9A%E8%B5%B7%E6%AD%A2%E4%B8%8B%E6%A0%87%E4%B8%8E%E6%AD%A5%E8%BF%9B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 12 条：不要在切片里同时指定起止下标与步进</h2>\n<p>除了基本的切片写法（参见第 11 条）外，Python 还有一种特殊的步进切片形式，也就是 somelist[start:end:stride]。这种形式会在每 n 个元素里面选取一个，这样很容易就能把奇数位置上的元素与偶数位置上的元素分别通过 <code class="language-text">x[::2]</code> 与 <code class="language-text">x[1::2]</code> 选取出来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7474713139372802000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`x = [\'red\', \'orange\', \'yellow\', \'green\', \'blue\', \'purple\']\nodds = x[::2]\nevens = x[1::2]\nprint(odds)\nprint(evens)\n\n>>>\n[\'red\', \'yellow\', \'blue\']\n[\'orange\', \'green\', \'purple\']`, `7474713139372802000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token string">\'yellow\'</span><span class="token punctuation">,</span> <span class="token string">\'green\'</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">,</span> <span class="token string">\'purple\'</span><span class="token punctuation">]</span>\nodds <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>\nevens <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>odds<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>evens<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token string">\'yellow\'</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token string">\'green\'</span><span class="token punctuation">,</span> <span class="token string">\'purple\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>带有步进的切片经常会引发意外的效果，并且使程序出现 bug。例如，Python 里面有个常见的技巧，就是把 -1 当成步进值对 bytes 类型的字符串做切片，这样就能将字符串反转过来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2209246093218575400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`x = b\'mongoose\'\ny = x[::-1]\nprint(y)\n\n>>>\nb\'esoognom\'`, `2209246093218575400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">x <span class="token operator">=</span> <span class="token string">b\'mongoose\'</span>\ny <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token string">b\'esoognom\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Unicode 形式的字符串也可以这样反转（参见第 3 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28140589125466840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`x = \'多喝水\'\ny = x[::-1]\nprint(y)\n\n>>>\n水喝多`, `28140589125466840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">x <span class="token operator">=</span> <span class="token string">\'多喝水\'</span>\ny <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n水喝多</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但如果把这种字符串编码成 UTF-8 标准的字节数据，就不能用这个技巧来反转了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46032003684797850000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`x = \'多喝水\'\nx = x.encode(\'utf-8\')\ny = x[::-1]\nz = y.decode(\'utf-8\')\n\n>>>\nTraceback ...\nUnicodeDecodeError: \'utf-8\' codec can\'t decode byte 0xb4 in position 0: invalid start byte`, `46032003684797850000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">x <span class="token operator">=</span> <span class="token string">\'多喝水\'</span>\nx <span class="token operator">=</span> x<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\ny <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>\nz <span class="token operator">=</span> y<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">\'utf-8\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nUnicodeDecodeError<span class="token punctuation">:</span> <span class="token string">\'utf-8\'</span> codec can\'t decode byte <span class="token number">0xb4</span> <span class="token keyword">in</span> position <span class="token number">0</span><span class="token punctuation">:</span> invalid start byte</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>除了 -1 之外，用其他负数做步进值，有没有意义呢？请看下面的例子：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8168508615730130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`x = [\'a\', \'b\', \'c\', \'d\', \'e\', \'f\', \'g\', \'h\']\nprint(x[::2])  # [\'a\', \'c\', \'e\', \'g\']\nprint(x[::-2])  # [\'h\', \'f\', \'d\', \'b\']`, `8168508615730130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">,</span> <span class="token string">\'e\'</span><span class="token punctuation">,</span> <span class="token string">\'f\'</span><span class="token punctuation">,</span> <span class="token string">\'g\'</span><span class="token punctuation">,</span> <span class="token string">\'h\'</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># [\'a\', \'c\', \'e\', \'g\']</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># [\'h\', \'f\', \'d\', \'b\']</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>上例中，<code class="language-text">::2</code> 表示从头开始往后选，每两个元素里面选一个。<code class="language-text">::-2</code> 的含义稍微有点儿绕，表示从末尾开始往前选，每两个元素里面选一个。</p>\n<p>同时使用起止下标与步进会让切片很难懂。方括号里面写三个值显得太过拥挤，读起来不大容易，而且在指定了步进值（尤其是负数步进值）的时候，我们必须很仔细地考虑：这究竟是从前往后取，还是从后往前取？</p>\n<p>为了避免这个问题，笔者建议大家不要把起止下标和步进值同时写在切片里。如果必须指定步进，那么尽量采用正数，而且要把起止下标都留空。即便必须同时使用步进值与起止下标，也应该考虑分成两次来写。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49853001642148720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`y = x[::2]  # [\'a\', \'c\', \'e\', \'g\']\nz = y[1:-1] # [\'c\', \'e\']`, `49853001642148720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">y <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># [\'a\', \'c\', \'e\', \'g\']</span>\nz <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># [\'c\', \'e\']</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>像刚才那样先隔位选取然后再切割，会让程序多做一次浅拷贝（shallow copy）。所以，应该把最能缩减列表长度的那个切片操作放在前面。如果程序实在没有那么多时间或内存去分两步操作，那么可以改用内置的 itertools 模块中的 islice 方法（参见第 36 条），这个方法用起来更清晰，因为它的起止位置与步进值都不能是负数。</p>\n<h3 id="总结-8"><a href="#%E6%80%BB%E7%BB%93-8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>同时指定切片的起止下标与步进值理解起来会很困难。</li>\n<li>如果要指定步进值，那就省略起止下标，而且最好采用正数作为步进值，尽量别用负数。</li>\n<li>不要把起始位置、终止位置与步进值全都写在同一个切片操作里。如果必须同时使用这三项指标，那就分两次来做（其中一次隔位选取，另一次做切割），也可以改用 itertools 内置模块里的 islice 方法。</li>\n</ol>\n<h2 id="第-13-条：通过带星号的-unpacking-操作来捕获多个元素，不要用切片"><a href="#%E7%AC%AC-13-%E6%9D%A1%EF%BC%9A%E9%80%9A%E8%BF%87%E5%B8%A6%E6%98%9F%E5%8F%B7%E7%9A%84-unpacking-%E6%93%8D%E4%BD%9C%E6%9D%A5%E6%8D%95%E8%8E%B7%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0%EF%BC%8C%E4%B8%8D%E8%A6%81%E7%94%A8%E5%88%87%E7%89%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 13 条：通过带星号的 unpacking 操作来捕获多个元素，不要用切片</h2>\n<p>基本的 unpacking 操作（参见第 6 条）有一项限制，就是必须提前确定需要拆解的序列的长度。例如，销售汽车的时候，我们可能会把每辆车的车龄写在一份列表中，然后按照从大到小的顺序排列好。如果试着通过基本的 unpacking 操作获取其中最旧的两辆车，那么程序运行时会出现异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22540166252605133000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_ages = [0, 9, 4, 8, 7, 20, 19, 1, 6, 15]\ncar_ages_descending = sorted(car_ages, reverse=True)\noldest, second_oldest = car_ages_descending\n\n>>>\nTraceback ...\nValueError: too many values to unpack (expected 2)`, `22540166252605133000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_ages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>\ncar_ages_descending <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>car_ages<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\noldest<span class="token punctuation">,</span> second_oldest <span class="token operator">=</span> car_ages_descending\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nValueError<span class="token punctuation">:</span> too many values to unpack <span class="token punctuation">(</span>expected <span class="token number">2</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 新手经常通过下标与切片（参见第 11 条）来处理这个问题。例如，可以明确通过下标把最旧和第二旧的那两辆车取出来，然后把其余的车放到另一份列表中。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54671540135187866000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_ages = [0, 9, 4, 8, 7, 20, 19, 1, 6, 15]\ncar_ages_descending = sorted(car_ages, reverse=True)\noldest = car_ages_descending[0]\nsecond_oldest = car_ages_descending[1]\nothers = car_ages_descending[2:]\nprint(oldest, second_oldest, others)\n\n>>>\n20 19 [15, 9, 8, 7, 6, 4, 1, 0]`, `54671540135187866000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_ages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>\ncar_ages_descending <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>car_ages<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\noldest <span class="token operator">=</span> car_ages_descending<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\nsecond_oldest <span class="token operator">=</span> car_ages_descending<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>\nothers <span class="token operator">=</span> car_ages_descending<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>oldest<span class="token punctuation">,</span> second_oldest<span class="token punctuation">,</span> others<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">20</span> <span class="token number">19</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样做没问题，但是下标与切片会让代码看起来很乱。而且，用这种办法把序列中的元素分成多个子集合，其实很容易出错，因为我们通常容易把下标多写或少写一个位置。例如，若修改了其中一行，但却忘了更新另一行，那就会遇到这种错误。</p>\n<p>这个问题通过带星号的表达式（starred expression）来解决会更好一些，这也是一种 unpacking 操作，它可以把无法由普通变量接收的那些元素全都囊括进去。下面用带星号的 unpacking 操作改写刚才那段代码，这次既不用取下标，也不用做切片。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36826968758085222000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_ages = [0, 9, 4, 8, 7, 20, 19, 1, 6, 15]\ncar_ages_descending = sorted(car_ages, reverse=True)\noldest, second_oldest, *others = car_ages_descending\nprint(oldest, second_oldest, others)\n\n>>>\n20 19 [15, 9, 8, 7, 6, 4, 1, 0]`, `36826968758085222000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_ages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>\ncar_ages_descending <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>car_ages<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\noldest<span class="token punctuation">,</span> second_oldest<span class="token punctuation">,</span> <span class="token operator">*</span>others <span class="token operator">=</span> car_ages_descending\n<span class="token keyword">print</span><span class="token punctuation">(</span>oldest<span class="token punctuation">,</span> second_oldest<span class="token punctuation">,</span> others<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">20</span> <span class="token number">19</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写简短易读，而且不容易出错，因为它不要求我们在修改完其中一个下标之后，还必须记得同步更新其他的下标。</p>\n<p>这种带星号的表达式可以出现在任意位置，所以它能够捕获序列中的任何一段元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44405950702006710000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_ages = [0, 9, 4, 8, 7, 20, 19, 1, 6, 15]\ncar_ages_descending = sorted(car_ages, reverse=True)\noldest, *others, youngest = car_ages_descending\nprint(oldest, youngest, others)\n*others, second_youngest, youngest = car_ages_descending\nprint(youngest, second_youngest, others)\n\n>>>\n20 0 [19, 15, 9, 8, 7, 6, 4, 1]\n0 1 [20, 19, 15, 9, 8, 7, 6, 4]`, `44405950702006710000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_ages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>\ncar_ages_descending <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>car_ages<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\noldest<span class="token punctuation">,</span> <span class="token operator">*</span>others<span class="token punctuation">,</span> youngest <span class="token operator">=</span> car_ages_descending\n<span class="token keyword">print</span><span class="token punctuation">(</span>oldest<span class="token punctuation">,</span> youngest<span class="token punctuation">,</span> others<span class="token punctuation">)</span>\n<span class="token operator">*</span>others<span class="token punctuation">,</span> second_youngest<span class="token punctuation">,</span> youngest <span class="token operator">=</span> car_ages_descending\n<span class="token keyword">print</span><span class="token punctuation">(</span>youngest<span class="token punctuation">,</span> second_youngest<span class="token punctuation">,</span> others<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">20</span> <span class="token number">0</span> <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>\n<span class="token number">0</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只不过，在使用这种写法时，至少要有一个普通的接收变量与它搭配，否则就会出现 SyntaxError。例如不能像下面这样，只使用带星号的表达式而不搭配普通变量。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80183354461747200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_ages = [0, 9, 4, 8, 7, 20, 19, 1, 6, 15]\ncar_ages_descending = sorted(car_ages, reverse=True)\n*others = car_ages_descending\n\n>>>\nSyntaxError: starred assignment target must be in a list or tuple`, `80183354461747200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_ages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>\ncar_ages_descending <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>car_ages<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token operator">*</span>others <span class="token operator">=</span> car_ages_descending\n\n<span class="token operator">>></span><span class="token operator">></span>\nSyntaxError<span class="token punctuation">:</span> starred assignment target must be <span class="token keyword">in</span> a <span class="token builtin">list</span> <span class="token keyword">or</span> <span class="token builtin">tuple</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>另外，对于单层结构来说，同一级里面最多只能出现一次带星号的 unpacking。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20371260091844313000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`first, *middle, *second_middle, last = [1, 2, 3, 4]\n\n>>>\nSyntaxError: two starred expressions in assignment`, `20371260091844313000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">first<span class="token punctuation">,</span> <span class="token operator">*</span>middle<span class="token punctuation">,</span> <span class="token operator">*</span>second_middle<span class="token punctuation">,</span> last <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nSyntaxError<span class="token punctuation">:</span> two starred expressions <span class="token keyword">in</span> assignment</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果要拆解的结构有很多层，那么同一级的不同部分里面可以各自出现带星号的 unpacking 操作。当然笔者并不推荐这种写法（类似的建议参见第 19 条）。这里举这样一个例子，是想帮助大家理解这种带星号的表达式可以实现怎样的拆分效果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7969138573370605000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`car_inventory = {\n    \'Downtown\': (\'Silver Shadow\', \'Pinto\', \'DMC\'),\n    \'Airport\': (\'Skyline\', \'Viper\', \'Gremlin\', \'Nova\'),\n}\n\n((loc1, (best1, *rest1)),\n (loc2, (best2, *rest2))) = car_inventory.items()\nprint(f\'Best at {loc1} is {best1}, {len(rest1)} others\')\nprint(f\'Best at {loc2} is {best2}, {len(rest2)} others\')\n\n>>>\nBest at Downtown is Silver Shadow, 2 others\nBest at Airport is Skyline, 3 others`, `7969138573370605000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">car_inventory <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'Downtown\'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'Silver Shadow\'</span><span class="token punctuation">,</span> <span class="token string">\'Pinto\'</span><span class="token punctuation">,</span> <span class="token string">\'DMC\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token string">\'Airport\'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'Skyline\'</span><span class="token punctuation">,</span> <span class="token string">\'Viper\'</span><span class="token punctuation">,</span> <span class="token string">\'Gremlin\'</span><span class="token punctuation">,</span> <span class="token string">\'Nova\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token punctuation">(</span><span class="token punctuation">(</span>loc1<span class="token punctuation">,</span> <span class="token punctuation">(</span>best1<span class="token punctuation">,</span> <span class="token operator">*</span>rest1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n <span class="token punctuation">(</span>loc2<span class="token punctuation">,</span> <span class="token punctuation">(</span>best2<span class="token punctuation">,</span> <span class="token operator">*</span>rest2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> car_inventory<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Best at </span><span class="token interpolation"><span class="token punctuation">{</span>loc1<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>best1<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>rest1<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> others\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Best at </span><span class="token interpolation"><span class="token punctuation">{</span>loc2<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>best2<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>rest2<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> others\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBest at Downtown <span class="token keyword">is</span> Silver Shadow<span class="token punctuation">,</span> <span class="token number">2</span> others\nBest at Airport <span class="token keyword">is</span> Skyline<span class="token punctuation">,</span> <span class="token number">3</span> others</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>带星号的表达式总会形成一份列表实例。如果要拆分的序列里已经没有元素留给它了，那么列表就是空白的。如果能提前确定有待处理的序列里至少会有 N 个元素，那么这项特性就相当有用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2002298909728028700"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`short_list = [1, 2]\nfirst, second, *rest = short_list\nprint(first, second, rest)\n\n>>>\n1 2 []`, `2002298909728028700`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">short_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>\nfirst<span class="token punctuation">,</span> second<span class="token punctuation">,</span> <span class="token operator">*</span>rest <span class="token operator">=</span> short_list\n<span class="token keyword">print</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> second<span class="token punctuation">,</span> rest<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span> <span class="token number">2</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>unpacking 操作也可以用在迭代器上，但是这样写与把数据拆分到多个变量里面的那种基本写法相比，并没有太大优势。例如，我可以先构造长度为 2 的取值范围（range），并把它封装在 it 这个迭代器里，然后将其中的值拆分到 first 与 second 这两个变量里。但这样写还不如直接使用形式相符的静态列表（例如[1, 2]），那样更简单。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31645519731275674000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = iter(range(1, 3))\nfirst, second = it\nprint(f\'{first} and {second}\')\n\n>>>\n1 and 2`, `31645519731275674000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nfirst<span class="token punctuation">,</span> second <span class="token operator">=</span> it\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>first<span class="token punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token punctuation">{</span>second<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span> <span class="token keyword">and</span> <span class="token number">2</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>对迭代器做 unpacking 操作的好处，主要体现在带星号的用法上面，它使迭代器的拆分值更清晰。例如，这里有个生成器，每次可以从含有整个一周的汽车订单的 CSV 文件中取出一行数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18546238086952505000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def generate_csv():\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    # ...`, `18546238086952505000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">generate_csv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token comment"># ...</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>我们可以用下标和切片来处理这个生成器所给出的结果，但这样写需要很多行代码，而且看着比较混乱。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65591023373556180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def generate_csv():\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    # ...\n\n\nall_csv_rows = list(generate_csv())\nheader = all_csv_rows[0]\nrows = all_csv_rows[1:]\nprint(\'CSV Header:\', header)\nprint(\'Row count:\', len(rows))\n\n>>>\nCSV Header: (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\nRow count: 4`, `65591023373556180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">generate_csv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token comment"># ...</span>\n\n\nall_csv_rows <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>generate_csv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nheader <span class="token operator">=</span> all_csv_rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>\nrows <span class="token operator">=</span> all_csv_rows<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'CSV Header:\'</span><span class="token punctuation">,</span> header<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Row count:\'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nCSV Header<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\nRow count<span class="token punctuation">:</span> <span class="token number">4</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>利用带星号的 unpacking 操作，我们可以把第一行（表头）单独放在 header 变量里，同时把迭代器所给出的其余内容合起来表示成 rows 变量。这样写就清楚多了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15445978997988674000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def generate_csv():\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    yield (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\n    # ...\n\n\nit = list(generate_csv())\nheader, *rows = it\nprint(\'CSV Header:\', header)\nprint(\'Row count:\', len(rows))\n\n>>>\nCSV Header: (\'Date\', \'Make\', \'Model\', \'Year\', \'Price\')\nRow count: 4`, `15445978997988674000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">generate_csv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\n    <span class="token comment"># ...</span>\n\n\nit <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>generate_csv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nheader<span class="token punctuation">,</span> <span class="token operator">*</span>rows <span class="token operator">=</span> it\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'CSV Header:\'</span><span class="token punctuation">,</span> header<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Row count:\'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nCSV Header<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">\'Date\'</span><span class="token punctuation">,</span> <span class="token string">\'Make\'</span><span class="token punctuation">,</span> <span class="token string">\'Model\'</span><span class="token punctuation">,</span> <span class="token string">\'Year\'</span><span class="token punctuation">,</span> <span class="token string">\'Price\'</span><span class="token punctuation">)</span>\nRow count<span class="token punctuation">:</span> <span class="token number">4</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>带星号的这部分总是会形成一份列表，所以要注意，这有可能耗尽计算机的全部内存并导致程序崩溃。首先必须确定系统有足够的内存可以存储拆分出来的结果数据，然后才可以对迭代器使用带星号的 unpacking 操作（还有另一种做法，参见第 31 条）。</p>\n<h3 id="总结-9"><a href="#%E6%80%BB%E7%BB%93-9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>拆分数据结构并把其中的数据赋给变量时，可以用带星号的表达式，将结构中无法与普通变量相匹配的内容捕获到一份列表里。</li>\n<li>这种带星号的表达式可以出现在赋值符号左侧的任意位置，它总是会形成一份含有零个或多个值的列表。</li>\n<li>在把列表拆解成互相不重叠的多个部分时，这种带星号的 unpacking 方式比较清晰，而通过下标与切片来实现的方式则很容易出错。</li>\n</ol>\n<h2 id="第-14-条：用-sort-方法的-key-参数来表示复杂的排序逻辑"><a href="#%E7%AC%AC-14-%E6%9D%A1%EF%BC%9A%E7%94%A8-sort-%E6%96%B9%E6%B3%95%E7%9A%84-key-%E5%8F%82%E6%95%B0%E6%9D%A5%E8%A1%A8%E7%A4%BA%E5%A4%8D%E6%9D%82%E7%9A%84%E6%8E%92%E5%BA%8F%E9%80%BB%E8%BE%91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 14 条：用 sort 方法的 key 参数来表示复杂的排序逻辑</h2>\n<p>内置的列表类型提供了名叫 sort 的方法，可以根据多项指标给 list 实例中的元素排序。在默认情况下，sort 方法总是按照自然升序排列列表内的元素。例如，如果列表中的元素都是整数，那么它就按数值从小到大排列。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87634901176279910000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`numbers = [93, 86, 11, 68, 70]\nnumbers.sort()\nprint(numbers)\n\n>>>\n[11, 68, 70, 86, 93]`, `87634901176279910000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>\nnumbers<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这里定义了一个 Tool 类表示各种建筑工具，它带有 <code class="language-text">__repr__</code> 方法，因此我们能把这个类的实例打印成字符串。</p>\n<p>如果仅仅这样写，那么这个由该类的对象所构成的列表是没办法用 sort 方法排序的，因为 sort 方法发现，排序所需要的特殊方法并没有定义在 Tool 类中。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="771018330146478000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Tool:\n    def __init__(self, name, weight):\n        self.name = name\n        self.weight = weight\n\n    def __repr__(self):\n        return f\'Tool({self.name!r}, {self.weight})\'\n\n\ntools = [\n    Tool(\'level\', 3.5),\n    Tool(\'hammer\', 1.25),\n    Tool(\'screwdriver\', 0.5),\n    Tool(\'chisel\', 0.25),\n]\n\ntools.sort()\n\n>>>\nTraceback ...\nTypeError: \'<\' not supported between instances of \'Tool\' and \'Tool\'`, `771018330146478000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Tool</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name\n        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> weight\n\n    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f\'Tool(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>weight<span class="token punctuation">}</span></span><span class="token string">)\'</span></span>\n\n\ntools <span class="token operator">=</span> <span class="token punctuation">[</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'level\'</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'hammer\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'screwdriver\'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'chisel\'</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\ntools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token string">\'&lt;\'</span> <span class="token keyword">not</span> supported between instances of <span class="token string">\'Tool\'</span> <span class="token keyword">and</span> <span class="token string">\'Tool\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面用 lambda 关键字定义这样的一个函数，把它传给 sort 方法的 key 参数，让我们能够按照 name 的字母顺序排列这些 Tool 对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54935093415070720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Tool:\n    def __init__(self, name, weight):\n        self.name = name\n        self.weight = weight\n\n    def __repr__(self):\n        return f\'Tool({self.name!r}, {self.weight})\'\n\n\ntools = [\n    Tool(\'level\', 3.5),\n    Tool(\'hammer\', 1.25),\n    Tool(\'screwdriver\', 0.5),\n    Tool(\'chisel\', 0.25),\n]\n\nprint(\'Unsorted:\', repr(tools))\ntools.sort(key=lambda x: x.name)\nprint(\'\\nSorted:\', tools)\n\n>>>\nUnsorted: [Tool(\'level\', 3.5), Tool(\'hammer\', 1.25), Tool(\'screwdriver\', 0.5), Tool(\'chisel\', 0.25)]\n\nSorted: [Tool(\'chisel\', 0.25), Tool(\'hammer\', 1.25), Tool(\'level\', 3.5), Tool(\'screwdriver\', 0.5)]`, `54935093415070720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Tool</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name\n        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> weight\n\n    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f\'Tool(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>weight<span class="token punctuation">}</span></span><span class="token string">)\'</span></span>\n\n\ntools <span class="token operator">=</span> <span class="token punctuation">[</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'level\'</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'hammer\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'screwdriver\'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'chisel\'</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Unsorted:\'</span><span class="token punctuation">,</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>tools<span class="token punctuation">)</span><span class="token punctuation">)</span>\ntools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>name<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'\\nSorted:\'</span><span class="token punctuation">,</span> tools<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nUnsorted<span class="token punctuation">:</span> <span class="token punctuation">[</span>Tool<span class="token punctuation">(</span><span class="token string">\'level\'</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'hammer\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'screwdriver\'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'chisel\'</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n\nSorted<span class="token punctuation">:</span> <span class="token punctuation">[</span>Tool<span class="token punctuation">(</span><span class="token string">\'chisel\'</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'hammer\'</span><span class="token punctuation">,</span> <span class="token number">1.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'level\'</span><span class="token punctuation">,</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'screwdriver\'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>有时我们可能需要用多个标准来排序。可以利用元组的特性：如果两个元组的首个元素相等，就比较第二个元素，如果仍然相等，就继续往下比较。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13889937042945833000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Tool:\n    def __init__(self, name, weight):\n        self.name = name\n        self.weight = weight\n\n    def __repr__(self):\n        return f\'Tool({self.name!r}, {self.weight})\'\n\n\npower_tools = [\n    Tool(\'drill\', 4),\n    Tool(\'circular saw\', 5),\n    Tool(\'jackhammer\', 40),\n    Tool(\'sander\', 4),\n]\n\npower_tools.sort(key=lambda x: (x.weight, x.name))\nprint(power_tools)\n\npower_tools.sort(key=lambda x: (x.weight, x.name), reverse=True)\nprint(power_tools)\n\n>>>\n[Tool(\'drill\', 4), Tool(\'sander\', 4), Tool(\'circular saw\', 5), Tool(\'jackhammer\', 40)]\n[Tool(\'jackhammer\', 40), Tool(\'circular saw\', 5), Tool(\'sander\', 4), Tool(\'drill\', 4)]`, `13889937042945833000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Tool</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name\n        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> weight\n\n    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f\'Tool(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>weight<span class="token punctuation">}</span></span><span class="token string">)\'</span></span>\n\n\npower_tools <span class="token operator">=</span> <span class="token punctuation">[</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'drill\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'circular saw\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'jackhammer\'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Tool<span class="token punctuation">(</span><span class="token string">\'sander\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\npower_tools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>weight<span class="token punctuation">,</span> x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>power_tools<span class="token punctuation">)</span>\n\npower_tools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>weight<span class="token punctuation">,</span> x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>power_tools<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span>Tool<span class="token punctuation">(</span><span class="token string">\'drill\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'sander\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'circular saw\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'jackhammer\'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span>Tool<span class="token punctuation">(</span><span class="token string">\'jackhammer\'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'circular saw\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'sander\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tool<span class="token punctuation">(</span><span class="token string">\'drill\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种做法有个缺点，就是 key 函数所构造的这个元组只能按同一个排序方向来对比它所表示的各项指标（要是升序，就都得是升序；要是降序，就都得是降序），可以利用以下方法实现不同方向的排序</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34270831756293353000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`power_tools.sort(key=lambda x: (-x.weight, x.name))\nprint(power_tools)`, `34270831756293353000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">power_tools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">.</span>weight<span class="token punctuation">,</span> x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>power_tools<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>但是 str 类型不支持一元减操作符，可以通过多次调用 sort 方法实现不同方向的排序，这里利用了 sort 方法是稳定排序算法的原理</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15256070254482213000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`power_tools.sort(key=lambda x: x.name)  # Name ascending\npower_tools.sort(key=lambda x: x.weight, reverse=True)  # Weight descending\nprint(power_tools)`, `15256070254482213000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">power_tools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>name<span class="token punctuation">)</span>  <span class="token comment"># Name ascending</span>\npower_tools<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>weight<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># Weight descending</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>power_tools<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>无论有多少项排序指标都可以按照这种思路来实现，而且每项指标可以分别按照各自的方向来排，不用全都是升序或全都是降序。只需要倒着写即可，也就是把最主要的那项排序指标放在最后一轮处理。在上面的例子中，首要指标是重量降序，次要指标是名称升序，所以先按名称升序排列，然后按重量降序排列。</p>\n<p>尽管这两种思路都能实现同样的效果，但只调用一次 sort，还是要比多次调用 sort 更为简单。所以，在实现多个指标按不同方向排序时，应该优先考虑让 key 函数返回元组，并对元组中的相应指标取相反数。只有在万不得已的时候，才可以考虑多次调用 sort 方法。</p>\n<h3 id="总结-10"><a href="#%E6%80%BB%E7%BB%93-10" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>列表的 sort 方法可以根据自然顺序给其中的字符串、整数、元组等内置类型的元素进行排序。</li>\n<li>普通对象如果通过特殊方法定义了自然顺序，那么也可以用 sort 方法来排列，但这样的对象并不多见。</li>\n<li>可以把辅助函数传给 sort 方法的 key 参数，让 sort 根据这个函数所返回的值来排列元素顺序，而不是根据元素本身来排列。</li>\n<li>如果排序时要依据的指标有很多项，可以把它们放在一个元组中，让 key 函数返回这样的元组。对于支持一元减操作符的类型来说，可以单独给这项指标取反，让排序算法在这项指标上按照相反的方向处理。</li>\n<li>如果这些指标不支持一元减操作符，可以多次调用 sort 方法，并在每次调用时分别指定 key 函数与 reverse 参数。最次要的指标放在第一轮处理，然后逐步处理更为重要的指标，首要指标放在最后一轮处理。</li>\n</ol>\n<h2 id="第-15-条：不要过分依赖给字典添加条目时所用的顺序"><a href="#%E7%AC%AC-15-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E8%BF%87%E5%88%86%E4%BE%9D%E8%B5%96%E7%BB%99%E5%AD%97%E5%85%B8%E6%B7%BB%E5%8A%A0%E6%9D%A1%E7%9B%AE%E6%97%B6%E6%89%80%E7%94%A8%E7%9A%84%E9%A1%BA%E5%BA%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 15 条：不要过分依赖给字典添加条目时所用的顺序</h2>\n<p>在 Python 3.5 与之前的版本中，迭代字典（dict）时所看到的顺序好像是任意的，不一定与当初把这些键值对添加到字典时的顺序相同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1217928876198581800"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# Python 3.5\nbaby_names = {\n    \'cat\': \'kitten\',\n    \'dog\': \'puppy\',\n}\n\nprint(baby_names)\n\n>>>\n{\'dog\': \'puppy\', \'cat\': \'kitten\'}`, `1217928876198581800`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token comment"># Python 3.5</span>\nbaby_names <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">,</span> <span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>之所以出现这种效果，是因为字典类型以前是用哈希表算法来实现的（这个算法通过内置的 hash 函数与一个随机的种子数来运行，而该种子数会在每次启动 Python 解释器时确定）。所以，这样的机制导致这些键值对在字典中的存放顺序不一定会与添加时的顺序相同，而且每次运行程序的时候，存放顺序可能都不一样。</p>\n<p>从 Python 3.6 开始，字典会保留这些键值对在添加时所用的顺序，而且 Python 3.7 版的语言规范正式确立了这条规则。于是，在新版的 Python 里，总是能够按照当初创建字典时的那套顺序来遍历这些键值对。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="36615222711244580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`baby_names = {\n    \'cat\': \'kitten\',\n    \'dog\': \'puppy\',\n}\n\nprint(baby_names)\n\n>>>\n{\'cat\': \'kitten\', \'dog\': \'puppy\'}`, `36615222711244580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">baby_names <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">,</span> <span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 Python 3.5 与之前的版本中，dict 所提供的许多方法（包括 keys、values、items 与 popitem 等）都不保证固定的顺序，所以让人觉得好像是随机处理的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48784674704877240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`baby_names = {\n    \'cat\': \'kitten\',\n    \'dog\': \'puppy\',\n}\n\n# Python 3.5\nprint(list(baby_names.keys()))\nprint(list(baby_names.values()))\nprint(list(baby_names.items()))\nprint(baby_names.popitem())  # Randomly chooses an item\n\n>>>\n[\'dog\', \'cat\']\n[\'puppy\', \'kitten\']\n[(\'dog\', \'puppy\'), (\'cat\', \'kitten\')]\n(\'dog\', \'puppy\')`, `48784674704877240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">baby_names <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment"># Python 3.5</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>popitem<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Randomly chooses an item</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'dog\'</span><span class="token punctuation">,</span> <span class="token string">\'cat\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token string">\'puppy\'</span><span class="token punctuation">,</span> <span class="token string">\'kitten\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">\'dog\'</span><span class="token punctuation">,</span> <span class="token string">\'puppy\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'cat\'</span><span class="token punctuation">,</span> <span class="token string">\'kitten\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token string">\'dog\'</span><span class="token punctuation">,</span> <span class="token string">\'puppy\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在新版的 Python 中，这些方法已经可以按照当初添加键值对时的顺序来处理了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83768704906562400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`baby_names = {\n    \'cat\': \'kitten\',\n    \'dog\': \'puppy\',\n}\n\nprint(list(baby_names.keys()))\nprint(list(baby_names.values()))\nprint(list(baby_names.items()))\nprint(baby_names.popitem())  # Randomly chooses an item\n\n>>>\n[\'cat\', \'dog\']\n[\'kitten\', \'puppy\']\n[(\'cat\', \'kitten\'), (\'dog\', \'puppy\')]\n(\'dog\', \'puppy\')`, `83768704906562400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">baby_names <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'cat\'</span><span class="token punctuation">:</span> <span class="token string">\'kitten\'</span><span class="token punctuation">,</span>\n    <span class="token string">\'dog\'</span><span class="token punctuation">:</span> <span class="token string">\'puppy\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>baby_names<span class="token punctuation">.</span>popitem<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Randomly chooses an item</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'cat\'</span><span class="token punctuation">,</span> <span class="token string">\'dog\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token string">\'kitten\'</span><span class="token punctuation">,</span> <span class="token string">\'puppy\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">\'cat\'</span><span class="token punctuation">,</span> <span class="token string">\'kitten\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'dog\'</span><span class="token punctuation">,</span> <span class="token string">\'puppy\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token punctuation">(</span><span class="token string">\'dog\'</span><span class="token punctuation">,</span> <span class="token string">\'puppy\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这项变化对 Python 中那些依赖字典类型及其实现细节的特性产生了很多影响。</p>\n<p>函数的关键字参数（包括万能的 <code class="language-text">**kwargs</code> 参数，参见第 23 条），以前是按照近乎随机的顺序出现的，这使函数调用操作变得很难调试。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13339582542591000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`# Python 3.5\ndef my_func(**kwargs):\n    for key, value in kwargs.items():\n        print(\'%s = %s\' % (key, value))\n\n\nmy_func(goose=\'gosling\', kangaroo=\'joey\')\n\n>>>\nkangaroo = joey\ngoose = gosling`, `13339582542591000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token comment"># Python 3.5</span>\n<span class="token keyword">def</span> <span class="token function">my_func</span><span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> kwargs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'%s = %s\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\nmy_func<span class="token punctuation">(</span>goose<span class="token operator">=</span><span class="token string">\'gosling\'</span><span class="token punctuation">,</span> kangaroo<span class="token operator">=</span><span class="token string">\'joey\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nkangaroo <span class="token operator">=</span> joey\ngoose <span class="token operator">=</span> gosling</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在，这些关键字参数总是能够保留调用函数时所指定的那套顺序。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76745230299785450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def my_func(**kwargs):\n    for key, value in kwargs.items():\n        print(\'%s = %s\' % (key, value))\n\n\nmy_func(goose=\'gosling\', kangaroo=\'joey\')\n\n>>>\ngoose = gosling\nkangaroo = joey`, `76745230299785450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">my_func</span><span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> kwargs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'%s = %s\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\nmy_func<span class="token punctuation">(</span>goose<span class="token operator">=</span><span class="token string">\'gosling\'</span><span class="token punctuation">,</span> kangaroo<span class="token operator">=</span><span class="token string">\'joey\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\ngoose <span class="token operator">=</span> gosling\nkangaroo <span class="token operator">=</span> joey</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>另外，类也会利用字典来保存这个类的实例所具备的一些数据。在早前版本的 Python 中，对象（object）中的字段看上去好像是按随机顺序出现的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85672441466082570000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyClass:\n    def __init__(self):\n        self.alligator = \'hatchling\'\n        self.elephant = \'calf\'\n\n\na = MyClass()\nfor key, value in a.__dict__.items():\n    print(\'%s = %s\' % (key, value))\n\n>>>\n# Python 3.5\nelephant = calf\nalligator = hatchling\n\n# Python > 3.5\nalligator = hatchling\nelephant = calf`, `85672441466082570000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>alligator <span class="token operator">=</span> <span class="token string">\'hatchling\'</span>\n        self<span class="token punctuation">.</span>elephant <span class="token operator">=</span> <span class="token string">\'calf\'</span>\n\n\na <span class="token operator">=</span> MyClass<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> a<span class="token punctuation">.</span>__dict__<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'%s = %s\'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token comment"># Python 3.5</span>\nelephant <span class="token operator">=</span> calf\nalligator <span class="token operator">=</span> hatchling\n\n<span class="token comment"># Python > 3.5</span>\nalligator <span class="token operator">=</span> hatchling\nelephant <span class="token operator">=</span> calf</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在的 Python 语言规范已经要求，字典必须保留添加键值对时所依照的顺序。所以，我们可以利用这样的特征来实现一些功能，而且可以把它融入自己给类和函数所设计的 API 中。</p>\n<blockquote>\n<p>其实，内置的 collections 模块早就提供了这种能够保留插入顺序的字典，叫作 OrderedDict。它的行为跟（Python 3.7 以来的）标准 dict 类型很像，但性能上有很大区别。如果要频繁插入或弹出键值对（例如要实现 least-recently-used 缓存），那么 OrderedDict 可能比标准的 Python dict 类型更合适（如何判断是否应该换用这种类型，请参见第 70 条）。</p>\n</blockquote>\n<p>处理字典的时候，不能总是假设所有的字典都能保留键值对插入时的顺序。在 Python 中，我们很容易就能定义出特制的容器类型，并且让这些容器也像标准的 list 与 dict 等类型那样遵守相关的协议（参见第 43 条）。Python 不是静态类型的语言，大多数代码都以鸭子类型（duck typing）机制运作（也就是说，对象支持什么样的行为，就可以当成什么样的数据使用，而不用执着于它在类体系中的地位）。这种特性可能会产生意想不到的问题。</p>\n<p>例如，现在要写一个程序，统计各种小动物的受欢迎程度。我们可以设定一个字典，把每种动物和它得到的票数关联起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25992431076168643000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`votes = {\n    \'otter\': 1281,\n    \'polar bear\': 587,\n    \'fox\': 863,\n}`, `25992431076168643000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">votes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1281</span><span class="token punctuation">,</span>\n    <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">587</span><span class="token punctuation">,</span>\n    <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">863</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在定义一个函数来处理投票数据。用户可以把空的字典传给这个函数，这样的话，它就会把每个动物及其排名放到这个字典中。这种字典可以充当数据模型，给带有用户界面（UI）的元素提供数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10428080734004986000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def populate_ranks(votes, ranks):\n    names = list(votes.keys())\n    names.sort(key=votes.get, reverse=True)\n    for i, name in enumerate(names, 1):\n        ranks[name] = i`, `10428080734004986000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">populate_ranks</span><span class="token punctuation">(</span>votes<span class="token punctuation">,</span> ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>votes<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    names<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>votes<span class="token punctuation">.</span>get<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> i<span class="token punctuation">,</span> name <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        ranks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> i</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们还需要写一个函数来查出人气最高的动物。这个函数假定 populate_ranks 总是会按照升序向字典写入键值对，这样第一个出现在字典里的就应该是排名最靠前的动物。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9823850001027633000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_winner(ranks):\n    return next(iter(ranks))`, `9823850001027633000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>下面来验证刚才设计的函数，看它们能不能实现想要的结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84482715745116850000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`votes = {\n    \'otter\': 1281,\n    \'polar bear\': 587,\n    \'fox\': 863,\n}\n\n\ndef populate_ranks(votes, ranks):\n    names = list(votes.keys())\n    names.sort(key=votes.get, reverse=True)\n    for i, name in enumerate(names, 1):\n        ranks[name] = i\n\n\ndef get_winner(ranks):\n    return next(iter(ranks))\n\n\nranks = {}\npopulate_ranks(votes, ranks)\nprint(ranks)\nwinner = get_winner(ranks)\nprint(winner)\n\n>>>\n{\'otter\': 1, \'fox\': 2, \'polar bear\': 3}\notter`, `84482715745116850000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">votes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1281</span><span class="token punctuation">,</span>\n    <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">587</span><span class="token punctuation">,</span>\n    <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">863</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token keyword">def</span> <span class="token function">populate_ranks</span><span class="token punctuation">(</span>votes<span class="token punctuation">,</span> ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>votes<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    names<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>votes<span class="token punctuation">.</span>get<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> i<span class="token punctuation">,</span> name <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        ranks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> i\n\n\n<span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\nranks <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\npopulate_ranks<span class="token punctuation">(</span>votes<span class="token punctuation">,</span> ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span>\nwinner <span class="token operator">=</span> get_winner<span class="token punctuation">(</span>ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>winner<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\notter</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>结果没有问题。但是，假设现在的需求变了，我们现在想要按照字母顺序在 UI 中显示，而不是像原来那样按照名次显示。为了实现这种效果，我们用内置的 collections.abc 模块定义这样一个类。这个类的功能和字典一样，而且会按照字母顺序迭代其中的内容。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41531363416250610000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections.abc import MutableMapping\n\n\nclass SortedDict(MutableMapping):\n    def __init__(self):\n        self.data = {}\n\n    def __getitem__(self, key):\n        return self.data[key]\n\n    def __setitem__(self, key, value):\n        self.data[key] = value\n\n    def __delitem__(self, key):\n        del self.data[key]\n\n    def __iter__(self):\n        keys = list(self.data.keys())\n        keys.sort()\n        for key in keys:\n            yield key\n\n    def __len__(self):\n        return len(self.data)\n\n\nvotes = {\n    \'otter\': 1281,\n    \'polar bear\': 587,\n    \'fox\': 863,\n}\n\n\ndef populate_ranks(votes, ranks):\n    names = list(votes.keys())\n    names.sort(key=votes.get, reverse=True)\n    for i, name in enumerate(names, 1):\n        ranks[name] = i\n\n\ndef get_winner(ranks):\n    return next(iter(ranks))\n\n\nsorted_ranks = SortedDict()\npopulate_ranks(votes, sorted_ranks)\nprint(sorted_ranks.data)\nwinner = get_winner(sorted_ranks)\nprint(winner)\n\n>>>\n{\'otter\': 1, \'fox\': 2, \'polar bear\': 3}\nfox`, `41531363416250610000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> MutableMapping\n\n\n<span class="token keyword">class</span> <span class="token class-name">SortedDict</span><span class="token punctuation">(</span>MutableMapping<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n\n    <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n\n    <span class="token keyword">def</span> <span class="token function">__delitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">del</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n\n    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        keys <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        keys<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">for</span> key <span class="token keyword">in</span> keys<span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> key\n\n    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\n\n\nvotes <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1281</span><span class="token punctuation">,</span>\n    <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">587</span><span class="token punctuation">,</span>\n    <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">863</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token keyword">def</span> <span class="token function">populate_ranks</span><span class="token punctuation">(</span>votes<span class="token punctuation">,</span> ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>votes<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    names<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>votes<span class="token punctuation">.</span>get<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> i<span class="token punctuation">,</span> name <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        ranks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> i\n\n\n<span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\nsorted_ranks <span class="token operator">=</span> SortedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>\npopulate_ranks<span class="token punctuation">(</span>votes<span class="token punctuation">,</span> sorted_ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\nwinner <span class="token operator">=</span> get_winner<span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>winner<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nfox</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>没有得到预期的结果，为什么会这样呢？因为 <code class="language-text">get_winner</code> 函数总是假设，迭代字典时的顺序应该跟 <code class="language-text">populate_ranks</code> 函数当初向字典中插入数据时的顺序一样。但是这次，我们用的是 SortedDict 实例，而不是标准的 dict 实例，所以这项假设不成立。因此，函数返回的数据是按字母顺序排列时最先出现的那个数据，也就是 <code class="language-text">&#39;fox&#39;</code>，有以下 3 种解决方案：</p>\n<ol>\n<li>\n<p>重新实现 <code class="language-text">get_winner</code> 函数，使它不再假设 ranks 字典总是能按照固定的顺序来迭代。这是最保险、最稳妥的一种方案。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11617857730049930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_winner(ranks):\n  for name, rank in ranks.items():\n     if rank == 1:\n           return name\n\nwinner = get_winner(sorted_ranks)\nprint(winner)\n\n>>>\notter`, `11617857730049930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">for</span> name<span class="token punctuation">,</span> rank <span class="token keyword">in</span> ranks<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">if</span> rank <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>\n           <span class="token keyword">return</span> name\n\nwinner <span class="token operator">=</span> get_winner<span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>winner<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\notter</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>在函数开头先判断 ranks 是不是预期的那种标准字典（dict）。如果不是，就抛出异常。这个办法的运行性能要比刚才那种好。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70552611364291450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_winner(ranks):\n  if not isinstance(ranks, dict):\n     raise TypeError(\'must provide a dict instance\')\n  return next(iter(ranks))\n\nget_winner(sorted_ranks)\n\n>>>\nTraceback ...\nTypeError: must provide a dict instance`, `70552611364291450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>ranks<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">\'must provide a dict instance\'</span><span class="token punctuation">)</span>\n  <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\nget_winner<span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> must provide a <span class="token builtin">dict</span> instance</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>通过类型注解（type annotation）来保证传给 <code class="language-text">get_winner</code> 函数的确实是个真正的 dict 实例，而不是那种行为跟标准字典类似的 MutableMapping（参见第 90 条）。下面就采用严格（strict）模式，针对含有注解的代码运行 mypy 工具。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35889688099832127000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from typing import Dict, MutableMapping\n\ndef populate_ranks(votes: Dict[str, int],\n                 ranks: Dict[str, int]) -> None:\n  names = list(votes.keys())\n  names.sort(key=votes.get, reverse=True)\n  for i, name in enumerate(names, 1):\n     ranks[name] = i\n\ndef get_winner(ranks: Dict[str, int]) -> str:\n  return next(iter(ranks))\n\nclass SortedDict(MutableMapping[str, int]):\n  def __init__(self):\n     self.data = {}\n\n  def __getitem__(self, key):\n     return self.data[key]\n\n  def __setitem__(self, key, value):\n     self.data[key] = value\n\n  def __delitem__(self, key):\n     del self.data[key]\n\n  def __iter__(self):\n     keys = list(self.data.keys())\n     keys.sort()\n     for key in keys:\n           yield key\n\n  def __len__(self):\n     return len(self.data)\n\nvotes = {\n  \'otter\': 1281,\n  \'polar bear\': 587,\n  \'fox\': 863,\n}\n\nsorted_ranks = SortedDict()\npopulate_ranks(votes, sorted_ranks)\nprint(sorted_ranks.data)\nwinner = get_winner(sorted_ranks)\nprint(winner)\n\n\\$ python3 -m mypy --strict test.py\ntest.py:42: error: Argument 2 to &quot;populate_ranks&quot; has incompatible type &quot;SortedDict&quot;; expected &quot;Dict[str, int]&quot;\ntest.py:44: error: Argument 1 to &quot;get_winner&quot; has incompatible type &quot;SortedDict&quot;; expected &quot;Dict[str, int]&quot;`, `35889688099832127000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> MutableMapping\n\n<span class="token keyword">def</span> <span class="token function">populate_ranks</span><span class="token punctuation">(</span>votes<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n                 ranks<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n  names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>votes<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  names<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>votes<span class="token punctuation">.</span>get<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n  <span class="token keyword">for</span> i<span class="token punctuation">,</span> name <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n     ranks<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> i\n\n<span class="token keyword">def</span> <span class="token function">get_winner</span><span class="token punctuation">(</span>ranks<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>\n  <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>ranks<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token keyword">class</span> <span class="token class-name">SortedDict</span><span class="token punctuation">(</span>MutableMapping<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n  <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n\n  <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n\n  <span class="token keyword">def</span> <span class="token function">__delitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">del</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n\n  <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     keys <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n     keys<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>\n     <span class="token keyword">for</span> key <span class="token keyword">in</span> keys<span class="token punctuation">:</span>\n           <span class="token keyword">yield</span> key\n\n  <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\n\nvotes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token string">\'otter\'</span><span class="token punctuation">:</span> <span class="token number">1281</span><span class="token punctuation">,</span>\n  <span class="token string">\'polar bear\'</span><span class="token punctuation">:</span> <span class="token number">587</span><span class="token punctuation">,</span>\n  <span class="token string">\'fox\'</span><span class="token punctuation">:</span> <span class="token number">863</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nsorted_ranks <span class="token operator">=</span> SortedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>\npopulate_ranks<span class="token punctuation">(</span>votes<span class="token punctuation">,</span> sorted_ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\nwinner <span class="token operator">=</span> get_winner<span class="token punctuation">(</span>sorted_ranks<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>winner<span class="token punctuation">)</span>\n\n$ python3 <span class="token operator">-</span>m mypy <span class="token operator">-</span><span class="token operator">-</span>strict test<span class="token punctuation">.</span>py\ntest<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">42</span><span class="token punctuation">:</span> error<span class="token punctuation">:</span> Argument <span class="token number">2</span> to <span class="token string">"populate_ranks"</span> has incompatible <span class="token builtin">type</span> <span class="token string">"SortedDict"</span><span class="token punctuation">;</span> expected <span class="token string">"Dict[str, int]"</span>\ntest<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">44</span><span class="token punctuation">:</span> error<span class="token punctuation">:</span> Argument <span class="token number">1</span> to <span class="token string">"get_winner"</span> has incompatible <span class="token builtin">type</span> <span class="token string">"SortedDict"</span><span class="token punctuation">;</span> expected <span class="token string">"Dict[str, int]"</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样可以检查出类型不相符的问题，mypy 会标出错误的用法，指出函数要求的是 dict，但传入的却是 MutableMapping。这个方案既能保证静态类型准确，又不会影响程序的运行效率。</p>\n</li>\n</ol>\n<h3 id="总结-11"><a href="#%E6%80%BB%E7%BB%93-11" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>\n<p>从 Python 3.7 版开始，我们就可以确信迭代标准的字典时所看到的顺序跟这些键值对插入字典时的顺序一致。</p>\n</li>\n<li>\n<p>在 Python 代码中，我们很容易就能定义跟标准的字典很像但本身并不是 dict 实例的对象。对于这种类型的对象，不能假设迭代时看到的顺序必定与插入时的顺序相同。</p>\n</li>\n<li>\n<p>如果不想把这种跟标准字典很相似的类型也当成标准字典来处理，那么可以考虑这样三种办法。</p>\n<ol>\n<li>不要依赖插入时的顺序编写代码；</li>\n<li>在程序运行时明确判断它是不是标准的字典；</li>\n<li>给代码添加类型注解并做静态分析。</li>\n</ol>\n</li>\n</ol>\n<h2 id="第-16-条：用-get-处理键不在字典中的情况，不要使用-in-与-keyerror"><a href="#%E7%AC%AC-16-%E6%9D%A1%EF%BC%9A%E7%94%A8-get-%E5%A4%84%E7%90%86%E9%94%AE%E4%B8%8D%E5%9C%A8%E5%AD%97%E5%85%B8%E4%B8%AD%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8-in-%E4%B8%8E-keyerror" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 16 条：用 get 处理键不在字典中的情况，不要使用 in 与 KeyError</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47785101128711410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`counters = {\n    \'pumpernickel\': 2,\n    \'sourdough\': 1,\n}\n\nkey = \'wheat\'\n\nif key not in counters:\n    counters[key] = 0\ncounters[key] += 1\n\nif key in counters:\n    counters[key] += 1\nelse:\n    counters[key] = 1\n\ntry:\n    counters[key] += 1\nexcept KeyError:\n    counters[key] = 1`, `47785101128711410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">counters <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'pumpernickel\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>\n    <span class="token string">\'sourdough\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nkey <span class="token operator">=</span> <span class="token string">\'wheat\'</span>\n\n<span class="token keyword">if</span> key <span class="token keyword">not</span> <span class="token keyword">in</span> counters<span class="token punctuation">:</span>\n    counters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>\ncounters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>\n\n<span class="token keyword">if</span> key <span class="token keyword">in</span> counters<span class="token punctuation">:</span>\n    counters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    counters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>\n\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    counters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>\n<span class="token keyword">except</span> KeyError<span class="token punctuation">:</span>\n    counters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用 get 来优化</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27591313921459302000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`counters = {\n    \'pumpernickel\': 2,\n    \'sourdough\': 1,\n}\n\nkey = \'wheat\'\n\ncount = counters.get(key, 0)\ncounters[key] = count + 1`, `27591313921459302000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">counters <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'pumpernickel\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>\n    <span class="token string">\'sourdough\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nkey <span class="token operator">=</span> <span class="token string">\'wheat\'</span>\n\ncount <span class="token operator">=</span> counters<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\ncounters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果使用 setdefault 改写是有问题的，这会有一次访问、两次赋值操作</p>\n<p>而且 setdefault 不管是否有这个键，都会执行默认值的分配，这会造成比较大的性能开销</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18888397563974492000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`count = counters.setdefault(key, 0)\ncounters[key] = count + 1`, `18888397563974492000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">count <span class="token operator">=</span> counters<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\ncounters<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>缓解性能问题的话，可以用 get 方法加赋值表达式，也可以直接用 defaultdict</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91986548643583300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`names = votes.get(key)\nif names is None:\n    votes[key] = names = []\nnames.append(who)\n\n# 或者使用赋值表达式\nif (names := votes.get(key)) is None:\n    votes[key] = names = []\nnames.append(who)`, `91986548643583300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">names <span class="token operator">=</span> votes<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n<span class="token keyword">if</span> names <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n    votes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\nnames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>who<span class="token punctuation">)</span>\n\n<span class="token comment"># 或者使用赋值表达式</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>names <span class="token punctuation">:</span><span class="token operator">=</span> votes<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n    votes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\nnames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>who<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只有与键相关联的默认值构造起来开销很低且可以变化，而且不用担心异常问题（例如 list 实例）。在这种情况下可以使用 setdefault，然而一般也优先考虑使用 defaultdict 取代 dict</p>\n<h3 id="总结-12"><a href="#%E6%80%BB%E7%BB%93-12" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>有四种办法可以处理键不在字典中的情况：in 表达式、KeyError 异常、get 方法与 setdefault 方法。</li>\n<li>如果跟键相关联的值是像计数器这样的基本类型，那么 get 方法就是最好的方案；如果是那种构造起来开销比较大，或是容易出异常的类型，那么可以把这个方法与赋值表达式结合起来使用。</li>\n<li>即使看上去最应该使用 setdefault 方案，也不一定要真的使用 setdefault 方案，而是可以考虑用 defaultdict 取代普通的 dict。</li>\n</ol>\n<h2 id="第-17-条：用-defaultdict-处理内部状态中缺失的元素，而不要用-setdefault"><a href="#%E7%AC%AC-17-%E6%9D%A1%EF%BC%9A%E7%94%A8-defaultdict-%E5%A4%84%E7%90%86%E5%86%85%E9%83%A8%E7%8A%B6%E6%80%81%E4%B8%AD%E7%BC%BA%E5%A4%B1%E7%9A%84%E5%85%83%E7%B4%A0%EF%BC%8C%E8%80%8C%E4%B8%8D%E8%A6%81%E7%94%A8-setdefault" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 17 条：用 defaultdict 处理内部状态中缺失的元素，而不要用 setdefault</h2>\n<p>通过 setdefault 方案把新的城市添加到对应的集合里，这要比利用 get 方法与赋值表达式（Python3.8 的新特性）来实现的方案短很多。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="37456803096205000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`visits = {\n    \'Mexico\': {\'Tulum\', \'Puerto Vallarta\'},\n    \'Japan\': {\'Hakone\'},\n}\n\nvisits.setdefault(\'France\', set()).add(\'Arles\')  # Short\nif (japan := visits.get(\'Japan\')) is None:  # Long\n    visits[\'Japan\'] = japan = set()\njapan.add(\'Kyoto\')\n\nprint(visits)\n\n>>>\n{\'Mexico\': {\'Tulum\', \'Puerto Vallarta\'}, \'Japan\': {\'Kyoto\', \'Hakone\'}, \'France\': {\'Arles\'}}`, `37456803096205000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">visits <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'Mexico\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Tulum\'</span><span class="token punctuation">,</span> <span class="token string">\'Puerto Vallarta\'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token string">\'Japan\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Hakone\'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n\nvisits<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">\'France\'</span><span class="token punctuation">,</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'Arles\'</span><span class="token punctuation">)</span>  <span class="token comment"># Short</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>japan <span class="token punctuation">:</span><span class="token operator">=</span> visits<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'Japan\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>  <span class="token comment"># Long</span>\n    visits<span class="token punctuation">[</span><span class="token string">\'Japan\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> japan <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\njapan<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'Kyoto\'</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'Mexico\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Tulum\'</span><span class="token punctuation">,</span> <span class="token string">\'Puerto Vallarta\'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'Japan\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Kyoto\'</span><span class="token punctuation">,</span> <span class="token string">\'Hakone\'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'France\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Arles\'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果程序所访问的这个字典需要由你自己明确地创建，那又该怎么写？</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18323144604300579000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Visits:\n    def __init__(self):\n        self.data = {}\n\n    def add(self, country, city):\n        city_set = self.data.setdefault(country, set())\n        city_set.add(city)\n\n\nvisits = Visits()\nvisits.add(\'Russia\', \'Yekaterinburg\')\nvisits.add(\'Tanzania\', \'Zanzibar\')\nprint(visits.data)\n\n>>>\n{\'Russia\': {\'Yekaterinburg\'}, \'Tanzania\': {\'Zanzibar\'}}`, `18323144604300579000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Visits</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> country<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        city_set <span class="token operator">=</span> self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>country<span class="token punctuation">,</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n        city_set<span class="token punctuation">.</span>add<span class="token punctuation">(</span>city<span class="token punctuation">)</span>\n\n\nvisits <span class="token operator">=</span> Visits<span class="token punctuation">(</span><span class="token punctuation">)</span>\nvisits<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'Russia\'</span><span class="token punctuation">,</span> <span class="token string">\'Yekaterinburg\'</span><span class="token punctuation">)</span>\nvisits<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'Tanzania\'</span><span class="token punctuation">,</span> <span class="token string">\'Zanzibar\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>visits<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'Russia\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Yekaterinburg\'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'Tanzania\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Zanzibar\'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上代码有以下问题</p>\n<ol>\n<li>调用了名字很怪的 setdefault 方法，很难让人理解发生了什么</li>\n<li>每次调用 add 方法，都会构造新的 set 实例</li>\n</ol>\n<p>改用 defaultdict 可以解决以上问题，它会在键缺失的情况下，自动添加这个键以及键所对应的默认值，每次发现键不存在时，该字典都会调用这个函数返回一份新的默认值</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8051630904452800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass Visits:\n    def __init__(self):\n        self.data = defaultdict(set)\n\n    def add(self, country, city):\n        self.data[country].add(city)\n\n\nvisits = Visits()\nvisits.add(\'England\', \'Bath\')\nvisits.add(\'England\', \'London\')\nprint(visits.data)\n\n>>>\ndefaultdict(<class \'set\'>, {\'England\': {\'Bath\', \'London\'}})`, `8051630904452800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">Visits</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> country<span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>country<span class="token punctuation">]</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>city<span class="token punctuation">)</span>\n\n\nvisits <span class="token operator">=</span> Visits<span class="token punctuation">(</span><span class="token punctuation">)</span>\nvisits<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'England\'</span><span class="token punctuation">,</span> <span class="token string">\'Bath\'</span><span class="token punctuation">)</span>\nvisits<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">\'England\'</span><span class="token punctuation">,</span> <span class="token string">\'London\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>visits<span class="token punctuation">.</span>data<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\ndefaultdict<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'set\'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">\'England\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'Bath\'</span><span class="token punctuation">,</span> <span class="token string">\'London\'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-13"><a href="#%E6%80%BB%E7%BB%93-13" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>如果你管理的字典可能需要添加任意的键，那么应该考虑能否用内置的 collections 模块中的 defaultdict 实例来解决问题。</li>\n<li>如果这种键名比较随意的字典是别人传给你的，你无法把它创建成 defaultdict，那么应该考虑通过 get 方法访问其中的键值。然而，在个别情况下，也可以考虑改用 setdefault 方法，因为那样写更短。</li>\n</ol>\n<h2 id="第-18-条：学会利用-__missing__-构造依赖键的默认值"><a href="#%E7%AC%AC-18-%E6%9D%A1%EF%BC%9A%E5%AD%A6%E4%BC%9A%E5%88%A9%E7%94%A8-__missing__-%E6%9E%84%E9%80%A0%E4%BE%9D%E8%B5%96%E9%94%AE%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 18 条：学会利用 <code class="language-text">__missing__</code> 构造依赖键的默认值</h2>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20699939682985690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pictures = {}\npath = \'profile_1234.png\'\nif (handle := pictures.get(path)) is None:\n    try:\n        handle = open(path, \'a+b\')\n    except OSError:\n        print(f\'Failed to open path {path}\')\n        raise\n    else:\n        pictures[path] = handle\n\nhandle.seek(0)\nimage_data = handle.read()`, `20699939682985690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pictures <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\npath <span class="token operator">=</span> <span class="token string">\'profile_1234.png\'</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>handle <span class="token punctuation">:</span><span class="token operator">=</span> pictures<span class="token punctuation">.</span>get<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        handle <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">\'a+b\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Failed to open path </span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">raise</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        pictures<span class="token punctuation">[</span>path<span class="token punctuation">]</span> <span class="token operator">=</span> handle\n\nhandle<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\nimage_data <span class="token operator">=</span> handle<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果改成 setdefault</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2926086906477287400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pictures = {}\npath = \'profile_1234.png\'\ntry:\n    handle = pictures.setdefault(path, open(path, \'a+b\'))\nexcept OSError:\n    print(f\'Failed to open path {path}\')\n    raise\nelse:\n    handle.seek(0)\n\nimage_data = handle.read()`, `2926086906477287400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pictures <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\npath <span class="token operator">=</span> <span class="token string">\'profile_1234.png\'</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    handle <span class="token operator">=</span> pictures<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">\'a+b\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">except</span> OSError<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Failed to open path </span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n    <span class="token keyword">raise</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    handle<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n\nimage_data <span class="token operator">=</span> handle<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而使用 setdefault 实现会有以下问题</p>\n<ol>\n<li>即便图片的路径名已经在字典里了，程序也还是得调用内置的 open 函数创建文件句柄，于是导致这个程序要给已经创建过 handle 的那份文件再度创建 handle（两者可能相互冲突）</li>\n<li>如果 try 块抛出异常，那我们可能无法判断这个异常是 open 函数导致的，还是 setdefault 方法导致的，因为这两次调用全都写在了同一行代码里</li>\n</ol>\n<p>理论上可以使用 defaultdict 优化，但是 defaultdict 的第二个函数不能传参</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73932971590257250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\ndef open_picture(profile_path):\n    try:\n        return open(profile_path, \'a+b\')\n    except OSError:\n        print(f\'Failed to open path {profile_path}\')\n        raise\n\n\npath = \'profile_1234.png\'\npictures = defaultdict(open_picture)\nhandle = pictures[path]\nhandle.seek(0)\nimage_data = handle.read()\n\n>>>\nTraceback ...\nTypeError: open_picture() missing 1 required positional argument: \'profile_path\'`, `73932971590257250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">def</span> <span class="token function">open_picture</span><span class="token punctuation">(</span>profile_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>profile_path<span class="token punctuation">,</span> <span class="token string">\'a+b\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Failed to open path </span><span class="token interpolation"><span class="token punctuation">{</span>profile_path<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">raise</span>\n\n\npath <span class="token operator">=</span> <span class="token string">\'profile_1234.png\'</span>\npictures <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>open_picture<span class="token punctuation">)</span>\nhandle <span class="token operator">=</span> pictures<span class="token punctuation">[</span>path<span class="token punctuation">]</span>\nhandle<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\nimage_data <span class="token operator">=</span> handle<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> open_picture<span class="token punctuation">(</span><span class="token punctuation">)</span> missing <span class="token number">1</span> required positional argument<span class="token punctuation">:</span> <span class="token string">\'profile_path\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>可以通过继承 dict 类型并实现 <code class="language-text">__missing__</code> 特殊方法来解决这个问题</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73525702599498690000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def open_picture(profile_path):\n    try:\n        return open(profile_path, \'a+b\')\n    except OSError:\n        print(f\'Failed to open path {profile_path}\')\n        raise\n\n\nclass Pictures(dict):\n    def __missing__(self, key):\n        value = open_picture(key)\n        self[key] = value\n        return value\n\n\npath = \'profile_1234.png\'\npictures = Pictures()\nhandle = pictures[path]\nhandle.seek(0)\nimage_data = handle.read()`, `73525702599498690000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">open_picture</span><span class="token punctuation">(</span>profile_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>profile_path<span class="token punctuation">,</span> <span class="token string">\'a+b\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Failed to open path </span><span class="token interpolation"><span class="token punctuation">{</span>profile_path<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">raise</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Pictures</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__missing__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        value <span class="token operator">=</span> open_picture<span class="token punctuation">(</span>key<span class="token punctuation">)</span>\n        self<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value\n        <span class="token keyword">return</span> value\n\n\npath <span class="token operator">=</span> <span class="token string">\'profile_1234.png\'</span>\npictures <span class="token operator">=</span> Pictures<span class="token punctuation">(</span><span class="token punctuation">)</span>\nhandle <span class="token operator">=</span> pictures<span class="token punctuation">[</span>path<span class="token punctuation">]</span>\nhandle<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\nimage_data <span class="token operator">=</span> handle<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-14"><a href="#%E6%80%BB%E7%BB%93-14" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>如果创建默认值需要较大的开销，或者可能抛出异常，那就不适合用 dict 类型的 setdefault 方法实现。</li>\n<li>传给 defaultdict 的函数必须是不需要参数的函数，所以无法创建出需要依赖键名的默认值。</li>\n<li>如果要构造的默认值必须根据键名来确定，那么可以定义自己的 dict 子类并实现 <code class="language-text">__missing__</code> 方法。</li>\n</ol>\n<h1 id="函数"><a href="#%E5%87%BD%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数</h1>\n<h2 id="第-19-条：不要把函数返回的多个数值拆分到三个以上的变量中"><a href="#%E7%AC%AC-19-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E6%8A%8A%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E7%9A%84%E5%A4%9A%E4%B8%AA%E6%95%B0%E5%80%BC%E6%8B%86%E5%88%86%E5%88%B0%E4%B8%89%E4%B8%AA%E4%BB%A5%E4%B8%8A%E7%9A%84%E5%8F%98%E9%87%8F%E4%B8%AD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 19 条：不要把函数返回的多个数值拆分到三个以上的变量中</h2>\n<p>unpacking 机制允许 Python 函数返回一个以上的值（参见第 6 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24907460597485986000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_stats(numbers):\n    minimum = min(numbers)\n    maximum = max(numbers)\n    return minimum, maximum\n\n\nlengths = [63, 73, 72, 60, 67, 66, 71, 61, 72, 70]\nminimum, maximum = get_stats(lengths)  # Two return values\nprint(f\'Min: {minimum}, Max: {maximum}\')\n\n>>>\nMin: 60, Max: 73`, `24907460597485986000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">def <span class="token function">get_stats</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    minimum <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    maximum <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> minimum<span class="token punctuation">,</span> maximum\n\n\nlengths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>\nminimum<span class="token punctuation">,</span> maximum <span class="token operator">=</span> <span class="token function">get_stats</span><span class="token punctuation">(</span>lengths<span class="token punctuation">)</span>  # Two <span class="token keyword">return</span> values\n<span class="token function">print</span><span class="token punctuation">(</span>f<span class="token string">\'Min: {minimum}, Max: {maximum}\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>>></span>\nMin<span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">,</span> Max<span class="token punctuation">:</span> <span class="token number">73</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45418930495745120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`first, second = 1, 2\nassert first == 1\nassert second == 2\n\n\ndef my_function():\n    return 1, 2\n\n\nfirst, second = my_function()\nassert first == 1\nassert second == 2`, `45418930495745120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="js"\n              >\n                <span class="gatsby-code-button-language">js</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js">first<span class="token punctuation">,</span> second <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span>\nassert first <span class="token operator">==</span> <span class="token number">1</span>\nassert second <span class="token operator">==</span> <span class="token number">2</span>\n\n\ndef <span class="token function">my_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span>\n\n\nfirst<span class="token punctuation">,</span> second <span class="token operator">=</span> <span class="token function">my_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nassert first <span class="token operator">==</span> <span class="token number">1</span>\nassert second <span class="token operator">==</span> <span class="token number">2</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在返回多个值的时候，可以用带星号的表达式接收那些没有被普通变量捕获到的值（参见第 13 条）</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17638778498135888000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_avg_ratio(numbers):\n    average = sum(numbers) / len(numbers)\n    scaled = [x / average for x in numbers]\n    scaled.sort(reverse=True)\n    return scaled\n\n\nlengths = [63, 73, 72, 60, 67, 66, 71, 61, 72, 70]\nlongest, *middle, shortest = get_avg_ratio(lengths)\nprint(f\'Longest:  {longest:>4.0%}\')\nprint(f\'Shortest: {shortest:>4.0%}\')\n\n>>>\nLongest:  108%\nShortest:  89%`, `17638778498135888000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_avg_ratio</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    average <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    scaled <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token operator">/</span> average <span class="token keyword">for</span> x <span class="token keyword">in</span> numbers<span class="token punctuation">]</span>\n    scaled<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> scaled\n\n\nlengths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>\nlongest<span class="token punctuation">,</span> <span class="token operator">*</span>middle<span class="token punctuation">,</span> shortest <span class="token operator">=</span> get_avg_ratio<span class="token punctuation">(</span>lengths<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Longest:  </span><span class="token interpolation"><span class="token punctuation">{</span>longest<span class="token punctuation">:</span><span class="token format-spec">>4.0%</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Shortest: </span><span class="token interpolation"><span class="token punctuation">{</span>shortest<span class="token punctuation">:</span><span class="token format-spec">>4.0%</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLongest<span class="token punctuation">:</span>  <span class="token number">108</span><span class="token operator">%</span>\nShortest<span class="token punctuation">:</span>  <span class="token number">89</span><span class="token operator">%</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55855489333027240000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def get_stats(numbers):\n    minimum = min(numbers)\n    maximum = max(numbers)\n    count = len(numbers)\n    average = sum(numbers)/count\n    sorted_numbers = sorted(numbers)\n    middle = count // 2\n    if count % 2 == 0:\n        lower = sorted_numbers[middle - 1]\n        upper = sorted_numbers[middle]\n        median = (lower + upper)/2\n    else:\n        median = sorted_numbers[middle]\n    return minimum, maximum, average, median, count\n\n\nlengths = [63, 73, 72, 60, 67, 66, 71, 61, 72, 70]\nminimum, maximum, average, median, count = get_stats(lengths)\nprint(f\'Min: {minimum}, Max: {maximum}\')\nprint(f\'Average: {average}, Median: {median}, Count: {count}\')\n\n>>>\nMin: 60, Max: 73\nAverage: 67.5, Median: 68.5, Count: 10`, `55855489333027240000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">get_stats</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    minimum <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    maximum <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    count <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    average <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token operator">/</span>count\n    sorted_numbers <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    middle <span class="token operator">=</span> count <span class="token operator">//</span> <span class="token number">2</span>\n    <span class="token keyword">if</span> count <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>\n        lower <span class="token operator">=</span> sorted_numbers<span class="token punctuation">[</span>middle <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>\n        upper <span class="token operator">=</span> sorted_numbers<span class="token punctuation">[</span>middle<span class="token punctuation">]</span>\n        median <span class="token operator">=</span> <span class="token punctuation">(</span>lower <span class="token operator">+</span> upper<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        median <span class="token operator">=</span> sorted_numbers<span class="token punctuation">[</span>middle<span class="token punctuation">]</span>\n    <span class="token keyword">return</span> minimum<span class="token punctuation">,</span> maximum<span class="token punctuation">,</span> average<span class="token punctuation">,</span> median<span class="token punctuation">,</span> count\n\n\nlengths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>\nminimum<span class="token punctuation">,</span> maximum<span class="token punctuation">,</span> average<span class="token punctuation">,</span> median<span class="token punctuation">,</span> count <span class="token operator">=</span> get_stats<span class="token punctuation">(</span>lengths<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Min: </span><span class="token interpolation"><span class="token punctuation">{</span>minimum<span class="token punctuation">}</span></span><span class="token string">, Max: </span><span class="token interpolation"><span class="token punctuation">{</span>maximum<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Average: </span><span class="token interpolation"><span class="token punctuation">{</span>average<span class="token punctuation">}</span></span><span class="token string">, Median: </span><span class="token interpolation"><span class="token punctuation">{</span>median<span class="token punctuation">}</span></span><span class="token string">, Count: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMin<span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">,</span> Max<span class="token punctuation">:</span> <span class="token number">73</span>\nAverage<span class="token punctuation">:</span> <span class="token number">67.5</span><span class="token punctuation">,</span> Median<span class="token punctuation">:</span> <span class="token number">68.5</span><span class="token punctuation">,</span> Count<span class="token punctuation">:</span> <span class="token number">10</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面的写法有 2 个问题：</p>\n<ol>\n<li>函数返回的五个值都是数字，所以很容易就会搞错顺序</li>\n<li>调用函数并拆分返回值的那行代码会写得比较长</li>\n</ol>\n<p>为避免这些问题，我们不应该把函数返回的多个值拆分到三个以上的变量里。一个三元组最多只拆成三个普通变量，或两个普通变量与一个万能变量（带星号的变量）。当然用于接收的变量个数也可以比这更少。假如要拆分的值确实很多，那最好还是定义一个轻便的类或 namedtuple（参见第 37 条），并让函数返回这样的实例。</p>\n<h3 id="总结-15"><a href="#%E6%80%BB%E7%BB%93-15" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>函数可以把多个值合起来通过一个元组返回给调用者，以便利用 Python 的 unpacking 机制去拆分。</li>\n<li>对于函数返回的多个值，可以把普通变量没有捕获到的那些值全都捕获到一个带星号的变量里。</li>\n<li>把返回的值拆分到四个或四个以上的变量是很容易出错的，所以最好不要那么写，而是应该通过小类或 namedtuple 实例完成。</li>\n</ol>\n<h2 id="第-20-条：遇到意外状况时应该抛出异常，不要返回-none"><a href="#%E7%AC%AC-20-%E6%9D%A1%EF%BC%9A%E9%81%87%E5%88%B0%E6%84%8F%E5%A4%96%E7%8A%B6%E5%86%B5%E6%97%B6%E5%BA%94%E8%AF%A5%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%EF%BC%8C%E4%B8%8D%E8%A6%81%E8%BF%94%E5%9B%9E-none" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 20 条：遇到意外状况时应该抛出异常，不要返回 None</h2>\n<p>编写工具函数（utility function）时，许多 Python 程序员都爱用 None 这个返回值来表示特殊情况。对于某些函数来说，这或许有几分道理。</p>\n<p>例如，我们要编写一个辅助函数计算两数相除的结果。在除数是 0 的情况下，返回 None 似乎相当合理，因为这种除法的结果是没有意义的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40710825123823250000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\n    try:\n        return a / b\n    except ZeroDivisionError:\n        return None`, `40710825123823250000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> a <span class="token operator">/</span> b\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token boolean">None</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>调用这个函数时，可以按自己的方式处理这样的返回值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46236468099847094000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\n    try:\n        return a / b\n    except ZeroDivisionError:\n        return None\n\n\nx, y = 1, 0\nresult = careful_divide(x, y)\nif result is None:\n    print(\'Invalid inputs\')\n\n>>>\nInvalid inputs`, `46236468099847094000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> a <span class="token operator">/</span> b\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token boolean">None</span>\n\n\nx<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>\nresult <span class="token operator">=</span> careful_divide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>\n<span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nInvalid inputs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果传给 <code class="language-text">careful_divide</code> 函数的被除数为 0，会怎么样呢？在这种情况下，只要除数不为 0，函数返回的结果就应该是 0。</p>\n<p>问题是，这个函数的返回值有时可能会用在 if 条件语句里面，那时可能会根据值本身是否相当于 False 来做判断，而不像刚才那样明确判断这个值是否为 None（第 5 条也列举了类似的例子）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66279367816220550000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\n    try:\n        return a / b\n    except ZeroDivisionError:\n        return None\n\n\nx, y = 0, 5\nresult = careful_divide(x, y)\nif not result:\n    print(\'Invalid inputs\')  # This runs! But shouldn\'t\n\n>>>\nInvalid inputs`, `66279367816220550000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> a <span class="token operator">/</span> b\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token boolean">None</span>\n\n\nx<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span>\nresult <span class="token operator">=</span> careful_divide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>\n<span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span>  <span class="token comment"># This runs! But shouldn\'t</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nInvalid inputs</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面这种 if 语句，会把函数返回 0 时的情况，也当成函数返回 None 时那样来处理。这种写法经常出现在 Python 代码里，因此像 <code class="language-text">careful_divide</code> 这样，用 None 来表示特殊状况的函数是很容易出错的。有两种办法可以减少这样的错误。</p>\n<ol>\n<li>\n<p>利用二元组把计算结果分成两部分返回（与这种写法有关的基础知识，参见第 19 条）。元组的首个元素表示操作是否成功，第二个元素表示计算的实际值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44870975687839154000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\ntry:\n    return True, a / b\nexcept ZeroDivisionError:\n    return False, None`, `44870975687839154000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token boolean">True</span><span class="token punctuation">,</span> a <span class="token operator">/</span> b\n<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">None</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写，会促使调用函数者去拆分返回值，他可以先看看这次运算是否成功，然后再决定怎么处理运算结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39249818030295810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`success, result = careful_divide(x, y)\nif not success:\n  print(\'Invalid inputs\')`, `39249818030295810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">success<span class="token punctuation">,</span> result <span class="token operator">=</span> careful_divide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>\n<span class="token keyword">if</span> <span class="token keyword">not</span> success<span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>但问题是，有些调用方总喜欢忽略返回元组的第一个部分（在 Python 代码里，习惯用下划线表示用不到的变量）。这样写成的代码，乍一看似乎没问题，但实际上还是无法区分返回 0 与返回 None 这两种情况。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21085396174434255000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`_, result = careful_divide(x, y)\nif not result:\n  print(\'Invalid inputs\')`, `21085396174434255000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">_<span class="token punctuation">,</span> result <span class="token operator">=</span> careful_divide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>\n<span class="token keyword">if</span> <span class="token keyword">not</span> result<span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>不采用 None 表示特例，而是向调用方抛出异常（Exception），让他自己去处理。下面我们把执行除法时发生的 ZeroDivisionError 转化成 ValueError，告诉调用方输入的值不对（什么时候应该使用 Exception 类的子类，可参见第 87 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="3439947386089237000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\ntry:\n    return a / b\nexcept ZeroDivisionError:\n    raise ValueError(\'Invalid inputs\')`, `3439947386089237000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> a <span class="token operator">/</span> b\n<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在，调用方拿到函数的返回值之后，不用先判断操作是否成功了。因为这次可以假设，只要能拿到返回值，就说明函数肯定顺利执行完了，所以只需要用 try 把函数包起来并在 else 块里处理运算结果就好（这种结构的详细用法，参见第 65 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98313628305028280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a, b):\ntry:\n    return a / b\nexcept ZeroDivisionError:\n    raise ValueError(\'Invalid inputs\')\n\nx, y = 5, 2\ntry:\n  result = careful_divide(x, y)\nexcept ValueError:\n  print(\'Invalid inputs\')\nelse:\n  print(\'Result is %.1f\' % result)\n\n>>>\nResult is 2.5`, `98313628305028280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> a <span class="token operator">/</span> b\n<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span>\n\nx<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n  result <span class="token operator">=</span> careful_divide<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>\n<span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Result is %.1f\'</span> <span class="token operator">%</span> result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nResult <span class="token keyword">is</span> <span class="token number">2.5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ol>\n<p>这个办法也可以扩展到那些使用类型注解的代码中（参见第 90 条），我们可以把函数的返回值指定为 float 类型，这样它就不可能返回 None 了。然而，Python 采用的是动态类型与静态类型相搭配的 gradual 类型系统，我们不能在函数的接口上指定函数可能抛出哪些异常（有的编程语言支持这样的受检异常（checked exception），调用方必须应对这些异常）。所以，我们只好把有可能抛出的异常写在文档里面，并希望调用方能够根据这份文档适当地捕获相关的异常（参见第 84 条）。</p>\n<p>下面我们给刚才那个函数加类型注解，并为它编写 docstring。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56046383003668820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def careful_divide(a: float, b: float) -> float:\n    &quot;&quot;&quot;Divides a by b.\n\n    Raises:\n      ValueError: When the inputs cannot be divided.\n    &quot;&quot;&quot;\n    try:\n        return a / b\n    except ZeroDivisionError as e:\n        raise ValueError(\'Invalid inputs\')`, `56046383003668820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">careful_divide</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Divides a by b.\n\n    Raises:\n      ValueError: When the inputs cannot be divided.\n    """</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> a <span class="token operator">/</span> b\n    <span class="token keyword">except</span> ZeroDivisionError <span class="token keyword">as</span> e<span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">\'Invalid inputs\'</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写，输入、输出与异常都显得很清晰，所以调用方出错的概率就变得很小了。</p>\n<h3 id="总结-16"><a href="#%E6%80%BB%E7%BB%93-16" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>用返回值 None 表示特殊情况是很容易出错的，因为这样的值在条件表达式里面，没办法与 0 和空白字符串之类的值区分，这些值都相当于 False。</li>\n<li>用异常表示特殊的情况，而不要返回 None。让调用这个函数的程序根据文档里写的异常情况做出处理。</li>\n<li>通过类型注解可以明确禁止函数返回 None，即便在特殊情况下，它也不能返回这个值。</li>\n</ol>\n<h2 id="第-21-条：了解如何在闭包里面使用外围作用域中的变量"><a href="#%E7%AC%AC-21-%E6%9D%A1%EF%BC%9A%E4%BA%86%E8%A7%A3%E5%A6%82%E4%BD%95%E5%9C%A8%E9%97%AD%E5%8C%85%E9%87%8C%E9%9D%A2%E4%BD%BF%E7%94%A8%E5%A4%96%E5%9B%B4%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 21 条：了解如何在闭包里面使用外围作用域中的变量</h2>\n<p>有时，我们要给列表中的元素排序，而且要优先把某个群组之中的元素放在其他元素的前面。例如，渲染用户界面时，可能就需要这样做，因为关键的消息和特殊的事件应该优先显示在其他信息之前。</p>\n<p>实现这种做法的一种常见方案，是把辅助函数通过 key 参数传给列表的 sort 方法（参见第 14 条），让这个方法根据辅助函数所返回的值来决定元素在列表中的先后顺序。辅助函数先判断当前元素是否处在重要群组里，如果在，就把返回值的第一项写成 0，让它能够排在不属于这个组的那些元素之前。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82440862199670460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def sort_priority(values, group):\n    def helper(x):\n        if x in group:\n            return (0, x)\n        return (1, x)\n    values.sort(key=helper)`, `82440862199670460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">sort_priority</span><span class="token punctuation">(</span>values<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">helper</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> x <span class="token keyword">in</span> group<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n    values<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>helper<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个函数可以处理比较简单的输入数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62807005436923410000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def sort_priority(values, group):\n    def helper(x):\n        if x in group:\n            return (0, x)\n        return (1, x)\n    values.sort(key=helper)\n\n\nnumbers = [8, 3, 1, 2, 5, 4, 7, 6]\ngroup = {2, 3, 5, 7}\nsort_priority(numbers, group)\nprint(numbers)\n\n>>>\n[2, 3, 5, 7, 1, 4, 6, 8]`, `62807005436923410000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">sort_priority</span><span class="token punctuation">(</span>values<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">helper</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> x <span class="token keyword">in</span> group<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n    values<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>helper<span class="token punctuation">)</span>\n\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>\ngroup <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span>\nsort_priority<span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> group<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>它为什么能够实现这个功能呢？这要分三个原因来讲：</p>\n<ol>\n<li>Python 支持闭包（closure），这让定义在大函数里面的小函数也能引用大函数之中的变量。具体到这个例子，<code class="language-text">sort_priority</code> 函数里面的那个 helper 函数也能够引用前者的 group 参数。</li>\n<li>函数在 Python 里是头等对象（first-class object），所以你可以像操作其他对象那样，直接引用它们、把它们赋给变量、将它们当成参数传给其他函数，或是在 in 表达式与 if 语句里面对它做比较，等等。闭包函数也是函数，所以，同样可以传给 sort 方法的 key 参数。</li>\n<li>Python 在判断两个序列（包括元组）的大小时，有自己的一套规则。它首先比较 0 号位置的那两个元素，如果相等，那就比较 1 号位置的那两个元素；如果还相等，那就比较 2 号位置的那两个元素；依此类推，直到得出结论为止。所以，我们可以利用这套规则让 helper 这个闭包函数返回一个元组，并把关键指标写为元组的首个元素以表示当前排序的值是否属于重要群组（0 表示属于，1 表示不属于）。</li>\n</ol>\n<p>如果这个 <code class="language-text">sort_priority</code> 函数还能告诉我们，列表里面有没有位于重要群组之中的元素，那就更好了，因为这样可以让用户界面开发者更方便地做出相应处理。添加这样一个功能似乎相当简单，因为闭包函数本身就需要判断当前值是否处在重要群组之中，既然这样，那么不妨让它在发现这种值时，顺便把标志变量翻转过来。最后，让闭包外的大函数（即 <code class="language-text">sort_priority</code> 函数）返回这个标志变量，如果闭包函数当时遇到过这样的值，那么这个标志肯定是 True。</p>\n<p>下面，试着用最直接的写法来实现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88348438390027320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def sort_priority2(numbers, group):\n    found = False\n\n    def helper(x):\n        if x in group:\n            found = True  # Seems simple\n            return (0, x)\n        return (1, x)\n    numbers.sort(key=helper)\n    return found\n\n\nnumbers = [8, 3, 1, 2, 5, 4, 7, 6]\ngroup = {2, 3, 5, 7}\nfound = sort_priority2(numbers, group)\nprint(\'Found:\', found)\nprint(numbers)\n\n>>>\nFound: False\n[2, 3, 5, 7, 1, 4, 6, 8]`, `88348438390027320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">sort_priority2</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    found <span class="token operator">=</span> <span class="token boolean">False</span>\n\n    <span class="token keyword">def</span> <span class="token function">helper</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> x <span class="token keyword">in</span> group<span class="token punctuation">:</span>\n            found <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># Seems simple</span>\n            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n    numbers<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>helper<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> found\n\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>\ngroup <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span>\nfound <span class="token operator">=</span> sort_priority2<span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> group<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Found:\'</span><span class="token punctuation">,</span> found<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFound<span class="token punctuation">:</span> <span class="token boolean">False</span>\n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>排序结果没有问题，可以看到：在排过序的 numbers 里面，重要群组 group 里的那些元素（2、3、5、7），确实出现在了其他元素前面。既然这样，那表示函数返回值的 found 变量就应该是 True，但我们看到的却是 False，这是为什么？</p>\n<p>在表达式中引用某个变量时，Python 解释器会按照下面的顺序，在各个作用域（scope）里面查找这个变量，以解析（resolve）这次引用</p>\n<ol>\n<li>当前函数的作用域。</li>\n<li>外围作用域（例如包含当前函数的其他函数所对应的作用域）。</li>\n<li>包含当前代码的那个模块所对应的作用域（也叫全局作用域，global scope）。</li>\n<li>内置作用域（built-in scope，也就是包含 len 与 str 等函数的那个作用域）。</li>\n</ol>\n<p>如果这些作用域中都没有定义名称相符的变量，那么程序就抛出 NameError 异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4593726818204180000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`foo = does_not_exist * 5\n\n>>>\nTraceback...\nNameError: name \'does_not_exist\' is not defined`, `4593726818204180000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">foo <span class="token operator">=</span> does_not_exist <span class="token operator">*</span> <span class="token number">5</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nNameError<span class="token punctuation">:</span> name <span class="token string">\'does_not_exist\'</span> <span class="token keyword">is</span> <span class="token keyword">not</span> defined</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>刚才讲的是怎么引用变量，现在我们来讲怎么给变量赋值，这要分两种情况处理。</p>\n<ol>\n<li>如果变量已经定义在当前作用域中，那么直接把新值交给它就行了。</li>\n<li>如果当前作用域中不存在这个变量，那么即便外围作用域里有同名的变量，Python 也还是会把这次的赋值操作当成变量的定义来处理</li>\n</ol>\n<p>这会产生一个重要的效果，也就是说，Python 会把包含赋值操作的这个函数当成新定义的这个变量的作用域。</p>\n<p>这可以解释刚才那种写法错在何处。<code class="language-text">sort_priority2</code> 函数里面的 helper 闭包函数是把 True 赋给了 found 变量。当前作用域里没有这样一个叫作 found 的变量，所以就算外围的 <code class="language-text">sort_priority2</code> 函数里面有 found 变量，系统也还是会把这次赋值当成定义，也就是会在 helper 里面定义一个新的 found 变量，而不是把它当成给 <code class="language-text">sort_priority2</code> 已有的那个 found 变量赋值。</p>\n<p>这种问题有时也称作作用域 bug（scoping bug），Python 新手可能认为这样的赋值规则很奇怪，但实际上 Python 是故意这么设计的。因为这样可以防止函数中的局部变量污染外围模块。假如不这样做，那么函数里的每条赋值语句都有可能影响全局作用域的变量，这样不仅混乱，而且会让全局变量之间彼此交互影响，从而导致很多难以探查的 bug。</p>\n<p>Python 有一种特殊的写法，可以把闭包里面的数据赋给闭包外面的变量。用 nonlocal 语句描述变量，就可以让系统在处理针对这个变量的赋值操作时，去外围作用域查找。然而，nonlocal 有个限制，就是不能侵入模块级别的作用域（以防污染全局作用域）。</p>\n<p>下面，用 nonlocal 改写刚才那个函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46329603153835475000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def sort_priority2(numbers, group):\n    found = False\n\n    def helper(x):\n        nonlocal found\n        if x in group:\n            found = True  # Seems simple\n            return (0, x)\n        return (1, x)\n    numbers.sort(key=helper)\n    return found\n\n\nnumbers = [8, 3, 1, 2, 5, 4, 7, 6]\ngroup = {2, 3, 5, 7}\nfound = sort_priority2(numbers, group)\nprint(\'Found:\', found)\nprint(numbers)\n\n>>>\nFound: True\n[2, 3, 5, 7, 1, 4, 6, 8]`, `46329603153835475000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{5}"\n              >\n                <span class="gatsby-code-button-language">py{5}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">sort_priority2</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    found <span class="token operator">=</span> <span class="token boolean">False</span>\n\n    <span class="token keyword">def</span> <span class="token function">helper</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="gatsby-highlight-code-line">        <span class="token keyword">nonlocal</span> found</span>        <span class="token keyword">if</span> x <span class="token keyword">in</span> group<span class="token punctuation">:</span>\n            found <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># Seems simple</span>\n            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n    numbers<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>helper<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> found\n\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>\ngroup <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span>\nfound <span class="token operator">=</span> sort_priority2<span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> group<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Found:\'</span><span class="token punctuation">,</span> found<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFound<span class="token punctuation">:</span> <span class="token boolean">True</span>\n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>nonlocal 语句清楚地表明，我们要把数据赋给闭包之外的变量。有一种跟它互补的语句，叫作 global，用这种语句描述某个变量后，在给这个变量赋值时，系统会直接把它放到模块作用域（或者说全局作用域）中。</p>\n<p>我们都知道全局变量不应该滥用，其实 nonlocal 也这样。除比较简单的函数外，大家尽量不要用这个语句，因为它造成的副作用有时很难发现。尤其是在那种比较长的函数里，nonlocal 语句与其关联变量的赋值操作之间可能隔得很远。</p>\n<p>如果 nonlocal 的用法比较复杂，那最好是改用辅助类来封装状态。下面就定义了这样一个类，用来实现与刚才那种写法相同的效果。这样虽然稍微长一点，但看起来更清晰易读（<code class="language-text">__call__</code> 这个特殊方法，请参见第 38 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83465003595036660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Sorter:\n    def __init__(self, group):\n        self.group = group\n        self.found = False\n\n    def __call__(self, x):\n        if x in self.group:\n            self.found = True\n            return (0, x)\n        return (1, x)\n\n\nnumbers = [8, 3, 1, 2, 5, 4, 7, 6]\ngroup = {2, 3, 5, 7}\nsorter = Sorter(group)\nnumbers.sort(key=sorter)\nassert sorter.found is True`, `83465003595036660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Sorter</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> group<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>group <span class="token operator">=</span> group\n        self<span class="token punctuation">.</span>found <span class="token operator">=</span> <span class="token boolean">False</span>\n\n    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> x <span class="token keyword">in</span> self<span class="token punctuation">.</span>group<span class="token punctuation">:</span>\n            self<span class="token punctuation">.</span>found <span class="token operator">=</span> <span class="token boolean">True</span>\n            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>\n\n\nnumbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>\ngroup <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span>\nsorter <span class="token operator">=</span> Sorter<span class="token punctuation">(</span>group<span class="token punctuation">)</span>\nnumbers<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span>sorter<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> sorter<span class="token punctuation">.</span>found <span class="token keyword">is</span> <span class="token boolean">True</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-17"><a href="#%E6%80%BB%E7%BB%93-17" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>闭包函数可以引用定义它们的那个外围作用域之中的变量。</li>\n<li>按照默认的写法，在闭包里面给变量赋值并不会改变外围作用域中的同名变量。</li>\n<li>先用 nonlocal 语句说明，然后赋值，可以修改外围作用域中的变量。</li>\n<li>除特别简单的函数外，尽量少用 nonlocal 语句。</li>\n</ol>\n<h2 id="第-22-条：用数量可变的位置参数给函数设计清晰的参数列表"><a href="#%E7%AC%AC-22-%E6%9D%A1%EF%BC%9A%E7%94%A8%E6%95%B0%E9%87%8F%E5%8F%AF%E5%8F%98%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E7%BB%99%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E6%B8%85%E6%99%B0%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 22 条：用数量可变的位置参数给函数设计清晰的参数列表</h2>\n<p>让函数接受数量可变的位置参数（positional argument），可以把函数设计得更加清晰（这些位置参数通常简称 var args，或者叫作 star args，因为我们习惯用 <code class="language-text">*args</code> 指代）。例如，假设我们要记录调试信息。如果采用参数数量固定的方案来设计，那么函数应该接受一个表示信息的 message 参数和一个 values 列表（这个列表用于存放需要填充到信息里的那些值）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15230510736620407000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def log(message, values):\n    if not values:\n        print(message)\n    else:\n        values_str = \', \'.join(str(x) for x in values)\n        print(f\'{message}: {values_str}\')\n\n\nlog(\'My numbers are\', [1, 2])\nlog(\'Hi there\', [])\n\n>>>\nMy numbers are: 1, 2\nHi there`, `15230510736620407000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token keyword">not</span> values<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        values_str <span class="token operator">=</span> <span class="token string">\', \'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> values<span class="token punctuation">)</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>values_str<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nlog<span class="token punctuation">(</span><span class="token string">\'My numbers are\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Hi there\'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMy numbers are<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span>\nHi there</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>即便没有值需要填充到信息里面，也必须专门传一个空白的列表进去，这样显得多余，而且让代码看起来比较乱。最好是能允许调用者把第二个参数留空。在 Python 里，可以给最后一个位置参数加前缀 *，这样调用者就只需要提供不带星号的那些参数，然后可以不再指其他参数，也可以继续指定任意数量的位置参数。函数的主体代码不用改，只修改调用代码即可。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56918451110002130000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def log(message, *values):  # The only difference\n    if not values:\n        print(message)\n    else:\n        values_str = \', \'.join(str(x) for x in values)\n        print(f\'{message}: {values_str}\')\n\n\nlog(\'My numbers are\', 1, 2)\nlog(\'Hi there\')  # Much better\n\n>>>\nMy numbers are: 1, 2\nHi there`, `56918451110002130000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token operator">*</span>values<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># The only difference</span>\n    <span class="token keyword">if</span> <span class="token keyword">not</span> values<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        values_str <span class="token operator">=</span> <span class="token string">\', \'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> values<span class="token punctuation">)</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>values_str<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nlog<span class="token punctuation">(</span><span class="token string">\'My numbers are\'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Hi there\'</span><span class="token punctuation">)</span>  <span class="token comment"># Much better</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nMy numbers are<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span>\nHi there</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法与拆解数据时用在赋值语句左边带星号的 unpacking 操作非常类似（参见第 13 条）。</p>\n<p>如果想把已有序列（例如某列表）里面的元素当成参数传给像 log 这样的参数个数可变的函数（variadic function），那么可以在传递序列的时采用 * 操作符。这会让 Python 把序列中的元素都当成位置参数传给这个函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53119004773537325000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`favorites = [7, 33, 99]\nlog(\'Favorite colors\', *favorites)\n\n>>>\nFavorite colors: 7, 33, 99`, `53119004773537325000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">favorites <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Favorite colors\'</span><span class="token punctuation">,</span> <span class="token operator">*</span>favorites<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFavorite colors<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">99</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>令函数接受数量可变的位置参数，可能导致两个问题。</p>\n<ol>\n<li>\n<p>程序总是必须先把这些参数转化成一个元组，然后才能把它们当成可选的位置参数传给函数。这意味着，如果调用函数时，把带 * 操作符的生成器传了过去，那么程序必须先把这个生成器里的所有元素迭代完（以便形成元组），然后才能继续往下执行（相关知识，参见第 30 条）。这个元组包含生成器所给出的每个值，这可能耗费大量内存，甚至会让程序崩溃。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92737209447319300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def my_generator():\nfor i in range(10):\n    yield i\n\ndef my_func(*args):\n  print(args)\n\nit = my_generator()\nmy_func(*it)\n\n>>>\n(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)`, `92737209447319300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">my_generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> i\n\n<span class="token keyword">def</span> <span class="token function">my_func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>\n\nit <span class="token operator">=</span> my_generator<span class="token punctuation">(</span><span class="token punctuation">)</span>\nmy_func<span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>接受 <code class="language-text">*args</code> 参数的函数，适合处理输入值不太多，而且数量可以提前预估的情况。在调用这种函数时，传给 <code class="language-text">*args</code> 这一部分的应该是许多个字面值或变量名才对。这种机制，主要是为了让代码写起来更方便、读起来更清晰。</p>\n</li>\n<li>\n<p>如果用了 <code class="language-text">*args</code> 之后，又要给函数添加新的位置参数，那么原有的调用操作就需要全都更新。例如给参数列表开头添加新的位置参数 sequence，那么没有据此更新的那些调用代码就会出错。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13914862405881490000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def log(sequence, message, *values):\nif not values:\n    print(f\'{sequence} - {message}\')\nelse:\n    values_str = \', \'.join(str(x) for x in values)\n    print(f\'{sequence} - {message}: {values_str}\')\n\nlog(1, \'Favorites\', 7, 33)  # New with *args OK\nlog(1, \'Hi there\')  # New message only OK\nlog(\'Favorite numbers\', 7, 33)  # old usage breaks\n\n>>>\n1 - Favorites: 7, 33\n1 - Hi there\nFavorite numbers - 7: 33`, `13914862405881490000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>sequence<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token operator">*</span>values<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">if</span> <span class="token keyword">not</span> values<span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>sequence<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">else</span><span class="token punctuation">:</span>\n    values_str <span class="token operator">=</span> <span class="token string">\', \'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> values<span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>sequence<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>values_str<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\nlog<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'Favorites\'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span>  <span class="token comment"># New with *args OK</span>\nlog<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'Hi there\'</span><span class="token punctuation">)</span>  <span class="token comment"># New message only OK</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Favorite numbers\'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span>  <span class="token comment"># old usage breaks</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span> <span class="token operator">-</span> Favorites<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">33</span>\n<span class="token number">1</span> <span class="token operator">-</span> Hi there\nFavorite numbers <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">33</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>问题在于：第三次调用 log 函数的那个地方并没有根据新的参数列表传入 sequence 参数，所以 Favorite numbers 就成了 sequence 参数，7 就成了 message 参数。这样的 bug 很难排查，因为程序不会抛出异常，只会采用错误的数据继续运行下去。为了彻底避免这种漏洞，在给这种 <code class="language-text">*arg</code> 函数添加参数时，应该使用只能通过关键字来指定的参数（keyword-only argument，参见第 25 条）。要是想做得更稳妥一些，可以考虑添加类型注解（参见第 90 条）。</p>\n</li>\n</ol>\n<h3 id="总结-18"><a href="#%E6%80%BB%E7%BB%93-18" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>用 def 定义函数时，可以通过 <code class="language-text">*args</code> 的写法让函数接受数量可变的位置参数。</li>\n<li>调用函数时，可以在序列左边加上 <code class="language-text">*</code> 操作符，把其中的元素当成位置参数传给 <code class="language-text">*args</code> 所表示的这一部分。</li>\n<li>如果 <code class="language-text">*</code> 操作符加在生成器前，那么传递参数时，程序有可能因为耗尽内存而崩溃。</li>\n<li>给接受 <code class="language-text">*args</code> 的函数添加新位置参数，可能导致难以排查的 bug。</li>\n</ol>\n<h2 id="第-23-条：用关键字参数来表示可选的行为"><a href="#%E7%AC%AC-23-%E6%9D%A1%EF%BC%9A%E7%94%A8%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0%E6%9D%A5%E8%A1%A8%E7%A4%BA%E5%8F%AF%E9%80%89%E7%9A%84%E8%A1%8C%E4%B8%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 23 条：用关键字参数来表示可选的行为</h2>\n<p>与大多数其他编程语言一样，Python 允许在调用函数时，按照位置传递参数</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50904101055183840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def remainder(number, divisor):\n    return number % divisor\n\n\nassert remainder(20, 7) == 6`, `50904101055183840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">remainder</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> divisor<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> number <span class="token operator">%</span> divisor\n\n\n<span class="token keyword">assert</span> remainder<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Python 函数里面的所有普通参数，除了按位置传递外，还可以按关键字传递。调用函数时，在调用括号内可以把关键字的名称写在 = 左边，把参数值写在右边。这种写法不在乎参数的顺序，只要把必须指定的所有位置参数全都传过去即可。另外，关键字形式与位置形式也可以混用。下面这四种写法的效果相同：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2948920189329596000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`remainder(20, 7)\nremainder(20, divisor=7)\nremainder(number=20, divisor=7)\nremainder(divisor=7, number=20)`, `2948920189329596000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">remainder<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\nremainder<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> divisor<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>\nremainder<span class="token punctuation">(</span>number<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> divisor<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>\nremainder<span class="token punctuation">(</span>divisor<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果混用，那么位置参数必须出现在关键字参数之前，否则就会出错。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38317827378401640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`remainder(number=20, 7)\n\n>>>\nTraceback ...\nSyntaxError: positional argument follows keyword argument`, `38317827378401640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">remainder<span class="token punctuation">(</span>number<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nSyntaxError<span class="token punctuation">:</span> positional argument follows keyword argument</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>每个参数只能指定一次，不能既通过位置形式指定，又通过关键字形式指定。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34014213394886795000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`remainder(20, number=7)\n\n>>>\nTraceback ...\nTypeError: remainder() got multiple values for argument number`, `34014213394886795000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">remainder<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> remainder<span class="token punctuation">(</span><span class="token punctuation">)</span> got multiple values <span class="token keyword">for</span> argument number</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果有一份字典，而且字典里面的内容能够用来调用 remainder 这样的函数，那么可以把 <code class="language-text">**</code> 运算符加在字典前面，这会让 Python 把字典里面的键值以关键字参数的形式传给函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10586538612175288000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`my_kwargs = {\n    \'number\': 20,\n    \'divisor\': 7,\n}\nassert remainder(**my_kwargs) == 6`, `10586538612175288000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">my_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'number\'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>\n    <span class="token string">\'divisor\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">assert</span> remainder<span class="token punctuation">(</span><span class="token operator">**</span>my_kwargs<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>调用函数时，带 <code class="language-text">**</code> 操作符的参数可以和位置参数或关键字参数混用，只要不重复指定就行。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27454537383845425000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`my_kwargs = {\n    \'divisor\': 7,\n}\nassert remainder(number=20, **my_kwargs) == 6`, `27454537383845425000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">my_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'divisor\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">assert</span> remainder<span class="token punctuation">(</span>number<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">**</span>my_kwargs<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>也可以对多个字典分别施加 <code class="language-text">**</code> 操作，只要这些字典所提供的参数不重叠就好。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="7709323333105478000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`my_kwargs = {\n    \'number\': 20,\n}\nother_kwargs = {\n    \'divisor\': 7,\n}\nassert remainder(**my_kwargs, **other_kwargs) == 6`, `7709323333105478000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">my_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'number\'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\nother_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'divisor\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">assert</span> remainder<span class="token punctuation">(</span><span class="token operator">**</span>my_kwargs<span class="token punctuation">,</span> <span class="token operator">**</span>other_kwargs<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>定义函数时，如果想让这个函数接受任意数量的关键字参数，那么可以在参数列表里写上万能形参 <code class="language-text">**kwargs</code>，它会把调用者传进来的参数收集合到一个字典里面稍后处理（第 26 条讲了一种特别适合这么做的情况）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22186571798463017000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def print_parameters(**kwargs):\n    for key, value in kwargs.items():\n        print(f\'{key} = {value}\')\n\n\nprint_parameters(alpha=1.5, beta=9, gamma=4)\n\n>>>\nalpha = 1.5\nbeta = 9\ngamma = 4`, `22186571798463017000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">print_parameters</span><span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> kwargs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nprint_parameters<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nalpha <span class="token operator">=</span> <span class="token number">1.5</span>\nbeta <span class="token operator">=</span> <span class="token number">9</span>\ngamma <span class="token operator">=</span> <span class="token number">4</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>关键字参数的灵活用法可以带来三个好处。</p>\n<ol>\n<li>\n<p>用关键字参数调用函数可以让初次阅读代码的人更容易看懂。例如，读到 remainder(20, 7) 这样的调用代码，就不太容易看出谁是被除数 number，谁是除数 divisor，只有去查看 remainder 的具体实现方法才能明白。但如果改用关键字形式来调用，例如 remainder(number=20, divisor=7)，那么每个参数的含义就相当明了。</p>\n</li>\n<li>\n<p>它可以带有默认值，该值是在定义函数时指定的。在大多数情况下，调用者只需要沿用这个值就好，但有时也可以明确指定自己想要传的值。这样能够减少重复代码，让程序看上去干净一些。</p>\n<p>例如，我们要计算液体流入容器的速率。如果这个容器带刻度，那么可以取前后两个时间点的刻度差（<code class="language-text">weight_diff</code>），并把它跟这两个时间点的时间差（<code class="language-text">time_diff</code>）相除，就可以算出流速了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69125019838617740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def flow_rate(weight_diff, time_diff):\nreturn weight_diff / time_diff\n\nweight_diff = 0.5\ntime_diff = 3\nflow = flow_rate(weight_diff, time_diff)\nprint(f\'{flow:.3} kg per second\')`, `69125019838617740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">flow_rate</span><span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="token keyword">return</span> weight_diff <span class="token operator">/</span> time_diff\n\nweight_diff <span class="token operator">=</span> <span class="token number">0.5</span>\ntime_diff <span class="token operator">=</span> <span class="token number">3</span>\nflow <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>flow<span class="token punctuation">:</span><span class="token format-spec">.3</span><span class="token punctuation">}</span></span><span class="token string"> kg per second\'</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>一般来说，我们会用每秒的千克数表示流速。但有的时候，我们还想估算更长的时间段（例如几小时或几天）内的流速结果。只需给同一个函数加一个 period 参数来表示那个时间段相当于多少秒即可。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85115941791669860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def flow_rate(weight_diff, time_diff, period):\n   return (weight_diff / time_diff) * period`, `85115941791669860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">flow_rate</span><span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>weight_diff <span class="token operator">/</span> time_diff<span class="token punctuation">)</span> <span class="token operator">*</span> period</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>这样写有个问题，就是每次调用函数时，都得明确指定 period 参数。即便我们想计算每秒钟的流速，也还是得明确指定 period 为 1。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17168188048168420000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`flow_per_second = flow_rate(weight_diff, time_diff, 1)`, `17168188048168420000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">flow_per_second <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>为了简化这种用法，我们可以给 period 参数设定默认值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80976694829357940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def flow_rate(weight_diff, time_diff, period=1):\n   return (weight_diff / time_diff) * period\n\nflow_per_second = flow_rate(weight_diff, time_diff)\nflow_per_hour = flow_rate(weight_diff, time_diff, 3600)`, `80976694829357940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">flow_rate</span><span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n   <span class="token keyword">return</span> <span class="token punctuation">(</span>weight_diff <span class="token operator">/</span> time_diff<span class="token punctuation">)</span> <span class="token operator">*</span> period\n\nflow_per_second <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">)</span>\nflow_per_hour <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> <span class="token number">3600</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个办法适用于默认值比较简单的情况。如果默认值本身要根据比较复杂的逻辑来确定（可参考第 24 条），那就得仔细考虑一下了。</p>\n</li>\n<li>\n<p>我们可以很灵活地扩充函数的参数，而不用担心会影响原有的函数调用代码。这样的话，我们就可以通过这些新参数在函数里面实现许多新的功能，同时又无须修改早前写好的调用代码，这也让程序不容易因此出现 bug。</p>\n<p>例如，我们想继续扩充上述 <code class="language-text">flow_rate</code> 函数的功能，让它可以用千克之外的其他重量单位来计算流速。那只需要再添加一个可选参数，用来表示 1 千克相当于多少个那样的单位即可。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9144872846372221000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def flow_rate(weight_diff, time_diff, period=1, units_per_kg=1):\n  return ((weight_diff * units_per_kg) / time_diff) * period`, `9144872846372221000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">flow_rate</span><span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> units_per_kg<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>weight_diff <span class="token operator">*</span> units_per_kg<span class="token punctuation">)</span> <span class="token operator">/</span> time_diff<span class="token punctuation">)</span> <span class="token operator">*</span> period</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>新参数 <code class="language-text">units_per_kg</code> 的默认值为 1，这表示默认情况下，依然以千克为重量单位来计算。于是，以前写好的那些调用代码就不用修改了。以后调用 <code class="language-text">flow_rate</code> 时，可以通过关键字形式给这个参数指定值，以表示他们想用的那种单位（例如磅，1 千克约等于 2.2 磅）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70774857232485286000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pounds_per_hour = flow_rate(weight_diff, time_diff,\n                        period=3600, units_per_kg=2.2)`, `70774857232485286000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pounds_per_hour <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span>\n                        period<span class="token operator">=</span><span class="token number">3600</span><span class="token punctuation">,</span> units_per_kg<span class="token operator">=</span><span class="token number">2.2</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>可选的关键字参数有助于维护向后兼容（backward compatibility）。这是个相当重要的问题，对于接受带 <code class="language-text">*args</code> 参数的函数，也要注意向后兼容（参见第 22 条）。</p>\n<p>像 period 和 <code class="language-text">units_per_kg</code> 这样可选的关键字参数，只有一个缺点，就是调用者仍然能够按照位置来指定。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49315388825329440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`pounds_per_hour = flow_rate(weight_diff, time_diff, 3600, 2.2)`, `49315388825329440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">pounds_per_hour <span class="token operator">=</span> flow_rate<span class="token punctuation">(</span>weight_diff<span class="token punctuation">,</span> time_diff<span class="token punctuation">,</span> <span class="token number">3600</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>通过位置来指定可选参数，可能会让读代码的人有点儿糊涂，因为他不太清楚 3600 和 2.2 这两个值分别指哪个量的缩放系数。所以，最好是能以关键字的形式给这些参数传值，而不要按位置去传。从设计函数的角度来说，还可以考虑用更加明确的方案以降低出错概率（参见第 25 条）。</p>\n</li>\n</ol>\n<h3 id="总结-19"><a href="#%E6%80%BB%E7%BB%93-19" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>函数的参数可以按位置指定，也可以用关键字的形式指定。</li>\n<li>关键字可以让每个参数的作用更加明了，因为在调用函数时只按位置指定参数，可能导致这些参数的含义不够明确。</li>\n<li>应该通过带默认值的关键字参数来扩展函数的行为，因为这不会影响原有的函数调用代码。</li>\n<li>可选的关键字参数总是应该通过参数名来传递，而不应按位置传递。</li>\n</ol>\n<h2 id="第-24-条：用-none-和-docstring-来描述默认值会变的参数"><a href="#%E7%AC%AC-24-%E6%9D%A1%EF%BC%9A%E7%94%A8-none-%E5%92%8C-docstring-%E6%9D%A5%E6%8F%8F%E8%BF%B0%E9%BB%98%E8%AE%A4%E5%80%BC%E4%BC%9A%E5%8F%98%E7%9A%84%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 24 条：用 None 和 docstring 来描述默认值会变的参数</h2>\n<p>有时，我们想把那种不能够提前固定的值，当作关键字参数的默认值。例如，记录日志消息时，默认的时间应该是触发事件的那一刻。所以，如果调用者没有明确指定时间，那么就默认把调用函数的那一刻当成这条日志的记录时间。现在试试下面这种写法，假定它能让 when 参数的默认值随着这个函数每次的执行时间而发生变化。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="88194607611802270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from time import sleep\nfrom datetime import datetime\n\n\ndef log(message, when=datetime.now()):\n    print(f\'{when}: {message}\')\n\n\nlog(\'Hi there!\')\nsleep(0.1)\nlog(\'Hello again!\')\n\n>>>\n2022-09-16 11:39:58.577119: Hi there!\n2022-09-16 11:39:58.577119: Hello again!`, `88194607611802270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep\n<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime\n\n\n<span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> when<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>when<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nlog<span class="token punctuation">(</span><span class="token string">\'Hi there!\'</span><span class="token punctuation">)</span>\nsleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Hello again!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">2022</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token number">58.577119</span><span class="token punctuation">:</span> Hi there!\n<span class="token number">2022</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">:</span><span class="token number">58.577119</span><span class="token punctuation">:</span> Hello again!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写不行。因为 datetime.now 只执行了一次，所以每条日志的时间戳（timestamp）相同。参数的默认值只会在系统加载这个模块的时候，计算一遍，而不会在每次执行时都重新计算，这通常意味着这些默认值在程序启动后，就已经定下来了。只要包含这段代码的那个模块已经加载进来，那么 when 参数的默认值就是加载时计算的那个 datetime.now()，系统不会重新计算。</p>\n<p>要想在 Python 里实现这种效果，惯用的办法是把参数的默认值设为 None，同时在 docstring 文档里面写清楚，这个参数为 None 时，函数会怎么运作（参见第 84 条）。给函数写实现代码时，要判断该参数是不是 None，如果是，就把它改成相应的默认值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54414738407683980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from time import sleep\nfrom datetime import datetime\n\n\ndef log(message, when=None):\n    &quot;&quot;&quot;Log a message with a timestamp.\n\n    Args:\n        message: Message to print.\n        when: datetime of when the message occurred.\n            Defaults to the present time.\n    &quot;&quot;&quot;\n    if when is None:\n        when = datetime.now()\n    print(f\'{when}: {message}\')\n\n\nlog(\'Hi there!\')\nsleep(0.1)\nlog(\'Hello again!\')\n\n>>>\n2022-09-16 11:52:02.810552: Hi there!\n2022-09-16 11:52:02.910765: Hello again!`, `54414738407683980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep\n<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime\n\n\n<span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> when<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Log a message with a timestamp.\n\n    Args:\n        message: Message to print.\n        when: datetime of when the message occurred.\n            Defaults to the present time.\n    """</span>\n    <span class="token keyword">if</span> when <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n        when <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>when<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nlog<span class="token punctuation">(</span><span class="token string">\'Hi there!\'</span><span class="token punctuation">)</span>\nsleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">(</span><span class="token string">\'Hello again!\'</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">2022</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">02.810552</span><span class="token punctuation">:</span> Hi there!\n<span class="token number">2022</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">02.910765</span><span class="token punctuation">:</span> Hello again!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>把参数的默认值写成 None 还有个重要的意义，就是用来表示那种以后可能由调用者修改内容的默认值（例如某个可变的容器）。例如，我们要写一个函数对采用 JSON 格式编码的数据做解码。如果无法解码，那么就返回调用时所指定的默认结果，假如调用者当时没有明确指定，那就返回空白的字典。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2512867762966664000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import json\n\n\ndef decode(data, default={}):\n    try:\n        return json.loads(data)\n    except ValueError:\n        return default`, `2512867762966664000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> json\n\n\n<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>\n        <span class="token keyword">return</span> default</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样的写法与前面 datetime.now 的例子有着同样的问题。系统只会计算一次 default 参数（在加载这个模块的时候），所以每次调用这个函数时，给调用者返回的都是一开始分配的那个字典，这就相当于凡是以默认值调用这个函数的代码都共用同一份字典。这会使程序出现很奇怪的效果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45134913443300050000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import json\n\n\ndef decode(data, default={}):\n    try:\n        return json.loads(data)\n    except ValueError:\n        return default\n\n\nfoo = decode(\'bad data\')\nfoo[\'stuff\'] = 5\nbar = decode(\'also bad\')\nbar[\'meep\'] = 1\nprint(\'Foo:\', foo)\nprint(\'Bar:\', bar)\n\n>>>\nFoo: {\'stuff\': 5, \'meep\': 1}\nBar: {\'stuff\': 5, \'meep\': 1}`, `45134913443300050000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> json\n\n\n<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>\n        <span class="token keyword">return</span> default\n\n\nfoo <span class="token operator">=</span> decode<span class="token punctuation">(</span><span class="token string">\'bad data\'</span><span class="token punctuation">)</span>\nfoo<span class="token punctuation">[</span><span class="token string">\'stuff\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span>\nbar <span class="token operator">=</span> decode<span class="token punctuation">(</span><span class="token string">\'also bad\'</span><span class="token punctuation">)</span>\nbar<span class="token punctuation">[</span><span class="token string">\'meep\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Foo:\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Bar:\'</span><span class="token punctuation">,</span> bar<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFoo<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'stuff\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">\'meep\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span>\nBar<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'stuff\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">\'meep\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们本意是想让这两次调用操作得到两个不同的空白字典，每个字典都可以分别用来存放不同的键值。但实际上，只要修改其中一个字典，另一个字典的内容就会受到影响。这种错误的根源在于，foo 和 bar 实际上是同一个字典，都等于系统一开始给 default 参数确定默认值时所分配的那个字典。它们表示的是同一个字典对象。</p>\n<p>要解决这个问题，可以把默认值设成 None，并且在 docstring 文档里面说明，函数在这个值为 None 时会怎么做。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="67441353151034720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import json\n\n\ndef decode(data, default=None):\n    &quot;&quot;&quot;Load JSON data from a string.\n\n    Args:\n        data: JSON data to decode.\n        default: Value to return if decoding fails.\n            Defaults to an empty dictionary.\n    &quot;&quot;&quot;\n    try:\n        return json.loads(data)\n    except ValueError:\n        if default is None:\n            default = {}\n        return default\n\n\nfoo = decode(\'bad data\')\nfoo[\'stuff\'] = 5\nbar = decode(\'also bad\')\nbar[\'meep\'] = 1\nprint(\'Foo:\', foo)\nprint(\'Bar:\', bar)\nassert foo is not bar\n\n>>>\nFoo: {\'stuff\': 5}\nBar: {\'meep\': 1}`, `67441353151034720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> json\n\n\n<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Load JSON data from a string.\n\n    Args:\n        data: JSON data to decode.\n        default: Value to return if decoding fails.\n            Defaults to an empty dictionary.\n    """</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> default <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            default <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">return</span> default\n\n\nfoo <span class="token operator">=</span> decode<span class="token punctuation">(</span><span class="token string">\'bad data\'</span><span class="token punctuation">)</span>\nfoo<span class="token punctuation">[</span><span class="token string">\'stuff\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span>\nbar <span class="token operator">=</span> decode<span class="token punctuation">(</span><span class="token string">\'also bad\'</span><span class="token punctuation">)</span>\nbar<span class="token punctuation">[</span><span class="token string">\'meep\'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Foo:\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Bar:\'</span><span class="token punctuation">,</span> bar<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> foo <span class="token keyword">is</span> <span class="token keyword">not</span> bar\n\n<span class="token operator">>></span><span class="token operator">></span>\nFoo<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'stuff\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span>\nBar<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'meep\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个思路可以跟类型注解搭配起来（参见第 90 条）。下面这种写法把 when 参数标注成可选（Optional）值，并限定其类型为 datetime。于是，它的取值就只有两种可能，要么是 None，要么是 datetime 对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10680898452786747000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from typing import Optional\n\n\ndef log_typed(message: str, when: Optional[datetime] = None) -> None:\n    &quot;&quot;&quot;Log a message with a timestamp.\n\n        Args:\n            message: Message to print.\n            when: datetime of when the message occurred.\n                Defaults to the present time.\n    &quot;&quot;&quot;\n    if when is None:\n        when = datetime.now()\n    print(f\'{when}: {message}\')`, `10680898452786747000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional\n\n\n<span class="token keyword">def</span> <span class="token function">log_typed</span><span class="token punctuation">(</span>message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> when<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Log a message with a timestamp.\n\n        Args:\n            message: Message to print.\n            when: datetime of when the message occurred.\n                Defaults to the present time.\n    """</span>\n    <span class="token keyword">if</span> when <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n        when <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>when<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-20"><a href="#%E6%80%BB%E7%BB%93-20" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>参数的默认值只会计算一次，也就是在系统把定义函数的那个模块加载进来的时候。所以，如果默认值将来可能由调用方修改（例如{}、[]）或者要随着调用时的情况变化（例如 datetime.now()），那么程序就会出现奇怪的效果。</li>\n<li>如果关键字参数的默认值属于这种会发生变化的值，那就应该写成 None，并且要在 docstring 里面描述函数此时的默认行为。</li>\n<li>默认值为 None 的关键字参数，也可以添加类型注解。</li>\n</ol>\n<h2 id="第-25-条：用只能以关键字指定和只能按位置传入的参数来设计清晰的参数列表"><a href="#%E7%AC%AC-25-%E6%9D%A1%EF%BC%9A%E7%94%A8%E5%8F%AA%E8%83%BD%E4%BB%A5%E5%85%B3%E9%94%AE%E5%AD%97%E6%8C%87%E5%AE%9A%E5%92%8C%E5%8F%AA%E8%83%BD%E6%8C%89%E4%BD%8D%E7%BD%AE%E4%BC%A0%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0%E6%9D%A5%E8%AE%BE%E8%AE%A1%E6%B8%85%E6%99%B0%E7%9A%84%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 25 条：用只能以关键字指定和只能按位置传入的参数来设计清晰的参数列表</h2>\n<p>按关键字传递参数是 Python 函数的一项强大特性（参见第 23 条）。这种关键字参数特别灵活，在很多情况下，都能让我们写出一看就懂的函数代码。例如，计算两数相除的结果时，可能需要仔细考虑各种特殊情况。</p>\n<p>例如，在除数为 0 的情况下，是抛出 ZeroDivisionError 异常，还是返回无穷（infinity）；在结果溢出的情况下，是抛出 OverflowError 异常，还是返回 0。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81955961655279760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division(number, divisor,\n                  ignore_overflow,\n                  ignore_zero_division):\n    try:\n        return number / divisor\n    except OverflowError:\n        if ignore_overflow:\n            return 0\n        else:\n            raise\n    except ZeroDivisionError:\n        if ignore_zero_division:\n            return float(\'inf\')\n        else:\n            raise`, `81955961655279760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">safe_division</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> divisor<span class="token punctuation">,</span>\n                  ignore_overflow<span class="token punctuation">,</span>\n                  ignore_zero_division<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> number <span class="token operator">/</span> divisor\n    <span class="token keyword">except</span> OverflowError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_overflow<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token number">0</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_zero_division<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个函数用起来很直观。如果想在结果溢出的情况下，让它返回 0，那么可以像下面这样调用函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42675574486598200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`result = safe_division(1.0, 10**500, True, False)\nprint(result)\n\n>>>\n0`, `42675574486598200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">result <span class="token operator">=</span> safe_division<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果想在除数是 0 的情况下，让函数返回无穷，那么就按下面这样来写。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4229459955901715500"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`result = safe_division(1.0, 0, False, True)\nprint(result)\n\n>>>\ninf`, `4229459955901715500`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">result <span class="token operator">=</span> safe_division<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\ninf</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>表示要不要忽略异常的那两个参数都是 Boolean 值，所以容易弄错位置，这会让程序出现难以查找的 bug。要想让代码看起来更清晰，一种办法是给这两个参数都指定默认值。按照默认值，该函数只要遇到特殊情况，就会抛出异常。</p>\n<p>调用者可以用关键字参数指定覆盖其中某个参数的默认值，以调整函数在遇到那种特殊情况时的处理方式，同时让另一个参数依然取那个参数自己的默认值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="42475763264834910000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division_b(number, divisor,\n                    ignore_overflow=False,\n                    ignore_zero_division=False):\n    try:\n        return number / divisor\n    except OverflowError:\n        if ignore_overflow:\n            return 0\n        else:\n            raise\n    except ZeroDivisionError:\n        if ignore_zero_division:\n            return float(\'inf\')\n        else:\n            raise\n\n\nresult = safe_division_b(1.0, 10**500, ignore_overflow=True)\nprint(result)\nresult = safe_division_b(1.0, 0, ignore_zero_division=True)\nprint(result)\n\n>>>\n0\ninf`, `42475763264834910000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{2-3}"\n              >\n                <span class="gatsby-code-button-language">py{2-3}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">safe_division_b</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> divisor<span class="token punctuation">,</span>\n<span class="gatsby-highlight-code-line">                    ignore_overflow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">                    ignore_zero_division<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> number <span class="token operator">/</span> divisor\n    <span class="token keyword">except</span> OverflowError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_overflow<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token number">0</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_zero_division<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n\n\nresult <span class="token operator">=</span> safe_division_b<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">500</span><span class="token punctuation">,</span> ignore_overflow<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\nresult <span class="token operator">=</span> safe_division_b<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ignore_zero_division<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">0</span>\ninf</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而，由于这些关键参数是可选的，我们没办法要求调用者必须按照关键字形式来指定这两个参数。他们还是可以用传统的写法，按位置给这个新定义的 <code class="language-text">safe_division_b</code> 函数传递参数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21461712660115894000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert safe_division_b(1.0, 10**500, True, False) == 0`, `21461712660115894000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> safe_division_b<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>对于这种参数比较复杂的函数，我们可以声明只能通过关键字指定的参数（keyword-only argument），这样的话，写出来的代码就能清楚地反映调用者的想法了。这种参数只能用关键字来指定，不能按位置传递。</p>\n<p>下面就重新定义 <code class="language-text">safe_division</code> 函数，让它接受这样的参数。参数列表里的 <code class="language-text">*</code> 符号把参数分成两组，左边是位置参数，右边是只能用关键字指定的参数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75025852326974280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division_c(number, divisor, *,\n                    ignore_overflow=False,\n                    ignore_zero_division=False):\n    try:\n        return number / divisor\n    except OverflowError:\n        if ignore_overflow:\n            return 0\n        else:\n            raise\n    except ZeroDivisionError:\n        if ignore_zero_division:\n            return float(\'inf\')\n        else:\n            raise\n\n\nassert safe_division_c(1.0, 10**500, True, False) == 0\n\n>>>\nTraceback ...\nTypeError: safe_division_c() takes 2 positional arguments but 4 were given`, `75025852326974280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{1}"\n              >\n                <span class="gatsby-code-button-language">py{1}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">safe_division_c</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> divisor<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span></span>                    ignore_overflow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>\n                    ignore_zero_division<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> number <span class="token operator">/</span> divisor\n    <span class="token keyword">except</span> OverflowError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_overflow<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token number">0</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_zero_division<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n\n\n<span class="token keyword">assert</span> safe_division_c<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> safe_division_c<span class="token punctuation">(</span><span class="token punctuation">)</span> takes <span class="token number">2</span> positional arguments but <span class="token number">4</span> were given</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>当然我们还是可以像前面那样，用关键字参数指定覆盖其中一个参数的默认值（即忽略其中一种特殊情况，并让函数在遇到另一种特殊情况时抛出异常）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17286162107543990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`result = safe_division_c(1.0, 0, ignore_zero_division=True)\nassert result == float(\'inf\')\ntry:\n    result = safe_division_c(1.0, 0)\nexcept ZeroDivisionError:\n    pass  # Expected`, `17286162107543990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">result <span class="token operator">=</span> safe_division_c<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ignore_zero_division<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> result <span class="token operator">==</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    result <span class="token operator">=</span> safe_division_c<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>  <span class="token comment"># Expected</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样改依然有问题，因为在 <code class="language-text">safe_division_c</code> 版本的函数里面，有两个参数（也就是 number 和 divisor）必须由调用者提供。然而，调用者在提供这两个参数时，既可以按位置提供，也可以按关键字提供，还可以把这两种方式混起来用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6582643193548087000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`assert safe_division_c(number=2, divisor=5) == 0.4\nassert safe_division_c(divisor=5, number=2) == 0.4\nassert safe_division_c(2, divisor=5) == 0.4`, `6582643193548087000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">assert</span> safe_division_c<span class="token punctuation">(</span>number<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> divisor<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.4</span>\n<span class="token keyword">assert</span> safe_division_c<span class="token punctuation">(</span>divisor<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.4</span>\n<span class="token keyword">assert</span> safe_division_c<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> divisor<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.4</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>在未来也许因为扩展函数的需要，甚至是因为代码风格的变化，或许要修改这两个参数的名字。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35732634799730258000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division_c(numerator, denominator, *,\n                    ignore_overflow=False,\n                    ignore_zero_division=False):`, `35732634799730258000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{1}"\n              >\n                <span class="gatsby-code-button-language">py{1}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">safe_division_c</span><span class="token punctuation">(</span>numerator<span class="token punctuation">,</span> denominator<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span></span>                    ignore_overflow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>\n                    ignore_zero_division<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这看起来只是文字上面的微调，但之前所有通过关键字形式来指定这两个参数的调用代码，都会出错。</p>\n<p>其实最重要的问题在于，我们根本就没打算把 number 和 divisor 这两个名称纳入函数的接口；我们只是在编写函数的实现代码时，随意挑了这两个比较顺口的名称而已。也并不期望调用者也非得采用这种称呼来指定这两个参数。</p>\n<p>Python 3.8 引入了一项新特性，可以解决这个问题，这就是只能按位置传递的参数（positional-only argument）。这种参数与刚才的只能通过关键字指定的参数（keyword-only argument）相反，它们必须按位置指定，绝不能通过关键字形式指定。下面来重新定义 <code class="language-text">safe_division</code> 函数，使其前两个必须由调用者提供的参数只能按位置来提供。参数列表中的 <code class="language-text">/</code> 符号，表示它左边的那些参数只能按位置指定。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39193318622829890000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division_d(numerator, denominator, /, *,\n                    ignore_overflow=False,\n                    ignore_zero_division=False):\n    try:\n        return numerator / denominator\n    except OverflowError:\n        if ignore_overflow:\n            return 0\n        else:\n            raise\n    except ZeroDivisionError:\n        if ignore_zero_division:\n            return float(\'inf\')\n        else:\n            raise\n\n\nassert safe_division_d(2, 5) == 0.4 # 正常运行\nassert safe_division_d(numerator=2, denominator=5) == 0.4 # 报错`, `39193318622829890000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{1}"\n              >\n                <span class="gatsby-code-button-language">py{1}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">safe_division_d</span><span class="token punctuation">(</span>numerator<span class="token punctuation">,</span> denominator<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span></span>                    ignore_overflow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>\n                    ignore_zero_division<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> numerator <span class="token operator">/</span> denominator\n    <span class="token keyword">except</span> OverflowError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_overflow<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token number">0</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_zero_division<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n\n\n<span class="token keyword">assert</span> safe_division_d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.4</span> <span class="token comment"># 正常运行</span>\n<span class="token keyword">assert</span> safe_division_d<span class="token punctuation">(</span>numerator<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> denominator<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.4</span> <span class="token comment"># 报错</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在我们可以确信：给 <code class="language-text">safe_division_d</code> 函数的前两个参数（也就是那两个必备的参数）所挑选的名称，已经与调用者的代码解耦了。即便以后再次修改这两个参数的名称，也不会影响已经写好的调用代码。</p>\n<p>在函数的参数列表之中，<code class="language-text">/</code> 符号左侧的参数是只能按位置指定的参数，<code class="language-text">*</code> 符号右侧的参数则是只能按关键字形式指定的参数。那么，这两个符号如果同时出现在参数列表中，会有什么效果呢？这是个值得注意的问题。这意味着，这两个符号之间的参数，既可以按位置提供，又可以用关键字形式指定（其实，如果不特别说明 Python 函数的参数全都属于这种参数）。在设计 API 时，为了体现某编程风格或者实现某些需求，可能会允许某些参数既可以按位置传递，也可以用关键字形式指定，这样可以让代码简单易读。例如，给下面这个 <code class="language-text">safe_division</code> 函数的参数列表添加一个可选的 ndigits 参数，允许调用者指定这次除法应该精确到小数点后第几位。</p>\n<p>下面我们用三种方式来调用这个 <code class="language-text">safe_division_e</code> 函数。ndigits 是个带默认值的普通参数，因此，它既可以按位置传递，也可以用关键字来指定，还可以直接省略。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76433486071369610000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def safe_division_e(numerator, denominator, /,\n                    ndigits=10, *,\n                    ignore_overflow=False,\n                    ignore_zero_division=False):\n    try:\n        fraction = numerator / denominator\n        return round(fraction, ndigits)\n    except OverflowError:\n        if ignore_overflow:\n            return 0\n        else:\n            raise\n    except ZeroDivisionError:\n        if ignore_zero_division:\n            return float(\'inf\')\n        else:\n            raise\n\n\nresult = safe_division_e(22, 7)\nprint(result)\nresult = safe_division_e(22, 7, 5)\nprint(result)\nresult = safe_division_e(22, 7, ndigits=2)\nprint(result)\n\n>>>\n3.1428571429\n3.14286\n3.14`, `76433486071369610000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">safe_division_e</span><span class="token punctuation">(</span>numerator<span class="token punctuation">,</span> denominator<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">,</span>\n                    ndigits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span>\n                    ignore_overflow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>\n                    ignore_zero_division<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        fraction <span class="token operator">=</span> numerator <span class="token operator">/</span> denominator\n        <span class="token keyword">return</span> <span class="token builtin">round</span><span class="token punctuation">(</span>fraction<span class="token punctuation">,</span> ndigits<span class="token punctuation">)</span>\n    <span class="token keyword">except</span> OverflowError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_overflow<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token number">0</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ignore_zero_division<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">\'inf\'</span><span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span>\n\n\nresult <span class="token operator">=</span> safe_division_e<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\nresult <span class="token operator">=</span> safe_division_e<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\nresult <span class="token operator">=</span> safe_division_e<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> ndigits<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">3.1428571429</span>\n<span class="token number">3.14286</span>\n<span class="token number">3.14</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-21"><a href="#%E6%80%BB%E7%BB%93-21" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Keyword-only argument 是一种只能通过关键字指定而不能通过位置指定的参数。这迫使调用者必须指明，这个值是传给哪一个参数的。在函数的参数列表中，这种参数位于 <code class="language-text">*</code> 符号的右侧。</li>\n<li>Positional-only argument 是这样一种参数，它不允许调用者通过关键字来指定，而是要求必须按位置传递。这可以降低调用代码与参数名称之间的耦合程度。在函数的参数列表中，这些参数位于 <code class="language-text">/</code> 符号的左侧。</li>\n<li>在参数列表中，位于 <code class="language-text">/</code> 与 <code class="language-text">*</code> 之间的参数，可以按位置指定，也可以用关键字来指定。这也是 Python 普通参数的默认指定方式。</li>\n</ol>\n<h2 id="第-26-条：用-functoolswraps-定义函数修饰器"><a href="#%E7%AC%AC-26-%E6%9D%A1%EF%BC%9A%E7%94%A8-functoolswraps-%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%E4%BF%AE%E9%A5%B0%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 26 条：用 functools.wraps 定义函数修饰器</h2>\n<p>Python 中有一种特殊的写法，可以用修饰器（decorator）来封装某个函数，从而让程序在执行这个函数之前与执行完这个函数之后，分别运行某些代码。这意味着，调用者传给函数的参数值、函数返回给调用者的值，以及函数抛出的异常，都可以由修饰器访问并修改。这是个很有用的机制，能够确保用户以正确的方式使用函数，也能够用来调试程序或实现函数注册功能，此外还有许多用途。</p>\n<p>例如，假设我们要把函数执行时收到的参数与返回的值记录下来。这在调试递归函数时是很有用的，因为我们需要知道，这个函数执行每一层递归时，输入的是什么参数，返回的是什么值。下面我们就定义这样一个修饰器，在实现这个修饰器时，用 <code class="language-text">*args</code> 与 <code class="language-text">**kwargs</code> 表示受修饰的原函数 func 所收到的参数（参见第 22 条与第 23 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17155584142690871000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def trace(func):\n    def wrapper(*args, **kwargs):\n        result = func(*args, **kwargs)\n        print(f\'{func.__name__}({args!r}，{kwargs!r})\'\n              f\'-> {result!r}\')\n        return result\n    return wrapper\n\n\n@trace # 相当于 fibonacci = trace(fibonacci)\ndef fibonacci(n):\n    &quot;&quot;&quot;Return the n-th Fibonacci number&quot;&quot;&quot;\n    if n in (0, 1):\n        return n\n    return fibonacci(n - 2) + fibonacci(n - 1)\n\nfibonacci(4)\n\n>>>\nfibonacci((0,)，{})-> 0\nfibonacci((1,)，{})-> 1\nfibonacci((2,)，{})-> 1\nfibonacci((1,)，{})-> 1\nfibonacci((0,)，{})-> 0\nfibonacci((1,)，{})-> 1\nfibonacci((2,)，{})-> 1\nfibonacci((3,)，{})-> 2\nfibonacci((4,)，{})-> 3`, `17155584142690871000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">trace</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        result <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{</span>args<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">，</span><span class="token interpolation"><span class="token punctuation">{</span>kwargs<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">)\'</span></span>\n              <span class="token string-interpolation"><span class="token string">f\'-> </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span> result\n    <span class="token keyword">return</span> wrapper\n\n\n@trace <span class="token comment"># 相当于 fibonacci = trace(fibonacci)</span>\n<span class="token keyword">def</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Return the n-th Fibonacci number"""</span>\n    <span class="token keyword">if</span> n <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> n\n    <span class="token keyword">return</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>\n\nfibonacci<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">0</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">1</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">1</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">1</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">0</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">1</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">1</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">2</span>\nfibonacci<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">)</span>，<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> <span class="token number">3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写确实能满足需求，但是会带来一个我们不愿意看到的副作用。修饰器返回的那个值，也就是刚才调用的 fibonacci，它的名字并不叫 <code class="language-text">fibonacci</code>。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44509746422434010000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(fibonacci)\n\n>>>\n<function trace.<locals>.wrapper at 0x108955dcO>`, `44509746422434010000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token operator">&lt;</span>function trace<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token builtin">locals</span><span class="token operator">></span><span class="token punctuation">.</span>wrapper at 0x108955dcO<span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种现象解释起来并不困难。trace 函数返回的，是它里面定义的 wrapper 函数，所以，当我们把这个返回值赋给 fibonacci 之后，fibonacci 这个名称所表示的自然就是 wrapper 了。问题在于，这样可能会干扰那些需要利用 introspection 机制来运作的工具，例如调试器（debugger）（参见第 80 条）。</p>\n<p>例如，如果用内置的 help 函数来查看修饰后的 fibonacci，那么打印出来的并不是我们想看的帮助文档，它本来应该打印前面定义时写的那行 <code class="language-text">Return the n-th Fibonacci number</code> 文本才对。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57291909829480510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`help(fibonacci)\n\n>>>\nHelp on function wrapper in module __main__:\n\nwrapper(*args, **kwargs)`, `57291909829480510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token builtin">help</span><span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nHelp on function wrapper <span class="token keyword">in</span> module __main__<span class="token punctuation">:</span>\n\nwrapper<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>对象序列化器（object serializer，参见第 68 条）也无法正常运作，因为它不能确定受修饰的那个原始函数的位置。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51669494935705985000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import pickle\n\npickle.dumps(fibonacci)\n\n>>>\nTraceback ...\nAttributeError: Can\'t pickle local object \'trace.<locals>.wrapper\'`, `51669494935705985000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> pickle\n\npickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nAttributeError<span class="token punctuation">:</span> Can<span class="token string">\'t pickle local object \'</span>trace<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token builtin">locals</span><span class="token operator">></span><span class="token punctuation">.</span>wrapper\'</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>要想解决这些问题，可以改用 functools 内置模块之中的 wraps 辅助函数来实现。wraps 本身也是个修饰器，它可以帮助你编写自己的修饰器。把它运用到 wrapper 函数上面，它就会将重要的元数据（metadata）全都从内部函数复制到外部函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11682019291794020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import pickle\nfrom functools import wraps\n\n\ndef trace(func):\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        result = func(*args, **kwargs)\n        print(f\'{func.__name__}({args!r}，{kwargs!r})\'\n              f\'-> {result!r}\')\n        return result\n    return wrapper\n\n\n@trace\ndef fibonacci(n):\n    &quot;&quot;&quot;Return the n-th Fibonacci number&quot;&quot;&quot;\n    if n in (0, 1):\n        return n\n    return fibonacci(n - 2) + fibonacci(n - 1)\n\n\npickle.dumps(fibonacci)\nhelp(fibonacci)`, `11682019291794020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{2,6}"\n              >\n                <span class="gatsby-code-button-language">py{2,6}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> pickle\n<span class="gatsby-highlight-code-line"><span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps</span>\n\n<span class="token keyword">def</span> <span class="token function">trace</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>\n<span class="gatsby-highlight-code-line">    @wraps<span class="token punctuation">(</span>func<span class="token punctuation">)</span></span>    <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        result <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{</span>args<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">，</span><span class="token interpolation"><span class="token punctuation">{</span>kwargs<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">)\'</span></span>\n              <span class="token string-interpolation"><span class="token string">f\'-> </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span> result\n    <span class="token keyword">return</span> wrapper\n\n\n@trace\n<span class="token keyword">def</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token triple-quoted-string string">"""Return the n-th Fibonacci number"""</span>\n    <span class="token keyword">if</span> n <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> n\n    <span class="token keyword">return</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>\n\n\npickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span>\n<span class="token builtin">help</span><span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在我们就可以通过 help 函数看到正确的文档了。虽然原来的 fibonacci 函数现在封装在修饰器里面，但我们还是可以看到它的文档。</p>\n<p>除了这里讲到的几个方面之外，Python 函数还有很多标准属性（例如 <code class="language-text">__name__</code>、<code class="language-text">__module__</code>、<code class="language-text">__annotations__</code>）也应该在受到封装时得以保留，这样才能让相关的接口正常运作。wraps 可以帮助保留这些属性，使程序表现出正确的行为。</p>\n<h3 id="总结-22"><a href="#%E6%80%BB%E7%BB%93-22" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>修饰器是 Python 中的一种写法，能够把一个函数封装在另一个函数里面，这样程序在执行原函数之前与执行完毕之后，就有机会执行其他一些逻辑了。</li>\n<li>修饰器可能会让那些利用 introspection 机制运作的工具（例如调试器）产生奇怪的行为。</li>\n<li>Python 内置的 functools 模块里有个叫作 wraps 的修饰器，可以帮助我们正确定义自己的修饰器，从而避开相关的问题。</li>\n</ol>\n<h1 id="推导与生成"><a href="#%E6%8E%A8%E5%AF%BC%E4%B8%8E%E7%94%9F%E6%88%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>推导与生成</h1>\n<h2 id="第-27-条：用列表推导取代-map-与-filter"><a href="#%E7%AC%AC-27-%E6%9D%A1%EF%BC%9A%E7%94%A8%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC%E5%8F%96%E4%BB%A3-map-%E4%B8%8E-filter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 27 条：用列表推导取代 map 与 filter</h2>\n<p>Python 里面有一种很精简的写法，可以根据某个序列或可迭代对象派生出一份新的列表。用这种写法写成的表达式，叫作列表推导（list comprehension）。假设我们要用列表中每个元素的平方值构建一份新的列表。传统的写法是，采用下面这个简单的 for 循环来实现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10265487548321927000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nsquares = []\nfor x in a:\n    squares.append(x**2)\nprint(squares)\n\n>>>\n[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]`, `10265487548321927000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nsquares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n<span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">:</span>\n    squares<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>squares<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面那段代码可以改用列表推导来写，这样可以在迭代列表的过程中，根据表达式算出新列表中的对应元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80404170931884200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nsquares = [x**2 for x in a]\nprint(squares)`, `80404170931884200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nsquares <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a<span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>squares<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这种功能当然也可以用内置函数 map 实现，它能够从多个列表中分别取出当前位置上的元素，并把它们当作参数传给映射函数，以求出新列表在这个位置上的元素值。如果映射关系比较简单（例如只是把一个列表映射到另一个列表），那么用列表推导来写还是比用 map 简单一些，因为用 map 的时候，必须先把映射逻辑定义成 lambda 函数，这看上去稍微有点烦琐。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63852965140529430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nsquares = list(map(lambda x: x ** 2, a))\nprint(squares)`, `63852965140529430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nsquares <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>squares<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>列表推导还有一个地方比 map 好，就是它能够方便地过滤原列表，把某些输入值对应的计算结果从输出结果中排除。例如，假设新列表只需要纳入原列表中那些偶数的平方值，那我们可以在推导的时候，在 for x in a 这一部分的右侧写一个条件表达式：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78796327285610300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\neven_squares = [x**2 for x in a if x % 2 == 0]\nprint(even_squares)\n\n>>>\n[4, 16, 36, 64, 100]`, `78796327285610300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\neven_squares <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>even_squares<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种功能也可以通过内置的 filter 与 map 函数来实现，但是这两个函数相结合的写法要比列表推导难懂一些。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="86384483665987000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\neven_squares = [x**2 for x in a if x % 2 == 0]\nalt = map(lambda x: x**2, filter(lambda x: x % 2 == 0, a))\nassert even_squares == list(alt)`, `86384483665987000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\neven_squares <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>\nalt <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> even_squares <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>alt<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>字典与集合也有相应的推导机制，分别叫作字典推导（dictionary comprehension）与集合推导（set comprehension）。编写算法时，可以利用这些机制根据原字典与原集合创建新字典与新集合。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54021258331559990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\neven_squares_dict = {x: x**2 for x in a if x % 2 == 0}\nthrees_cubed_set = {x**3 for x in a if x % 3 == 0}\nprint(even_squares_dict)\nprint(threes_cubed_set)\n\n>>>\n{2: 4, 4: 16, 6: 36, 8: 64, 10: 100}\n{216, 729, 27}`, `54021258331559990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\neven_squares_dict <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">}</span>\nthrees_cubed_set <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">**</span><span class="token number">3</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">}</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>even_squares_dict<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>threes_cubed_set<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span>\n<span class="token punctuation">{</span><span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">729</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果改用 map 与 filter 实现，那么还必须调用相应的构造器（constructor），这会让代码变得很长，需要分成多行才能写得下。这样看起来比较乱，不如使用推导机制的代码清晰。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74179998230972190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\neven_squares_dict = {x: x**2 for x in a if x % 2 == 0}\nthrees_cubed_set = {x**3 for x in a if x % 3 == 0}\n\nalt_dict = dict(map(lambda x: (x, x**2),\n                    filter(lambda x: x % 2 == 0, a)))\nalt_set = set(map(lambda x: x**3,\n                  filter(lambda x: x % 3 == 0, a)))\n\nassert even_squares_dict == alt_dict\nassert threes_cubed_set == alt_set`, `74179998230972190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\neven_squares_dict <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">}</span>\nthrees_cubed_set <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">**</span><span class="token number">3</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">}</span>\n\nalt_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                    <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nalt_set <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">,</span>\n                  <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token keyword">assert</span> even_squares_dict <span class="token operator">==</span> alt_dict\n<span class="token keyword">assert</span> threes_cubed_set <span class="token operator">==</span> alt_set</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-23"><a href="#%E6%80%BB%E7%BB%93-23" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>列表推导要比内置的 map 与 filter 函数清晰，因为它不用另外定义 lambda 表达式。</li>\n<li>列表推导可以很容易地跳过原列表中的某些数据，假如改用 map 实现，那么必须搭配 filter 才能实现。</li>\n<li>字典与集合也可以通过推导来创建。</li>\n</ol>\n<h2 id="第-28-条：控制推导逻辑的子表达式不要超过两个"><a href="#%E7%AC%AC-28-%E6%9D%A1%EF%BC%9A%E6%8E%A7%E5%88%B6%E6%8E%A8%E5%AF%BC%E9%80%BB%E8%BE%91%E7%9A%84%E5%AD%90%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8D%E8%A6%81%E8%B6%85%E8%BF%87%E4%B8%A4%E4%B8%AA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 28 条：控制推导逻辑的子表达式不要超过两个</h2>\n<p>除了最基本的用法（参见第 27 条）外，列表推导还支持多层循环。例如，要把矩阵（一种二维列表，它的每个元素本身也是列表）转化成普通的一维列表，那么可以在推导时，使用两条 for 子表达式。这些子表达式会按照从左到右的顺序解读。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10270907573819433000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nflat = [x for row in matrix for x in row]\nprint(flat)\n\n>>>\n[1, 2, 3, 4, 5, 6, 7, 8, 9]`, `10270907573819433000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nflat <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix <span class="token keyword">for</span> x <span class="token keyword">in</span> row<span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>flat<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写简单易懂，这也正是多层循环在列表推导之中的合理用法。多层循环还可以用来重制那种两层深的结构。例如，如果要根据二维矩阵里每个元素的平方值构建一个新的二维矩阵，那么可以采用下面这种写法。这看上去有点儿复杂，因为它把小的推导逻辑 <code class="language-text">[x**2 for x in row]</code> 嵌到了大的推导逻辑里面，不过，这行语句总体上不难理解。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10395154054979815000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nsquared = [[x**2 for x in row] for row in matrix]\nprint(squared)\n\n>>>\n[[1, 4, 9], [16, 25, 36], [49, 64, 81]]`, `10395154054979815000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nsquared <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> row<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix<span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>squared<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果推导过程中还要再加一层循环，那么语句就会变得很长，必须把它分成多行来写，例如下面是把一个三维矩阵转化成普通一维列表的代码。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72970506081818830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`my_lists = [\n    [[1, 2, 3], [4, 5, 6]]\n]\nflat = [x for sublist1 in my_lists\n        for sublist2 in sublist1\n        for x in sublist2]\nprint(flat)\n\n>>>\n[1, 2, 3, 4, 5, 6]`, `72970506081818830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">my_lists <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\n<span class="token punctuation">]</span>\nflat <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> sublist1 <span class="token keyword">in</span> my_lists\n        <span class="token keyword">for</span> sublist2 <span class="token keyword">in</span> sublist1\n        <span class="token keyword">for</span> x <span class="token keyword">in</span> sublist2<span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>flat<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在这种情况下，采用列表推导来实现，其实并不会比传统的 for 循环节省多少代码。下面用常见的 for 循环改写刚才的例子。这次我们通过级别不同的缩进表示每一层循环的深度，这要比刚才那种三层矩阵的列表推导更加清晰。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="80394031914459200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`my_lists = [\n    [[1, 2, 3], [4, 5, 6]]\n]\nflat = []\nfor sublistl in my_lists:\n    for sublist2 in sublistl:\n        flat.extend(sublist2)`, `80394031914459200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">my_lists <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\n<span class="token punctuation">]</span>\nflat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n<span class="token keyword">for</span> sublistl <span class="token keyword">in</span> my_lists<span class="token punctuation">:</span>\n    <span class="token keyword">for</span> sublist2 <span class="token keyword">in</span> sublistl<span class="token punctuation">:</span>\n        flat<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>sublist2<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>推导的时候，可以使用多个 if 条件。如果这些 if 条件出现在同一层循环内，那么它们之间默认是 and 关系，也就是必须同时成立。例如，如果要用原列表中大于 4 且是偶数的值来构建新列表，那么既可以连用两个 if，也可以只用一个 if，下面两种写法效果相同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96629892634423720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nb = [x for x in a if x > 4 if x % 2 == 0]\nc = [x for x in a if x > 4 and x % 2 == 0]`, `96629892634423720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nb <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">></span> <span class="token number">4</span> <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>\nc <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> x <span class="token operator">></span> <span class="token number">4</span> <span class="token keyword">and</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>在推导时，每一层的 for 子表达式都可以带有 if 条件。例如，要根据原矩阵构建新的矩阵，把其中各元素之和大于等于 10 的那些行选出来，而且只保留其中能够被 3 整除的那些元素。这个逻辑用列表推导来写，并不需要太多的代码，但是这些代码理解起来会很困难。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59146720965354200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]\nfiltered = [[x for x in row if x % 3 == 0]\n            for row in matrix if sum(row) >= 10]\nprint(filtered)\n\n>>>\n[[6], [9]]`, `59146720965354200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\nfiltered <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> row <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>\n            <span class="token keyword">for</span> row <span class="token keyword">in</span> matrix <span class="token keyword">if</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>filtered<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>虽然这个例子是笔者专门构造出来的，但在实际中，我们确实会碰到很多类似的需求。有人可能觉得，这些需求应该通过推导来实现。然而，笔者强烈建议大家不要用刚才的写法来推导新的 list、dict 或 set，因为这样写出来的代码很难让初次阅读这段程序的人看懂。对于 dict 来说，问题尤其严重，因为必须得把键与值的推导逻辑都表达出来才行。</p>\n<p>总之，在表示推导逻辑时，最多只应该写两个子表达式（例如两个 if 条件、两个 for 循环，或者一个 if 条件与一个 for 循环）。只要实现的逻辑比这还复杂，那就应该采用普通的 if 与 for 语句来实现，并且可以考虑编写辅助函数（参见第 30 条）。</p>\n<h3 id="总结-24"><a href="#%E6%80%BB%E7%BB%93-24" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>推导的时候可以使用多层循环，每层循环可以带有多个条件。</li>\n<li>控制推导逻辑的子表达式不要超过两个，否则代码很难读懂。</li>\n</ol>\n<h2 id="第-29-条：用赋值表达式消除推导中的重复代码"><a href="#%E7%AC%AC-29-%E6%9D%A1%EF%BC%9A%E7%94%A8%E8%B5%8B%E5%80%BC%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B6%88%E9%99%A4%E6%8E%A8%E5%AF%BC%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 29 条：用赋值表达式消除推导中的重复代码</h2>\n<p>推导 list、dict 与 set 等变体结构时，经常要在多个地方用到同一个计算结果。例如，我们要给制作紧固件的公司编写程序以管理订单。顾客下单后，我们要判断当前的库存能否满足这份订单，也就是说，要核查每种产品的数量有没有达到可以发货的最低限制（8 个为一批，至少要有一批，才能发货）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98527567143295450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`stock = {\n    \'nails\': 125,\n    \'screws\': 35,\n    \'wingnuts\': 8,\n    \'washers\': 24,\n}\norder = [\'screws\', \'wingnuts\', \'clips\']\n\n\ndef get_batches(count, size):\n    return count // size\n\n\nresult = {}\nfor name in order:\n    count = stock.get(name, 0)\n    batches = get_batches(count, 8)\n    if batches:\n        result[name] = batches\n\nprint(result)\n\n>>>\n{\'screws\': 4, \'wingnuts\': 1}`, `98527567143295450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">stock <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'nails\'</span><span class="token punctuation">:</span> <span class="token number">125</span><span class="token punctuation">,</span>\n    <span class="token string">\'screws\'</span><span class="token punctuation">:</span> <span class="token number">35</span><span class="token punctuation">,</span>\n    <span class="token string">\'wingnuts\'</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>\n    <span class="token string">\'washers\'</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\norder <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'screws\'</span><span class="token punctuation">,</span> <span class="token string">\'wingnuts\'</span><span class="token punctuation">,</span> <span class="token string">\'clips\'</span><span class="token punctuation">]</span>\n\n\n<span class="token keyword">def</span> <span class="token function">get_batches</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> count <span class="token operator">//</span> size\n\n\nresult <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token keyword">for</span> name <span class="token keyword">in</span> order<span class="token punctuation">:</span>\n    count <span class="token operator">=</span> stock<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>\n    batches <span class="token operator">=</span> get_batches<span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> batches<span class="token punctuation">:</span>\n        result<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> batches\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'screws\'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">\'wingnuts\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这段循环逻辑，如果改用字典推导来写，会简单一些（参见第 27 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21371426644054070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`found = {name: get_batches(stock.get(name, 0), 8)\n         for name in order\n         if get_batches(stock.get(name, 0), 8)}\nprint(found)`, `21371426644054070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">found <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> get_batches<span class="token punctuation">(</span>stock<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>\n         <span class="token keyword">for</span> name <span class="token keyword">in</span> order\n         <span class="token keyword">if</span> get_batches<span class="token punctuation">(</span>stock<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">}</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>found<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写虽然比刚才简短，但问题是，它把 <code class="language-text">get_batches(stock.get(name, 0), 8)</code> 写了两遍。这样会让代码看起来比较乱，而且实际上，程序也没有必要把这个结果计算两遍。另外，如果这两个地方忘了同步更新，那么程序就会出现 bug。例如，我们决定每一批不是 8 个，而是 4 个，那么需要把 <code class="language-text">get_batches</code> 的第二个参数从 8 改成 4，但是，万一我们忘了同步修改另一个地方，那么代码就可能会出问题（它会把大于等于 4 但是小于 8 的情况给漏掉）。</p>\n<p>有个简单的办法可以解决这个问题，那就是在推导的过程中使用 Python 3.8 新引入的 <code class="language-text">:=</code> 操作符进行赋值表达（参见第 10 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93760993694844000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`found = {name: batches for name in order\n         if (batches := get_batches(stock.get(name, 0), 8))}`, `93760993694844000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">found <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> batches <span class="token keyword">for</span> name <span class="token keyword">in</span> order\n         <span class="token keyword">if</span> <span class="token punctuation">(</span>batches <span class="token punctuation">:</span><span class="token operator">=</span> get_batches<span class="token punctuation">(</span>stock<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>这条 <code class="language-text">batches := get_batches(...)</code> 赋值表达式，能够从 stock 字典里查到对应产品一共有几批，并把这个批数放在 batches 变量里。这样的话，我们推导这个产品所对应批数时，就不用再通过 <code class="language-text">get_batches</code> 计算了，因为结果已经保存到 batches 里面了。这种写法只需要把 get 与 <code class="language-text">get_batches</code> 调用一次即可，这样能够提升效率，因为我们不需要针对 order 列表中的每件产品都多做一次 get 与 <code class="language-text">get_batches</code>。</p>\n<p>在推导过程中，描述新值的那一部分也可以出现赋值表达式。但如果在其他部分引用了定义在那一部分的变量，那么程序可能就会在运行时出错。例如，如果写成了下面这样，那么程序就必须先考虑 <code class="language-text">for name, count in stock.items() if tenth &gt; 0</code>，而这个时候，其中的 tenth 还没有得到定义。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82455516251987230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`result = {name: (tenth := count // 10)\n          for name, count in stock.items() if tenth > 0}\nprint(result)\n\n>>>\nTraceback ...\nNameError: name \'tenth\' is not defined`, `82455516251987230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">result <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token punctuation">(</span>tenth <span class="token punctuation">:</span><span class="token operator">=</span> count <span class="token operator">//</span> <span class="token number">10</span><span class="token punctuation">)</span>\n          <span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> stock<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> tenth <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">}</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nNameError<span class="token punctuation">:</span> name <span class="token string">\'tenth\'</span> <span class="token keyword">is</span> <span class="token keyword">not</span> defined</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为了解决这个问题，可以把赋值表达式移动到 if 条件里面，然后在描述新值的这一部分引用已经定义过的 tenth 变量。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65259930625537340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`result = {name: tenth for name, count in stock.items()\n          if (tenth := count // 10) > 0}\nprint(result)\n\n>>>\n{\'nails\': 12, \'screws\': 3, \'washers\': 2}`, `65259930625537340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">result <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> tenth <span class="token keyword">for</span> name<span class="token punctuation">,</span> count <span class="token keyword">in</span> stock<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>tenth <span class="token punctuation">:</span><span class="token operator">=</span> count <span class="token operator">//</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">}</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'nails\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'screws\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">\'washers\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果推导逻辑不带条件，而表示新值的那一部分又使用了 <code class="language-text">:=</code> 操作符，那么操作符左边的变量就会泄漏到包含这条推导语句的那个作用域里（参见第 21 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13134350566295904000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`half = [(last := count // 2) for count in stock.values()]\nprint(f\'Last item of {half} is {last}\')\n\n>>>\nLast item of [62, 17, 4, 12] is 12`, `13134350566295904000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">half <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>last <span class="token punctuation">:</span><span class="token operator">=</span> count <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> count <span class="token keyword">in</span> stock<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Last item of </span><span class="token interpolation"><span class="token punctuation">{</span>half<span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>last<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLast item of <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token number">12</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这与普通的 for 循环所用的那个循环变量类似</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8027141091691159000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`for count in stock.values():  # Leaks loop variable\n    pass\nprint(f\'Last item of {list(stock.values())} is {count}\')\n\n>>>\nLast item of [125, 35, 8, 24] is 24`, `8027141091691159000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">for</span> count <span class="token keyword">in</span> stock<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Leaks loop variable</span>\n    <span class="token keyword">pass</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Last item of </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">list</span><span class="token punctuation">(</span>stock<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLast item of <span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token number">24</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而，推导语句中的 for 循环所使用的循环变量，是不会像刚才那样泄漏到外面的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82303954500145990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`half = [count // 2 for count in stock.values()]\nprint(half)\n# Works\nprint(count)  # Exception because loop variable didn\'t leak\n\n>>>\n[62, 17, 4, 12]\nTraceback ...\nNameError: name \'count\' is not defined`, `82303954500145990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">half <span class="token operator">=</span> <span class="token punctuation">[</span>count <span class="token operator">//</span> <span class="token number">2</span> <span class="token keyword">for</span> count <span class="token keyword">in</span> stock<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>half<span class="token punctuation">)</span>\n<span class="token comment"># Works</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>  <span class="token comment"># Exception because loop variable didn\'t leak</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nNameError<span class="token punctuation">:</span> name <span class="token string">\'count\'</span> <span class="token keyword">is</span> <span class="token keyword">not</span> defined</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>最好不要泄漏循环变量，所以，建议赋值表达式只出现在推导逻辑的条件之中。</p>\n<p>赋值表达式不仅可以用在推导过程中，而且可以用来编写生成器表达式（generator expression，参见第 32 条）。下面这种写法创建的是迭代器，而不是字典实例，该迭代器每次会给出一对数值，其中第一个元素为产品的名字，第二个元素为这种产品的库存。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84586493980329120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`found = ((name, batches) for name in order\n         if (batches := get_batches(stock.get(name, 0), 8)))\nprint(next(found))\nprint(next(found))\n\n>>>\n(\'screws\', 4)\n(\'wingnuts\', 1)`, `84586493980329120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">found <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> batches<span class="token punctuation">)</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> order\n         <span class="token keyword">if</span> <span class="token punctuation">(</span>batches <span class="token punctuation">:</span><span class="token operator">=</span> get_batches<span class="token punctuation">(</span>stock<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>found<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>found<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">(</span><span class="token string">\'screws\'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>\n<span class="token punctuation">(</span><span class="token string">\'wingnuts\'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-25"><a href="#%E6%80%BB%E7%BB%93-25" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>编写推导式与生成器表达式时，可以在描述条件的那一部分通过赋值表达式定义变量，并在其他部分复用该变量，可使程序简单易读。</li>\n<li>对于推导式与生成器表达式来说，虽然赋值表达式也可以出现在描述条件的那一部分之外，但最好别这么写。</li>\n</ol>\n<h2 id="第-30-条：不要让函数直接返回列表，应该让它逐个生成列表里的值"><a href="#%E7%AC%AC-30-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E8%AE%A9%E5%87%BD%E6%95%B0%E7%9B%B4%E6%8E%A5%E8%BF%94%E5%9B%9E%E5%88%97%E8%A1%A8%EF%BC%8C%E5%BA%94%E8%AF%A5%E8%AE%A9%E5%AE%83%E9%80%90%E4%B8%AA%E7%94%9F%E6%88%90%E5%88%97%E8%A1%A8%E9%87%8C%E7%9A%84%E5%80%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 30 条：不要让函数直接返回列表，应该让它逐个生成列表里的值</h2>\n<p>如果函数要返回的是个包含许多结果的序列，那么最简单的办法就是把这些结果放到列表中。例如，我们要返回字符串里每个单词的首字母所对应的下标。下面这种写法，会把每次遇到的新单词所在的位置追加（append）到存放结果的 result 列表中，在函数末尾返回这份列表。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68210526282715400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def index_words(text):\n    result = []\n    if text:\n        result.append(0)\n    for index, letter in enumerate(text):\n        if letter == \' \':\n            result.append(index + 1)\n    return result`, `68210526282715400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">index_words</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">if</span> text<span class="token punctuation">:</span>\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> index<span class="token punctuation">,</span> letter <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> letter <span class="token operator">==</span> <span class="token string">\' \'</span><span class="token punctuation">:</span>\n            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们把一段范例文本传给这个函数，它可以返回正确的结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53802811291710030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`address = \'Four score and seven years ago...\'\nresult = index_words(address)\nprint(result)\n\n>>>\n[0, 5, 11, 15, 21, 27]`, `53802811291710030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">address <span class="token operator">=</span> <span class="token string">\'Four score and seven years ago...\'</span>\nresult <span class="token operator">=</span> index_words<span class="token punctuation">(</span>address<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>index_words 函数有两个缺点。</p>\n<ol>\n<li>\n<p>它的代码看起来有点杂乱。每找到一个新单词，它都要调用 append 方法，而调用这个方法时，必须写上 result.append 这样一串字符，这就把我们想要强调的重点，也就是这个新单词在字符串中的位置（index + 1）淡化了。另外，函数还必须专门用一行代码创建这个保存结果的 result 列表，并且要用一条 return 语句把它返回给调用者。这样算下来，虽然函数的主体部分大约有 130 个字符（非空白的），但真正重要的只有 75 个左右。</p>\n<p>这种函数改用生成器（generator）来实现会比较好。生成器由包含 yield 表达式的函数创建。下面就定义一个生成器函数，实现与刚才那个函数相同的效果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81785559342941030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def index_words_iter(text):\n  if text:\n     yield 0\n  for index, letter in enumerate(text):\n     if letter == \' \':\n           yield index + 1\n\naddress = \'Four score and seven years ago...\'\nresult = index_words_iter(address)\nprint(list(result))`, `81785559342941030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">index_words_iter</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  <span class="token keyword">if</span> text<span class="token punctuation">:</span>\n     <span class="token keyword">yield</span> <span class="token number">0</span>\n  <span class="token keyword">for</span> index<span class="token punctuation">,</span> letter <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">if</span> letter <span class="token operator">==</span> <span class="token string">\' \'</span><span class="token punctuation">:</span>\n           <span class="token keyword">yield</span> index <span class="token operator">+</span> <span class="token number">1</span>\n\naddress <span class="token operator">=</span> <span class="token string">\'Four score and seven years ago...\'</span>\nresult <span class="token operator">=</span> index_words_iter<span class="token punctuation">(</span>address<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>它必须把所有的结果都保存到列表中，然后才能返回列表。如果输入的数据特别多，那么程序可能会因为耗尽内存而崩溃。</p>\n<p>相反，用生成器函数来实现，就不会有这个问题了。它可以接受长度任意的输入信息，并把内存消耗量压得比较低。例如下面这个生成器，只需要把当前这行文字从文件中读进来就行，每次推进的时候，它都只处理一个单词，直到把当前这行文字处理完毕，才读入下一行文字。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="63608587068533604000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\ndef index_file(handle):\n  offset = 0\n  for line in handle:\n     if line:\n           yield offset\n     for letter in line:\n           offset += 1\n           if letter == \' \':\n              yield offset\n\nwith open(\'address.txt\', \'r\') as f:\n  it = index_file(f)\n  results = itertools.islice(it, 0, 10)\n  print(list(results))`, `63608587068533604000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\n<span class="token keyword">def</span> <span class="token function">index_file</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">:</span>\n  offset <span class="token operator">=</span> <span class="token number">0</span>\n  <span class="token keyword">for</span> line <span class="token keyword">in</span> handle<span class="token punctuation">:</span>\n     <span class="token keyword">if</span> line<span class="token punctuation">:</span>\n           <span class="token keyword">yield</span> offset\n     <span class="token keyword">for</span> letter <span class="token keyword">in</span> line<span class="token punctuation">:</span>\n           offset <span class="token operator">+=</span> <span class="token number">1</span>\n           <span class="token keyword">if</span> letter <span class="token operator">==</span> <span class="token string">\' \'</span><span class="token punctuation">:</span>\n              <span class="token keyword">yield</span> offset\n\n<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'address.txt\'</span><span class="token punctuation">,</span> <span class="token string">\'r\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n  it <span class="token operator">=</span> index_file<span class="token punctuation">(</span>f<span class="token punctuation">)</span>\n  results <span class="token operator">=</span> itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>it<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>\n  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>该函数运行时所耗的内存，取决于文件中最长的那一行所包含的字符数。把刚才那份输入数据存放到 address.txt 文件，让这个函数去读取并用它所返回的生成器构建一份列表，可以看到跟原来相同的结果（islice 函数的详细用法，参见第 36 条）。</p>\n<p>定义这种生成器函数的时候，只有一个地方需要注意，就是调用者无法重复使用函数所返回的迭代器，因为这些迭代器是有状态的（参见第 31 条）。</p>\n</li>\n</ol>\n<h3 id="总结-26"><a href="#%E6%80%BB%E7%BB%93-26" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>用生成器来实现比让函数把结果收集合到列表里再返回，要更加清晰一些。</li>\n<li>生成器函数所返回的迭代器可以产生一系列值，每次产生的那个值都是由函数体的下一条 yield 表达式所决定的。</li>\n<li>不管输入的数据量有多大，生成器函数每次都只需要根据其中的一小部分来计算当前这次的输出值。它不用把整个输入值全都读取进来，也不用一次就把所有的输出值全都算好。</li>\n</ol>\n<h2 id="第-31-条：谨慎地迭代函数所收到的参数"><a href="#%E7%AC%AC-31-%E6%9D%A1%EF%BC%9A%E8%B0%A8%E6%85%8E%E5%9C%B0%E8%BF%AD%E4%BB%A3%E5%87%BD%E6%95%B0%E6%89%80%E6%94%B6%E5%88%B0%E7%9A%84%E5%8F%82%E6%95%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 31 条：谨慎地迭代函数所收到的参数</h2>\n<p>如果函数接受的参数是个包含许多对象的列表，那么这份列表有可能要迭代多次。例如，我们要分析美国得克萨斯州的游客数量。原始数据保存在一份列表中，其中的每个元素表示每年有多少游客到这个城市旅游（单位是百万）。我们现在要统计每个城市的游客数占游客总数的百分比。</p>\n<p>为了求出这份数据，先把列表里的所有元素加起来求出游客总数，然后，分别用每个城市的游客数除以游客总数计算出该城市在总数据中所占的百分比。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48445034911093195000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize(numbers):\n    total = sum(numbers)\n    result = []\n    for value in numbers:\n        percent = 100 * value / total\n        result.append(percent)\n    return result`, `48445034911093195000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>把一份范例数据放到列表中传给这个函数，可以得到正确的结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="87463403041991920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize(numbers):\n    total = sum(numbers)\n    result = []\n    for value in numbers:\n        percent = 100 * value / total\n        result.append(percent)\n    return result\n\n\nvisits = [15, 35, 80]\npercentages = normalize(visits)\nprint(percentages)\nassert sum(percentages) == 100.0\n\n>>>\n[11.538461538461538, 26.923076923076923, 61.53846153846154]`, `87463403041991920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result\n\n\nvisits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>\npercentages <span class="token operator">=</span> normalize<span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">11.538461538461538</span><span class="token punctuation">,</span> <span class="token number">26.923076923076923</span><span class="token punctuation">,</span> <span class="token number">61.53846153846154</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为了应对规模更大的数据，我们现在需要让程序能够从文件中读取信息，并假设得克萨斯州所有城市的游客数都放在这份文件中。笔者决定用生成器实现，因为这样做可以让我们把同样的功能套用在其他数据上面，例如分析全世界（而不仅仅是得克萨斯一州）各城市的游客数。那些场合的数据量与内存用量可能会比现在大得多（参见第 30 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8113089951782237000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def read_visits(data_path):\n    with open(data_path)as f:\n        for line in f:\n            yield int(line)`, `8113089951782237000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">read_visits</span><span class="token punctuation">(</span>data_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>data_path<span class="token punctuation">)</span><span class="token keyword">as</span> f<span class="token punctuation">:</span>\n        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>奇怪的是，对 <code class="language-text">read_visits</code> 所返回的迭代器调用 normalize 函数后，并没有得到结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84241028163972660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = read_visits(\'my_numbers.txt\')\npercentages = normalize(it)\nprint(percentages)\n\n>>>\n[]`, `84241028163972660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> read_visits<span class="token punctuation">(</span><span class="token string">\'my_numbers.txt\'</span><span class="token punctuation">)</span>\npercentages <span class="token operator">=</span> normalize<span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>出现这种状况的原因在于，迭代器只能产生一次结果。假如迭代器或生成器已经抛出过 StopIteration 异常，继续用它来构造列表或是像 normalize 那样对它做 for 循环，那它不会给出任何结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="47838821756164630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = read_visits(\'my_numbers.txt\')\nprint(list(it))\nprint(list(it))  # Already exhausted\n\n>>>\n[15, 35, 80]\n[]`, `47838821756164630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> read_visits<span class="token punctuation">(</span><span class="token string">\'my_numbers.txt\'</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Already exhausted</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>还有个因素也很令人迷惑，那就是：在已经把数据耗完的迭代器上面继续迭代，程序居然不报错。for 循环、list 构造器以及 Python 标准库的其他许多函数，都认为迭代器在正常的操作过程中抛出 StopIteration 异常是很自然的。它们没办法区分，这个迭代器是本身就没有数据可以提供，还是虽然有数据，但现在已经耗尽了。</p>\n<p>为了解决这个问题，我们可以把外界传入的迭代器特意遍历一整轮，从而将其中的内容复制到一份列表里。这样的话，以后就可以用这份列表来处理数据了，那时想迭代多少遍都可以。下面的函数与原来的 normalize 函数功能相同，但是它会把收到的那个 numbers 迭代器所能提供的数据明确地复制到 <code class="language-text">numbers_copy</code> 列表里。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62626278332733776000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize_copy(numbers):\n    numbers_copy = list(numbers)  # Copy the iterator\n    total = sum(numbers_copy)\n    result = []\n    for value in numbers_copy:\n        percent = 100 * value / total\n        result.append(percent)\n    return result`, `62626278332733776000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize_copy</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    numbers_copy <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>  <span class="token comment"># Copy the iterator</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers_copy<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers_copy<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在的这个函数就可以正确处理 <code class="language-text">read_visits</code> 生成器函数所返回的 it 值了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78821577000202730000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = read_visits(\'my_numbers.txt\')\npercentages = normalize_copy(it)\nprint(percentages)\nassert sum(percentages) == 100.0`, `78821577000202730000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> read_visits<span class="token punctuation">(</span><span class="token string">\'my_numbers.txt\'</span><span class="token punctuation">)</span>\npercentages <span class="token operator">=</span> normalize_copy<span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个办法虽然能解决问题，但如果输入给它的迭代器所要提供的数据量相当庞大，那么有可能导致程序在复制迭代器时，因耗尽内存而崩溃。所以，把这个方案用在大规模的数据集合上面，会抵消掉 <code class="language-text">read_visits</code> 的好处。编写那样一个函数，就是不想让程序把整套数据全都读取进来，而是可以一条一条地处理。为了应对大规模的数据，其中一个变通方案是让 normalize 函数接受另外一个函数（也就是下面的 <code class="language-text">get_iter</code>），使它每次要使用迭代器时，都去向那个函数索要。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41814854607500870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize_func(get_iter):\n    total = sum(get_iter())  # New iterator\n    result = []\n    for value in get_iter():  # New iterator\n        percent = 100 * value / total\n        result.append(percent)\n    return result`, `41814854607500870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize_func</span><span class="token punctuation">(</span>get_iter<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>get_iter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># New iterator</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> get_iter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># New iterator</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用 <code class="language-text">normalize_func</code> 函数时，需要传入一条 <code class="language-text">lambda</code> 表达式，让这个表达式去调用 <code class="language-text">read_visits</code> 生成器函数。这样 <code class="language-text">normalize_func</code> 每次向 <code class="language-text">get_iter</code> 索要迭代器时，程序都会给出一个新的迭代器。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97212251518168940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`path = \'my_numbers.txt\'\npercentages = normalize_func(lambda: read_visits(path))\nprint(percentages)\nassert sum(percentages) == 100.0`, `97212251518168940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">path <span class="token operator">=</span> <span class="token string">\'my_numbers.txt\'</span>\npercentages <span class="token operator">=</span> normalize_func<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> read_visits<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样做虽然可行，但传入这么一个 lambda 表达式显得有点儿生硬。要想用更好的办法解决这个问题，可以新建一种容器类，让它实现迭代器协议（iterator protocol）。</p>\n<p>Python 的 for 循环及相关的表达式，正是按照迭代器协议来遍历容器内容的。Python 执行 <code class="language-text">for x in foo</code> 这样的语句时，实际上会调用 iter(foo)，也就是把 foo 传给内置的 iter 函数。这个函数会触发名为 <code class="language-text">foo.__iter__</code> 的特殊方法，该方法必须返回迭代器对象（这个迭代器对象本身要实现 <code class="language-text">__next__</code> 特殊方法）。最后，Python 会用迭代器对象反复调用内置的 next 函数，直到数据耗尽为止（如果抛出 StopIteration 异常，就表示数据已经迭代完了）。</p>\n<p>这个过程听上去比较复杂，但总结起来，其实只需要让你的类在实现 <code class="language-text">__iter__</code> 方法时，按照生成器的方式来写就好。下面定义这样一种可迭代的容器类，用来读取文件中的游客数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96699480974414740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ReadVisits:\n    def __init__(self, data_path):\n        self.data_path = data_path\n\n    def __iter__(self):\n        with open(self.data_path) as f:\n            for line in f:\n                yield int(line)`, `96699480974414740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ReadVisits</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data_path <span class="token operator">=</span> data_path\n\n    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>\n                <span class="token keyword">yield</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们只需要把新的容器传给最早的那个 normalize 函数运行即可，函数本身的代码不需要修改。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49346786475695010000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize(numbers):\n    total = sum(numbers)\n    result = []\n    for value in numbers:\n        percent = 100 * value / total\n        result.append(percent)\n    return result\n\n\nclass ReadVisits:\n    def __init__(self, data_path):\n        self.data_path = data_path\n\n    def __iter__(self):\n        with open(self.data_path) as f:\n            for line in f:\n                yield int(line)\n\n\npath = \'my_numbers.txt\'\nvisits = ReadVisits(path)\npercentages = normalize(visits)\nprint(percentages)\nassert sum(percentages) == 100.0`, `49346786475695010000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result\n\n\n<span class="token keyword">class</span> <span class="token class-name">ReadVisits</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data_path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>data_path <span class="token operator">=</span> data_path\n\n    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data_path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>\n                <span class="token keyword">yield</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>\n\n\npath <span class="token operator">=</span> <span class="token string">\'my_numbers.txt\'</span>\nvisits <span class="token operator">=</span> ReadVisits<span class="token punctuation">(</span>path<span class="token punctuation">)</span>\npercentages <span class="token operator">=</span> normalize<span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样做为什么可行呢？因为 normalize 函数里面的 sum 会触发 <code class="language-text">ReadVisits.__iter__</code>，让系统分配一个新的迭代器对象给它。接下来，normalize 通过 for 循环计算每项数据占总值的百分比时，又会触发 <code class="language-text">__iter__</code>，于是系统会分配另一个迭代器对象。这些迭代器各自推进，其中一个迭代器把数据耗尽，并不会影响其他迭代器。所以，在每一个迭代器上面遍历，都可以分别看到一套完整的数据。这种方案的唯一缺点，就是多次读取输入数据。</p>\n<p>明白了 ReadVisits 这种容器的工作原理后，我们就可以在编写函数和方法时先确认一下，收到的应该是像 ReadVisits 这样的容器，而不是普通的迭代器。按照协议，如果将普通的迭代器传给内置的 iter 函数，那么函数会把迭代器本身返回给调用者。反之，如果传来的是容器类型，那么 iter 函数就会返回一个新的迭代器对象。我们可以借助这条规律，判断输入值是不是这种容器。如果不是，就抛出 TypeError 异常，因为我们没办法在那样的值上面重复遍历。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62238990015203150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize_defensive(numbers):\n    if iter(numbers) is numbers:  # An iterator -- bad!\n        raise TypeError(\'Must supply a container\')\n    total = sum(numbers)\n    result = []\n    for value in numbers:\n        percent = 100 * value / total\n        result.append(percent)\n    return result`, `62238990015203150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize_defensive</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token keyword">is</span> numbers<span class="token punctuation">:</span>  <span class="token comment"># An iterator -- bad!</span>\n        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">\'Must supply a container\'</span><span class="token punctuation">)</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>还有一种写法也可以检测出这样的问题。collections.abc 内置模块里定义了名为 Iterator 的类，它用在 isinstance 函数中，可以判断自己收到的参数是不是这种实例。如果是，就抛出异常（参见第 43 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91485205030526100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def normalize_defensive(numbers):\n    if isinstance(numbers, Iterator):  # Another way to check\n        raise TypeError(\'Must supply a container\')\n    total = sum(numbers)\n    result = []\n    for value in numbers:\n        percent = 100 * value / total\n        result.append(percent)\n    return result`, `91485205030526100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">normalize_defensive</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> Iterator<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Another way to check</span>\n        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">\'Must supply a container\'</span><span class="token punctuation">)</span>\n    total <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>\n    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> value <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>\n        percent <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> value <span class="token operator">/</span> total\n        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>percent<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种自定义容器的方案，最适合于既不想像 <code class="language-text">normalize_copy</code> 函数一样，把迭代器提供的这套数据全部复制一份，同时又要多次遍历这套数据的情况。该方案不仅支持自定义容器，还支持系统自带的列表类型，因为这些全都属于遵循迭代器协议的可迭代容器。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82783444563677900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`visits = [15, 35, 80]\npercentages = normalize_defensive(visits)\nassert sum(percentages) == 100.0\n\npath = \'my_numbers.txt\'\nvisits = ReadVisits(path)\npercentages = normalize_defensive(visits)\nassert sum(percentages) == 100.0`, `82783444563677900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">visits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>\npercentages <span class="token operator">=</span> normalize_defensive<span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span>\n\npath <span class="token operator">=</span> <span class="token string">\'my_numbers.txt\'</span>\nvisits <span class="token operator">=</span> ReadVisits<span class="token punctuation">(</span>path<span class="token punctuation">)</span>\npercentages <span class="token operator">=</span> normalize_defensive<span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\n<span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>percentages<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果输入的是普通迭代器而不是容器，那么 <code class="language-text">normalize_defensive</code> 就会抛出异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="22851971371736710000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`visits = [15, 35, 80]\nit = iter(visits)\nnormalize_defensive(it)\n\n>>>\nTraceback ...\nTypeError: Must supply a container`, `22851971371736710000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">visits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span>\nit <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>visits<span class="token punctuation">)</span>\nnormalize_defensive<span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> Must supply a container</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种思路也适用于异步的迭代器（示例参见第 61 条）。</p>\n<h3 id="总结-27"><a href="#%E6%80%BB%E7%BB%93-27" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>函数和方法如果要把收到的参数遍历很多遍，那就必须特别小心。因为如果这些参数为迭代器，那么程序可能得不到预期的值，从而出现奇怪的效果。</li>\n<li>Python 的迭代器协议确定了容器与迭代器应该怎样跟内置的 iter 及 next 函数、for 循环及相关的表达式交互。</li>\n<li>要想让自定义的容器类型可以迭代，只需要把 <code class="language-text">__iter__</code> 方法实现为生成器即可。</li>\n<li>可以把值传给 iter 函数，检测它返回的是不是那个值本身。如果是，就说明这是个普通的迭代器，而不是一个可以迭代的容器。另外，也可以用内置的 isinstance 函数判断该值是不是 collections.abc.Iterator 类的实例。</li>\n</ol>\n<h2 id="第-32-条：考虑用生成器表达式改写数据量较大的列表推导"><a href="#%E7%AC%AC-32-%E6%9D%A1%EF%BC%9A%E8%80%83%E8%99%91%E7%94%A8%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%94%B9%E5%86%99%E6%95%B0%E6%8D%AE%E9%87%8F%E8%BE%83%E5%A4%A7%E7%9A%84%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 32 条：考虑用生成器表达式改写数据量较大的列表推导</h2>\n<p>列表推导可以根据输入序列中的每个元素创建一个包含派生元素的新列表（参见第 27 条）。如果输入的数据量比较小，那么这样做没问题，但如果数据量很大，那么程序就有可能因为内存耗尽而崩溃。</p>\n<p>例如，我们要读取一份文件并返回每行的字符数。假如采用列表推导来实现，那需要把文件中的每行文本都载入内存，并统计长度。对于庞大的文件，或者像 network socket 这样无休止的输入来说，这么写恐怕有问题。下面就是采用列表推导写的代码，它只能处理输入数据量比较少的情况。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71350290568132430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`value = [len(x) for x in open(\'my_file.txt\')]\nprint(value)`, `71350290568132430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'my_file.txt\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>要想处理大规模的数据，可以使用生成器表达式（generator expression）来做，它扩展了列表推导式与生成器机制。程序在对生成器表达式求值时，并不会让它把包含输出结果的那个序列立刻构建出来，而是会把它当成一个迭代器，该迭代器每次可以根据表达式中的逻辑给出一项结果。</p>\n<p>生成器表达式的写法，与列表推导式语法类似，但它是写在一对圆括号内，而不是方括号里面。下面这种写法的效果与刚才一样，但是程序并不会立刻给出全部结果，而是先将生成器表达式表示成一个迭代器返回。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94599943936605140000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = (len(x) for x in open(\'my_file.txt\'))\nprint(it)\n\n>>>\n<generator object <genexpr> at 0x7f13063e03c0>`, `94599943936605140000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'my_file.txt\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token operator">&lt;</span>generator <span class="token builtin">object</span> <span class="token operator">&lt;</span>genexpr<span class="token operator">></span> at <span class="token number">0x7f13063e03c0</span><span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>返回的迭代器每次可以推进一步，这时它会根据生成表达式的逻辑计算出下一项输出结果（这项结果可以通过内置的 next 函数取得）。需要多少项结果，就把迭代器推进多少次，这种采用生成器表达式来实现的写法不会消耗太多内存。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77739207796649120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(next(it))\nprint(next(it))`, `77739207796649120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>生成器表达式还有个强大的特性，就是可以组合起来。例如，可以用刚才那条生成器表达式所形成的 it 迭代器作为输入，编写一条新的生成器表达式。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75483166467766160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`it = (len(x) for x in open(\'my_file.txt\'))\nroots = ((x, x ** 0.5) for x in it)\nprint(roots)`, `75483166467766160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">it <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">\'my_file.txt\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nroots <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> x <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> it<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>roots<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这条表达式所形成的 roots 迭代器每次推进时，会引发连锁反应：它也推进内部迭代器 it 以判断当前是否还能在 it 上面继续迭代，如果可以，就把 it 所返回的值代入 <code class="language-text">(x, x ** 0.5)</code> 里面求出结果。这种写法使用的内存同样不会太多。</p>\n<p>多个生成器嵌套而成的代码，执行起来还是相当快的。所以，如果要对数据量很大的输入流做一系列处理，那么生成器表达式应该是个很好的选择。唯一需要注意的是，生成器表达式返回的迭代器是有状态的，跑完一整轮之后，就不能继续使用了（参见第 31 条）。</p>\n<h3 id="总结-28"><a href="#%E6%80%BB%E7%BB%93-28" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>通过列表推导来处理大量的输入数据，可能会占用许多内存。</li>\n<li>改用生成器表达式来做，可以避免内存使用量过大的问题，因为这种表达式所形成的迭代器每次只会计算一项结果。</li>\n<li>生成器表达式所形成的迭代器可以当成 for 语句的子表达式出现在另一个生成器表达式里。</li>\n<li>把生成器表达式组合起来使用，能够写出执行速度快且占用内存少的代码。</li>\n</ol>\n<h2 id="第-33-条：通过-yield-from-把多个生成器连起来用"><a href="#%E7%AC%AC-33-%E6%9D%A1%EF%BC%9A%E9%80%9A%E8%BF%87-yield-from-%E6%8A%8A%E5%A4%9A%E4%B8%AA%E7%94%9F%E6%88%90%E5%99%A8%E8%BF%9E%E8%B5%B7%E6%9D%A5%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 33 条：通过 yield from 把多个生成器连起来用</h2>\n<p>生成器有很多好处（参见第 30 条），而且能够解决许多常见的问题（参见第 31 条）。生成器的用途特别广，所以许多程序都会频繁使用它们，而且是一个连着一个地用。</p>\n<p>例如，我们要编写一个图形程序，让它在屏幕上面移动图像，从而形成动画效果。假设要实现这样一段动画：图片先快速移动一段时间，然后暂停，接下来慢速移动一段时间。为了把移动与暂停表示出来，笔者定义了下面两个生成器函数，让它们分别给出图片在当前时间段内应该保持的速度。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31461818823382080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def move(period, speed):\n    for _ in range(period):\n        yield speed\n\n\ndef pause(delay):\n    for _ in range(delay):\n        yield 0`, `31461818823382080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">move</span><span class="token punctuation">(</span>period<span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> speed\n\n\n<span class="token keyword">def</span> <span class="token function">pause</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为了把完整的动画制作出来，需要将 move 与 pause 连起来使用，从而算出这张图片当前的位置与上一个位置之差。下面的函数用三个 for 循环来表示动画的三个环节，在每一个环节里，它都通过 yield 把图片当前的位置与上一次的位置之差 delta 返回给调用者。根据 animate 函数返回的 delta 值，即可把整段动画做好。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77818736846443500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def animate():\n    for delta in move(4, 5.0):\n        yield delta\n    for delta in pause(3):\n        yield delta\n    for delta in move(2, 3.0):\n        yield delta`, `77818736846443500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> delta <span class="token keyword">in</span> move<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> delta\n    <span class="token keyword">for</span> delta <span class="token keyword">in</span> pause<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> delta\n    <span class="token keyword">for</span> delta <span class="token keyword">in</span> move<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> delta</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>接下来，我们就根据 animate 生成器所给出的 delta 值，把整个动画效果渲染出来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58455641563620020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def render(delta):\n    print(f\'Delta: {delta:.1f}\')\n    # Move the images onscreen\n\n\ndef run(func):\n    for delta in func():\n        render(delta)\n\n\nrun(animate)\n\n>>>\nDelta: 5.0\nDelta: 5.0\nDelta: 5.0\nDelta: 5.0\nDelta: 0.0\nDelta: 0.0\nDelta: 0.0\nDelta: 3.0\nDelta: 3.0`, `58455641563620020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">render</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Delta: </span><span class="token interpolation"><span class="token punctuation">{</span>delta<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n    <span class="token comment"># Move the images onscreen</span>\n\n\n<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> delta <span class="token keyword">in</span> func<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        render<span class="token punctuation">(</span>delta<span class="token punctuation">)</span>\n\n\nrun<span class="token punctuation">(</span>animate<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">3.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">3.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法的问题在于，animate 函数里有很多重复的地方。比如它反复使用 for 结构来操纵生成器，而且每个 for 结构都使用相同的 yield 表达式，这样看上去很啰唆。这个例子仅仅连用了三个生成器，就让代码变得如此烦琐，若是动画里面有十几或几十个环节，那么代码读起来会更加困难。</p>\n<p>为了解决这个问题，我们可以改用 yield from 形式的表达式来实现。这种形式，会先从嵌套进去的小生成器里面取值，如果该生成器已经用完，那么程序的控制流程就会回到 yield from 所在的这个函数之中，然后它有可能进入下一套 yield from 逻辑。下面这段代码，用 yield from 语句重新实现了 animate 函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74265707175787320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def animate_composed():\n    yield from move(4, 5.0)\n    yield from pause(3)\n    yield from move(2, 3.0)\n\nrun(animate_composed)\n\n>>>\nDelta: 5.0\nDelta: 5.0\nDelta: 5.0\nDelta: 5.0\nDelta: 0.0\nDelta: 0.0\nDelta: 0.0\nDelta: 3.0\nDelta: 3.0`, `74265707175787320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">animate_composed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> move<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> pause<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> move<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">)</span>\n\nrun<span class="token punctuation">(</span>animate_composed<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">5.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">0.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">3.0</span>\nDelta<span class="token punctuation">:</span> <span class="token number">3.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>它的运行结果与刚才一样，但是代码看上去更清晰、更直观了。Python 解释器看到 yield from 形式的表达式后，会自己想办法实现与带有普通 yield 语句的 for 循环相同的效果，而且这种实现方式要更快。下面采用内置的 timeit 模块编写并运行一个 micro-benchmark 试试。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52119799205969610000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import timeit\n\n\ndef child():\n    for i in range(1_000_000):\n        yield i\n\n\ndef slow():\n    for i in child():\n        yield i\n\n\ndef fast():\n    yield from child()\n\n\nbaseline = timeit.timeit(\n    stmt=\'for _ in slow(): pass\',\n    globals=globals(),\n    number=50)\nprint(f\'Manual nesting {baseline:.2f}s\')\ncomparison = timeit.timeit(\n    stmt=\'for _ in fast(): pass\',\n    globals=globals(),\n    number=50)\nprint(f\'Composed nesting {comparison:2f}s\')\nreduction = -(comparison - baseline)/baseline\nprint(f\'{reduction:.1%} less time\')\n\n>>>\nManual nesting 3.70s\nComposed nesting 3.319963s\n10.2% less time`, `52119799205969610000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> timeit\n\n\n<span class="token keyword">def</span> <span class="token function">child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>1_000_000<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> i\n\n\n<span class="token keyword">def</span> <span class="token function">slow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> child<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> i\n\n\n<span class="token keyword">def</span> <span class="token function">fast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> child<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n\nbaseline <span class="token operator">=</span> timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>\n    stmt<span class="token operator">=</span><span class="token string">\'for _ in slow(): pass\'</span><span class="token punctuation">,</span>\n    <span class="token builtin">globals</span><span class="token operator">=</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    number<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Manual nesting </span><span class="token interpolation"><span class="token punctuation">{</span>baseline<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">s\'</span></span><span class="token punctuation">)</span>\ncomparison <span class="token operator">=</span> timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>\n    stmt<span class="token operator">=</span><span class="token string">\'for _ in fast(): pass\'</span><span class="token punctuation">,</span>\n    <span class="token builtin">globals</span><span class="token operator">=</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    number<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Composed nesting </span><span class="token interpolation"><span class="token punctuation">{</span>comparison<span class="token punctuation">:</span><span class="token format-spec">2f</span><span class="token punctuation">}</span></span><span class="token string">s\'</span></span><span class="token punctuation">)</span>\nreduction <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>comparison <span class="token operator">-</span> baseline<span class="token punctuation">)</span><span class="token operator">/</span>baseline\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>reduction<span class="token punctuation">:</span><span class="token format-spec">.1%</span><span class="token punctuation">}</span></span><span class="token string"> less time\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nManual nesting <span class="token number">3.</span>70s\nComposed nesting <span class="token number">3.</span>319963s\n<span class="token number">10.2</span><span class="token operator">%</span> less time</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>所以，如果要把多个生成器连起来用，那么笔者强烈建议优先考虑 yield from 表达式。</p>\n<h3 id="总结-29"><a href="#%E6%80%BB%E7%BB%93-29" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>如果要连续使用多个生成器，那么可以通过 yield from 表达式来分别使用这些生成器，这样做能够免去重复的 for 结构。</li>\n<li>yield from 的性能要胜过那种在 for 循环里手工编写 yield 表达式的方案。</li>\n</ol>\n<h2 id="第-34-条：不要用-send-给生成器注入数据"><a href="#%E7%AC%AC-34-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E7%94%A8-send-%E7%BB%99%E7%94%9F%E6%88%90%E5%99%A8%E6%B3%A8%E5%85%A5%E6%95%B0%E6%8D%AE" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 34 条：不要用 send 给生成器注入数据</h2>\n<p>yield 表达式让我们能够轻松地写出生成器函数，使得调用者可以每次只获取输出序列中的一项结果（参见第 30 条）。但问题是，这种通道是单向的，也就是说，无法让生成器在其一端接收数据流，同时在另一端给出计算结果。假如能实现双向通信，那么生成器的适用面会更广。</p>\n<p>例如，我们想用软件实现无线电广播，用它来发送信号。为了编写这个程序，我们必须用一个函数来模拟正弦波，让它能够给出一系列按照正弦方式分布的点。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57718363004657270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import math\n\n\ndef wave(amplitude, steps):\n    step_size = 2 * math.pi / steps\n    for step in range(steps):\n        radians = step * step_size\n        fraction = math.sin(radians)\n        output = amplitude * fraction\n        yield output`, `57718363004657270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> math\n\n\n<span class="token keyword">def</span> <span class="token function">wave</span><span class="token punctuation">(</span>amplitude<span class="token punctuation">,</span> steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    step_size <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">/</span> steps\n    <span class="token keyword">for</span> step <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        radians <span class="token operator">=</span> step <span class="token operator">*</span> step_size\n        fraction <span class="token operator">=</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>radians<span class="token punctuation">)</span>\n        output <span class="token operator">=</span> amplitude <span class="token operator">*</span> fraction\n        <span class="token keyword">yield</span> output</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>有了这个 wave 函数，我们可以让它按照某个固定的振幅生成一系列可供传输的值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10257754774916129000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def transmit(output):\n    if output is None:\n        print(f\'Output is None\')\n    else:\n        print(f\'Output: {output:>5.1f}\')\n\n\ndef run(it):\n    for output in it:\n        transmit(output)\n\n\nrun(wave(3.0, 8))\n\n>>>\nOutput:   0.0\nOutput:   2.1\nOutput:   3.0\nOutput:   2.1\nOutput:   0.0\nOutput:  -2.1\nOutput:  -3.0\nOutput:  -2.1`, `10257754774916129000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">transmit</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> output <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output is None\'</span></span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output: </span><span class="token interpolation"><span class="token punctuation">{</span>output<span class="token punctuation">:</span><span class="token format-spec">>5.1f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> output <span class="token keyword">in</span> it<span class="token punctuation">:</span>\n        transmit<span class="token punctuation">(</span>output<span class="token punctuation">)</span>\n\n\nrun<span class="token punctuation">(</span>wave<span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.1</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">3.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.1</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">2.1</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">3.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">2.1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写可以生成基本的波形，但问题是，该函数在产生这些值的时候，只能按照刚开始给定的振幅来计算，而没办法使振幅在整个生成过程中根据某个因素发生变化（例如在发送调幅广播信号时，我们就需要这么做）。现在，我们要让生成器在计算每个值的时候，都能考虑到振幅的变化，从而实现调幅。</p>\n<p>Python 的生成器支持 send 方法，这可以让生成器变为双向通道。send 方法可以把参数发给生成器，让它成为上一条 yield 表达式的求值结果，并将生成器推进到下一条 yield 表达式，然后把 yield 右边的值返回给 send 方法的调用者。然而在一般情况下，我们还是会通过内置的 next 函数来推进生成器，按照这种写法，上一条 yield 表达式的求值结果总是 None。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64500017482877990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def my_generator():\n    received = yield 1\n    print(f\'received {received}\')\n\n\nit = iter(my_generator())\noutput = next(it)  # Get first generator output\nprint(f\'output = {output}\')\ntry:\n    next(it)  # Run generator until it exits\nexcept StopIteration:\n    pass\n\n>>>\noutput = 1\nreceived None`, `64500017482877990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">my_generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    received <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token number">1</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'received </span><span class="token interpolation"><span class="token punctuation">{</span>received<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nit <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>my_generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\noutput <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>  <span class="token comment"># Get first generator output</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'output = </span><span class="token interpolation"><span class="token punctuation">{</span>output<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    <span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>  <span class="token comment"># Run generator until it exits</span>\n<span class="token keyword">except</span> StopIteration<span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\noutput <span class="token operator">=</span> <span class="token number">1</span>\nreceived <span class="token boolean">None</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果不通过 for 循环或内置的 next 函数推进生成器，而是改用 send 方法，那么调用方法时传入的参数就会成为上一条 yield 表达式的值，生成器拿到这个值后，会继续运行到下一条 yield 表达式那里。可是，刚开始推进生成器的时候，它是从头执行的，而不是从某一条 yield 表达式那里继续的，所以，首次调用 send 方法时，只能传 None，要是传入其他值，程序运行时就会抛出异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14278440160944527000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def my_generator():\n    received = yield 1\n    print(f\'received {received}\')\n\n\nit = iter(my_generator())\noutput = it.send(None)  # Get first generator output\nprint(f\'output {output}\')\ntry:\n    it.send(\'hello!\')  # Send value into the generator\nexcept StopIteration:\n    pass\n\n>>>\noutput 1\nreceived hello!`, `14278440160944527000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">my_generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    received <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token number">1</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'received </span><span class="token interpolation"><span class="token punctuation">{</span>received<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\nit <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>my_generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\noutput <span class="token operator">=</span> it<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># Get first generator output</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'output </span><span class="token interpolation"><span class="token punctuation">{</span>output<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    it<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">\'hello!\'</span><span class="token punctuation">)</span>  <span class="token comment"># Send value into the generator</span>\n<span class="token keyword">except</span> StopIteration<span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\noutput <span class="token number">1</span>\nreceived hello!</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们可以利用这种机制让调用者把振幅发送过来，这样函数就能根据这个输入值调整生成的正弦波幅值了。首先修改 wave 函数的代码，让它把 yield 表达式的求值结果（也就是调用者通过 send 发过来的振幅）保存到 amplitude 变量里，这样就能根据该变量计算出下次应该生成的值。</p>\n<p>然后，要修改 run 函数调用 <code class="language-text">wave_modulating</code> 函数的方式。它现在必须把每次所要使用的振幅发给 <code class="language-text">wave_modulating</code> 生成器。首次必须发送 None，因为此时生成器还没有遇到过 yield 表达式，它不需要知道上一条 yield 表达式的求值结果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38026629933477120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import math\n\n\ndef transmit(output):\n    if output is None:\n        print(f\'Output is None\')\n    else:\n        print(f\'Output: {output:>5.1f}\')\n\n\ndef wave_modulating(steps):\n    step_size = 2 * math.pi / steps\n    amplitude = yield  # Receive initial amplitude\n    for step in range(steps):\n        radians = step * step_size\n        fraction = math.sin(radians)\n        output = amplitude * fraction\n        amplitude = yield output  # Receive next amplitude\n\n\ndef run_modulating(it):\n    amplitudes = [None, 7, 7, 7, 2, 2, 2, 2, 10, 10, 10, 10, 10]\n    for amplitude in amplitudes:\n        output = it.send(amplitude)\n        transmit(output)\n\n\nrun_modulating(wave_modulating(12))\n\n>>>\nOutput is None\nOutput:   0.0\nOutput:   3.5\nOutput:   6.1\nOutput:   2.0\nOutput:   1.7\nOutput:   1.0\nOutput:   0.0\nOutput:  -5.0\nOutput:  -8.7\nOutput: -10.0\nOutput:  -8.7\nOutput:  -5.0`, `38026629933477120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> math\n\n\n<span class="token keyword">def</span> <span class="token function">transmit</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> output <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output is None\'</span></span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output: </span><span class="token interpolation"><span class="token punctuation">{</span>output<span class="token punctuation">:</span><span class="token format-spec">>5.1f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">wave_modulating</span><span class="token punctuation">(</span>steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    step_size <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">/</span> steps\n    amplitude <span class="token operator">=</span> <span class="token keyword">yield</span>  <span class="token comment"># Receive initial amplitude</span>\n    <span class="token keyword">for</span> step <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        radians <span class="token operator">=</span> step <span class="token operator">*</span> step_size\n        fraction <span class="token operator">=</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>radians<span class="token punctuation">)</span>\n        output <span class="token operator">=</span> amplitude <span class="token operator">*</span> fraction\n        amplitude <span class="token operator">=</span> <span class="token keyword">yield</span> output  <span class="token comment"># Receive next amplitude</span>\n\n\n<span class="token keyword">def</span> <span class="token function">run_modulating</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    amplitudes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> amplitude <span class="token keyword">in</span> amplitudes<span class="token punctuation">:</span>\n        output <span class="token operator">=</span> it<span class="token punctuation">.</span>send<span class="token punctuation">(</span>amplitude<span class="token punctuation">)</span>\n        transmit<span class="token punctuation">(</span>output<span class="token punctuation">)</span>\n\n\nrun_modulating<span class="token punctuation">(</span>wave_modulating<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nOutput <span class="token keyword">is</span> <span class="token boolean">None</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">3.5</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">1.7</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">1.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">5.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">8.7</span>\nOutput<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">8.7</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">5.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写没问题，程序可以按照每次输入的值调整输出信号的振幅。首次输出的肯定是 None，因为此时 <code class="language-text">wave_modulating</code> 函数并不知道 amplitude 是多少，它只有在运行第一条 yield 表达式后，才能把调用者通过 send 发来的值保存到这个变量里。</p>\n<p>这种写法有个缺点，就是它很难让初次阅读这段代码的人立刻理解它的意思。把 yield 放在赋值语句的右侧，本身就不太直观，因为我们必须先了解生成器的这项高级特性，才能明白 yield 与 send 是如何相互配合的。</p>\n<p>现在假设程序的需求变得更复杂了。这次要生成的载波不是简单的正弦波，而是由多个信号序列构成的复合波形（complex waveform）。要实现这个需求，可以连用几条 yield from 语句，把多个生成器串接起来（参见第 33 条）。下面先验证一下，这种写法能否处理振幅固定的简单情况。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40523215243092795000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def complex_wave():\n    yield from wave(7.0, 3)\n    yield from wave(2.0, 4)\n    yield from wave(10.0, 5)\n\n\nrun(complex_wave())\n\n>>>\nOutput:   0.0\nOutput:   6.1\nOutput:  -6.1\nOutput:   0.0\nOutput:   2.0\nOutput:   0.0\nOutput:  -2.0\nOutput:   0.0\nOutput:   9.5\nOutput:   5.9\nOutput:  -5.9\nOutput:  -9.5`, `40523215243092795000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">complex_wave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave<span class="token punctuation">(</span><span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave<span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave<span class="token punctuation">(</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>\n\n\nrun<span class="token punctuation">(</span>complex_wave<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">9.5</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">5.9</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">5.9</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">9.5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>可以看到，利用 yield from 表达式确实可以处理比较简单的情况。那既然这样，我们再试试看，它能否处理那种采用 send 方法写成的函数。下面就用这种写法，接连多次调用 <code class="language-text">wave_modulating</code> 生成器。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60524241417909460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def complex_wave_modulating():\n    yield from wave_modulating(3)\n    yield from wave_modulating(4)\n    yield from wave_modulating(5)\n\n\nrun_modulating(complex_wave_modulating())\n\n>>>\nOutput is None\nOutput:   0.0\nOutput:   6.1\nOutput:  -6.1\nOutput is None\nOutput:   0.0\nOutput:   2.0\nOutput:   0.0\nOutput: -10.0\nOutput is None\nOutput:   0.0\nOutput:   9.5\nOutput:   5.9`, `60524241417909460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">complex_wave_modulating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_modulating<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_modulating<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_modulating<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>\n\n\nrun_modulating<span class="token punctuation">(</span>complex_wave_modulating<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nOutput <span class="token keyword">is</span> <span class="token boolean">None</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">6.1</span>\nOutput <span class="token keyword">is</span> <span class="token boolean">None</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span>\nOutput <span class="token keyword">is</span> <span class="token boolean">None</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">9.5</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">5.9</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写在大方向上是对的，但问题在于：程序竟然输出了那么多 None！这是为什么呢？因为每条 yield from 表达式其实都在遍历一个嵌套进去的生成器，所以每个嵌套生成器都必须分别执行它们各自的第一条 yield 语句（也就是什么值都不带的那条 yield 语句），只有执行过这条语句之后，这些生成器才能通过 send 方法所传来的值决定这条语句的求值结果，并把这个结果放在 amplitude 变量里以计算下一次应该输出的值。所以，<code class="language-text">complex_wave_modulating</code> 函数处理完前一个嵌套的生成器之后，会进入下一个嵌套的生成器，而这时就必须先把该生成器的第一条 yield 语句运行过去，这就导致后面两个嵌套生成器会各自从 amplitudes 列表里浪费掉一个，并使得每个嵌套生成器所拿到的第一个结果必定是 None，还会让最后那个嵌套生成器少执行两次。</p>\n<p>这意味着，虽然 yield from 语句与 send 方法单独用着都没问题，然而结合使用的效果却不太让人满意。当然也可以在 <code class="language-text">run_modulating</code> 函数里添加一些代码，使得计算波形的步调与 amplitudes 列表提供振幅值的步调相一致，但这只能使程序越写越复杂，因为利用 send 方法写成的 <code class="language-text">wave_modulating</code> 函数本身已经不太直观了，而我们又把这个生成器函数通过 yield from 语句套到了 <code class="language-text">complex_wave_modulating</code> 里面，这理解起来就更加困难了。所以，笔者建议彻底抛开 send 方法，改用更简单的方案来做。</p>\n<p>最简单的一种写法，是把迭代器传给 wave 函数，让 wave 每次用到振幅的时候，通过 Python 内置的 next 函数推进这个迭代器并返回一个输入振幅。于是，这就促使多个生成器之间，产生连环反应（其他类似案例参见第 32 条）。</p>\n<p>这样，我们只需要把同一个迭代器分别传给这几条 yield from 语句里的 <code class="language-text">wave_cascading</code> 就行。迭代器是有状态的（参见第 31 条），所以下一个 <code class="language-text">wave_cascading</code> 会从上一个 <code class="language-text">wave_cascading</code> 使用完的地方，继续往下使用 <code class="language-text">amplitude_it</code> 迭代器。</p>\n<p>要想触发这个组合的生成器，只需要把振幅值放在列表中，并把针对列表制作的迭代器传给 <code class="language-text">complex_wave_cascading</code> 就好。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96891640561537370000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import math\n\n\ndef transmit(output):\n    if output is None:\n        print(f\'Output is None\')\n    else:\n        print(f\'Output: {output:>5.1f}\')\n\n\ndef wave_cascading(amplitude_it, steps):\n    step_size = 2 * math.pi / steps\n    for step in range(steps):\n        radians = step * step_size\n        fraction = math.sin(radians)\n        amplitude = next(amplitude_it)  # Get next input\n        output = amplitude * fraction\n        yield output\n\n\ndef complex_wave_cascading(amplitude_it):\n    yield from wave_cascading(amplitude_it, 3)\n    yield from wave_cascading(amplitude_it, 4)\n    yield from wave_cascading(amplitude_it, 5)\n\n\ndef run_cascading():\n    amplitudes = [7, 7, 7, 2, 2, 2, 2, 10, 10, 10, 10, 10]\n    it = complex_wave_cascading(iter(amplitudes))\n    for amplitude in amplitudes:\n        output = next(it)\n        transmit(output)\n\n\nrun_cascading()\n\n>>>\nOutput:   0.0\nOutput:   6.1\nOutput:  -6.1\nOutput:   0.0\nOutput:   2.0\nOutput:   0.0\nOutput:  -2.0\nOutput:   0.0\nOutput:   9.5\nOutput:   5.9\nOutput:  -5.9\nOutput:  -9.5`, `96891640561537370000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> math\n\n\n<span class="token keyword">def</span> <span class="token function">transmit</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> output <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output is None\'</span></span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Output: </span><span class="token interpolation"><span class="token punctuation">{</span>output<span class="token punctuation">:</span><span class="token format-spec">>5.1f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">wave_cascading</span><span class="token punctuation">(</span>amplitude_it<span class="token punctuation">,</span> steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    step_size <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">/</span> steps\n    <span class="token keyword">for</span> step <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>steps<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        radians <span class="token operator">=</span> step <span class="token operator">*</span> step_size\n        fraction <span class="token operator">=</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>radians<span class="token punctuation">)</span>\n        amplitude <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>amplitude_it<span class="token punctuation">)</span>  <span class="token comment"># Get next input</span>\n        output <span class="token operator">=</span> amplitude <span class="token operator">*</span> fraction\n        <span class="token keyword">yield</span> output\n\n\n<span class="token keyword">def</span> <span class="token function">complex_wave_cascading</span><span class="token punctuation">(</span>amplitude_it<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_cascading<span class="token punctuation">(</span>amplitude_it<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_cascading<span class="token punctuation">(</span>amplitude_it<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>\n    <span class="token keyword">yield</span> <span class="token keyword">from</span> wave_cascading<span class="token punctuation">(</span>amplitude_it<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">run_cascading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    amplitudes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\n    it <span class="token operator">=</span> complex_wave_cascading<span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>amplitudes<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> amplitude <span class="token keyword">in</span> amplitudes<span class="token punctuation">:</span>\n        output <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n        transmit<span class="token punctuation">(</span>output<span class="token punctuation">)</span>\n\n\nrun_cascading<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">6.1</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">2.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">0.0</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">9.5</span>\nOutput<span class="token punctuation">:</span>   <span class="token number">5.9</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">5.9</span>\nOutput<span class="token punctuation">:</span>  <span class="token operator">-</span><span class="token number">9.5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种写法最大的优点在于，迭代器可以来自任何地方，而且完全可以是动态的（例如可以用生成器函数来实现迭代器）。此方案只有一个缺陷，就是必须假设负责输入的生成器绝对能保证线程安全，但有时其实保证不了这一点。如果代码要跨越线程边界，那么用 async 函数实现可能更好（参见第 62 条）。</p>\n<h3 id="总结-30"><a href="#%E6%80%BB%E7%BB%93-30" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>send 方法可以把数据注入生成器，让它成为上一条 yield 表达式的求值结果，生成器可以把这个结果赋给变量。</li>\n<li>把 send 方法与 yield from 表达式搭配起来使用，可能导致奇怪的结果，例如会让程序在本该输出有效值的地方输出 None。</li>\n<li>通过迭代器向组合起来的生成器输入数据，要比采用 send 方法的那种方案好，所以尽量避免使用 send 方法。</li>\n</ol>\n<h2 id="第-35-条：不要通过-throw-变换生成器的状态"><a href="#%E7%AC%AC-35-%E6%9D%A1%EF%BC%9A%E4%B8%8D%E8%A6%81%E9%80%9A%E8%BF%87-throw-%E5%8F%98%E6%8D%A2%E7%94%9F%E6%88%90%E5%99%A8%E7%9A%84%E7%8A%B6%E6%80%81" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 35 条：不要通过 throw 变换生成器的状态</h2>\n<p>除 yield from 表达式（参见第 33 条）与 send 方法（参见第 34 条）外，生成器还有一项高级功能，就是可以把调用者通过 throw 方法传来的 Exception 实例重新抛出。这个 throw 方法用起来很简单：如果调用了这个方法，那么生成器下次推进时，就不会像平常那样，直接走到下一条 yield 表达式那里，而是会把通过 throw 方法传入的异常重新抛出。下面用代码演示这种效果。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71239824245714625000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyError(Exception):\n    pass\n\n\ndef my_generator():\n    yield 1\n    yield 2\n    yield 3\n\n\nit = my_generator()\nprint(next(it))  # Yield 1\nprint(next(it))  # Yield 2\nprint(it.throw(MyError(\'test error\')))\n\n>>>\n1\n2\nTraceback ...\n__main__.MyError: test error`, `71239824245714625000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyError</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">my_generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token number">1</span>\n    <span class="token keyword">yield</span> <span class="token number">2</span>\n    <span class="token keyword">yield</span> <span class="token number">3</span>\n\n\nit <span class="token operator">=</span> my_generator<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Yield 1</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Yield 2</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>throw<span class="token punctuation">(</span>MyError<span class="token punctuation">(</span><span class="token string">\'test error\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span>\n<span class="token number">2</span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n__main__<span class="token punctuation">.</span>MyError<span class="token punctuation">:</span> test error</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>生成器函数可以用标准的 try/except 复合语句把 yield 表达式包裹起来，如果函数上次执行到了这条表达式这里，而这次即将继续执行时，又发现外界通过 throw 方法给自己注入了异常，那么这个异常就会被 try 结构捕获下来，如果捕获之后不继续抛异常，那么生成器函数会推进到下一条 yield 表达式（更多异常处理，参见第 65 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="21817022060747383000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyError(Exception):\n    pass\n\n\ndef my_generator():\n    yield 1\n    try:\n        yield 2\n    except MyError:\n        print(\'Got MyError!\')\n    else:\n        yield 3\n    yield 4\n\n\nit = my_generator()\nprint(next(it))  # Yield 1\nprint(next(it))  # Yield 2\nprint(it.throw(MyError(\'test error\')))\n\n>>>\n1\n2\nGot MyError!\n4`, `21817022060747383000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyError</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">my_generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">yield</span> <span class="token number">1</span>\n    <span class="token keyword">try</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> <span class="token number">2</span>\n    <span class="token keyword">except</span> MyError<span class="token punctuation">:</span>\n        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Got MyError!\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> <span class="token number">3</span>\n    <span class="token keyword">yield</span> <span class="token number">4</span>\n\n\nit <span class="token operator">=</span> my_generator<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Yield 1</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Yield 2</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>throw<span class="token punctuation">(</span>MyError<span class="token punctuation">(</span><span class="token string">\'test error\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">1</span>\n<span class="token number">2</span>\nGot MyError!\n<span class="token number">4</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这项机制会在生成器与调用者之间形成双向通信通道（另一种双向通信通道，参见第 34 条），这在某些情况下是有用的。例如，要编写一个偶尔可以重置的计时器程序。笔者定义下面的 Reset 异常与 timer 生成器方法，让调用者可以在 timer 给出的迭代器上通过 throw 方法注入 Reset 异常，令计时器重置。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49695312708598170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Reset(Exception):\n    pass\n\n\ndef timer(period):\n    current = period\n    while current:\n        current -= 1\n        try:\n            yield current\n        except Reset:\n            current = period`, `49695312708598170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Reset</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    current <span class="token operator">=</span> period\n    <span class="token keyword">while</span> current<span class="token punctuation">:</span>\n        current <span class="token operator">-=</span> <span class="token number">1</span>\n        <span class="token keyword">try</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> current\n        <span class="token keyword">except</span> Reset<span class="token punctuation">:</span>\n            current <span class="token operator">=</span> period</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>按照这种写法，如果 timer 正准备从 yield 表达式往下推进时，发现有人注入了 Reset 异常，那么它就会把这个异常捕获下来，并进入 except 分支，在这里它会把表示倒计时的 current 变量重新调整成最初的 period 值。</p>\n<p>这个计时器可以与外界某个按秒轮询的输入机制对接起来。为此，笔者定义一个 run 函数以驱动 timer 生成器所给出的那个 it 迭代器，并根据外界的情况做处理，如果外界要求重置，那就通过 it 迭代器的 throw 方法给计时器注入 Reset 变量，如果外界没有这样要求，那就调用 announce 函数打印生成器所给的倒计时值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35468875027325743000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Reset(Exception):\n    pass\n\n\ndef timer(period):\n    current = period\n    while current:\n        current -= 1\n        try:\n            yield current\n        except Reset:\n            current = period\n\n\ndef check_for_reset():\n    # Poll for external event\n    # ...\n    pass\n\n\ndef announce(remaining):\n    print(f\'{remaining} ticks remaining\')\n\n\ndef run():\n    it = timer(4)\n    while True:\n        try:\n            if check_for_reset():\n                current = it.throw(Reset())\n            else:\n                current = next(it)\n        except StopIteration:\n            break\n        else:\n            announce(current)\n\n\nrun()\n\n>>>\n3 ticks remaining\n2 ticks remaining\n1 ticks remaining\n0 ticks remaining`, `35468875027325743000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Reset</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    current <span class="token operator">=</span> period\n    <span class="token keyword">while</span> current<span class="token punctuation">:</span>\n        current <span class="token operator">-=</span> <span class="token number">1</span>\n        <span class="token keyword">try</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> current\n        <span class="token keyword">except</span> Reset<span class="token punctuation">:</span>\n            current <span class="token operator">=</span> period\n\n\n<span class="token keyword">def</span> <span class="token function">check_for_reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token comment"># Poll for external event</span>\n    <span class="token comment"># ...</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">announce</span><span class="token punctuation">(</span>remaining<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>remaining<span class="token punctuation">}</span></span><span class="token string"> ticks remaining\'</span></span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    it <span class="token operator">=</span> timer<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>\n    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>\n        <span class="token keyword">try</span><span class="token punctuation">:</span>\n            <span class="token keyword">if</span> check_for_reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n                current <span class="token operator">=</span> it<span class="token punctuation">.</span>throw<span class="token punctuation">(</span>Reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token keyword">else</span><span class="token punctuation">:</span>\n                current <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n        <span class="token keyword">except</span> StopIteration<span class="token punctuation">:</span>\n            <span class="token keyword">break</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            announce<span class="token punctuation">(</span>current<span class="token punctuation">)</span>\n\n\nrun<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">3</span> ticks remaining\n<span class="token number">2</span> ticks remaining\n<span class="token number">1</span> ticks remaining\n<span class="token number">0</span> ticks remaining</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写没错，但是有点儿难懂，因为用了许多层嵌套结构。我们要判断 <code class="language-text">check_for_reset</code> 函数的返回值，以确定是应该通过 it.throw 注入 Reset 异常，还是应该通过 next 推进迭代器。如果是要推进迭代器，那么还得捕获 StopIteration 异常：若是捕获到了这种异常，那说明迭代器已经走到终点，则要执行 break 跳出 while 循环；若没捕获到，则需要调用 announce 函数打印倒计时值。这会让代码变得很乱。</p>\n<p>有个简单的办法，能够改写这段代码，那就是用可迭代的容器对象（参见第 31 条）定义一个有状态的闭包（参见第 38 条）。下面的代码就写了这样一个 Timer 类，并通过它重新实现刚才的 timer 生成器。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16365807444312642000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Timer:\n    def __init__(self, period):\n        self.current = period\n        self.period = period\n\n    def reset(self):\n        self.current = self.period\n\n    def __iter__(self):\n        while self.current:\n            self.current -= 1\n            yield self.current`, `16365807444312642000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Timer</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> period\n        self<span class="token punctuation">.</span>period <span class="token operator">=</span> period\n\n    <span class="token keyword">def</span> <span class="token function">reset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> self<span class="token punctuation">.</span>period\n\n    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">while</span> self<span class="token punctuation">.</span>current<span class="token punctuation">:</span>\n            self<span class="token punctuation">.</span>current <span class="token operator">-=</span> <span class="token number">1</span>\n            <span class="token keyword">yield</span> self<span class="token punctuation">.</span>current</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在，run 函数就好写多了，因为它只需要用 for 循环迭代这个 timer 即可。这样写出来的代码，不像刚才那样有那么多层嵌套，所以读起来很容易懂。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="33614808019226960000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Reset(Exception):\n    pass\n\n\ndef check_for_reset():\n    # Poll for external event\n    # ...\n    pass\n\n\ndef announce(remaining):\n    print(f\'{remaining} ticks remaining\')\n\n\nclass Timer:\n    def __init__(self, period):\n        self.current = period\n        self.period = period\n\n    def reset(self):\n        self.current = self.period\n\n    def __iter__(self):\n        while self.current:\n            self.current -= 1\n            yield self.current\n\n\ndef run():\n    timer = Timer(4)\n    for current in timer:\n        if check_for_reset():\n            timer.reset()\n        announce(current)\n\n\nrun()\n\n>>>\n3 ticks remaining\n2 ticks remaining\n1 ticks remaining\n0 ticks remaining`, `33614808019226960000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{29-37}"\n              >\n                <span class="gatsby-code-button-language">py{29-37}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Reset</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">check_for_reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token comment"># Poll for external event</span>\n    <span class="token comment"># ...</span>\n    <span class="token keyword">pass</span>\n\n\n<span class="token keyword">def</span> <span class="token function">announce</span><span class="token punctuation">(</span>remaining<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>remaining<span class="token punctuation">}</span></span><span class="token string"> ticks remaining\'</span></span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Timer</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> period<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> period\n        self<span class="token punctuation">.</span>period <span class="token operator">=</span> period\n\n    <span class="token keyword">def</span> <span class="token function">reset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> self<span class="token punctuation">.</span>period\n\n    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">while</span> self<span class="token punctuation">.</span>current<span class="token punctuation">:</span>\n            self<span class="token punctuation">.</span>current <span class="token operator">-=</span> <span class="token number">1</span>\n            <span class="token keyword">yield</span> self<span class="token punctuation">.</span>current\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    timer <span class="token operator">=</span> Timer<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">for</span> current <span class="token keyword">in</span> timer<span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">if</span> check_for_reset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            timer<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        announce<span class="token punctuation">(</span>current<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">run<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">3</span> ticks remaining\n<span class="token number">2</span> ticks remaining\n<span class="token number">1</span> ticks remaining\n<span class="token number">0</span> ticks remaining</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写所输出的结果与前面一样，但是这种实现方案理解起来要容易得多，即便是初次阅读这段代码的人也很容易就能读懂。凡是想用生成器与异常来实现的功能，通常都可以改用异步机制去做（参见第 60 条），那样会更好。如果确实遇到了这里讲到的这种需求，那么应该通过可迭代的类来实现生成器，而不要用 throw 方法注入异常。</p>\n<h3 id="总结-31"><a href="#%E6%80%BB%E7%BB%93-31" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>throw 方法可以把异常发送到生成器刚执行过的那条 yield 表达式那里，让这个异常在生成器下次推进时重新抛出。</li>\n<li>通过 throw 方法注入异常，会让代码变得难懂，因为需要用多层嵌套的模板结构来抛出并捕获这种异常。</li>\n<li>如果确实遇到了这样的特殊情况，那么应该通过类的 <code class="language-text">__iter__</code> 方法实现生成器，并且专门提供一个方法，让调用者通过这个方法来触发这种特殊的状态变换逻辑。</li>\n</ol>\n<h2 id="第-36-条：考虑用-itertools-拼装迭代器与生成器"><a href="#%E7%AC%AC-36-%E6%9D%A1%EF%BC%9A%E8%80%83%E8%99%91%E7%94%A8-itertools-%E6%8B%BC%E8%A3%85%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%8E%E7%94%9F%E6%88%90%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 36 条：考虑用 itertools 拼装迭代器与生成器</h2>\n<p>Python 内置的 itertools 模块里有很多函数，可以用来安排迭代器之间的交互关系（相关的基础知识，参见第 30 条与第 31 条）。</p>\n<p>如果要实现比较难写的迭代逻辑，那么应该先查看 itertools 的文档（在 Python 解释器界面输入 help(itertools)），说不定里面就有你能用到的函数。下面分三大类，列出其中最重要的函数。</p>\n<h3 id="连接多个迭代器"><a href="#%E8%BF%9E%E6%8E%A5%E5%A4%9A%E4%B8%AA%E8%BF%AD%E4%BB%A3%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>连接多个迭代器</h3>\n<p>内置的 itertools 模块有一些函数可以把多个迭代器连成一个使用。</p>\n<h4 id="chain"><a href="#chain" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>chain</h4>\n<p>chain 可以把多个迭代器从头到尾连成一个迭代器。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17143130361474812000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.chain([1, 2, 3], [4, 5, 6])\nprint(list(it))\n\n>>>\n[1, 2, 3, 4, 5, 6]`, `17143130361474812000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>chain<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="repeat"><a href="#repeat" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>repeat</h4>\n<p>repeat 可以制作这样一个迭代器，它会不停地输出某个值。调用 repeat 时，也可以通过第二个参数指定迭代器最多能输出几次。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93382646150867170000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.repeat(\'hello\', 3)\nprint(list(it))\n\n>>>\n[\'hello\', \'hello\', \'hello\']`, `93382646150867170000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token string">\'hello\'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'hello\'</span><span class="token punctuation">,</span> <span class="token string">\'hello\'</span><span class="token punctuation">,</span> <span class="token string">\'hello\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="cycle"><a href="#cycle" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cycle</h4>\n<p>cycle 可以制作这样一个迭代器，它会循环地输出某段内容之中的各项元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14067666396750856000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.cycle([1, 2])\nresult = [next(it) for _ in range(10)]\nprint(result)\n\n>>>\n[1, 2, 1, 2, 1, 2, 1, 2, 1, 2]`, `14067666396750856000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>cycle<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\nresult <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">next</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="tee"><a href="#tee" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>tee</h4>\n<p>tee 可以让一个迭代器分裂成多个平行的迭代器，具体个数由第二个参数指定。如果这些迭代器推进的速度不一致，那么程序可能要用大量内存做缓冲，以存放进度落后的迭代器将来会用到的元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70809112949934530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit1, it2, it3 = itertools.tee([\'first\', \'second\'], 3)\nprint(list(it1))\nprint(list(it2))\nprint(list(it3))\n\n>>>\n[\'first\', \'second\']\n[\'first\', \'second\']\n[\'first\', \'second\']`, `70809112949934530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit1<span class="token punctuation">,</span> it2<span class="token punctuation">,</span> it3 <span class="token operator">=</span> itertools<span class="token punctuation">.</span>tee<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'first\'</span><span class="token punctuation">,</span> <span class="token string">\'second\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it1<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it2<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it3<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'first\'</span><span class="token punctuation">,</span> <span class="token string">\'second\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token string">\'first\'</span><span class="token punctuation">,</span> <span class="token string">\'second\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">[</span><span class="token string">\'first\'</span><span class="token punctuation">,</span> <span class="token string">\'second\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="zip_longest"><a href="#zip_longest" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>zip_longest</h4>\n<p>它与 Python 内置的 zip 函数类似（参见第 8 条），但区别在于，如果源迭代器的长度不同，那么它会用 fillvalue 参数的值来填补提前耗尽的那些迭代器所留下的空缺。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68180228896605995000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nkeys = [\'one\', \'two\', \'three\']\nvalues = [1, 2]\n\nnormal = list(zip(keys, values))\nprint(\'zip:        \', normal)\n\nit = itertools.zip_longest(keys, values, fillvalue=\'nope\')\nlongest = list(it)\nprint(\'zip_longest:\', longest)\n\n>>>\nzip:         [(\'one\', 1), (\'two\', 2)]\nzip_longest: [(\'one\', 1), (\'two\', 2), (\'three\', \'nope\')]`, `68180228896605995000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nkeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'one\'</span><span class="token punctuation">,</span> <span class="token string">\'two\'</span><span class="token punctuation">,</span> <span class="token string">\'three\'</span><span class="token punctuation">]</span>\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>\n\nnormal <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'zip:        \'</span><span class="token punctuation">,</span> normal<span class="token punctuation">)</span>\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>zip_longest<span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">,</span> fillvalue<span class="token operator">=</span><span class="token string">\'nope\'</span><span class="token punctuation">)</span>\nlongest <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'zip_longest:\'</span><span class="token punctuation">,</span> longest<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token builtin">zip</span><span class="token punctuation">:</span>         <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">\'one\'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'two\'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\nzip_longest<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">\'one\'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'two\'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'three\'</span><span class="token punctuation">,</span> <span class="token string">\'nope\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="过滤源迭代器中的元素"><a href="#%E8%BF%87%E6%BB%A4%E6%BA%90%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过滤源迭代器中的元素</h3>\n<p>Python 内置的 itertools 模块里有一些函数可以过滤源迭代器中的元素。</p>\n<h4 id="islice"><a href="#islice" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>islice</h4>\n<p>islice 可以在不拷贝数据的前提下，按照下标切割源迭代器。可以只给出切割的终点，也可以同时给出起点与终点，还可以指定步进值。这种切割方式与标准的序列切片及步进机制类似（参见第 11 条与第 12 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31244401974056560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nvalues = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nfirst_five = itertools.islice(values, 5)\nprint(\'First five: \', list(first_five))\nmiddle_odds = itertools.islice(values, 2, 8, 2)\nprint(\'Middle odds:\', list(middle_odds))\n\n>>>\nFirst five:  [1, 2, 3, 4, 5]\nMiddle odds: [3, 5, 7]`, `31244401974056560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nfirst_five <span class="token operator">=</span> itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>values<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'First five: \'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>first_five<span class="token punctuation">)</span><span class="token punctuation">)</span>\nmiddle_odds <span class="token operator">=</span> itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>values<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Middle odds:\'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>middle_odds<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFirst five<span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>\nMiddle odds<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="takewhile"><a href="#takewhile" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>takewhile</h4>\n<p>takewhile 会一直从源迭代器里获取元素，直到某元素让测试函数返回 False 为止。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83856061447156380000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nvalues = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\n\ndef less_than_seven(x):\n    return x < 7\n\n\nit = itertools.takewhile(less_than_seven, values)\nprint(list(it))\n\n>>>\n[1, 2, 3, 4, 5, 6]`, `83856061447156380000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\n\n\n<span class="token keyword">def</span> <span class="token function">less_than_seven</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> x <span class="token operator">&lt;</span> <span class="token number">7</span>\n\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>takewhile<span class="token punctuation">(</span>less_than_seven<span class="token punctuation">,</span> values<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="dropwhile"><a href="#dropwhile" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>dropwhile</h4>\n<p>与 takewhile 相反，dropwhile 会一直跳过源序列里的元素，直到某元素让测试函数返回 True 为止，然后它会从这个地方开始逐个取值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="54024279091283200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nvalues = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\n\ndef less_than_seven(x):\n    return x < 7\n\n\nit = itertools.dropwhile(less_than_seven, values)\nprint(list(it))\n\n>>>\n[7, 8, 9, 10]`, `54024279091283200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\n\n\n<span class="token keyword">def</span> <span class="token function">less_than_seven</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> x <span class="token operator">&lt;</span> <span class="token number">7</span>\n\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>dropwhile<span class="token punctuation">(</span>less_than_seven<span class="token punctuation">,</span> values<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="filterfalse"><a href="#filterfalse" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>filterfalse</h4>\n<p>filterfalse 和内置的 filter 函数相反，它会逐个输出源迭代器里使得测试函数返回 False 的那些元素。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20758432102009516000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nvalues = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\n\ndef evens(x):\n    return x % 2 == 0\n\n\nfilter_result = filter(evens, values)\nprint(\'Filter:      \', list(filter_result))\nfilter_false_result = itertools.filterfalse(evens, values)\nprint(\'Filter false:\', list(filter_false_result))\n\n>>>\nFilter:       [2, 4, 6, 8, 10]\nFilter false: [1, 3, 5, 7, 9]`, `20758432102009516000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\n\n\n<span class="token keyword">def</span> <span class="token function">evens</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span>\n\n\nfilter_result <span class="token operator">=</span> <span class="token builtin">filter</span><span class="token punctuation">(</span>evens<span class="token punctuation">,</span> values<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Filter:      \'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>filter_result<span class="token punctuation">)</span><span class="token punctuation">)</span>\nfilter_false_result <span class="token operator">=</span> itertools<span class="token punctuation">.</span>filterfalse<span class="token punctuation">(</span>evens<span class="token punctuation">,</span> values<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Filter false:\'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>filter_false_result<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nFilter<span class="token punctuation">:</span>       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nFilter false<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="用源迭代器中的元素合成新元素"><a href="#%E7%94%A8%E6%BA%90%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E5%90%88%E6%88%90%E6%96%B0%E5%85%83%E7%B4%A0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用源迭代器中的元素合成新元素</h3>\n<p>Python 内置的 itertools 模块里，有一些函数可以根据源迭代器中的元素合成新的元素。</p>\n<h4 id="accumulate"><a href="#accumulate" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>accumulate</h4>\n<p>accumulate 会从源迭代器里取出一个元素，并把已经累计的结果与这个元素一起传给表示累加逻辑的函数，然后输出那个函数的计算结果，并把结果当成新的累计值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91741314244075300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nvalues = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nsum_reduce = itertools.accumulate(values)\nprint(\'Sum:   \', list(sum_reduce))\n\n\ndef sum_modulo_20(first, second):\n    output = first + second\n    return output % 20\n\n\nmodulo_reduce = itertools.accumulate(values, sum_modulo_20)\nprint(\'Modulo:\', list(modulo_reduce))\n\n>>>\nSum:    [1, 3, 6, 10, 15, 21, 28, 36, 45, 55]\nModulo: [1, 3, 6, 10, 15, 1, 8, 16, 5, 15]`, `91741314244075300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nvalues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>\nsum_reduce <span class="token operator">=</span> itertools<span class="token punctuation">.</span>accumulate<span class="token punctuation">(</span>values<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Sum:   \'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sum_reduce<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">sum_modulo_20</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> second<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    output <span class="token operator">=</span> first <span class="token operator">+</span> second\n    <span class="token keyword">return</span> output <span class="token operator">%</span> <span class="token number">20</span>\n\n\nmodulo_reduce <span class="token operator">=</span> itertools<span class="token punctuation">.</span>accumulate<span class="token punctuation">(</span>values<span class="token punctuation">,</span> sum_modulo_20<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Modulo:\'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>modulo_reduce<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nSum<span class="token punctuation">:</span>    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">]</span>\nModulo<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这与内置的 functools 模块中 reduce 函数，实际上是一样的，只不过这个函数每次只给出一项累计值。如果调用者没有指定表示累加逻辑的双参数函数（binary function），那么默认的逻辑就是两值相加。</p>\n<h4 id="product"><a href="#product" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>product</h4>\n<p>product 会从一个或多个源迭代器里获取元素，并计算笛卡尔积（Cartesian product），它可以取代那种多层嵌套的列表推导代码（参见第 28 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89529881557505330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nsingle = itertools.product([1, 2], repeat=2)\nprint(\'Single:  \', list(single))\n\nmultiple = itertools.product([1, 2], [\'a\', \'b\'])\nprint(\'Multiple:\', list(multiple))\n\n>>>\nSingle:   [(1, 1), (1, 2), (2, 1), (2, 2)]\nMultiple: [(1, \'a\'), (1, \'b\'), (2, \'a\'), (2, \'b\')]`, `89529881557505330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nsingle <span class="token operator">=</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Single:  \'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>single<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\nmultiple <span class="token operator">=</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Multiple:\'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>multiple<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nSingle<span class="token punctuation">:</span>   <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\nMultiple<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="permutations"><a href="#permutations" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>permutations</h4>\n<p>permutations 会考虑源迭代器所能给出的全部元素，并逐个输出由其中 N 个元素形成的每种有序排列（permutation）方式，元素相同但顺序不同，算作两种排列。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23910698237112693000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.permutations([1, 2, 3, 4], 2)\nprint(list(it))\n\n>>>\n[(1, 2), (1, 3), (1, 4), (2, 1), (2, 3), (2, 4), (3, 1), (3, 2), (3, 4), (4, 1), (4, 2), (4, 3)]`, `23910698237112693000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>permutations<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="combinations"><a href="#combinations" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>combinations</h4>\n<p>combinations 会考虑源迭代器所能给出的全部元素，并逐个输出由其中 N 个元素形成的每种无序组合（combination）方式，元素相同但顺序不同，算作同一种组合。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76852185081597980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.combinations([1, 2, 3, 4], 2)\nprint(list(it))\n\n>>>\n[(1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)]`, `76852185081597980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>combinations<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id="combinations_with_replacement"><a href="#combinations_with_replacement" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">combinations_with_replacement</code></h4>\n<p><code class="language-text">combinations_with_replacement</code> 与 combinations 类似，但它允许同一个元素在组合里多次出现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48808264434742440000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import itertools\n\nit = itertools.combinations_with_replacement([1, 2, 3, 4], 2)\nprint(list(it))\n\n>>>\n[(1, 1), (1, 2), (1, 3), (1, 4), (2, 2), (2, 3), (2, 4), (3, 3), (3, 4), (4, 4)]`, `48808264434742440000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> itertools\n\nit <span class="token operator">=</span> itertools<span class="token punctuation">.</span>combinations_with_replacement<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-32"><a href="#%E6%80%BB%E7%BB%93-32" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>itertools 包里面有三套函数可以拼装迭代器与生成器，它们分别能够连接多个迭代器，过滤源迭代器中的元素，以及用源迭代器中的元素合成新元素。</li>\n<li>通过 help(itertools) 查看文档，了解这些函数所支持的其他参数，以及许多更为高级的函数和实用的代码范例。</li>\n</ol>\n<h1 id="类与接口"><a href="#%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>类与接口</h1>\n<h2 id="第-37-条：用组合起来的类来实现多层结构，不要用嵌套的内置类型"><a href="#%E7%AC%AC-37-%E6%9D%A1%EF%BC%9A%E7%94%A8%E7%BB%84%E5%90%88%E8%B5%B7%E6%9D%A5%E7%9A%84%E7%B1%BB%E6%9D%A5%E5%AE%9E%E7%8E%B0%E5%A4%9A%E5%B1%82%E7%BB%93%E6%9E%84%EF%BC%8C%E4%B8%8D%E8%A6%81%E7%94%A8%E5%B5%8C%E5%A5%97%E7%9A%84%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 37 条：用组合起来的类来实现多层结构，不要用嵌套的内置类型</h2>\n<p>Python 内置的字典类型，很适合维护对象在生命期内的动态内部状态。所谓动态的（dynamic），是指我们无法获知那套状态会用到哪些标识符。例如，如果要用成绩册（Gradebook）记录学生的分数，而我们又没办法提前确定这些学生的名字，那么受到记录的每位学生与各自的分数，对于 Gradebook 对象来说，就属于动态的内部状态。为了实现这个需求，笔者定义下面这样一个类，让它把学生的名字当作键保存到 <code class="language-text">_grades</code> 字典中，因为我们无法提前确定要记录哪些学生，所以不能将每位学生的名字都设置成这个类的一项属性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55592860772153310000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class SimpleGradebook:\n\n    def __init__(self):\n        self._grades = {}\n\n    def add_student(self, name):\n        self._grades[name] = []\n\n    def report_grade(self, name, score):\n        self._grades[name].append(score)\n\n    def average_grade(self, name):\n        grades = self._grades[name]\n        return sum(grades) / len(grades)\n\n\nbook = SimpleGradebook()\nbook.add_student(\'Isaac Newton\')\nbook.report_grade(\'Isaac Newton\', 90)\nbook.report_grade(\'Isaac Newton\', 95)\nbook.report_grade(\'Isaac Newton\', 85)\n\nprint(book.average_grade(\'Isaac Newton\'))\n\n>>>\n90.0`, `55592860772153310000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">SimpleGradebook</span><span class="token punctuation">:</span>\n\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n    <span class="token keyword">def</span> <span class="token function">report_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> score<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>score<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">average_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        grades <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>grades<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>grades<span class="token punctuation">)</span>\n\n\nbook <span class="token operator">=</span> SimpleGradebook<span class="token punctuation">(</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>add_student<span class="token punctuation">(</span><span class="token string">\'Isaac Newton\'</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Isaac Newton\'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Isaac Newton\'</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Isaac Newton\'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>average_grade<span class="token punctuation">(</span><span class="token string">\'Isaac Newton\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">90.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>字典与相关的内置类型用起来很方便，但同时也容易遭到滥用导致代码出问题。例如，我们现在要扩展这个 SimpleGradebook 类的功能，让它按照科目保存成绩，而不是把所有科目的成绩存在一起。通过修改 <code class="language-text">_grades</code> 字典的用法，使它必须把键（也就是学生的名字）与另一个小字典相对应，而不是像刚才那样，直接与列表对应起来。那份小字典以各科的名称作键与一份列表对应起来，以保存学生在这一科的全部考试成绩。这次笔者用 defaultdict 来实现这个小字典，这样可以方便地处理科目名称还不存在的那些情况（参见第 17 条）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27355561007692120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass BySubjectGradebook:\n    def __init__(self):\n        self._grades = {}  # Outer dict\n\n    def add_student(self, name):\n        self._grades[name] = defaultdict(list)  # Inner dict`, `27355561007692120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">BySubjectGradebook</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># Outer dict</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>  <span class="token comment"># Inner dict</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>程序写到现在，还算比较直观。但是接下来，我们要编写 <code class="language-text">report_grade</code> 方法来记录某位学生在某科目上的一次成绩，并且要写 <code class="language-text">average_grade</code> 方法计算某位学生所有科目的平均成绩。这两个方法写起来就稍微有点复杂了，因为必须处理多层嵌套的字典结构，不过，这似乎还在可以把握的范围内。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23173457687497700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass BySubjectGradebook:\n    def __init__(self):\n        self._grades = {}  # Outer dict\n\n    def add_student(self, name):\n        self._grades[name] = defaultdict(list)  # Inner dict\n\n    def report_grade(self, name, subject, grade):\n        by_subject = self._grades[name]\n        grade_list = by_subject[subject]\n        grade_list.append(grade)\n\n    def average_grade(self, name):\n        by_subject = self._grades[name]\n        total, count = 0, 0\n        for grades in by_subject.values():\n            total += sum(grades)\n            count += len(grades)\n        return total / count`, `23173457687497700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{11-22}"\n              >\n                <span class="gatsby-code-button-language">py{11-22}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">BySubjectGradebook</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># Outer dict</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>  <span class="token comment"># Inner dict</span>\n\n<span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">report_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> grade<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        by_subject <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">        grade_list <span class="token operator">=</span> by_subject<span class="token punctuation">[</span>subject<span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">        grade_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>grade<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">average_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        by_subject <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">        total<span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">for</span> grades <span class="token keyword">in</span> by_subject<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            total <span class="token operator">+=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>grades<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">            count <span class="token operator">+=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>grades<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">return</span> total <span class="token operator">/</span> count</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>扩展后的类，用起来依然比较容易。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45148986581387575000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`book = BySubjectGradebook()\nbook.add_student(\'Albert Einstein\')\nbook.report_grade(\'Albert Einstein\', \'Math\', 75)\nbook.report_grade(\'Albert Einstein\', \'Math\', 65)\nbook.report_grade(\'Albert Einstein\', \'Gym\', 90)\nbook.report_grade(\'Albert Einstein\', \'Gym\', 95)\nprint(book.average_grade(\'Albert Einstein\'))\n\n>>>\n81.25`, `45148986581387575000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">book <span class="token operator">=</span> BySubjectGradebook<span class="token punctuation">(</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>add_student<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Math\'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Math\'</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Gym\'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Gym\'</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>average_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">81.25</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在假设需求又变了，我们还要记录每次考试在科目里的权重（weight），因为期中考试与期末考试及随堂举行的临时考试（pop quiz）在总成绩里占的比例是不同的。实现这项功能的一种办法是改变里面那个小字典的用法，让它不要把成绩（score）直接添加到与键名（也就科目名称）相对应的那份列表里，而是先用成绩与权重构造元组，然后把（score, weight）形式的元组添加到列表里。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="4682914757060019000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass WeightedGradebook:\n    def __init__(self):\n        self._grades = {}\n\n    def add_student(self, name):\n        self._grades[name] = defaultdict(list)\n\n    def report_grade(self, name, subject, score, weight):\n        by_subject = self._grades[name]\n        grade_list = by_subject[subject]\n        grade_list.append((score, weight))`, `4682914757060019000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">WeightedGradebook</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">report_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        by_subject <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n        grade_list <span class="token operator">=</span> by_subject<span class="token punctuation">[</span>subject<span class="token punctuation">]</span>\n        grade_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class="language-text">report_grade</code> 方法改起来似乎挺简单的，只需要把原来的成绩变为带权重的元组保存到列表里面即可。但是 <code class="language-text">average_grade</code> 方法就比较难懂了，因为我们必须在循环里面再嵌套一个循环。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64317620588558120000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass WeightedGradebook:\n    def __init__(self):\n        self._grades = {}\n\n    def add_student(self, name):\n        self._grades[name] = defaultdict(list)\n\n    def report_grade(self, name, subject, score, weight):\n        by_subject = self._grades[name]\n        grade_list = by_subject[subject]\n        grade_list.append((score, weight))\n\n    def average_grade(self, name):\n        by_subject = self._grades[name]\n        score_sum, score_count = 0, 0\n        for subject, scores in by_subject.items():\n            subject_avg, total_weight = 0, 0\n            for score, weight in scores:\n                subject_avg += score * weight\n                total_weight += weight\n\n            score_sum += subject_avg / total_weight\n            score_count += 1\n        return score_sum / score_count\n\n\nbook = WeightedGradebook()\nbook.add_student(\'Albert Einstein\')\nbook.report_grade(\'Albert Einstein\', \'Math\', 75, 0.05)\nbook.report_grade(\'Albert Einstein\', \'Math\', 65, 0.15)\nbook.report_grade(\'Albert Einstein\', \'Math\', 70, 0.80)\nbook.report_grade(\'Albert Einstein\', \'Gym\', 100, 0.40)\nbook.report_grade(\'Albert Einstein\', \'Gym\', 85, 0.60)\nprint(book.average_grade(\'Albert Einstein\'))\n\n>>>\n80.25`, `64317620588558120000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">WeightedGradebook</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token keyword">def</span> <span class="token function">add_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">report_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        by_subject <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n        grade_list <span class="token operator">=</span> by_subject<span class="token punctuation">[</span>subject<span class="token punctuation">]</span>\n        grade_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">average_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        by_subject <span class="token operator">=</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n        score_sum<span class="token punctuation">,</span> score_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>\n        <span class="token keyword">for</span> subject<span class="token punctuation">,</span> scores <span class="token keyword">in</span> by_subject<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            subject_avg<span class="token punctuation">,</span> total_weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>\n            <span class="token keyword">for</span> score<span class="token punctuation">,</span> weight <span class="token keyword">in</span> scores<span class="token punctuation">:</span>\n                subject_avg <span class="token operator">+=</span> score <span class="token operator">*</span> weight\n                total_weight <span class="token operator">+=</span> weight\n\n            score_sum <span class="token operator">+=</span> subject_avg <span class="token operator">/</span> total_weight\n            score_count <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> score_sum <span class="token operator">/</span> score_count\n\n\nbook <span class="token operator">=</span> WeightedGradebook<span class="token punctuation">(</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>add_student<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Math\'</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Math\'</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">0.15</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Math\'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">0.80</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Gym\'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0.40</span><span class="token punctuation">)</span>\nbook<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">,</span> <span class="token string">\'Gym\'</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">0.60</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>average_grade<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">80.25</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个类用起来也变得困难了，因为单看代码很难知道 <code class="language-text">report_grade</code> 里面那些数字形式的位置参数表示什么意思。</p>\n<p>如果遇到的是类似这种比较复杂的需求，那么不要再嵌套字典、元组、集合、列表等内置的类型了，而是应该编写一批新类并让这些类形成一套体系。</p>\n<p>拿这个成绩册的例子来说，一开始我们并不知道后来要考虑成绩权重，所以那个时候似乎没有必要专门创建这样一套类体系。后来，当要纳入权重因素时，有人认为，这可以继续通过 Python 内置的字典与元组来实现，因为只不过是要给保存内部状态的那个结构多添加一层而已。所以，才有了刚才那种复杂的写法。其实，在需要分科目统计成绩时，就不应该继续嵌套下去了，那样会让字典里出现小字典，而小字典里又会出现列表。这种超过两层的嵌套结构，其他开发者很难看懂，而且后面维护起来也很麻烦。</p>\n<p>只要发现记录内部状态的代码开始变得复杂起来，就应该及时把这些代码拆分到多个类里。这样可以定义良好的接口，并且能够合理地封装数据。这种写法可以在接口与具体实现之间创建一层抽象。</p>\n<h3 id="把多层嵌套的内置类型重构为类体系"><a href="#%E6%8A%8A%E5%A4%9A%E5%B1%82%E5%B5%8C%E5%A5%97%E7%9A%84%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B%E9%87%8D%E6%9E%84%E4%B8%BA%E7%B1%BB%E4%BD%93%E7%B3%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>把多层嵌套的内置类型重构为类体系</h3>\n<p>有很多种办法可以实现重构（除了这里讲的这种，第 89 条还讲了另一种）。笔者这里采用的办法是，先从依赖树的最底层做起，也就是考虑怎么记录某科目的单次考试成绩与权重。这么简单的一条信息，似乎没必要专门写一个类来记录。由于分数不需要修改，因此元组已经足够用了。下面以（score, weight）形式的元组来记录单次考试成绩，并把这种元素添加到列表里面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9119075588888980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`grades = []\ngrades.append((95, 0.45))\ngrades.append((85, 0.55))\ntotal = sum(score * weight for score, weight in grades)\ntotal_weight = sum(weight for _, weight in grades)\naverage_grade = total / total_weight`, `9119075588888980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">grades <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\ngrades<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\ngrades<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">0.55</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\ntotal <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>score <span class="token operator">*</span> weight <span class="token keyword">for</span> score<span class="token punctuation">,</span> weight <span class="token keyword">in</span> grades<span class="token punctuation">)</span>\ntotal_weight <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>weight <span class="token keyword">for</span> _<span class="token punctuation">,</span> weight <span class="token keyword">in</span> grades<span class="token punctuation">)</span>\naverage_grade <span class="token operator">=</span> total <span class="token operator">/</span> total_weight</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>汇总每次考试的权重之和（<code class="language-text">total * weight</code>）时，不需要关注具体的成绩，所以在 <code class="language-text">for ... in ...</code> 结构中用下划线（<code class="language-text">*</code>）表示元组中的 score 那一部分，表示计算时忽略它。</p>\n<p>这种写法的问题在于，元组里的元素只能通过位置区分。例如，如果还要把老师的评语记在每次考试的成绩旁边，那么早前使用二元组的那些代码就全都需要修改，因为现在必须采用包含三个元素的元组才行。另外，统计成绩之和与权重之和时，还得分别用一个下划线跳过每个三元组里面表示评语的那一部分。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93189329072616780000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`grades = []\ngrades.append((95, 0.45, \'Great job\'))\ngrades.append((85, 0.55, \'Better next time\'))\ntotal = sum(score * weight for score, weight, _ in grades)\ntotal_weight = sum(weight for _, weight, _ in grades)\naverage_grade = total / total_weight`, `93189329072616780000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">grades <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\ngrades<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token string">\'Great job\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\ngrades<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">0.55</span><span class="token punctuation">,</span> <span class="token string">\'Better next time\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\ntotal <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>score <span class="token operator">*</span> weight <span class="token keyword">for</span> score<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> _ <span class="token keyword">in</span> grades<span class="token punctuation">)</span>\ntotal_weight <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>weight <span class="token keyword">for</span> _<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> _ <span class="token keyword">in</span> grades<span class="token punctuation">)</span>\naverage_grade <span class="token operator">=</span> total <span class="token operator">/</span> total_weight</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>元组拖得太长，就跟字典套得太深一样，都不好维护。所以只要发现元组里的元素超过两个，就应该考虑其他办法了。</p>\n<p>Python 内置的 collections 模块里有个具名元组（namedtuple）类型，恰好可以满足这样的需求，这种类型很容易就能定义出小型的类以表示不可变的数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70512773058300790000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import namedtuple\n\nGrade = namedtuple(\'Grade\', (\'score\', \'weight\'))`, `70512773058300790000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple\n\nGrade <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">\'Grade\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'score\'</span><span class="token punctuation">,</span> <span class="token string">\'weight\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这样的类，既可以通过位置参数构造，也可以用关键字参数来创建。每个属性都有名字，因此可以根据属性名称访问字段，如果将来需求发生变化（例如需要修改数据，或是要转变成一个简单的数据容器），也很容易就能把这种 namedtuple 改写成普通的类。</p>\n<h3 id="namedtuple-的局限"><a href="#namedtuple-%E7%9A%84%E5%B1%80%E9%99%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>namedtuple 的局限</h3>\n<p>虽然 namedtuple 可以用于许多场合，但我们一定要知道在哪些情况下不适合用它。</p>\n<ol>\n<li>namedtuple 类无法指定默认的参数值。如果数据的可选属性比较多，那么采用这种类来表示，会很不方便。在属性较多的情况下，应该改用内置的 dataclasses 模块实现。</li>\n<li>namedtuple 实例的属性值仍然可以通过数字下标与迭代来访问，所以可能还是会有人（尤其是那些通过你发布的 API 来编程的人）会采用这种方式访问这些属性，这样的话，将来就不太容易把它转成普通的类了。如果无法完全控制这些 namedtuple 实例的用法，那么最好还是明确定义一个新的类。</li>\n</ol>\n<p>有了叫作 Grade 的具名元组，我们就可以写出表示科目的 Subject 类，让它容纳许多个这样的元组。</p>\n<p>然后，就可以写一个表示学生的 Student 类，用它来记录某位学生各科目（Subject）的考试成绩。</p>\n<p>最后，写这样一个表示成绩册的 Gradebook 容器类，把每位学生的名字与表示这位学生的 Student 对象关联起来，如果成绩册里还没有记录过这位学生，那么在调用 <code class="language-text">get_student</code> 方法时，Gradebook 就会构造一个默认的 Student 对象给调用者使用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="71922241695852175000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import namedtuple, defaultdict\n\nGrade = namedtuple(\'Grade\', (\'score\', \'weight\'))\n\n\nclass Subject:\n    def __init__(self):\n        self._grades = []\n\n    def report_grade(self, score, weight):\n        self._grades.append(Grade(score, weight))\n\n    def average_grade(self):\n        total, total_weight = 0, 0\n        for grade in self._grades:\n            total += grade.score * grade.weight\n            total_weight += grade.weight\n        return total / total_weight\n\n\nclass Student:\n    def __init__(self):\n        self._subjects = defaultdict(Subject)\n\n    def get_subject(self, name):\n        return self._subjects[name]\n\n    def average_grade(self):\n        total, count = 0, 0\n        for subject in self._subjects.values():\n            total += subject.average_grade()\n            count += 1\n        return total / count\n\n\nclass Gradebook:\n    def __init__(self):\n        self._students = defaultdict(Student)\n\n    def get_student(self, name):\n        return self._students[name]\n\n\nbook = Gradebook()\nalbert = book.get_student(\'Albert Einstein\')\nmath = albert.get_subject(\'Math\')\nmath.report_grade(75, 0.05)\nmath.report_grade(65, 0.15)\nmath.report_grade(70, 0.80)\ngym = albert.get_subject(\'Gym\')\ngym.report_grade(100, 0.40)\ngym.report_grade(85, 0.60)\nprint(albert.average_grade())\n\n>>>\n80.25`, `71922241695852175000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token punctuation">,</span> defaultdict\n\nGrade <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">\'Grade\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">\'score\'</span><span class="token punctuation">,</span> <span class="token string">\'weight\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Subject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n\n    <span class="token keyword">def</span> <span class="token function">report_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_grades<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Grade<span class="token punctuation">(</span>score<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">average_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        total<span class="token punctuation">,</span> total_weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>\n        <span class="token keyword">for</span> grade <span class="token keyword">in</span> self<span class="token punctuation">.</span>_grades<span class="token punctuation">:</span>\n            total <span class="token operator">+=</span> grade<span class="token punctuation">.</span>score <span class="token operator">*</span> grade<span class="token punctuation">.</span>weight\n            total_weight <span class="token operator">+=</span> grade<span class="token punctuation">.</span>weight\n        <span class="token keyword">return</span> total <span class="token operator">/</span> total_weight\n\n\n<span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_subjects <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>Subject<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_subject</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_subjects<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n\n    <span class="token keyword">def</span> <span class="token function">average_grade</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        total<span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>\n        <span class="token keyword">for</span> subject <span class="token keyword">in</span> self<span class="token punctuation">.</span>_subjects<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            total <span class="token operator">+=</span> subject<span class="token punctuation">.</span>average_grade<span class="token punctuation">(</span><span class="token punctuation">)</span>\n            count <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> total <span class="token operator">/</span> count\n\n\n<span class="token keyword">class</span> <span class="token class-name">Gradebook</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_students <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>Student<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_student</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_students<span class="token punctuation">[</span>name<span class="token punctuation">]</span>\n\n\nbook <span class="token operator">=</span> Gradebook<span class="token punctuation">(</span><span class="token punctuation">)</span>\nalbert <span class="token operator">=</span> book<span class="token punctuation">.</span>get_student<span class="token punctuation">(</span><span class="token string">\'Albert Einstein\'</span><span class="token punctuation">)</span>\nmath <span class="token operator">=</span> albert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token string">\'Math\'</span><span class="token punctuation">)</span>\nmath<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span>\nmath<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">0.15</span><span class="token punctuation">)</span>\nmath<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">0.80</span><span class="token punctuation">)</span>\ngym <span class="token operator">=</span> albert<span class="token punctuation">.</span>get_subject<span class="token punctuation">(</span><span class="token string">\'Gym\'</span><span class="token punctuation">)</span>\ngym<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0.40</span><span class="token punctuation">)</span>\ngym<span class="token punctuation">.</span>report_grade<span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">0.60</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>albert<span class="token punctuation">.</span>average_grade<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token number">80.25</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这些类的代码所占篇幅，虽然比原来那种写法长了一倍，但理解起来却要容易得多。而且用这些类写出来的调用代码，也比原来更清晰、更便于扩展。</p>\n<p>另外，还可以提供一些向后兼容的方法，帮助大家把采用旧式 API 所写的代码迁移到这种通过对象体系所设计的方案之中。</p>\n<h3 id="总结-33"><a href="#%E6%80%BB%E7%BB%93-33" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>不要在字典里嵌套字典、长元组，以及用其他内置类型构造的复杂结构。</li>\n<li>namedtuple 能够实现出轻量级的容器，以存放不可变的数据，而且将来可以灵活地转化成普通的类。</li>\n<li>如果发现用字典来维护内部状态的那些代码已经越写越复杂了，那么就应该考虑改用多个类来实现。</li>\n</ol>\n<h2 id="第-38-条：让简单的接口接受函数，而不是类的实例"><a href="#%E7%AC%AC-38-%E6%9D%A1%EF%BC%9A%E8%AE%A9%E7%AE%80%E5%8D%95%E7%9A%84%E6%8E%A5%E5%8F%A3%E6%8E%A5%E5%8F%97%E5%87%BD%E6%95%B0%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 38 条：让简单的接口接受函数，而不是类的实例</h2>\n<p>Python 有许多内置的 API，都允许我们传入某个函数来定制它的行为。这种函数可以叫作挂钩（hook），API 在执行过程中，会回调（call back）这些挂钩函数。例如，list 类型的 sort 方法就带有可选的 key 参数，如果明确指定了这个参数，那么它就会按照你提供的挂钩函数来决定列表中每个元素的先后顺序（参见第 14 条）。下面的代码把内置的 len 函数当成挂钩传给 key 参数，让 sort 方法根据长度排列这些名字。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="94467877493017330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`names = [\'Socrates\', \'Archimedes\', \'Plato\', \'Aristotle\']\nnames.sort(key=len)\nprint(names)\n\n>>>\n[\'Plato\', \'Socrates\', \'Aristotle\', \'Archimedes\']`, `94467877493017330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'Socrates\'</span><span class="token punctuation">,</span> <span class="token string">\'Archimedes\'</span><span class="token punctuation">,</span> <span class="token string">\'Plato\'</span><span class="token punctuation">,</span> <span class="token string">\'Aristotle\'</span><span class="token punctuation">]</span>\nnames<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">[</span><span class="token string">\'Plato\'</span><span class="token punctuation">,</span> <span class="token string">\'Socrates\'</span><span class="token punctuation">,</span> <span class="token string">\'Aristotle\'</span><span class="token punctuation">,</span> <span class="token string">\'Archimedes\'</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在其他编程语言中，挂钩可能会用抽象类（abstract class）来定义。但在 Python 中，许多挂钩都是无状态的函数（stateless function），带有明确的参数与返回值。挂钩用函数来描述，要比定义成类更简单。用作挂钩的函数与别的函数一样，都是 Python 里的头等（first-class）对象，也就是说，这些函数与方法可以像 Python 中其他值那样传递与引用。</p>\n<p>例如，我们要定制 defaultdict 类的行为（相关的知识，参见第 17 条）。这种 defaultdict 数据结构允许调用者提供一个函数，用来在键名缺失的情况下，创建与这个键相对应的值。只要字典发现调用者想要访问的键不存在，就会触发这个函数，以返回应该与键相关联的默认值。下面定义一个 <code class="language-text">log_missing</code> 函数作为键名缺失时的挂钩，该函数总是会把这种键的默认值设为 0。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="37916932828634040000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def log_missing():\n    print(\'Key added\')\n    return 0`, `37916932828634040000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">log_missing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Key added\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>下面这段代码通过定制的 defaultdict 字典，把 increments 列表里面描述的增量添加到 current 这个普通字典所提供的初始量上面，但字典里一开始没有 red 和 orange 这两个键，因此 <code class="language-text">log_missing</code> 这个挂钩函数会触发两次，每次它都会打印 Key added 信息。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70089021618918520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\ndef log_missing():\n    print(\'Key added\')\n    return 0\n\n\ncurrent = {\'green\': 12, \'blue\': 3}\nincrements = [\n    (\'red\', 5),\n    (\'blue\', 17),\n    (\'orange\', 9),\n]\nresult = defaultdict(log_missing, current)\nprint(\'Before:\', dict(result))\nfor key, amount in increments:\n    result[key] += amount\nprint(\'After:\', dict(result))\n\n>>>\nBefore: {\'green\': 12, \'blue\': 3}\nKey added\nKey added\nAfter: {\'green\': 12, \'blue\': 20, \'red\': 5, \'orange\': 9}`, `70089021618918520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">def</span> <span class="token function">log_missing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Key added\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> <span class="token number">0</span>\n\n\ncurrent <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nincrements <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'blue\'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\nresult <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>log_missing<span class="token punctuation">,</span> current<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before:\'</span><span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">for</span> key<span class="token punctuation">,</span> amount <span class="token keyword">in</span> increments<span class="token punctuation">:</span>\n    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> amount\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After:\'</span><span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nKey added\nKey added\nAfter<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">\'red\'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">\'orange\'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>通过 <code class="language-text">log_missing</code> 这样的挂钩函数，我们很容易构建出便于测试的 API，这种 API 可以把挂钩所实现的附加效果（side effect）与数据本身所应具备的确定行为分开。例如，假设我们要在传给 defaultdict 的挂钩里面，统计它总共遇到了多少次键名缺失的情况。要实现这项功能，其中一个办法是采用有状态的闭包（stateful closure，参见第 21 条）。下面就定义一个辅助函数，把 missing 闭包当作挂钩传给 defaultdict 字典，以便为缺失的键提供默认值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62315843270496200000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def increment_with_report(current, increments):\n    added_count = 0\n\n    def missing():\n        nonlocal added_count  # Stateful closure\n        added_count += 1\n        return 0\n\n    result = defaultdict(missing, current)\n    for key, amount in increments:\n        result[key] += amount\n\n    return result, added_count`, `62315843270496200000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">increment_with_report</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> increments<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    added_count <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">missing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">nonlocal</span> added_count  <span class="token comment"># Stateful closure</span>\n        added_count <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span>\n\n    result <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>missing<span class="token punctuation">,</span> current<span class="token punctuation">)</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> amount <span class="token keyword">in</span> increments<span class="token punctuation">:</span>\n        result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> amount\n\n    <span class="token keyword">return</span> result<span class="token punctuation">,</span> added_count</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>运行这个辅助函数处理前面的数据，可以得到预期的结果（可以看到，键名缺失的情况确实出现了两次，函数返回的 count 值也为 2）。统计键名缺失次数所用的 <code class="language-text">added_count</code> 状态是由 missing 挂钩维护的，采用挂钩来运作的 defaultdict 字典并不需要关注这个细节。于是，这就体现了把简单函数传给接口的另一个好处，也就是方便稍后添加新的功能，因为我们可以把实现这项功能所用的状态隐藏在这个简单的闭包里面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17276498596298850000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\ndef increment_with_report(current, increments):\n    added_count = 0\n\n    def missing():\n        nonlocal added_count  # Stateful closure\n        added_count += 1\n        return 0\n\n    result = defaultdict(missing, current)\n    for key, amount in increments:\n        result[key] += amount\n\n    return result, added_count\n\n\ncurrent = {\'green\': 12, \'blue\': 3}\nincrements = [\n    (\'red\', 5),\n    (\'blue\', 17),\n    (\'orange\', 9),\n]\nresult, count = increment_with_report(current, increments)\nassert count == 2`, `17276498596298850000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{25-26}"\n              >\n                <span class="gatsby-code-button-language">py{25-26}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">def</span> <span class="token function">increment_with_report</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> increments<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    added_count <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">missing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">nonlocal</span> added_count  <span class="token comment"># Stateful closure</span>\n        added_count <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span>\n\n    result <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>missing<span class="token punctuation">,</span> current<span class="token punctuation">)</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> amount <span class="token keyword">in</span> increments<span class="token punctuation">:</span>\n        result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> amount\n\n    <span class="token keyword">return</span> result<span class="token punctuation">,</span> added_count\n\n\ncurrent <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nincrements <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'blue\'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n<span class="gatsby-highlight-code-line">result<span class="token punctuation">,</span> count <span class="token operator">=</span> increment_with_report<span class="token punctuation">(</span>current<span class="token punctuation">,</span> increments<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> count <span class="token operator">==</span> <span class="token number">2</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>与无状态的闭包函数相比，用有状态的闭包作为挂钩写出来的代码会难懂一些。为了让代码更清晰，可以专门定义一个小类，把原本由闭包所维护的状态给封装起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="70009171437071900000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class CountMissing:\n    def __init__(self):\n        self.added = 0\n\n    def missing(self):\n        self.added += 1\n        return 0`, `70009171437071900000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">CountMissing</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">missing</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在其他编程语言中，可能需要修改 defaultdict 以便与 CountMissing 接口相适应。但在 Python 中，方法与函数都是头等的（first-class）对象，因此可以直接通过对象引用它所属的 CountMissing 类里的 missing 方法，并把这个方法传给 defaultdict 充当挂钩，让字典可以用这个挂钩制作默认值。在 Python 中，这种通过对象实例而引用的方法，很容易就能满足函数的接口</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="5199665106043949000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass CountMissing:\n    def __init__(self):\n        self.added = 0\n\n    def missing(self):\n        self.added += 1\n        return 0\n\n\ncurrent = {\'green\': 12, \'blue\': 3}\nincrements = [\n    (\'red\', 5),\n    (\'blue\', 17),\n    (\'orange\', 9),\n]\ncounter = CountMissing()\nresult = defaultdict(counter.missing, current)  # Method ref\nfor key, amount in increments:\n    result[key] += amount\nassert counter.added == 2`, `5199665106043949000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{19-23}"\n              >\n                <span class="gatsby-code-button-language">py{19-23}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">CountMissing</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">missing</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span>\n\n\ncurrent <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nincrements <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'blue\'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n<span class="gatsby-highlight-code-line">counter <span class="token operator">=</span> CountMissing<span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">result <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>counter<span class="token punctuation">.</span>missing<span class="token punctuation">,</span> current<span class="token punctuation">)</span>  <span class="token comment"># Method ref</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">for</span> key<span class="token punctuation">,</span> amount <span class="token keyword">in</span> increments<span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> amount</span><span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> counter<span class="token punctuation">.</span>added <span class="token operator">==</span> <span class="token number">2</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>把有状态的闭包所具备的行为，改用辅助类来实现，要比前面的 <code class="language-text">increment_with_report</code> 函数更清晰。但如果单看这个类，可能没办法立刻了解它的意图。CountMissing 对象应该由谁构造？missing 方法应该由谁调用？这个类将来还会不会再增加 public 方法？这些疑惑都必须在看到 defaultdict 的用法之后才能解开。</p>\n<p>为了让这个类的意义更加明确，可以给它定义名为 <code class="language-text">__call__</code> 的特殊方法。这会让这个类的对象能够像函数那样得到调用。同时，也让内置的 callable 函数能够针对这种实例返回 True 值，用以表示这个实例与普通的函数或方法类似，都是可调用的。凡是能够像这样（在后面加一对括号来）执行的对象，都叫作 callable。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16763914436363160000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BetterCountMissing:\n    def __init__(self):\n        self.added = 0\n\n    def __call__(self):\n        self.added += 1\n        return 0\n\n\ncounter = BetterCountMissing()\nassert counter() == 0\nassert callable(counter)`, `16763914436363160000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BetterCountMissing</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span>\n\n\ncounter <span class="token operator">=</span> BetterCountMissing<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>\n<span class="token keyword">assert</span> <span class="token builtin">callable</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面，就用这样的 BetterCountMissing 实例给 defaultdict 当挂钩，让它在字典里没有键名时，创建默认的键值，并把这种情况记入键名缺失的总次数里。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97127364487629680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections import defaultdict\n\n\nclass BetterCountMissing:\n    def __init__(self):\n        self.added = 0\n\n    def __call__(self):\n        self.added += 1\n        return 0\n\n\ncurrent = {\'green\': 12, \'blue\': 3}\nincrements = [\n    (\'red\', 5),\n    (\'blue\', 17),\n    (\'orange\', 9),\n]\ncounter = BetterCountMissing()\nresult = defaultdict(counter, current)\nfor key, amount in increments:\n    result[key] += amount\nassert counter.added == 2`, `97127364487629680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{19-23}"\n              >\n                <span class="gatsby-code-button-language">py{19-23}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict\n\n\n<span class="token keyword">class</span> <span class="token class-name">BetterCountMissing</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>added <span class="token operator">+=</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> <span class="token number">0</span>\n\n\ncurrent <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">\'green\'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">\'blue\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>\nincrements <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">(</span><span class="token string">\'red\'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'blue\'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">\'orange\'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n<span class="gatsby-highlight-code-line">counter <span class="token operator">=</span> BetterCountMissing<span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">result <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span>counter<span class="token punctuation">,</span> current<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">for</span> key<span class="token punctuation">,</span> amount <span class="token keyword">in</span> increments<span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> amount</span><span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> counter<span class="token punctuation">.</span>added <span class="token operator">==</span> <span class="token number">2</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面这段代码要比 CountMissing 更清晰，因为它里面有 <code class="language-text">__call__</code> 方法，这说明这个类的实例可像普通的函数那样使用（例如可以传给 API 当挂钩）。即便是初次看到这段代码，也能明白这个类的主要目标。因为你应该会注意到那个比较显眼的 <code class="language-text">__call__</code> 方法。它强烈暗示着这个类可以像有状态的闭包那样使用。</p>\n<p>总之，最大的优势在于，defaultdict 仍然不需要关注 <code class="language-text">__call__</code> 方法触发之后究竟会做什么。它只知道自己可以用这样一个挂钩，来给缺失的键制作默认值。Python 很容易就能设计这种把挂钩函数当参数来用的接口，面对这种接口，调用者可以采用最适合自己的，把符合接口要求的东西传进去。</p>\n<h3 id="总结-34"><a href="#%E6%80%BB%E7%BB%93-34" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>如果想设计简单的 Python 接口，让组件之间能够通过接口交互，那么可以考虑让接口接受挂钩函数，而不一定非得定义新类，并要求使用者传入这种类的实例。</li>\n<li>Python 的函数与方法都是头等对象，这意味着它们可以像其他类型那样，用在表达式里。</li>\n<li>某个类如果定义了 <code class="language-text">__call__</code> 特殊方法，那么它的实例就可以像普通的 Python 函数那样调用。</li>\n<li>如果想用函数来维护状态，那么可以考虑定义一个带有 <code class="language-text">__call__</code> 方法的新类，而不要用有状态的闭包去实现。</li>\n</ol>\n<h2 id="第-39-条：通过-classmethod-多态来构造同一体系中的各类对象"><a href="#%E7%AC%AC-39-%E6%9D%A1%EF%BC%9A%E9%80%9A%E8%BF%87-classmethod-%E5%A4%9A%E6%80%81%E6%9D%A5%E6%9E%84%E9%80%A0%E5%90%8C%E4%B8%80%E4%BD%93%E7%B3%BB%E4%B8%AD%E7%9A%84%E5%90%84%E7%B1%BB%E5%AF%B9%E8%B1%A1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 39 条：通过 @classmethod 多态来构造同一体系中的各类对象</h2>\n<p>在 Python 中，不仅对象支持多态，类也支持多态。类的多态是什么意思，这样做有什么好处？</p>\n<p>多态机制使同一体系中的多个类可以按照各自独有的方式来实现同一个方法，这意味着这些类都可以满足同一套接口，或者都可以当作某个抽象类来使用，同时，它们又能在这个前提下，实现各自的功能（参见第 43 条）。</p>\n<p>例如，要实现一套 MapReduce（映射-归纳/映射-化简）流程，并且以一个通用的类来表示输入数据。于是，笔者就定义了这样一个 InputData 类，并把 read 方法留给子类去实现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="82250690599306630000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class InputData:\n    def read(self):\n        raise NotImplementedError`, `82250690599306630000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">InputData</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>然后，编写一个具体的 InputData 子类，例如，可以从磁盘文件中读取数据的 PathInputData 类。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76788650802754080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class PathInputData(InputData):\n    def __init__(self, path):\n        super().__init__()\n        self.path = path\n\n    def read(self):\n        with open(self.path) as f:\n            return f.read()`, `76788650802754080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">PathInputData</span><span class="token punctuation">(</span>InputData<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>path <span class="token operator">=</span> path\n\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>通用的 InputData 类以后可能会有很多个像 PathInputData 这样的子类，每个子类都会实现标准的 read 接口，并按照各自的方式把需要处理的数据读取进来。例如，有的 InputData 子类可从网上读取数据，有的 InputData 可读取压缩格式的数据并将其解压成普通数据，等等。</p>\n<p>除了输入数据要通用，我们还想让处理 MapReduce 任务的工作节点（Worker）也能有一套通用的抽象接口，这样不同的 Worker 就可以通过这套标准的接口来消耗输入数据。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2931094036782667000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Worker:\n    def __init__(self, input_data):\n        self.input_data = input_data\n        self.result = None\n\n    def map(self):\n        raise NotImplementedError\n\n    def reduce(self, other):\n        raise NotImplementedError`, `2931094036782667000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Worker</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>input_data <span class="token operator">=</span> input_data\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token boolean">None</span>\n\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面，我们定义一种具体的 Worker 子类，使它按照特定的方式实现 MapReduce。也就是统计每份数据里的换行符个数，然后把所有的统计值汇总起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25816214124030034000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class LineCountWorker(Worker):\n    def map(self):\n        data = self.input_data.read()\n        self.result = data.count(\'\\n\')\n\n    def reduce(self, other):\n        self.result += other.result`, `25816214124030034000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">LineCountWorker</span><span class="token punctuation">(</span>Worker<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        data <span class="token operator">=</span> self<span class="token punctuation">.</span>input_data<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">\'\\n\'</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">+=</span> other<span class="token punctuation">.</span>result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样实现似乎不错，但接下来会碰到一个大难题，也就是如何把这些组件拼接起来。输入数据与工作节点都有各自的类体系，而且这两套体系也抽象出了合理的接口，然而，它们都必须落实到具体的对象上面，只有构造出了具体对象，才能写出有用的程序。问题是，这些对象由谁来构造？构造出来之后，怎么编排 MapReduce 流程？</p>\n<p>最简单的办法，是编写几个辅助函数，手动构建这些对象并把它们连接起来。例如，可以采用下面的辅助函数读取目录中的内容，并给目录下每份文件构造一个 PathInputData 实例。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78848450666259640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import os\n\n\ndef generate_inputs(data_dir):\n    for name in os.listdir(data_dir):\n        yield PathInputData(os.path.join(data_dir, name))`, `78848450666259640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> os\n\n\n<span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> PathInputData<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>接下来，再编写一个辅助函数，针对 <code class="language-text">generate_inputs</code> 返回的每个 InputData 实例分别创建相应的 LineCountWorker 对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="89063336061867620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def create_workers(input_list):\n    workers = []\n    for input_data in input_list:\n        workers.append(LineCountWorker(input_data))\n    return workers`, `89063336061867620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">create_workers</span><span class="token punctuation">(</span>input_list<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    workers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> input_data <span class="token keyword">in</span> input_list<span class="token punctuation">:</span>\n        workers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>LineCountWorker<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> workers</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然后，将这些 Worker 实例的映射（map）工作分发到多个线程中去执行（参见第 53 条）。反复调用 reduce，把这些 Worker 计算出的结果合并成一个值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="69008154932940700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from threading import Thread\n\n\ndef execute(workers):\n    threads = [Thread(target=w.map) for w in workers]\n    for thread in threads:\n        thread.start()\n    for thread in threads:\n        thread.join()\n\n    first, *rest = workers\n    for worker in rest:\n        first.reduce(worker)\n    return first.result`, `69008154932940700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread\n\n\n<span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>workers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    threads <span class="token operator">=</span> <span class="token punctuation">[</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>w<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">)</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> workers<span class="token punctuation">]</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    first<span class="token punctuation">,</span> <span class="token operator">*</span>rest <span class="token operator">=</span> workers\n    <span class="token keyword">for</span> worker <span class="token keyword">in</span> rest<span class="token punctuation">:</span>\n        first<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>worker<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> first<span class="token punctuation">.</span>result</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>最后，编写一个函数，将刚才那三个环节串起来。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6020823379660478000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def mapreduce(data_dir):\n    inputs = generate_inputs(data_dir)\n    workers = create_workers(inputs)\n    return execute(workers)`, `6020823379660478000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">mapreduce</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    inputs <span class="token operator">=</span> generate_inputs<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span>\n    workers <span class="token operator">=</span> create_workers<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> execute<span class="token punctuation">(</span>workers<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>可以看到，该函数可以很好地处理随机制造出的这批输入文件。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="19850515279857816000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import random\nfrom threading import Thread\nimport os\n\n\nclass InputData:\n    def read(self):\n        raise NotImplementedError\n\n\nclass PathInputData(InputData):\n    def __init__(self, path):\n        super().__init__()\n        self.path = path\n\n    def read(self):\n        with open(self.path) as f:\n            return f.read()\n\n\nclass Worker:\n    def __init__(self, input_data):\n        self.input_data = input_data\n        self.result = None\n\n    def map(self):\n        raise NotImplementedError\n\n    def reduce(self, other):\n        raise NotImplementedError\n\n\nclass LineCountWorker(Worker):\n    def map(self):\n        data = self.input_data.read()\n        self.result = data.count(\'\\n\')\n\n    def reduce(self, other):\n        self.result += other.result\n\n\ndef generate_inputs(data_dir):\n    for name in os.listdir(data_dir):\n        yield PathInputData(os.path.join(data_dir, name))\n\n\ndef create_workers(input_list):\n    workers = []\n    for input_data in input_list:\n        workers.append(LineCountWorker(input_data))\n    return workers\n\n\ndef mapreduce(data_dir):\n    inputs = generate_inputs(data_dir)\n    workers = create_workers(inputs)\n    return execute(workers)\n\n\ndef execute(workers):\n    threads = [Thread(target=w.map) for w in workers]\n    for thread in threads:\n        thread.start()\n    for thread in threads:\n        thread.join()\n\n    first, *rest = workers\n    for worker in rest:\n        first.reduce(worker)\n    return first.result\n\n\ndef write_test_files(tmpdir):\n    os.makedirs(tmpdir)\n    print(\'generate dir is:\', os.path.abspath(tmpdir))\n    for i in range(100):\n        with open(os.path.join(tmpdir, str(i)), \'w\') as f:\n            f.write(\'\\n\' * random.randint(0, 100))\n\n\ntmpdir = \'test_inputs\'\nwrite_test_files(tmpdir)\nresult = mapreduce(tmpdir)\nprint(f\'There are {result} lines\')\n\n>>>\ngenerate dir is: /home/123/Desktop/test_inputs\nThere are 4884 lines`, `19850515279857816000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{73-84}"\n              >\n                <span class="gatsby-code-button-language">py{73-84}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> random\n<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread\n<span class="token keyword">import</span> os\n\n\n<span class="token keyword">class</span> <span class="token class-name">InputData</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n\n<span class="token keyword">class</span> <span class="token class-name">PathInputData</span><span class="token punctuation">(</span>InputData<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>path <span class="token operator">=</span> path\n\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Worker</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>input_data <span class="token operator">=</span> input_data\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token boolean">None</span>\n\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n\n<span class="token keyword">class</span> <span class="token class-name">LineCountWorker</span><span class="token punctuation">(</span>Worker<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        data <span class="token operator">=</span> self<span class="token punctuation">.</span>input_data<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">\'\\n\'</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">+=</span> other<span class="token punctuation">.</span>result\n\n\n<span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">for</span> name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">yield</span> PathInputData<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">create_workers</span><span class="token punctuation">(</span>input_list<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    workers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token keyword">for</span> input_data <span class="token keyword">in</span> input_list<span class="token punctuation">:</span>\n        workers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>LineCountWorker<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">return</span> workers\n\n\n<span class="token keyword">def</span> <span class="token function">mapreduce</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    inputs <span class="token operator">=</span> generate_inputs<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span>\n    workers <span class="token operator">=</span> create_workers<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> execute<span class="token punctuation">(</span>workers<span class="token punctuation">)</span>\n\n\n<span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>workers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    threads <span class="token operator">=</span> <span class="token punctuation">[</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>w<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">)</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> workers<span class="token punctuation">]</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    first<span class="token punctuation">,</span> <span class="token operator">*</span>rest <span class="token operator">=</span> workers\n    <span class="token keyword">for</span> worker <span class="token keyword">in</span> rest<span class="token punctuation">:</span>\n        first<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>worker<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> first<span class="token punctuation">.</span>result\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">write_test_files</span><span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'generate dir is:\'</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmpdir<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'w\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">\'\\n\'</span> <span class="token operator">*</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">tmpdir <span class="token operator">=</span> <span class="token string">\'test_inputs\'</span></span><span class="gatsby-highlight-code-line">write_test_files<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">result <span class="token operator">=</span> mapreduce<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'There are </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string"> lines\'</span></span><span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\ngenerate <span class="token builtin">dir</span> <span class="token keyword">is</span><span class="token punctuation">:</span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">123</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>test_inputs\nThere are <span class="token number">4884</span> lines</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然而这样做有个大问题，就是 mapreduce 函数根本不通用。假如要使用其他的 InputData 或 Worker 子类，那就必须修改 <code class="language-text">generate_inputs</code>、<code class="language-text">create_workers</code> 与 mapreduce 的代码，以匹配新类的用法。</p>\n<p>这个问题的根本原因在于，构造对象的办法不够通用。在其他编程语言中，可以利用构造函数多态（constructor polymorphism）来解决，也就是子类不仅要具备与超类一致的构造函数，而且还必须各自提供一个特殊的构造函数以实现和自身有关的构造逻辑。这样，刚才那些辅助方法在编排 MapReduce 流程时，就可以按照超类的形式统一地构造这些对象，并使其根据所属的子类分别去触发相关的特殊构造函数（类似工厂模式）。但是我们在 Python 里不能这样做，因为 Python 的类只能有一个构造方法（即 <code class="language-text">__init__</code> 方法），没办法要求所有的 InputData 子类都采用同一种写法来定义 <code class="language-text">__init__</code>（因为它们必须用各自不同的数据来完成构造）。</p>\n<p>这个问题，最好是能够通过类方法多态（class method polymorphism）来解决。这种多态与 InputData.read 所体现的实例方法多态（instance method polymorphism）很像，只不过它针对的是类，而不是这些类的对象。</p>\n<p>我们现在运用方法多态来实现 MapReduce 流程所用到的这些类。首先改写 InputData 类，把 <code class="language-text">generate_inputs</code> 方法放到该类里面并声明成通用的 @classmethod，这样它的所有子类都可以通过同一个接口来新建具体的 InputData 实例。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="8861279844477377000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class GenericInputData:\n    def read(self):\n        raise NotImplementedError\n\n    @classmethod\n    def generate_inputs(cls, config):\n        raise NotImplementedError`, `8861279844477377000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">GenericInputData</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>新的 <code class="language-text">generate_inputs</code> 方法带有一个叫作 config 的字典参数，调用者可以把一系列配置信息放到字典里中，让具体的 GenericInputData 子类去解读。例如 PathInputData 这个子类就会通过 <code class="language-text">data_dir</code> 键从字典里寻找含有输入文件的那个目录。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92928493468685070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class PathInputData(GenericInputData):\n    @classmethod\n    def generate_inputs(cls, config):\n        data_dir = config[\'data_dir\']\n        for name in os.listdir(data_dir):\n            yield cls(os.path.join(data_dir, name))`, `92928493468685070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">PathInputData</span><span class="token punctuation">(</span>GenericInputData<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        data_dir <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">\'data_dir\'</span><span class="token punctuation">]</span>\n        <span class="token keyword">for</span> name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> cls<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然后，可以用类似的思路改写前面的 Worker 类。把名叫 <code class="language-text">create_workers</code> 的辅助方法移到这个类里面并且也声明成 @classmethod。新方法的 <code class="language-text">input_class</code> 参数将会是 GenericInputData 的某个子类，我们要通过这个参数触发那个子类的 <code class="language-text">generate_inputs</code> 方法，以创建出 Worker 所需的输入信息。有了输入信息之后，通过 <code class="language-text">cls(input_data)</code> 这个通用的形式来调用构造函数，这样创建的实例，其类型是 cls 所表示的具体 GenericWorker 子类。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93848373566525230000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class GenericWorker:\n    def __init__(self, input_data):\n        self.input_data = input_data\n        self.result = None\n\n    def map(self):\n        raise NotImplementedError\n\n    def reduce(self, other):\n        raise NotImplementedError\n\n    @classmethod\n    def create_workers(cls, input_class, config):\n        workers = []\n        for input_data in input_class.generate_inputs(config):\n            workers.append(cls(input_data))\n        return workers`, `93848373566525230000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">GenericWorker</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>input_data <span class="token operator">=</span> input_data\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token boolean">None</span>\n\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">create_workers</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> input_class<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        workers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n        <span class="token keyword">for</span> input_data <span class="token keyword">in</span> input_class<span class="token punctuation">.</span>generate_inputs<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            workers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cls<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span> workers</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>请注意，上面的代码创建输入信息时，用的是 <code class="language-text">input_class.generate_inputs</code> 这样的写法，这么写正是为了触发类多态机制，以便将 <code class="language-text">generate_inputs</code> 派发到 <code class="language-text">input_class</code> 所表示的那个实际子类上面。另外还要注意，在构造 GenericWorker 的子类对象时，用的是 <code class="language-text">cls(...)</code> 这样的通用写法，而没有直接调用 <code class="language-text">__init__</code> 方法。</p>\n<p>接下来要修改具体的 Worker 类，这其实很简单，只需要把超类的名称改为 GenericWorker 就好。</p>\n<p>最后，重新编写 mapreduce 函数，让它通过 <code class="language-text">worker_class.create_workers</code> 来创建工作节点，这样它就变得通用了。</p>\n<p>把原来那套实现方案所处理的随机文件，再采用这套新的工作节点来处理，可以产生相同的结果。区别只在于，这次调用 mapreduce 时，必须多传几个参数，因为它现在是个通用的函数，必须把实际的输入数据与实际的工作节点告诉它。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56986100276870870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import random\nfrom threading import Thread\nimport os\n\n\nclass GenericInputData:\n    def read(self):\n        raise NotImplementedError\n\n    @classmethod\n    def generate_inputs(cls, config):\n        raise NotImplementedError\n\n\nclass PathInputData(GenericInputData):\n    def __init__(self, path):\n        super().__init__()\n        self.path = path\n\n    def read(self):\n        with open(self.path) as f:\n            return f.read()\n\n    @classmethod\n    def generate_inputs(cls, config):\n        data_dir = config[\'data_dir\']\n        for name in os.listdir(data_dir):\n            yield cls(os.path.join(data_dir, name))\n\n\nclass GenericWorker:\n    def __init__(self, input_data):\n        self.input_data = input_data\n        self.result = None\n\n    def map(self):\n        raise NotImplementedError\n\n    def reduce(self, other):\n        raise NotImplementedError\n\n    @classmethod\n    def create_workers(cls, input_class, config):\n        workers = []\n        for input_data in input_class.generate_inputs(config):\n            workers.append(cls(input_data))\n        return workers\n\n\nclass LineCountWorker(GenericWorker):\n    def map(self):\n        data = self.input_data.read()\n        self.result = data.count(\'\\n\')\n\n    def reduce(self, other):\n        self.result += other.result\n\n\ndef mapreduce(worker_class, input_class, config):\n    workers = worker_class.create_workers(input_class, config)\n    return execute(workers)\n\n\ndef execute(workers):\n    threads = [Thread(target=w.map) for w in workers]\n    for thread in threads:\n        thread.start()\n    for thread in threads:\n        thread.join()\n\n    first, *rest = workers\n    for worker in rest:\n        first.reduce(worker)\n    return first.result\n\n\ndef write_test_files(tmpdir):\n    os.makedirs(tmpdir)\n    print(\'generate dir is:\', os.path.abspath(tmpdir))\n    for i in range(100):\n        with open(os.path.join(tmpdir, str(i)), \'w\') as f:\n            f.write(\'\\n\' * random.randint(0, 100))\n\n\ntmpdir = \'test_inputs\'\nwrite_test_files(tmpdir)\nconfig = {\n    \'data_dir\': tmpdir\n}\nresult = mapreduce(LineCountWorker, PathInputData, config)\nprint(f\'There are {result} lines\')\n\n>>>\ngenerate dir is: /home/123/Desktop/test_inputs\nThere are 5373 lines`, `56986100276870870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{6,10-12,15,24-28,31,42-47,50,59-61,87-90}"\n              >\n                <span class="gatsby-code-button-language">py{6,10-12,15,24-28,31,42-47,50,59-61,87-90}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> random\n<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread\n<span class="token keyword">import</span> os\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">GenericInputData</span><span class="token punctuation">:</span></span>    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n<span class="gatsby-highlight-code-line">    @<span class="token builtin">classmethod</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">raise</span> NotImplementedError</span>\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">PathInputData</span><span class="token punctuation">(</span>GenericInputData<span class="token punctuation">)</span><span class="token punctuation">:</span></span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>path <span class="token operator">=</span> path\n\n    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            <span class="token keyword">return</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="gatsby-highlight-code-line">    @<span class="token builtin">classmethod</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">generate_inputs</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        data_dir <span class="token operator">=</span> config<span class="token punctuation">[</span><span class="token string">\'data_dir\'</span><span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">for</span> name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            <span class="token keyword">yield</span> cls<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">GenericWorker</span><span class="token punctuation">:</span></span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>input_data <span class="token operator">=</span> input_data\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token boolean">None</span>\n\n    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">raise</span> NotImplementedError\n\n<span class="gatsby-highlight-code-line">    @<span class="token builtin">classmethod</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">create_workers</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> input_class<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        workers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">for</span> input_data <span class="token keyword">in</span> input_class<span class="token punctuation">.</span>generate_inputs<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            workers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cls<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">return</span> workers</span>\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">LineCountWorker</span><span class="token punctuation">(</span>GenericWorker<span class="token punctuation">)</span><span class="token punctuation">:</span></span>    <span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        data <span class="token operator">=</span> self<span class="token punctuation">.</span>input_data<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">=</span> data<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">\'\\n\'</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">reduce</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>result <span class="token operator">+=</span> other<span class="token punctuation">.</span>result\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">def</span> <span class="token function">mapreduce</span><span class="token punctuation">(</span>worker_class<span class="token punctuation">,</span> input_class<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    workers <span class="token operator">=</span> worker_class<span class="token punctuation">.</span>create_workers<span class="token punctuation">(</span>input_class<span class="token punctuation">,</span> config<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">return</span> execute<span class="token punctuation">(</span>workers<span class="token punctuation">)</span></span>\n\n<span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>workers<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    threads <span class="token operator">=</span> <span class="token punctuation">[</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>w<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">)</span> <span class="token keyword">for</span> w <span class="token keyword">in</span> workers<span class="token punctuation">]</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>\n        thread<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    first<span class="token punctuation">,</span> <span class="token operator">*</span>rest <span class="token operator">=</span> workers\n    <span class="token keyword">for</span> worker <span class="token keyword">in</span> rest<span class="token punctuation">:</span>\n        first<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>worker<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> first<span class="token punctuation">.</span>result\n\n\n<span class="token keyword">def</span> <span class="token function">write_test_files</span><span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span>\n    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'generate dir is:\'</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmpdir<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'w\'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>\n            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">\'\\n\'</span> <span class="token operator">*</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\ntmpdir <span class="token operator">=</span> <span class="token string">\'test_inputs\'</span>\nwrite_test_files<span class="token punctuation">(</span>tmpdir<span class="token punctuation">)</span>\n<span class="gatsby-highlight-code-line">config <span class="token operator">=</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token string">\'data_dir\'</span><span class="token punctuation">:</span> tmpdir</span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span></span><span class="gatsby-highlight-code-line">result <span class="token operator">=</span> mapreduce<span class="token punctuation">(</span>LineCountWorker<span class="token punctuation">,</span> PathInputData<span class="token punctuation">,</span> config<span class="token punctuation">)</span></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'There are </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string"> lines\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\ngenerate <span class="token builtin">dir</span> <span class="token keyword">is</span><span class="token punctuation">:</span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">123</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>test_inputs\nThere are <span class="token number">5373</span> lines</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这套方案让我们能够随意编写其他的 GenericInputData 与 GenericWorker 子类，而不用再花时间去调整它们之间的拼接代码（glue code）。</p>\n<h3 id="总结-35"><a href="#%E6%80%BB%E7%BB%93-35" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Python 只允许每个类有一个构造方法，也就是 <code class="language-text">__init__</code> 方法。</li>\n<li>如果想在超类中用通用的代码构造子类实例，那么可以考虑定义 @classmethod 方法，并在里面用 <code class="language-text">cls(...)</code> 的形式构造具体的子类对象。</li>\n<li>通过类方法多态机制，我们能够以通用的形式构造并拼接具体的子类对象。</li>\n</ol>\n<h2 id="第-40-条：通过-super-初始化超类"><a href="#%E7%AC%AC-40-%E6%9D%A1%EF%BC%9A%E9%80%9A%E8%BF%87-super-%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B6%85%E7%B1%BB" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 40 条：通过 super 初始化超类</h2>\n<p>以前有种简单的写法，能在子类里面执行超类的初始化逻辑，那就是直接在超类名称上调用 <code class="language-text">__init__</code> 方法并把子类实例传进去。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="91483124471381360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass MyChildClass(MyBaseClass):\n    def __init__(self):\n        MyBaseClass.__init__(self, 5)`, `91483124471381360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyChildClass</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个办法能够应对比较简单的类体系，但是在其他的情况下容易出现问题。</p>\n<p>假如某个类继承了多个超类（一般来说不应该采用多重继承，笔者这里只是举例而已，参见第 41 条），那么直接调用超类的 <code class="language-text">__init__</code> 方法会让代码产生误会。</p>\n<p>直接调用 <code class="language-text">__init__</code> 方法所产生的第一个问题在于，超类的构造逻辑不一定会按照它们在子类 class 语句中的声明顺序执行。例如，在 MyBaseClass 之外再定义两个类，让它们也分别去操纵本实例的 value 字段。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27829781950358077000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class TimesTwo:\n    def __init__(self):\n        self.value *= 2\n\n\nclass PlusFive:\n    def __init__(self):\n        self.value += 5`, `27829781950358077000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">TimesTwo</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">*=</span> <span class="token number">2</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">PlusFive</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面这个子类继承了刚才那三个类，而且它在 class 语句里指定的超类顺序与它执行那些超类的 <code class="language-text">__init__</code> 时所用的顺序一致。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79498238245182870000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class OneWay(MyBaseClass, TimesTwo, PlusFive):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        TimesTwo.__init__(self)\n        PlusFive.__init__(self)`, `79498238245182870000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">OneWay</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">,</span> TimesTwo<span class="token punctuation">,</span> PlusFive<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        TimesTwo<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>\n        PlusFive<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写，程序会按正常顺序初始化那几个超类。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="65017192023882146000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass TimesTwo:\n    def __init__(self):\n        self.value *= 2\n\n\nclass PlusFive:\n    def __init__(self):\n        self.value += 5\n\n\nclass OneWay(MyBaseClass, TimesTwo, PlusFive):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        TimesTwo.__init__(self)\n        PlusFive.__init__(self)\n\n\nfoo = OneWay(5)\nprint(\'First ordering value is (5 * 2) + 5 =\', foo.value)\n\n>>>\nFirst ordering value is (5 * 2) + 5 = 15`, `65017192023882146000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{23-24}"\n              >\n                <span class="gatsby-code-button-language">py{23-24}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">TimesTwo</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">*=</span> <span class="token number">2</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">PlusFive</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">5</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">OneWay</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">,</span> TimesTwo<span class="token punctuation">,</span> PlusFive<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        TimesTwo<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>\n        PlusFive<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>\n\n\n<span class="gatsby-highlight-code-line">foo <span class="token operator">=</span> OneWay<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'First ordering value is (5 * 2) + 5 =\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">.</span>value<span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\nFirst ordering value <span class="token keyword">is</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">=</span> <span class="token number">15</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但如果子类在 class 语句里指定的超类顺序，与它执行那些超类的 <code class="language-text">__init__</code> 时的顺序不同，那么运行结果就会让人困惑（例如这次先声明它继承 PlusFive 类，然后才声明它继承 TimesTwo 类，但执行 <code class="language-text">__init__</code> 的顺序却刚好相反）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34412473595821600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class AnotherWay(MyBaseClass, PlusFive, TimesTwo):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        TimesTwo.__init_(self)\n        PlusFive.__init_(self)`, `34412473595821600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">AnotherWay</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">,</span> PlusFive<span class="token punctuation">,</span> TimesTwo<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        TimesTwo<span class="token punctuation">.</span>__init_<span class="token punctuation">(</span>self<span class="token punctuation">)</span>\n        PlusFive<span class="token punctuation">.</span>__init_<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>该子类调整了两个超类的声明顺序，但没有相应调整构造逻辑的执行顺序，因此它还是会跟前面那个子类一样，先初始化 TimesTwo，然后初始化 PlusFive。这样写，就让初次看到这段代码的人很难理解程序的运行结果，他们以为程序先加 5，再乘 2，这样算出来是 20；但实际上，程序依照的是 <code class="language-text">__init__</code> 的调用顺序，而不是 class 语句中的声明顺序，这是个很难察觉的问题。</p>\n<p>直接调用 <code class="language-text">__init__</code> 所产生的第二个问题在于，无法正确处理菱形继承（diamond inheritance）。这种继承指的是子类通过类体系里两条不同路径的类继承了同一个超类。如果采用刚才那种常见的写法来调用超类的 <code class="language-text">__init__</code>，那么会让超类的初始化逻辑重复执行，从而引发混乱。例如，下面先从 MyBaseClass 派生出两个子类。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="99196382895244280000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass TimesSeven(MyBaseClass):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        self.value *= 7\n\n\nclass PlusNine(MyBaseClass):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        self.value += 9`, `99196382895244280000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">TimesSeven</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">*=</span> <span class="token number">7</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">PlusNine</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">9</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>然后，定义最终的子类，让它分别继承刚才那两个类，这样 MyBaseClass 就会出现在菱形体系的顶端。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43569305390926135000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass TimesSeven(MyBaseClass):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        self.value *= 7\n\n\nclass PlusNine(MyBaseClass):\n    def __init__(self, value):\n        MyBaseClass.__init__(self, value)\n        self.value += 9\n\n\nclass ThisWay(TimesSeven, PlusNine):\n    def __init__(self, value):\n        TimesSeven.__init__(self, value)\n        PlusNine.__init__(self, value)\n\n\nfoo = ThisWay(5)\nprint(\'Should be (5 * 7) + 9 = 44 but is\', foo.value)\n\n>>>\nShould be (5 * 7) + 9 = 44 but is 14`, `43569305390926135000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{18-25}"\n              >\n                <span class="gatsby-code-button-language">py{18-25}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">TimesSeven</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">*=</span> <span class="token number">7</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">PlusNine</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        MyBaseClass<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">9</span>\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">ThisWay</span><span class="token punctuation">(</span>TimesSeven<span class="token punctuation">,</span> PlusNine<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        TimesSeven<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        PlusNine<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line">foo <span class="token operator">=</span> ThisWay<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Should be (5 * 7) + 9 = 44 but is\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">.</span>value<span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\nShould be <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">=</span> <span class="token number">44</span> but <span class="token keyword">is</span> <span class="token number">14</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>当 ThisWay 调用第二个超类的 <code class="language-text">__init__</code> 时，那个方法会再度触发 MyBaseClass 的 <code class="language-text">__init__</code>，导致 self.value 重新变成 5。所以，最后的结果是 5 + 9 = 14，而不是 <code class="language-text">(5 * 7) + 9 = 44</code>，因为早前由 <code class="language-text">TimesSeven.__init__</code> 所做的初始化效果已经被第二次执行的 <code class="language-text">MyBaseClass.__init__</code> 覆盖了。这是个违背直觉的结果，如果情况更为复杂，那么调试起来会特别困难。</p>\n<p>为了解决这些问题，Python 内置了 super 函数并且规定了标准的方法解析顺序（method resolution order，MRO）。super 能够确保菱形继承体系中的共同超类只初始化一次（其他案例参见第 48 条）。MRO 可以确定超类之间的初始化顺序，它遵循 C3 线性化（C3 linearization）算法。</p>\n<p>下面再创建一套菱形的类体系，但是这次，我们改用 <code class="language-text">super()</code> 来调用超类的初始化逻辑。</p>\n<p>位于菱形结构顶端的 MyBaseClass，会率先初始化，而且只会初始化一次。接下来，程序会参照菱形底端那个子类在 class 语句里声明超类时的顺序，来执行菱形结构中部的那两个超类。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46874464649028470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass TimesSevenCorrect(MyBaseClass):\n    def __init__(self, value):\n        super().__init__(value)\n        self.value *= 7\n\n\nclass PlusNineCorrect(MyBaseClass):\n    def __init__(self, value):\n        super().__init__(value)\n        self.value += 9\n\n\nclass GoodWay(TimesSevenCorrect, PlusNineCorrect):\n    def __init__(self, value):\n        super().__init__(value)\n\n\nfoo = GoodWay(5)\nprint(\'Should be 7 * (5 + 9) = 98 but is\', foo.value)\n\n>>>\nShould be 7 * (5 + 9) = 98 but is 98`, `46874464649028470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">TimesSevenCorrect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">*=</span> <span class="token number">7</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">PlusNineCorrect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">9</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">GoodWay</span><span class="token punctuation">(</span>TimesSevenCorrect<span class="token punctuation">,</span> PlusNineCorrect<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n\n\nfoo <span class="token operator">=</span> GoodWay<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Should be 7 * (5 + 9) = 98 but is\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nShould be <span class="token number">7</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">98</span> but <span class="token keyword">is</span> <span class="token number">98</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这个执行顺序，似乎与看上去的相反。既然 GoodWay 在指定超类时，先写的是 TimesSevenCorrect，那就应该先执行 <code class="language-text">TimesSevenCorrect.__init__</code> 才对，这样结果应该是 <code class="language-text">(5 * 7) + 9 = 44</code>。但实际上并非如此。这两个超类之间的初始化顺序，要由子类的 MRO 确定，它可以通过 mro 方法来查询。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="30010351796881830000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`mro_str = \'\\n\'.join(repr(cls) for cls in GoodWay.mro())\nprint(mro_str)\n\n>>>\n<class \'__main__.GoodWay\'>\n<class \'__main__.TimesSevenCorrect\'>\n<class \'__main__.PlusNineCorrect\'>\n<class \'__main__.MyBaseClass\'>\n<class \'object\'>`, `30010351796881830000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">mro_str <span class="token operator">=</span> <span class="token string">\'\\n\'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span> <span class="token keyword">for</span> cls <span class="token keyword">in</span> GoodWay<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>mro_str<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'__main__.GoodWay\'</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'__main__.TimesSevenCorrect\'</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'__main__.PlusNineCorrect\'</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'__main__.MyBaseClass\'</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">\'object\'</span><span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>调用 GoodWay(5) 时，会先触发 <code class="language-text">TimesSevenCorrect.__init__</code>，进而触发 <code class="language-text">PlusNineCorrect.__init__</code>，而这又会触发 <code class="language-text">MyBaseClass.__init__</code>。程序到达菱形结构的顶端后，开始执行 MyBaseClass 的初始化逻辑，然后按照与刚才相反的顺序，依次执行 PlusNineCorrect、TimesSevenCorrect 与 GoodWay 的初始化逻辑。所以，程序首先会在 <code class="language-text">MyBaseClass.__init__</code> 中，把 value 设为 5，然后在 <code class="language-text">PlusNineCorrect.__init__</code> 里面给它加 9，这样就成了 14，接着又会在 <code class="language-text">TimesSevenCorrect.__init__</code> 里面将它乘 7，于是等于 98。</p>\n<p>除了可以应对菱形继承结构，通过 super() 调用 <code class="language-text">__init__</code>，与在子类内通过类名直接调用 <code class="language-text">__init__</code> 相比，可使代码更容易维护。现在不用从子类里面指名调用 <code class="language-text">MyBaseClass.__init__</code> 方法了，因此可以把 MyBaseClass 改成其他名字，或者让 TimesSevenCorrect 与 PlusNineCorrect 从另外一个超类里面继承，这些改动都无须调整 super 这一部分的代码。假如像原来那样写，那就必须手工修改 <code class="language-text">__init__</code> 方法前面的类名。</p>\n<p>super 函数也可以用双参数的形式调用。第一个参数表示从这个类型开始（不含该类型本身）按照方法解析顺序（MRO）向上搜索，而解析顺序则要由第二个参数所在类型的 <code class="language-text">__mro__</code> 决定。例如，按照下面这种写法，如果在 super 所返回的内容上调用 <code class="language-text">__init__</code> 方法，那么程序会从 ExplicitTrisect 类型开始（不含该类型本身）按照 MRO 向上搜索，直至找到这样的 <code class="language-text">__init__</code> 方法为止，而解析顺序是由第二个参数（self）所属的类型（ExplicitTrisect）决定的，所以解析顺序是 <code class="language-text">ExplicitTrisect -&gt; MyBaseClass -&gt; object</code>。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="25670873885511393000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ExplicitTrisect(MyBaseClass):\n    def __init__(self, value):\n        super(ExplicitTrisect, self).__init__(value)\n        self.value /= 3`, `25670873885511393000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ExplicitTrisect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span>ExplicitTrisect<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">/=</span> <span class="token number">3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>一般来说，在类的 <code class="language-text">__init__</code> 方法里面通过 super 初始化实例时，不需要采用双参数的形式，而是可以直接采用不带参数的写法调用 super，这样 Python 编译器会自动将 <code class="language-text">__class__</code> 和 self 当成参数传递进去。所以，下面这两种写法跟刚才那种写法是同一个意思。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66059908663722000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.value = value\n\n\nclass ExplicitTrisect(MyBaseClass):\n    def __init__(self, value):\n        super(ExplicitTrisect, self).__init__(value)\n        self.value /= 3\n\n\nclass AutomaticTrisect(MyBaseClass):\n    def __init__(self, value):\n        super(__class__, self).__init__(value)\n        self.value /= 3\n\n\nclass ImplicitTrisect(MyBaseClass):\n    def __init__(self, value):\n        super().__init__(value)\n        self.value /= 3\n\n\nassert ExplicitTrisect(9).value == 3\nassert AutomaticTrisect(9).value == 3\nassert ImplicitTrisect(9).value == 3`, `66059908663722000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n\n\n<span class="token keyword">class</span> <span class="token class-name">ExplicitTrisect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span>ExplicitTrisect<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">/=</span> <span class="token number">3</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">AutomaticTrisect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span>__class__<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">/=</span> <span class="token number">3</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">ImplicitTrisect</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">/=</span> <span class="token number">3</span>\n\n\n<span class="token keyword">assert</span> ExplicitTrisect<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">3</span>\n<span class="token keyword">assert</span> AutomaticTrisect<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">3</span>\n<span class="token keyword">assert</span> ImplicitTrisect<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只有一种情况需要明确给 super 指定参数，这就是：我们想从子类里面访问超类对某项功能所做的实现方案，而那种方案可能已经被子类覆盖掉了（例如，在封装或复用功能时，就会遇到这样的情况）。</p>\n<h3 id="总结-36"><a href="#%E6%80%BB%E7%BB%93-36" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Python 有标准的方法解析顺序（MRO）规则，可以用来判定超类之间的初始化顺序，并解决菱形继承问题。</li>\n<li>可以通过 Python 内置的 super 函数正确触发超类的 <code class="language-text">__init__</code> 逻辑。一般情况下，不需要给这个函数指定参数。</li>\n</ol>\n<h2 id="第-41-条：考虑用-mix-in-类来表示可组合的功能"><a href="#%E7%AC%AC-41-%E6%9D%A1%EF%BC%9A%E8%80%83%E8%99%91%E7%94%A8-mix-in-%E7%B1%BB%E6%9D%A5%E8%A1%A8%E7%A4%BA%E5%8F%AF%E7%BB%84%E5%90%88%E7%9A%84%E5%8A%9F%E8%83%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 41 条：考虑用 mix-in 类来表示可组合的功能</h2>\n<p>Python 是面向对象的编程语言，而且内置了相关的机制，使开发者能够正确处理多重继承（参见第 40 条）。尽管如此，但还是应该尽量少用多重继承。</p>\n<p>如果既要通过多重继承来方便地封装逻辑，又想避开可能出现的问题，那么就应该把有待继承的类写成 mix-in 类。这种类只提供一小套方法给子类去沿用，而不定义自己实例级别的属性，也不需要 <code class="language-text">__init__</code> 构造函数。</p>\n<p>在 Python 里很容易编写 mix-in，因为无论对象是什么类型，我们都可以方便地检视（inspect）它当前的状态。这种动态检测机制，让我们只需要把通用的功能在 mix-in 实现一遍即可，将来也可以把这项功能应用到其他许多类里面。可以把这些 mix-in 类有层次地组合起来，从而用相当少的代码表达出丰富的功能。</p>\n<p>例如，现在要实现这样一个功能，把内存中的 Python 对象表示成字典形式以便做序列化（serialization）处理。不妨将这项功能写为通用代码，以供其他类使用。</p>\n<p>为了演示这种做法，笔者定义下面这个 mix-in，让它提供名为 <code class="language-text">to_dict</code> 的 public 方法。凡是想支持这项功能的类，都可以从 mix-in 继承。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98170853834482930000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ToDictMixin:\n    def to_dict(self):\n        return self._traverse_dict(self.__dict__)`, `98170853834482930000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ToDictMixin</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">to_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>具体的实现代码写得很直观，我们可以通过 isinstance 函数动态地检视值的类型，并利用 hasattr 函数判断值里面有没有叫作 <code class="language-text">__dict__</code> 的字典。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98905806109863030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def _traverse_dict(self, instance_dict):\n    output = {}\n    for key, value in instance_dict.items():\n        output[key] = self._traverse(key, value)\n    return output\n\n\ndef _traverse(self, key, value):\n    if isinstance(value, ToDictMixin):\n        return value.to_dict()\n    elif isinstance(value, dict):\n        return self._traverse_dict(value)\n    elif isinstance(value, list):\n        return [self._traverse(key, i) for i in value]\n    elif hasattr(value, \'__dict__\'):\n        return self._traverse_dict(value.__dict__)\n    else:\n        return value`, `98905806109863030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">_traverse_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> instance_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        output<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n    <span class="token keyword">return</span> output\n\n\n<span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> value<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n    <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">]</span>\n    <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">\'__dict__\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n    <span class="token keyword">else</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> value</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>下面以二叉树为例，演示如何使表示二叉树的 BinaryTree 类具备刚才那个 mix-in 所提供的功能。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58712940488460740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BinaryTree(ToDictMixin):\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right`, `58712940488460740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>定义了这样的 BinaryTree 类后，很容易就能把二叉树里面那些相互关联的 Python 对象转换成字典的形式。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62327564387968270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ToDictMixin:\n    def _traverse_dict(self, instance_dict):\n        output = {}\n        for key, value in instance_dict.items():\n            output[key] = self._traverse(key, value)\n        return output\n\n    def _traverse(self, key, value):\n        if isinstance(value, ToDictMixin):\n            return value.to_dict()\n        elif isinstance(value, dict):\n            return self._traverse_dict(value)\n        elif isinstance(value, list):\n            return [self._traverse(key, i) for i in value]\n        elif hasattr(value, \'__dict__\'):\n            return self._traverse_dict(value.__dict__)\n        else:\n            return value\n\n    def to_dict(self):\n        return self._traverse_dict(self.__dict__)\n\n\nclass BinaryTree(ToDictMixin):\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\ntree = BinaryTree(10,\n                  left=BinaryTree(7, right=BinaryTree(9)),\n                  right=BinaryTree(13, left=BinaryTree(11)))\nprint(tree.to_dict())\n\n>>>\n{\'value\': 10, \'left\': {\'value\': 7, \'left\': None, \'right\': {\'value\': 9, \'left\': None, \'right\': None}}, \'right\': {\'value\': 13, \'left\': {\'value\': 11, \'left\': None, \'right\': None}, \'right\': None}}`, `62327564387968270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{31-34}"\n              >\n                <span class="gatsby-code-button-language">py{31-34}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ToDictMixin</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> instance_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            output<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> output\n\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">]</span>\n        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">\'__dict__\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value\n\n    <span class="token keyword">def</span> <span class="token function">to_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="gatsby-highlight-code-line">tree <span class="token operator">=</span> BinaryTree<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">                  left<span class="token operator">=</span>BinaryTree<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> right<span class="token operator">=</span>BinaryTree<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">                  right<span class="token operator">=</span>BinaryTree<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> left<span class="token operator">=</span>BinaryTree<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>mix-in 最妙的地方在于，子类既可以沿用它所提供的功能，又可以对其中一些地方做自己的处理。例如，我们从普通的二叉树（BinaryTree）派生了一个子类，让这种特殊的 BinaryTreeWithParent 二叉树能够把指向上级节点的引用保留下来。但问题是，这种二叉树的 <code class="language-text">to_dict</code> 方法是从 ToDictMixin 继承来的，它所触发的 <code class="language-text">_traverse</code> 方法，在面对循环引用时，会无休止地递归下去。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="92232482440689550000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BinaryTreeWithParent(BinaryTree):\n    def __init__(self, value, left=None,\n                 right=None, parent=None):\n        super().__init__(value, left=left, right=right)\n        self.parent = parent`, `92232482440689550000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BinaryTreeWithParent</span><span class="token punctuation">(</span>BinaryTree<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>\n                 right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">,</span> left<span class="token operator">=</span>left<span class="token punctuation">,</span> right<span class="token operator">=</span>right<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为了避免无限循环，我们可以覆盖 <code class="language-text">BinaryTreeWithParent._traverse</code> 方法，让它对指向上级节点的引用做专门处理，而对于其他的值，则继续沿用从 mix-in 继承的 <code class="language-text">_traverse</code> 逻辑。下面这段代码，首先判断当前值是不是指向上级节点的引用。如果是，就直接返回上级节点的 value 值；如果不是，那就通过内置的 super 函数沿用由 mix-in 超类所给出默认实现方案。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16056238173810390000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`def _traverse(self, key, value):\n   if (isinstance(value, BinaryTreeWithParent) and\n            key == \'parent\'):\n      return value.value  # Prevent cycles\n   else:\n      return super()._traverse(key, value)`, `16056238173810390000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> BinaryTreeWithParent<span class="token punctuation">)</span> <span class="token keyword">and</span>\n            key <span class="token operator">==</span> <span class="token string">\'parent\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> value<span class="token punctuation">.</span>value  <span class="token comment"># Prevent cycles</span>\n   <span class="token keyword">else</span><span class="token punctuation">:</span>\n      <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在调用 <code class="language-text">BinaryTreeWithParent.to_dict</code> 就没有问题了，因为它所触发的是 BinaryTreeWithParent 自己的 <code class="language-text">_traverse</code> 方法，该方法不会再递归地处理循环引用。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44409859694713315000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ToDictMixin:\n    def _traverse_dict(self, instance_dict):\n        output = {}\n        for key, value in instance_dict.items():\n            output[key] = self._traverse(key, value)\n        return output\n\n    def _traverse(self, key, value):\n        if isinstance(value, ToDictMixin):\n            return value.to_dict()\n        elif isinstance(value, dict):\n            return self._traverse_dict(value)\n        elif isinstance(value, list):\n            return [self._traverse(key, i) for i in value]\n        elif hasattr(value, \'__dict__\'):\n            return self._traverse_dict(value.__dict__)\n        else:\n            return value\n\n    def to_dict(self):\n        return self._traverse_dict(self.__dict__)\n\n\nclass BinaryTree(ToDictMixin):\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\nclass BinaryTreeWithParent(BinaryTree):\n    def __init__(self, value, left=None,\n                 right=None, parent=None):\n        super().__init__(value, left=left, right=right)\n        self.parent = parent\n\n    def _traverse(self, key, value):\n        if (isinstance(value, BinaryTreeWithParent) and\n                key == \'parent\'):\n            return value.value  # Prevent cycles\n        else:\n            return super()._traverse(key, value)\n\n\nroot = BinaryTreeWithParent(10)\nroot.left = BinaryTreeWithParent(7, parent=root)\nroot.left.right = BinaryTreeWithParent(9, parent=root.left)\nprint(root.to_dict())\n\n>>>\n{\'value\': 10, \'left\': {\'value\': 7, \'left\': None, \'right\': {\'value\': 9, \'left\': None, \'right\': None, \'parent\': 7}, \'parent\': 10}, \'right\': None, \'parent\': None}`, `44409859694713315000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{37-42}"\n              >\n                <span class="gatsby-code-button-language">py{37-42}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ToDictMixin</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> instance_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            output<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> output\n\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">]</span>\n        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">\'__dict__\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value\n\n    <span class="token keyword">def</span> <span class="token function">to_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryTreeWithParent</span><span class="token punctuation">(</span>BinaryTree<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>\n                 right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">,</span> left<span class="token operator">=</span>left<span class="token punctuation">,</span> right<span class="token operator">=</span>right<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent\n\n<span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> BinaryTreeWithParent<span class="token punctuation">)</span> <span class="token keyword">and</span></span><span class="gatsby-highlight-code-line">                key <span class="token operator">==</span> <span class="token string">\'parent\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            <span class="token keyword">return</span> value<span class="token punctuation">.</span>value  <span class="token comment"># Prevent cycles</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span></span>\n\nroot <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>\nroot<span class="token punctuation">.</span>left <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>root<span class="token punctuation">)</span>\nroot<span class="token punctuation">.</span>left<span class="token punctuation">.</span>right <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'parent\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'parent\'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'parent\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只要 <code class="language-text">BinaryTreeWithParent._traverse</code> 没问题，带有 BinaryTreeWithParent 属性的其他类就可以直接继承 ToDictMixin，这样的话，程序在把这种对象转化成字典时，会自动对其中的 BinaryTreeWithParent 属性做出正确处理。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57315459382229020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ToDictMixin:\n    def _traverse_dict(self, instance_dict):\n        output = {}\n        for key, value in instance_dict.items():\n            output[key] = self._traverse(key, value)\n        return output\n\n    def _traverse(self, key, value):\n        if isinstance(value, ToDictMixin):\n            return value.to_dict()\n        elif isinstance(value, dict):\n            return self._traverse_dict(value)\n        elif isinstance(value, list):\n            return [self._traverse(key, i) for i in value]\n        elif hasattr(value, \'__dict__\'):\n            return self._traverse_dict(value.__dict__)\n        else:\n            return value\n\n    def to_dict(self):\n        return self._traverse_dict(self.__dict__)\n\n\nclass BinaryTree(ToDictMixin):\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\nclass BinaryTreeWithParent(BinaryTree):\n    def __init__(self, value, left=None,\n                 right=None, parent=None):\n        super().__init__(value, left=left, right=right)\n        self.parent = parent\n\n    def _traverse(self, key, value):\n        if (isinstance(value, BinaryTreeWithParent) and\n                key == \'parent\'):\n            return value.value  # Prevent cycles\n        else:\n            return super()._traverse(key, value)\n\n\nclass NamedSubTree(ToDictMixin):\n    def __init__(self, name, tree_with_parent):\n        self.name = name\n        self.tree_with_parent = tree_with_parent\n\n\nroot = BinaryTreeWithParent(10)\nroot.left = BinaryTreeWithParent(7, parent=root)\nroot.left.right = BinaryTreeWithParent(9, parent=root.left)\n\nmy_tree = NamedSubTree(\'foobar\', root.left.right)\nprint(my_tree.to_dict())  # No infinite loop\n\n>>>\n{\'name\': \'foobar\', \'tree_with_parent\': {\'value\': 9, \'left\': None, \'right\': None, \'parent\': 7}}`, `57315459382229020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{45-48,55-56}"\n              >\n                <span class="gatsby-code-button-language">py{45-48,55-56}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ToDictMixin</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> instance_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            output<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> output\n\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">]</span>\n        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">\'__dict__\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value\n\n    <span class="token keyword">def</span> <span class="token function">to_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryTreeWithParent</span><span class="token punctuation">(</span>BinaryTree<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>\n                 right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>value<span class="token punctuation">,</span> left<span class="token operator">=</span>left<span class="token punctuation">,</span> right<span class="token operator">=</span>right<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent\n\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> BinaryTreeWithParent<span class="token punctuation">)</span> <span class="token keyword">and</span>\n                key <span class="token operator">==</span> <span class="token string">\'parent\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value<span class="token punctuation">.</span>value  <span class="token comment"># Prevent cycles</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n\n\n<span class="gatsby-highlight-code-line"><span class="token keyword">class</span> <span class="token class-name">NamedSubTree</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> tree_with_parent<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name</span><span class="gatsby-highlight-code-line">        self<span class="token punctuation">.</span>tree_with_parent <span class="token operator">=</span> tree_with_parent</span>\n\nroot <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>\nroot<span class="token punctuation">.</span>left <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>root<span class="token punctuation">)</span>\nroot<span class="token punctuation">.</span>left<span class="token punctuation">.</span>right <span class="token operator">=</span> BinaryTreeWithParent<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span>\n\n<span class="gatsby-highlight-code-line">my_tree <span class="token operator">=</span> NamedSubTree<span class="token punctuation">(</span><span class="token string">\'foobar\'</span><span class="token punctuation">,</span> root<span class="token punctuation">.</span>left<span class="token punctuation">.</span>right<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>my_tree<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># No infinite loop</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'name\'</span><span class="token punctuation">:</span> <span class="token string">\'foobar\'</span><span class="token punctuation">,</span> <span class="token string">\'tree_with_parent\'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'value\'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">\'left\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'right\'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">\'parent\'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>多个 mix-in 可以组合起来用。例如，我们要再写一个 mix-in，让所有的类都可以通过继承它来实现 JSON 序列化功能。在编写这个 mix-in 时，假设继承了它的那个类肯定有自己的 <code class="language-text">to_dict</code> 方法（这个方法有可能是从另一个 mix-in（如 ToDictMixin）继承的）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="1755312778830897400"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import json\n\n\nclass JsonMixin:\n    @classmethod\n    def from_json(cls, data):\n        kwargs = json.loads(data)\n        return cls(**kwargs)\n\n    def to_json(self):\n        return json.dumps(self.to_dict())`, `1755312778830897400`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> json\n\n\n<span class="token keyword">class</span> <span class="token class-name">JsonMixin</span><span class="token punctuation">:</span>\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">from_json</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        kwargs <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> cls<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>self<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>请注意，JsonMixin 既定义了实例方法，也定义了类方法。于是，继承了这个 mix-in 的其他类也会拥有这两种行为。在本例中，继承 JsonMixin 的类只需要提供 <code class="language-text">to_dict</code> 方法以及能够接受关键字参数的 <code class="language-text">__init__</code> 方法即可（参见第 23 条）。</p>\n<p>有了这样两个 mix-in，我们很容易就能创建一套含有工具类的体系，让其中的各种类型都可以把对象序列化成 JSON 格式并且能够根据 JSON 格式的数据创建这样的对象。而这只需要开发者按照固定的样式多写一点点代码即可。例如，可以用这样一套由数据类所构成的体系表示数据中心的各种设备与它们之间的结构关系。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96039946354065470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import json\n\n\nclass ToDictMixin:\n    def _traverse_dict(self, instance_dict):\n        output = {}\n        for key, value in instance_dict.items():\n            output[key] = self._traverse(key, value)\n        return output\n\n    def _traverse(self, key, value):\n        if isinstance(value, ToDictMixin):\n            return value.to_dict()\n        elif isinstance(value, dict):\n            return self._traverse_dict(value)\n        elif isinstance(value, list):\n            return [self._traverse(key, i) for i in value]\n        elif hasattr(value, \'__dict__\'):\n            return self._traverse_dict(value.__dict__)\n        else:\n            return value\n\n    def to_dict(self):\n        return self._traverse_dict(self.__dict__)\n\n\nclass JsonMixin:\n    @classmethod\n    def from_json(cls, data):\n        kwargs = json.loads(data)\n        return cls(**kwargs)\n\n    def to_json(self):\n        return json.dumps(self.to_dict())\n\n\nclass Switch(ToDictMixin, JsonMixin):\n    def __init__(self, ports=None, speed=None):\n        self.ports = ports\n        self.speed = speed\n\n\nclass Machine(ToDictMixin, JsonMixin):\n    def __init__(self, cores=None, ram=None, disk=None):\n        self.cores = cores\n        self.ram = ram\n        self.disk = disk\n\n\nclass DatacenterRack(ToDictMixin, JsonMixin):\n    def __init__(self, switch=None, machines=None):\n        self.switch = Switch(**switch)\n        self.machines = [\n            Machine(**kwargs) for kwargs in machines]\n\n\nserialized = &quot;&quot;&quot;{\n    &quot;switch&quot;: {&quot;ports&quot;: 5, &quot;speed&quot;: 1e9},\n    &quot;machines&quot;: [\n        {&quot;cores&quot;: 8, &quot;ram&quot;: 32e9, &quot;disk&quot;: 5e12},\n        {&quot;cores&quot;: 4, &quot;ram&quot;: 16e9, &quot;disk&quot;: 1e12},\n        {&quot;cores&quot;: 2, &quot;ram&quot;: 4e9, &quot;disk&quot;: 500e9}\n    ]\n}\n&quot;&quot;&quot;\n\ndeserialized = DatacenterRack.from_json(serialized)\nroundtrip = deserialized.to_json()\nassert json.loads(serialized) == json.loads(roundtrip)`, `96039946354065470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">import</span> json\n\n\n<span class="token keyword">class</span> <span class="token class-name">ToDictMixin</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        output <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> instance_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            output<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> output\n\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ToDictMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">)</span>\n        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> value<span class="token punctuation">]</span>\n        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">\'__dict__\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>value<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n        <span class="token keyword">else</span><span class="token punctuation">:</span>\n            <span class="token keyword">return</span> value\n\n    <span class="token keyword">def</span> <span class="token function">to_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_traverse_dict<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">JsonMixin</span><span class="token punctuation">:</span>\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">from_json</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        kwargs <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>\n        <span class="token keyword">return</span> cls<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>self<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">,</span> JsonMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ports<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ports <span class="token operator">=</span> ports\n        self<span class="token punctuation">.</span>speed <span class="token operator">=</span> speed\n\n\n<span class="token keyword">class</span> <span class="token class-name">Machine</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">,</span> JsonMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cores<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ram<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> disk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>cores <span class="token operator">=</span> cores\n        self<span class="token punctuation">.</span>ram <span class="token operator">=</span> ram\n        self<span class="token punctuation">.</span>disk <span class="token operator">=</span> disk\n\n\n<span class="token keyword">class</span> <span class="token class-name">DatacenterRack</span><span class="token punctuation">(</span>ToDictMixin<span class="token punctuation">,</span> JsonMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> switch<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> machines<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>switch <span class="token operator">=</span> Switch<span class="token punctuation">(</span><span class="token operator">**</span>switch<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>machines <span class="token operator">=</span> <span class="token punctuation">[</span>\n            Machine<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token keyword">for</span> kwargs <span class="token keyword">in</span> machines<span class="token punctuation">]</span>\n\n\nserialized <span class="token operator">=</span> <span class="token triple-quoted-string string">"""{\n    "switch": {"ports": 5, "speed": 1e9},\n    "machines": [\n        {"cores": 8, "ram": 32e9, "disk": 5e12},\n        {"cores": 4, "ram": 16e9, "disk": 1e12},\n        {"cores": 2, "ram": 4e9, "disk": 500e9}\n    ]\n}\n"""</span>\n\ndeserialized <span class="token operator">=</span> DatacenterRack<span class="token punctuation">.</span>from_json<span class="token punctuation">(</span>serialized<span class="token punctuation">)</span>\nroundtrip <span class="token operator">=</span> deserialized<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>serialized<span class="token punctuation">)</span> <span class="token operator">==</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>roundtrip<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写之后，我们很容易就能根据 JSON 格式的信息把这些对象还原出来，另外，也可以把它们再序列化成 JSON 格式。下面我们就先把 serialized 变量所指的一段 JSON 信息反序列化（也就是还原）成 DatacenterRack 对象，然后再把这个对象序列化成 JSON 信息并保存到 roundtrip 变量，最后通过 json.loads 方法验证这两个变量中的信息是否等效。</p>\n<p>对于 JsonMixin 这样的 mix-in 来说，即便直接继承它的那个类还通过类体系中的其他更高层类型间接地继承了它，程序也依然能够正常运行，因为 Python 可以把相关的方法正确地派发给 JsonMixin 类。</p>\n<h3 id="总结-37"><a href="#%E6%80%BB%E7%BB%93-37" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>超类最好能写成不带实例属性与 <code class="language-text">__init__</code> 方法的 mix-in 类，以避免由多重继承所引发的一些问题。</li>\n<li>如果子类要定制（或者说修改）mix-in 所提供的功能，那么可以在自己的代码里面覆盖相关的实例方法。</li>\n<li>根据需求，mix-in 可以只提供实例方法，也可以只提供类方法，还可以同时提供这两种方法。</li>\n<li>把每个 mix-in 所提供的简单功能组合起来，可以实现比较复杂的功能。</li>\n</ol>\n<h2 id="第-42-条：优先考虑用-public-属性表示应受保护的数据，不要用-private-属性表示"><a href="#%E7%AC%AC-42-%E6%9D%A1%EF%BC%9A%E4%BC%98%E5%85%88%E8%80%83%E8%99%91%E7%94%A8-public-%E5%B1%9E%E6%80%A7%E8%A1%A8%E7%A4%BA%E5%BA%94%E5%8F%97%E4%BF%9D%E6%8A%A4%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%B8%8D%E8%A6%81%E7%94%A8-private-%E5%B1%9E%E6%80%A7%E8%A1%A8%E7%A4%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 42 条：优先考虑用 public 属性表示应受保护的数据，不要用 private 属性表示</h2>\n<p>Python 类的属性只有两种访问级别，也就是 public 与 private。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60739906467669740000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyObject:\n    def __init__(self):\n        self.public_field = 5\n        self.__private_field = 10\n\n    def get_private_field(self):\n        return self.__private_field`, `60739906467669740000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>public_field <span class="token operator">=</span> <span class="token number">5</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">10</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>public 属性能够公开访问，只需要在对象后面加上圆点操作符（dot operator），并写出属性的名称即可。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16161185748179595000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyObject:\n    def __init__(self):\n        self.public_field = 5\n        self.__private_field = 10\n\n    def get_private_field(self):\n        return self.__private_field\n\n\nfoo = MyObject()\nassert foo.public_field == 5`, `16161185748179595000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{10-11}"\n              >\n                <span class="gatsby-code-button-language">py{10-11}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>public_field <span class="token operator">=</span> <span class="token number">5</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">10</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field\n\n\n<span class="gatsby-highlight-code-line">foo <span class="token operator">=</span> MyObject<span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> foo<span class="token punctuation">.</span>public_field <span class="token operator">==</span> <span class="token number">5</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果属性名以两个下划线开头，那么即为 private 字段。属性所在的类可以通过实例方法访问该属性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78838331610744460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyObject:\n    def __init__(self):\n        self.public_field = 5\n        self.__private_field = 10\n\n    def get_private_field(self):\n        return self.__private_field\n\n\nfoo = MyObject()\nassert foo.get_private_field() == 10`, `78838331610744460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{11}"\n              >\n                <span class="gatsby-code-button-language">py{11}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>public_field <span class="token operator">=</span> <span class="token number">5</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">10</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field\n\n\nfoo <span class="token operator">=</span> MyObject<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> foo<span class="token punctuation">.</span>get_private_field<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">10</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>但如果在类的外面直接通过对象访问 private 字段，那么程序就会抛出异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23292058354853840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyObject:\n    def __init__(self):\n        self.public_field = 5\n        self.__private_field = 10\n\n    def get_private_field(self):\n        return self.__private_field\n\n\nfoo = MyObject()\nfoo.__private_field\n\n>>>\nTraceback ...\nAttributeError: \'MyObject\' object has no attribute \'__private_field\'`, `23292058354853840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{11}"\n              >\n                <span class="gatsby-code-button-language">py{11}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>public_field <span class="token operator">=</span> <span class="token number">5</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">10</span>\n\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field\n\n\nfoo <span class="token operator">=</span> MyObject<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="gatsby-highlight-code-line">foo<span class="token punctuation">.</span>__private_field</span>\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nAttributeError<span class="token punctuation">:</span> <span class="token string">\'MyObject\'</span> <span class="token builtin">object</span> has no attribute <span class="token string">\'__private_field\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>类方法（@classmethod）可以访问本类的 private 属性，因为这种方法也是在这个类（class）的范围里面声明的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="29030976898519100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyOtherObject:\n    def __init__(self):\n        self.__private_field = 71\n\n    @classmethod\n    def get_private_field_of_instance(cls, instance):\n        return instance.__private_field\n\n\nbar = MyOtherObject()\nassert MyOtherObject.get_private_field_of_instance(bar) == 71`, `29030976898519100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyOtherObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">71</span>\n\n    @<span class="token builtin">classmethod</span>\n    <span class="token keyword">def</span> <span class="token function">get_private_field_of_instance</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> instance<span class="token punctuation">.</span>__private_field\n\n\nbar <span class="token operator">=</span> MyOtherObject<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> MyOtherObject<span class="token punctuation">.</span>get_private_field_of_instance<span class="token punctuation">(</span>bar<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">71</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>private 字段只给这个类自己使用，子类不能访问超类的 private 字段。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="10858250018584158000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyParentObject:\n    def __init__(self):\n        self.__private_field = 71\n\n\nclass MyChildObject(MyParentObject):\n    def get_private_field(self):\n        return self.__private_field\n\n\nbaz = MyChildObject()\nbaz.get_private_field()\n\n>>>\nTraceback ...\nAttributeError: \'MyChildObject\' object has no attribute \'_MyChildObject__private_field\'`, `10858250018584158000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyParentObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">71</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyChildObject</span><span class="token punctuation">(</span>MyParentObject<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field\n\n\nbaz <span class="token operator">=</span> MyChildObject<span class="token punctuation">(</span><span class="token punctuation">)</span>\nbaz<span class="token punctuation">.</span>get_private_field<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nAttributeError<span class="token punctuation">:</span> <span class="token string">\'MyChildObject\'</span> <span class="token builtin">object</span> has no attribute <span class="token string">\'_MyChildObject__private_field\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这种防止其他类访问 private 属性的功能，其实仅仅是通过变换属性名称而实现的。当 Python 编译器看到 <code class="language-text">MyChildObject.get_private_field</code> 这样的方法想要访问 <code class="language-text">__private_field</code> 属性时，它会把下划线和类名加在这个属性名称的前面，所以代码实际上访问的是 <code class="language-text">_MyChildObject__private_field</code>。在上面的例子中，<code class="language-text">__private_field</code> 是在 MyParentObject 的 <code class="language-text">__init__</code> 里面定义的，所以，它变换之后的真实名称是 <code class="language-text">_MyParentObject__private_field</code>。子类不能通过 <code class="language-text">__private_field</code> 来访问这个属性，因为这样写实际上是在访问不存在的 <code class="language-text">_MyChildObject__private_field</code>，而不是 <code class="language-text">_MyParentObject__private_field</code>。</p>\n<p>了解名称变换规则后，我们就可以从任何一个类里面访问 private 属性。无论是子类还是外部的类，都可以不经许可就访问到这些属性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62692669756380545000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyParentObject:\n    def __init__(self):\n        self.__private_field = 71\n\n\nclass MyChildObject(MyParentObject):\n    def get_private_field(self):\n        return self.__private_field\n\n\nbaz = MyChildObject()\nassert baz._MyParentObject__private_field == 71`, `62692669756380545000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{12}"\n              >\n                <span class="gatsby-code-button-language">py{12}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyParentObject</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__private_field <span class="token operator">=</span> <span class="token number">71</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyChildObject</span><span class="token punctuation">(</span>MyParentObject<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">get_private_field</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__private_field\n\n\nbaz <span class="token operator">=</span> MyChildObject<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="gatsby-highlight-code-line"><span class="token keyword">assert</span> baz<span class="token punctuation">.</span>_MyParentObject__private_field <span class="token operator">==</span> <span class="token number">71</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>查看该对象的属性字典，就会发现 private 属性的名称其实是以变换后的名称存储的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="97146732417038500000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`print(baz.__dict__)\n\n>>>\n{\'_MyParentObject__private_field\': 71}`, `97146732417038500000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">print</span><span class="token punctuation">(</span>baz<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\n<span class="token punctuation">{</span><span class="token string">\'_MyParentObject__private_field\'</span><span class="token punctuation">:</span> <span class="token number">71</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为什么 Python 不从语法上严格禁止其他类访问 private 属性呢？这可以用一句常见的 Python 格言来回答：我们都是成年人了（We are all consenting adults here）。意思是说，我们用不着让编程语言把自己给拦住。你可以按照自己的想法扩展某个类的功能，同时也必须考虑到这样做的风险，并为此负责。Python 开发者相信，虽然开放访问权限可能导致别人不按默认方式扩展这个类，但总比封闭起来要好。</p>\n<p>另外，Python 里面还有一些挂钩函数可以访问到这种属性（参见第 47 条），我们可以通过这些机制按需操纵对象的内部数据。既然这样，那即便 Python 阻止我们通过圆点加名称的办法访问 private 属性，我们也还是有其他办法能访问到，那么 Python 阻止 private 属性访问又有何意义？</p>\n<p>为了减少在不知情情况下访问内部数据而造成的损伤，Python 开发者会按照风格指南里面建议的方式来给字段命名（参见第 2 条）。以单下划线开头的字段（例如 <code class="language-text">_protected_field</code>），习惯上叫作受保护的（protected）字段，表示这个类以外的用户在使用这种字段时必须慎重。</p>\n<p>尽管如此，有许多 Python 新手还是喜欢把内部的 API 设计成 private 字段，想通过这种写法防止子类或外部类访问这些字段。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77862698706013260000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyStringClass:\n    def __init__(self, value):\n        self.__value = value\n\n    def get_value(self):\n        return str(self.__value)\n\n\nfoo = MyStringClass(5)\nassert foo.get_value() == \'5\'`, `77862698706013260000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyStringClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__value <span class="token operator">=</span> value\n\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>__value<span class="token punctuation">)</span>\n\n\nfoo <span class="token operator">=</span> MyStringClass<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> foo<span class="token punctuation">.</span>get_value<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">\'5\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这么写不对。因为总会有开发者（也包括你自己）想要继承这个类，并给里面添加新的行为，或采用更高效的办法来实现已有的行为（例如他可能觉得，<code class="language-text">MyStringClass.get_value</code> 总是返回字符串的方式的效率不高）。如果把属性设为 private，那么子类在覆盖或扩充这个类的时候，就必须采用变换之后的名称来访问那个属性，这会让代码变得很容易出错。例如，在写这样一个子类时，就不得不去访问超类中的 private 字段。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49070891226176450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyStringClass:\n    def __init__(self, value):\n        self.__value = value\n\n    def get_value(self):\n        return str(self.__value)\n\n\nclass MyIntegerSubclass(MyStringClass):\n    def get_value(self):\n        return int(self._MyStringClass__value)\n\n\nfoo = MyIntegerSubclass(\'5\')\nassert foo.get_value() == 5`, `49070891226176450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyStringClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__value <span class="token operator">=</span> value\n\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>__value<span class="token punctuation">)</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyIntegerSubclass</span><span class="token punctuation">(</span>MyStringClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_MyStringClass__value<span class="token punctuation">)</span>\n\n\nfoo <span class="token operator">=</span> MyIntegerSubclass<span class="token punctuation">(</span><span class="token string">\'5\'</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> foo<span class="token punctuation">.</span>get_value<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这样写的问题是，如果类体系发生变动，那么引用 private 属性的那些代码就失效了。例如，MyIntegerSubclass 类的直接超类（也就是 MyStringClass）本身现在也继承自一个类（叫作 MyBaseClass），而且它把早前的 <code class="language-text">__value</code> 属性移到了那个类里面。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="23661690923898982000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyBaseClass:\n    def __init__(self, value):\n        self.__value = value\n\n    def get_value(self):\n        return self.__value\n\n\nclass MyStringClass(MyBaseClass):\n    def get_value(self):\n        return str(super().get_value())  # Updated\n\n\nclass MyIntegerSubclass(MyStringClass):\n    def get_value(self):\n        return int(self._MyStringClass__value)  # Not updated\n\n\nfoo = MyIntegerSubclass(5)\nfoo.get_value()\n\n>>>\nTraceback ...\nAttributeError: \'MyIntegerSubclass\' object has no attribute \'_MyStringClass__value\'`, `23661690923898982000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyBaseClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__value <span class="token operator">=</span> value\n\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__value\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyStringClass</span><span class="token punctuation">(</span>MyBaseClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Updated</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">MyIntegerSubclass</span><span class="token punctuation">(</span>MyStringClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_MyStringClass__value<span class="token punctuation">)</span>  <span class="token comment"># Not updated</span>\n\n\nfoo <span class="token operator">=</span> MyIntegerSubclass<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>\nfoo<span class="token punctuation">.</span>get_value<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nAttributeError<span class="token punctuation">:</span> <span class="token string">\'MyIntegerSubclass\'</span> <span class="token builtin">object</span> has no attribute <span class="token string">\'_MyStringClass__value\'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>现在的 <code class="language-text">__value</code> 属性，是在 MyBaseClass 里面设置的，而不是在 MyStringClass 里面，所以 MyIntegerSubclass 没办法再通过 <code class="language-text">self._MyStringClass__value</code> 访问这个属性。</p>\n<p>一般来说，这种属性应该设置成 protected 字段，这样虽然有可能导致子类误用，但还是要比直接设为 private 好。我们可以在每个 protected 字段的文档里面详细解释，告诉用户这是属于可以由子类来操作的内部 API，还是属于完全不应该触碰的数据。这样的文档，既可以给别人提供建议，也可以指导自己安全地扩充代码。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="77122730243890320000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class MyStringClass:\n    def __init__(self, value):\n        # This stores the user-supplied value for the object.\n        # It should be coercible to a string. Once assigned in\n        # the object it should be treated as immutable.\n        self._value = value`, `77122730243890320000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">MyStringClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token comment"># This stores the user-supplied value for the object.</span>\n        <span class="token comment"># It should be coercible to a string. Once assigned in</span>\n        <span class="token comment"># the object it should be treated as immutable.</span>\n        self<span class="token punctuation">.</span>_value <span class="token operator">=</span> value</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>只有一种情况是可以考虑用 private 属性解决的，就是子类属性有可能与超类重名的情况。如果子类定义属性时使用的名称，恰巧与超类相同，那就会出现这个问题。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="64886949844468990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ApiClass:\n    def __init__(self):\n        self._value = 5\n\n    def get(self):\n        return self._value\n\n\nclass Child(ApiClass):\n    def __init__(self):\n        super().__init__()\n        self._value = \'hello\'  # Conflicts\n\n\na = Child()\nprint(f\'{a.get()} and {a._value} should be different\')`, `64886949844468990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ApiClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_value <span class="token operator">=</span> <span class="token number">5</span>\n\n    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_value\n\n\n<span class="token keyword">class</span> <span class="token class-name">Child</span><span class="token punctuation">(</span>ApiClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>_value <span class="token operator">=</span> <span class="token string">\'hello\'</span>  <span class="token comment"># Conflicts</span>\n\n\na <span class="token operator">=</span> Child<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">.</span>_value<span class="token punctuation">}</span></span><span class="token string"> should be different\'</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果超类属于开放给外界使用的 API，那么你就没办法预料哪些子类会继承它，也不知道那些子类会添加什么属性，此时很有可能出现这个问题，而且你无法通过重构代码来解决。属性名越常见（如本例中的 value），越容易发生冲突。为了减少冲突，我们可以把超类的属性设计成 private 属性，使子类的属性名不太可能与超类重复。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76734871918554370000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ApiClass:\n    def __init__(self):\n        self.__value = 5  # Double underscore\n\n    def get(self):\n        return self.__value  # Double underscore\n\n\nclass Child(ApiClass):\n    def __init__(self):\n        super().__init__()\n        self._value = \'hello\'  # OK!\n\n\na = Child()\nprint(f\'{a.get()} and {a._value} are different\')`, `76734871918554370000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">ApiClass</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>__value <span class="token operator">=</span> <span class="token number">5</span>  <span class="token comment"># Double underscore</span>\n\n    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__value  <span class="token comment"># Double underscore</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">Child</span><span class="token punctuation">(</span>ApiClass<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>_value <span class="token operator">=</span> <span class="token string">\'hello\'</span>  <span class="token comment"># OK!</span>\n\n\na <span class="token operator">=</span> Child<span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'</span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">.</span>_value<span class="token punctuation">}</span></span><span class="token string"> are different\'</span></span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="总结-38"><a href="#%E6%80%BB%E7%BB%93-38" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>Python 编译器无法绝对禁止外界访问 private 属性。</li>\n<li>从一开始就应该考虑允许其他类能继承这个类，并利用其中的内部 API 与属性去实现更多功能，而不是把它们藏起来。</li>\n<li>把需要保护的数据设计成 protected 字段，并用文档加以解释，而不要通过 private 属性限制访问。</li>\n<li>只有在子类不受控制且名称有可能与超类冲突时，才可以考虑给超类设计 private 属性。</li>\n</ol>\n<h2 id="第-43-条：自定义的容器类型应该从-collectionsabc-继承"><a href="#%E7%AC%AC-43-%E6%9D%A1%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B%E5%BA%94%E8%AF%A5%E4%BB%8E-collectionsabc-%E7%BB%A7%E6%89%BF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第 43 条：自定义的容器类型应该从 collections.abc 继承</h2>\n<p>编写 Python 程序时，要花很多精力来定义类，以存放数据并描述这种对象与其他对象之间的关系。每个 Python 类其实都是某种容器，可以把属性与功能封装进来。除了自定义的类之外，Python 本身还提供了一些内置的容器类型，例如列表（list）、元组（tuple）、集合（set）、字典（dict）等，也可以用来管理数据。</p>\n<p>如果要定义的是那种用法比较简单的类，那么我们自然就会想到直接从 Python 内置的容器类型里面继承，例如通过继承 list 类型实现某种序列。下面就是笔者自己定制的一种 list 类型，它在 list 的基础上提供了 frequency 方法，用来计算每个元素出现的次数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="35592486961635970000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class FrequencyList(list):\n    def __init__(self, members):\n        super().__init__(members)\n\n    def frequency(self):\n        counts = {}\n        for item in self:\n            counts[item] = counts.get(item, 0) + 1\n        return counts`, `35592486961635970000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">FrequencyList</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> members<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>members<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">frequency</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        counts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">:</span>\n            counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> counts</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>继承 list 类，可以自动获得标准的 Python 列表所具备的各项功能。这样的话，其他开发者就可以像使用普通列表那样使用 FrequencyList 了。此外，我们还可以定义其他一些方法，来提供想要实现的各种行为。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="52309060810416190000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class FrequencyList(list):\n    def __init__(self, members):\n        super().__init__(members)\n\n    def frequency(self):\n        counts = {}\n        for item in self:\n            counts[item] = counts.get(item, 0) + 1\n        return counts\n\n\nfoo = FrequencyList([\'a\', \'b\', \'a\', \'c\', \'b\', \'a\', \'d\'])\nprint(\'Length is\', len(foo))\n\nprint(foo.pop())\nprint(\'After pop:\', repr(foo))\nprint(\'Frequency:\', foo.frequency())\n\n>>>\nLength is 7\nd\nAfter pop: [\'a\', \'b\', \'a\', \'c\', \'b\', \'a\']\nFrequency: {\'a\': 3, \'b\': 2, \'c\': 1}`, `52309060810416190000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{12-17}"\n              >\n                <span class="gatsby-code-button-language">py{12-17}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">FrequencyList</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> members<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>members<span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">frequency</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        counts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n        <span class="token keyword">for</span> item <span class="token keyword">in</span> self<span class="token punctuation">:</span>\n            counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> counts<span class="token punctuation">.</span>get<span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>\n        <span class="token keyword">return</span> counts\n\n\n<span class="gatsby-highlight-code-line">foo <span class="token operator">=</span> FrequencyList<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'d\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Length is\'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After pop:\'</span><span class="token punctuation">,</span> <span class="token builtin">repr</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Frequency:\'</span><span class="token punctuation">,</span> foo<span class="token punctuation">.</span>frequency<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="token operator">>></span><span class="token operator">></span>\nLength <span class="token keyword">is</span> <span class="token number">7</span>\nd\nAfter pop<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">,</span> <span class="token string">\'a\'</span><span class="token punctuation">]</span>\nFrequency<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">\'a\'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">\'b\'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">\'c\'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>有的时候，某个对象所属的类本身虽然不是 list 的子类，但我们还是想让它能像 list 那样，可以通过下标来访问。例如，下面这个表示二叉树节点的 BinaryNode 类就不是 list 的子类，但我们想让它能够像序列（list 或 tuple 等）那样，通过下标来访问。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79639439447074650000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BinaryNode:\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right`, `79639439447074650000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BinaryNode</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们需要怎么做，才能让这个类可以像序列一样访问呢？答案是，需要实现一些名称特殊的实例方法。当通过下标访问序列中的元素时：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="39587520111382020000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`bar = [1, 2, 3]\nbar[0]`, `39587520111382020000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">bar <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>\nbar<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>Python 会把访问操作解读为：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="73479617946283330000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`bar.__getitem__(0)`, `73479617946283330000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">bar<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>所以，为了让 BinaryNode 类能像序列那样使用，我们可以定义 <code class="language-text">__getitem__</code> 方法（一般叫作 dunder getitem，其中的 dunder 为 double underscore（双下划线）的简称）。这个方法可以按照深度优先的方式遍历 BinaryNode 对象所表示的二叉树。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96907953935838450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BinaryNode:\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\nclass IndexableNode(BinaryNode):\n    def _traverse(self):\n        if self.left is not None:\n            yield from self.left._traverse()\n        yield self\n        if self.right is not None:\n            yield from self.right._traverse()\n\n    def __getitem__(self, index):\n        for i, item in enumerate(self._traverse()):\n            if i == index:\n                return item.value\n        raise IndexError(f\'Index {index} is out of range\')\n\n\ntree = IndexableNode(\n    10,\n    left=IndexableNode(\n        5,\n        left=IndexableNode(2),\n        right=IndexableNode(\n            6,\n            right=IndexableNode(7))),\n    right=IndexableNode(\n        15,\n        left=IndexableNode(11)))\n\nprint(\'LRR is\', tree.left.right.right.value)\nprint(\'Index 0 is\', tree[0])\nprint(\'Index 1 is\', tree[1])\nprint(\'11 in the tree?\', 11 in tree)\nprint(\'17 in the tree?\', 17 in tree)\nprint(\'Tree is\', list(tree))\n\n>>>\nLRR is 7\nIndex 0 is 2\nIndex 1 is 5\n11 in the tree? True\n17 in the tree? False\nTree is [2, 5, 6, 7, 10, 11, 15]`, `96907953935838450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BinaryNode</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="token keyword">class</span> <span class="token class-name">IndexableNode</span><span class="token punctuation">(</span>BinaryNode<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>left <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>left<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">yield</span> self\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>right <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>right<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">if</span> i <span class="token operator">==</span> index<span class="token punctuation">:</span>\n                <span class="token keyword">return</span> item<span class="token punctuation">.</span>value\n        <span class="token keyword">raise</span> IndexError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Index </span><span class="token interpolation"><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token string"> is out of range\'</span></span><span class="token punctuation">)</span>\n\n\ntree <span class="token operator">=</span> IndexableNode<span class="token punctuation">(</span>\n    <span class="token number">10</span><span class="token punctuation">,</span>\n    left<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span>\n        <span class="token number">5</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        right<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span>\n            <span class="token number">6</span><span class="token punctuation">,</span>\n            right<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    right<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span>\n        <span class="token number">15</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>IndexableNode<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'LRR is\'</span><span class="token punctuation">,</span> tree<span class="token punctuation">.</span>left<span class="token punctuation">.</span>right<span class="token punctuation">.</span>right<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Index 0 is\'</span><span class="token punctuation">,</span> tree<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Index 1 is\'</span><span class="token punctuation">,</span> tree<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'11 in the tree?\'</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token keyword">in</span> tree<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'17 in the tree?\'</span><span class="token punctuation">,</span> <span class="token number">17</span> <span class="token keyword">in</span> tree<span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Tree is\'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nLRR <span class="token keyword">is</span> <span class="token number">7</span>\nIndex <span class="token number">0</span> <span class="token keyword">is</span> <span class="token number">2</span>\nIndex <span class="token number">1</span> <span class="token keyword">is</span> <span class="token number">5</span>\n<span class="token number">11</span> <span class="token keyword">in</span> the tree? <span class="token boolean">True</span>\n<span class="token number">17</span> <span class="token keyword">in</span> the tree? <span class="token boolean">False</span>\nTree <span class="token keyword">is</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>我们可以像使用 BinaryNode 那样，用这种定制过的 IndexableNode 对象来构造二叉树。</p>\n<p>我们既可以像访问列表那样来访问二叉树中的节点，也可以明确通过 left 与 right 属性来访问。</p>\n<p>但问题是，除了下标索引，list 实例还支持其他一些功能，所以只实现 <code class="language-text">__getitem__</code> 这样一个特殊方法是不够的。例如，我们现在还是没办法像查询 list 长度那样查询这种二叉树的长度（元素总数）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="74463182958016480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`len(tree)\n\n>>>\nTraceback ...\nTypeError: object of type \'IndexableNode\' has no len()`, `74463182958016480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token builtin">len</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> <span class="token builtin">object</span> of <span class="token builtin">type</span> <span class="token string">\'IndexableNode\'</span> has no <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>要想让定制的二叉树支持内置的 len 函数，必须再实现一个特殊方法，也就是 <code class="language-text">__len__</code> 方法。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34757881282838454000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class BinaryNode:\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\nclass SequenceNode(BinaryNode):\n    def _traverse(self):\n        if self.left is not None:\n            yield from self.left._traverse()\n        yield self\n        if self.right is not None:\n            yield from self.right._traverse()\n\n    def __getitem__(self, index):\n        for i, item in enumerate(self._traverse()):\n            if i == index:\n                return item.value\n        raise IndexError(f\'Index {index} is out of range\')\n\n    def __len__(self):\n        for count, _ in enumerate(self._traverse(), 1):\n            pass\n        return count\n\n\ntree = SequenceNode(\n    10,\n    left=SequenceNode(\n        5,\n        left=SequenceNode(2),\n        right=SequenceNode(\n            6,\n            right=SequenceNode(7))),\n    right=SequenceNode(\n        15,\n        left=SequenceNode(11)))\n\nprint(\'Tree length is\', len(tree))\n\n>>>\nTree length is 7`, `34757881282838454000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py{22-25}"\n              >\n                <span class="gatsby-code-button-language">py{22-25}</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight has-highlighted-lines" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">BinaryNode</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="token keyword">class</span> <span class="token class-name">SequenceNode</span><span class="token punctuation">(</span>BinaryNode<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>left <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>left<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">yield</span> self\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>right <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>right<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">if</span> i <span class="token operator">==</span> index<span class="token punctuation">:</span>\n                <span class="token keyword">return</span> item<span class="token punctuation">.</span>value\n        <span class="token keyword">raise</span> IndexError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Index </span><span class="token interpolation"><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token string"> is out of range\'</span></span><span class="token punctuation">)</span>\n\n<span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">for</span> count<span class="token punctuation">,</span> _ <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            <span class="token keyword">pass</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">return</span> count</span>\n\ntree <span class="token operator">=</span> SequenceNode<span class="token punctuation">(</span>\n    <span class="token number">10</span><span class="token punctuation">,</span>\n    left<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span>\n        <span class="token number">5</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        right<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span>\n            <span class="token number">6</span><span class="token punctuation">,</span>\n            right<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    right<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span>\n        <span class="token number">15</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>SequenceNode<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Tree length is\'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTree length <span class="token keyword">is</span> <span class="token number">7</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>实现完这样两个方法之后，我们仍然没办法让这种二叉树具备列表所应支持的全套功能。因为，有些 Python 开发者可能还想在二叉树上面调用 count 与 index 等方法，他们觉得，既然 list 或 tuple 这样的序列支持这些方法，那二叉树也应该支持才对。这样看来，要定制一个与标准容器兼容的类，似乎比想象中麻烦。</p>\n<p>为了方便大家定制容器，Python 内置的 collections.abc 模块定义了一系列抽象基类（abstract base class），把每种容器类型应该提供的所有常用方法都写了出来。我们只需要从这样的抽象基类里面继承就好。同时，如果忘了实现某些必备的方法，那么程序会报错，提醒我们这些方法必须实现。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="75291337346105640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections.abc import Sequence\n\n\nclass BadType(Sequence):\n    pass\n\n\nfoo = BadType()\n\n>>>\nTraceback ...\nTypeError: Can\'t instantiate abstract class BadType with abstract methods __getitem__, __len__`, `75291337346105640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> Sequence\n\n\n<span class="token keyword">class</span> <span class="token class-name">BadType</span><span class="token punctuation">(</span>Sequence<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\nfoo <span class="token operator">=</span> BadType<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nTypeError<span class="token punctuation">:</span> Can\'t instantiate abstract <span class="token keyword">class</span> <span class="token class-name">BadType</span> <span class="token keyword">with</span> abstract methods __getitem__<span class="token punctuation">,</span> __len__</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果这些必备的方法都已经实现好了，那我们就可以从 collections.abc 模块的抽象基类里面继承了。例如，下面这个 BetterNode 二叉树类就是正确的，因为它已经通过继承前面的 SequenceNode 类实现了序列容器所应支持的全部必备方法，至于其他一些方法（例如 index 与 count）则会由 Sequence 这个抽象基类自动帮我们实现（它在实现的时候，会借助 BetterNode 从 SequenceNode 继承的那些必备方法）。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="53873126440558486000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`from collections.abc import Sequence\n\n\nclass BinaryNode:\n    def __init__(self, value, left=None, right=None):\n        self.value = value\n        self.left = left\n        self.right = right\n\n\nclass SequenceNode(BinaryNode):\n    def _traverse(self):\n        if self.left is not None:\n            yield from self.left._traverse()\n        yield self\n        if self.right is not None:\n            yield from self.right._traverse()\n\n    def __getitem__(self, index):\n        for i, item in enumerate(self._traverse()):\n            if i == index:\n                return item.value\n        raise IndexError(f\'Index {index} is out of range\')\n\n    def __len__(self):\n        for count, _ in enumerate(self._traverse(), 1):\n            pass\n        return count\n\n\nclass BetterNode(SequenceNode, Sequence):\n    pass\n\n\ntree = BetterNode(\n    10,\n    left=BetterNode(\n        5,\n        left=BetterNode(2),\n        right=BetterNode(\n            6,\n            right=BetterNode(7))),\n    right=BetterNode(\n        15,\n        left=BetterNode(11))\n)\n\nprint(\'Index of 7 is\', tree.index(7))\nprint(\'Count of 10 is\', tree.count(10))\n\n>>>\nIndex of 7 is 3\nCount of 10 is 1`, `53873126440558486000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> Sequence\n\n\n<span class="token keyword">class</span> <span class="token class-name">BinaryNode</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value\n        self<span class="token punctuation">.</span>left <span class="token operator">=</span> left\n        self<span class="token punctuation">.</span>right <span class="token operator">=</span> right\n\n\n<span class="token keyword">class</span> <span class="token class-name">SequenceNode</span><span class="token punctuation">(</span>BinaryNode<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>left <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>left<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token keyword">yield</span> self\n        <span class="token keyword">if</span> self<span class="token punctuation">.</span>right <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>\n            <span class="token keyword">yield</span> <span class="token keyword">from</span> self<span class="token punctuation">.</span>right<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">if</span> i <span class="token operator">==</span> index<span class="token punctuation">:</span>\n                <span class="token keyword">return</span> item<span class="token punctuation">.</span>value\n        <span class="token keyword">raise</span> IndexError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Index </span><span class="token interpolation"><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span><span class="token string"> is out of range\'</span></span><span class="token punctuation">)</span>\n\n    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">for</span> count<span class="token punctuation">,</span> _ <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_traverse<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">pass</span>\n        <span class="token keyword">return</span> count\n\n\n<span class="token keyword">class</span> <span class="token class-name">BetterNode</span><span class="token punctuation">(</span>SequenceNode<span class="token punctuation">,</span> Sequence<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">pass</span>\n\n\ntree <span class="token operator">=</span> BetterNode<span class="token punctuation">(</span>\n    <span class="token number">10</span><span class="token punctuation">,</span>\n    left<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span>\n        <span class="token number">5</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        right<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span>\n            <span class="token number">6</span><span class="token punctuation">,</span>\n            right<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    right<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span>\n        <span class="token number">15</span><span class="token punctuation">,</span>\n        left<span class="token operator">=</span>BetterNode<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Index of 7 is\'</span><span class="token punctuation">,</span> tree<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Count of 10 is\'</span><span class="token punctuation">,</span> tree<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nIndex of <span class="token number">7</span> <span class="token keyword">is</span> <span class="token number">3</span>\nCount of <span class="token number">10</span> <span class="token keyword">is</span> <span class="token number">1</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>对于定制集合或可变映射等复杂的容器类型来说，继承 collections.abc 模块里的 Set 或 MutableMapping 等抽象基类所带来的好处会更加明显。假如自己从头开始实现，那必须编写大量的特殊方法才能让这些容器类的对象也能像标准的 Python 容器那样使用。</p>\n<p>collections.abc 模块要求子类必须实现某些特殊方法，另外，Python 在比较或排列对象时，还会用到其他一些特殊方法，无论定制的是不是容器类，有时为了支持某些功能，你都必须定义相关的特殊方法才行（案例参见第 73 条）。</p>\n<h3 id="总结-39"><a href="#%E6%80%BB%E7%BB%93-39" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>如果要编写的新类比较简单，那么可以直接从 Python 的容器类型（例如 list 或 dict）里面继承。</li>\n<li>如果想让定制的容器类型能像标准的 Python 容器那样使用，那么有可能要编写许多特殊方法。</li>\n<li>可以从 collections.abc 模块里的抽象基类之中派生自己的容器类型，这样可以让容器自动具备相关的功能，同时又可以保证没有把实现这些功能所必备的方法给漏掉。</li>\n</ol>\n<h1 id="元类与属性"><a href="#%E5%85%83%E7%B1%BB%E4%B8%8E%E5%B1%9E%E6%80%A7" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>元类与属性</h1>\n<h2 id="用纯属性与修饰器取代旧式的-setter-与-getter-方法"><a href="#%E7%94%A8%E7%BA%AF%E5%B1%9E%E6%80%A7%E4%B8%8E%E4%BF%AE%E9%A5%B0%E5%99%A8%E5%8F%96%E4%BB%A3%E6%97%A7%E5%BC%8F%E7%9A%84-setter-%E4%B8%8E-getter-%E6%96%B9%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用纯属性与修饰器取代旧式的 setter 与 getter 方法</h2>\n<p>从其他编程语言转入 Python 的开发者，可能想在类里面明确地实现 getter 与 setter 方法。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66648243384637150000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class OldResistor:\n    def __init__(self, ohms):\n        self._ohms = ohms\n\n    def get_ohms(self):\n        return self._ohms\n\n    def set_ohms(self, ohms):\n        self._ohms = ohms`, `66648243384637150000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">OldResistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_ohms <span class="token operator">=</span> ohms\n\n    <span class="token keyword">def</span> <span class="token function">get_ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_ohms\n\n    <span class="token keyword">def</span> <span class="token function">set_ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_ohms <span class="token operator">=</span> ohms</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>虽然这些 setter 与 getter 用起来很简单，但这并不符合 Python 的风格。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20970145791941360000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`r0 = OldResistor(50e3)\nprint(\'Before:\', r0.get_ohms())\nr0.set_ohms(10e3)\nprint(\'After: \', r0.get_ohms())\n\n>>>\nBefore: 50000.0\nAfter:  10000.0`, `20970145791941360000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">r0 <span class="token operator">=</span> OldResistor<span class="token punctuation">(</span><span class="token number">50e3</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'Before:\'</span><span class="token punctuation">,</span> r0<span class="token punctuation">.</span>get_ohms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nr0<span class="token punctuation">.</span>set_ohms<span class="token punctuation">(</span><span class="token number">10e3</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'After: \'</span><span class="token punctuation">,</span> r0<span class="token punctuation">.</span>get_ohms<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore<span class="token punctuation">:</span> <span class="token number">50000.0</span>\nAfter<span class="token punctuation">:</span>  <span class="token number">10000.0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>例如，想让属性值变大或者变小，采用这些方法来写会特别麻烦。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="2848904960312004000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`r0.set_ohms(r0.get_ohms() - 4e3)\nassert r0.get_ohms() == 6e3`, `2848904960312004000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">r0<span class="token punctuation">.</span>set_ohms<span class="token punctuation">(</span>r0<span class="token punctuation">.</span>get_ohms<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">4e3</span><span class="token punctuation">)</span>\n<span class="token keyword">assert</span> r0<span class="token punctuation">.</span>get_ohms<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">6e3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>这种工具方法确实有助于将类的接口定义得更加清晰，并方便开发者封装功能、验证用法、划定界限。这些都是在设计类时应该考虑的目标，实现这些目标可以确保我们在完善这个类的过程中不影响已经写好的调用代码。</p>\n<p>可是，在 Python 中实现这些目标时，没必要明确定义 setter 与 getter 方法。而是应该从最简单的 public 属性开始写起，例如像下面这样：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48793258466181920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resistor:\n    def __init__(self, ohms):\n        self.ohms = ohms\n        self.voltage = 0\n        self.current = 0\n\n\nr1 = Resistor(50e3)\nr1.ohms = 10e3`, `48793258466181920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Resistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ohms <span class="token operator">=</span> ohms\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">0</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span>\n\n\nr1 <span class="token operator">=</span> Resistor<span class="token punctuation">(</span><span class="token number">50e3</span><span class="token punctuation">)</span>\nr1<span class="token punctuation">.</span>ohms <span class="token operator">=</span> <span class="token number">10e3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>按照这种写法，很容易就能实现原地增减属性值。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="51612853080253070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`r1.ohms += 5e3`, `51612853080253070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">r1<span class="token punctuation">.</span>ohms <span class="token operator">+=</span> <span class="token number">5e3</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>将来如果想在设置属性时，实现特别的功能，那么可以先通过 @property 修饰器来封装获取属性的那个方法，并在封装出来的修饰器上面通过 setter 属性来封装设置属性的那个方法（参见第 26 条）。下面这个新类继承自刚才的 Resistor 类，它允许我们通过设置 voltage（电压）属性来改变 current（电流）。为了正确实现这项功能，必须保证设置属性与获取属性所用的那两个方法都跟属性同名。</p>\n<p>按照这种写法，给 voltage 属性赋值会触发同名的 setter 方法，该方法会根据新的 voltage 计算本对象的 current 属性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="55288271896269750000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resistor:\n    def __init__(self, ohms):\n        self.ohms = ohms\n        self.voltage = 0\n        self.current = 0\n\n\nclass VoltageResistance(Resistor):\n    def __init__(self, ohms):\n        super().__init__(ohms)\n        self._voltage = 0\n\n    @property\n    def voltage(self):\n        return self._voltage\n\n    @voltage.setter\n    def voltage(self, voltage):\n        self._voltage = voltage\n        self.current = self._voltage / self.ohms\n\n\nr2 = VoltageResistance(1e3)\nprint(f\'Before: {r2.current: .2f} amps\')\nr2.voltage = 10\nprint(f\'After:  {r2.current: .2f} amps\')\n\n>>>\nBefore:  0.00 amps\nAfter:   0.01 amps`, `55288271896269750000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Resistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ohms <span class="token operator">=</span> ohms\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">0</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">VoltageResistance</span><span class="token punctuation">(</span>Resistor<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>ohms<span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>_voltage <span class="token operator">=</span> <span class="token number">0</span>\n\n    @<span class="token builtin">property</span>\n    <span class="token keyword">def</span> <span class="token function">voltage</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_voltage\n\n    @voltage<span class="token punctuation">.</span>setter\n    <span class="token keyword">def</span> <span class="token function">voltage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> voltage<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_voltage <span class="token operator">=</span> voltage\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> self<span class="token punctuation">.</span>_voltage <span class="token operator">/</span> self<span class="token punctuation">.</span>ohms\n\n\nr2 <span class="token operator">=</span> VoltageResistance<span class="token punctuation">(</span><span class="token number">1e3</span><span class="token punctuation">)</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Before: </span><span class="token interpolation"><span class="token punctuation">{</span>r2<span class="token punctuation">.</span>current<span class="token punctuation">:</span><span class="token format-spec"> .2f</span><span class="token punctuation">}</span></span><span class="token string"> amps\'</span></span><span class="token punctuation">)</span>\nr2<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">10</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'After:  </span><span class="token interpolation"><span class="token punctuation">{</span>r2<span class="token punctuation">.</span>current<span class="token punctuation">:</span><span class="token format-spec"> .2f</span><span class="token punctuation">}</span></span><span class="token string"> amps\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore<span class="token punctuation">:</span>  <span class="token number">0.00</span> amps\nAfter<span class="token punctuation">:</span>   <span class="token number">0.01</span> amps</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>为属性指定 setter 方法还可以用来检查调用方所传入的值在类型与范围上是否符合要求。例如，下面这个 Resistor 子类可以确保用户设置的电阻值总是大于 0 的。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62815669531352580000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resistor:\n    def __init__(self, ohms):\n        self.ohms = ohms\n        self.voltage = 0\n        self.current = 0\n\n\nclass BoundedResistance(Resistor):\n    def __init__(self, ohms):\n        super().__init__(ohms)\n\n    @property\n    def ohms(self):\n        return self._ohms\n\n    @ohms.setter\n    def ohms(self, ohms):\n        if ohms <= 0:\n            raise ValueError(f\'ohms must be > 0; got {ohms}\')\n        self._ohms = ohms\n\n\nr3 = BoundedResistance(1e3)\nr3.ohms = 0\n\n>>>\nTraceback ...\nValueError: ohms must be > 0; got 0`, `62815669531352580000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Resistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ohms <span class="token operator">=</span> ohms\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">0</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">BoundedResistance</span><span class="token punctuation">(</span>Resistor<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>ohms<span class="token punctuation">)</span>\n\n    @<span class="token builtin">property</span>\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_ohms\n\n    @ohms<span class="token punctuation">.</span>setter\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> ohms <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'ohms must be > 0; got </span><span class="token interpolation"><span class="token punctuation">{</span>ohms<span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>_ohms <span class="token operator">=</span> ohms\n\n\nr3 <span class="token operator">=</span> BoundedResistance<span class="token punctuation">(</span><span class="token number">1e3</span><span class="token punctuation">)</span>\nr3<span class="token punctuation">.</span>ohms <span class="token operator">=</span> <span class="token number">0</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nValueError<span class="token punctuation">:</span> ohms must be <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> got <span class="token number">0</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果构造时所用的值无效，那么同样会触发异常。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6593990467563083000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`BoundedResistance(-5)\n\n>>>\nValueError: ohms must be > 0; got -5`, `6593990467563083000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py">BoundedResistance<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nValueError<span class="token punctuation">:</span> ohms must be <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> got <span class="token operator">-</span><span class="token number">5</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>之所以会出现这种效果，是因为子类的构造器（<code class="language-text">BoundedResistance.__init__</code>）会调用超类的构造器（<code class="language-text">Resistor.__init__</code>），而超类的构造器会把 self.ohms 设置成 -5。于是，就会触发 BoundedResistance 里面的 <code class="language-text">@ohms.setter</code> 方法，该方法立刻发现属性值无效，所以程序在对象还没有构造完之前，就会抛出异常。</p>\n<p>我们还可以利用 @property 阻止用户修改超类中的属性。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="38343609048214100000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resistor:\n    def __init__(self, ohms):\n        self.ohms = ohms\n        self.voltage = 0\n        self.current = 0\n\n\nclass FixedResistance(Resistor):\n    def __init__(self, ohms):\n        super().__init__(ohms)\n\n    @property\n    def ohms(self):\n        return self._ohms\n\n    @ohms.setter\n    def ohms(self, ohms):\n        if hasattr(self, \'_ohms\'):\n            raise AttributeError(&quot;Ohms is immutable&quot;)\n        self._ohms = ohms\n\n\nr4 = FixedResistance(1e3)\nr4.ohms = 2e3\n\n>>>\nTraceback ...\nAttributeError: Ohms is immutable`, `38343609048214100000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Resistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ohms <span class="token operator">=</span> ohms\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">0</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">FixedResistance</span><span class="token punctuation">(</span>Resistor<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>ohms<span class="token punctuation">)</span>\n\n    @<span class="token builtin">property</span>\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_ohms\n\n    @ohms<span class="token punctuation">.</span>setter\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">\'_ohms\'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n            <span class="token keyword">raise</span> AttributeError<span class="token punctuation">(</span><span class="token string">"Ohms is immutable"</span><span class="token punctuation">)</span>\n        self<span class="token punctuation">.</span>_ohms <span class="token operator">=</span> ohms\n\n\nr4 <span class="token operator">=</span> FixedResistance<span class="token punctuation">(</span><span class="token number">1e3</span><span class="token punctuation">)</span>\nr4<span class="token punctuation">.</span>ohms <span class="token operator">=</span> <span class="token number">2e3</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nTraceback <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\nAttributeError<span class="token punctuation">:</span> Ohms <span class="token keyword">is</span> immutable</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>构造好对象之后，如果试图给属性赋值，那么程序就会抛出异常。</p>\n<p>用 @property 实现 setter 与 getter 时，还应该注意不要让对象产生反常的行为。例如，不要在某属性的 getter 方法里面设置其他属性的值。</p>\n<p>假如在获取属性的 getter 方法里面修改了其他属性的值，那么用户查询这个属性时，就会觉得相当奇怪，他可能不理解为什么另外一个属性会在我查询这个属性时发生变化。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61566052259664940000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Resistor:\n    def __init__(self, ohms):\n        self.ohms = ohms\n        self.voltage = 0\n        self.current = 0\n\n\nclass MysteriousResistor(Resistor):\n    @property\n    def ohms(self):\n        self.voltage = self._ohms * self.current\n        return self._ohms\n\n    @ohms.setter\n    def ohms(self, ohms):\n        self._ohms = ohms\n\n\nr7 = MysteriousResistor(10)\nr7.current = 0.01\nprint(f\'Before: {r7.voltage:.2f}\')\nr7.ohms\nprint(f\'After: {r7.voltage: .2f}\')\n\n>>>\nBefore: 0.00\nAfter:  0.10`, `61566052259664940000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                title="py"\n              >\n                <span class="gatsby-code-button-language">py</span>\n                <span class="gatsby-code-button-text-icon">复制代码</span>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="py"><pre style="counter-reset: linenumber NaN" class="language-py line-numbers"><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Resistor</span><span class="token punctuation">:</span>\n    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>ohms <span class="token operator">=</span> ohms\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> <span class="token number">0</span>\n        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name">MysteriousResistor</span><span class="token punctuation">(</span>Resistor<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    @<span class="token builtin">property</span>\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>voltage <span class="token operator">=</span> self<span class="token punctuation">.</span>_ohms <span class="token operator">*</span> self<span class="token punctuation">.</span>current\n        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_ohms\n\n    @ohms<span class="token punctuation">.</span>setter\n    <span class="token keyword">def</span> <span class="token function">ohms</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ohms<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        self<span class="token punctuation">.</span>_ohms <span class="token operator">=</span> ohms\n\n\nr7 <span class="token operator">=</span> MysteriousResistor<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>\nr7<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">0.01</span>\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'Before: </span><span class="token interpolation"><span class="token punctuation">{</span>r7<span class="token punctuation">.</span>voltage<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\nr7<span class="token punctuation">.</span>ohms\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f\'After: </span><span class="token interpolation"><span class="token punctuation">{</span>r7<span class="token punctuation">.</span>voltage<span class="token punctuation">:</span><span class="token format-spec"> .2f</span><span class="token punctuation">}</span></span><span class="token string">\'</span></span><span class="token punctuation">)</span>\n\n<span class="token operator">>></span><span class="token operator">></span>\nBefore<span class="token punctuation">:</span> <span class="token number">0.00</span>\nAfter<span class="token punctuation">:</span>  <span class="token number">0.10</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>最好的办法是，只在 @property.setter 方法里面修改状态，而且只应该修改对象之中与当前属性有关的状态。同时还得注意不要产生让调用者感到意外的其他一些副作用，例如，不要动态地引入模块，不要运行速度较慢的辅助函数，不要做 I/O，不要执行开销较大的数据库查询操作等。类的属性用起来应该跟其他的 Python 对象一样方便而快捷。如果确实要执行比较复杂或比较缓慢的操作，那么应该用普通的方法来做，而不应该把这些操作放在获取及设置属性的这两个方法里面。</p>\n<p>@property 最大的缺点是，通过它而编写的属性获取及属性设置方法只能由子类共享。与此无关的类不能共用这份逻辑。但是没关系，Python 还支持描述符（descriptor，参见第 46 条），我们可以利用这种机制把早前编写的属性获取与属性设置逻辑复用到其他许多地方。</p>\n<h3 id="总结-40"><a href="#%E6%80%BB%E7%BB%93-40" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>\n<ol>\n<li>给新类定义接口时，应该先从简单的 public 属性写起，避免定义 setter 与 getter 方法。</li>\n<li>如果在访问属性时确实有必要做特殊的处理，那就通过 @property 来定义获取属性与设置属性的方法。</li>\n<li>实现 @property 方法时，应该遵循最小惊讶原则，不要引发奇怪的副作用。</li>\n<li>@property 方法必须执行得很快。复杂或缓慢的任务，尤其是涉及 I/O 或者会引发副作用的那些任务，还是用普通的方法来实现比较好。</li>\n</ol>\n<p>// TODO 编写高质量 Python 待完成</p>',
excerpt:"培养 Pythonic 思维 第 1 条：查询自己使用的 Python 版本 Python 2 于 2020 年 1 月 1 日退场，到这一刻，所有的 bug 修复、安全补丁，以及特性向后移植都会停止。此后，如果你还坚持使用 Python…",frontmatter:{date:"2023-06-13 12:00:28",path:"/writing-high-quality-python/",tags:"后端, python, 读书笔记",title:"编写高质量Python",draft:null}}},pathContext:{mainPostPath:"/three-js-practice-test/",nextPostPath:"/rust-practice-test/",prePostPath:"/writing-high-quality-python/"}}}});